-----label-----
1
-----code-----
int recv_data(int fd)
{
	struct client *c;
	ssize_t len;

	c = client_find(fd);
	if (!c) {
#ifdef DEBUG
		syslog(LOG_WARN, "could not find a client session for fd %d", fd);
		int i;
		for (i = 0; i < NUM_CLIENTS; i++) {
			if (CLIENTS[i].fd == -1) continue;
			syslog(LOG_WARN, " client[%d] fd = %d // %s", i,
					CLIENTS[i].fd, CLIENTS[i].addr);
		}
#endif
		return 0;
	}

	vdebug("reading from %s, fd %d", c->addr, fd);
	for (;;) {
		vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",
				fd, c->offset, sizeof(c->pdu), c->addr);

		len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);
		if (len <= 0) {
			if (errno == EAGAIN) return 0;
			if (len == 0)
				vdebug("EOF from %s, fd %d", c->addr, fd);
			else
				syslog(LOG_INFO, "failed to read from %s: %s",
						c->addr, strerror(errno));

			client_close(fd);
			break;
		}

		c->offset += len;
		c->bytes += len;
		vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",
				fd, len, c->offset, c->addr);

		if (c->offset < sizeof(c->pdu)) {
			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",
					c->offset, sizeof(c->pdu), c->addr, fd);
			continue;
		}

		c->offset = 0;
		if (pdu_unpack(&c->pdu) != 0) {
			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);
#ifdef DEBUG
			uint8_t *byte = ((uint8_t*)(&c->pdu));
			int off = 0;
			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)
				;
			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);
#endif
			memset(&c->pdu, 0, sizeof(c->pdu));
			continue;
		}

		syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",
				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,
				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);

		iris_call_submit_result(&c->pdu);
		memset(&c->pdu, 0, sizeof(c->pdu));
	}
	return 0;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
5,6
5,7
7,8
9,10
9,11
9,12
9,13
9,14
9,15
9,16
10,11
11,12
11,13
12,13
14,15
14,16
17,18
18,19
18,20
19,20
21,22
23,24
24,25
24,26
25,26
27,28
27,29
28,29
30,31
32,33
32,34
33,34
34,35
36,37
37,38
39,40
40,41
40,42
40,43
40,44
41,42
44,45
44,46
45,46
48,49
50,51
50,52
52,53
52,54
52,55
52,56
52,57
52,58
52,59
52,60
52,61
52,62
52,63
52,64
53,54
54,55
54,56
54,57
54,58
54,59
54,60
55,56
58,59
60,61
60,62
61,62
64,65
65,66
66,67
66,68
67,68
70,71
70,72
71,72
74,75
75,76
75,77
76,77
78,79
78,80
78,81
78,82
79,80
81,82
83,84
83,85
84,85
84,86
85,86
87,88
89,90
90,91
91,92
91,93
92,93
95,96
95,97
96,97
99,100
99,101
100,101
100,102
101,102
104,105
104,106
104,107
104,108
105,106
105,107
106,107
106,108
107,108
109,110
111,112
113,114
113,115
113,116
114,115
114,116
115,116
118,119
119,120
119,121
119,122
119,123
120,121
123,124
123,125
124,125
127,128
129,130
130,131
130,132
130,133
130,134
130,135
131,132
133,134
136,137
136,138
137,138
140,141
140,142
141,142
143,144
145,146
146,147
146,148
147,148
149,150
152,153
153,154
153,155
154,155
154,156
155,156
158,159
160,161
161,162
161,163
162,163
162,164
163,164
166,167
168,169
169,170
169,171
169,172
169,173
169,174
169,175
170,171
173,174
175,176
177,178
177,179
178,179
181,182
181,183
182,183
185,186
185,187
186,187
186,188
187,188
187,189
188,189
191,192
192,193
193,194
193,195
194,195
197,198
197,199
198,199
199,200
199,201
199,202
199,203
199,204
199,205
200,201
203,204
203,205
204,205
207,208
208,209
209,210
209,211
210,211
213,214
213,215
214,215
217,218
220,221
221,222
221,223
222,223
222,224
223,224
227,228
227,229
228,229
228,230
229,230
229,231
230,231
232,233
233,234
233,235
234,235
238,239
238,240
238,241
239,240
240,241
240,242
240,243
240,244
240,245
241,242
243,244
246,247
246,248
247,248
250,251
252,253
253,254
253,255
253,256
253,257
254,255
256,257
257,258
257,259
258,259
262,263
263,264
264,265
264,266
265,266
269,270
270,271
270,272
270,273
270,274
270,275
270,276
270,277
270,278
270,279
270,280
271,272
273,274
276,277
276,278
277,278
277,279
278,279
282,283
282,284
283,284
283,285
284,285
288,289
288,290
289,290
289,291
290,291
293,294
293,295
294,295
294,296
295,296
299,300
299,301
300,301
300,302
301,302
305,306
305,307
306,307
306,308
307,308
311,312
311,313
312,313
312,314
313,314
317,318
317,319
318,319
318,320
319,320
323,324
324,325
324,326
325,326
327,328
328,329
328,330
329,330
332,333
333,334
333,335
333,336
333,337
334,335
336,337
337,338
337,339
338,339
342,343
343,344
344,345
344,346
345,346
348,349
-----nextToken-----
2,4,6,8,13,15,16,20,22,26,29,31,35,38,42,43,46,47,49,51,56,57,59,62,63,68,69,72,73,77,80,82,86,88,93,94,97,98,102,103,108,110,112,116,117,121,122,125,126,128,132,134,135,138,139,142,144,148,150,151,156,157,159,164,165,167,171,172,174,176,179,180,183,184,189,190,195,196,201,202,205,206,211,212,215,216,218,219,224,225,226,231,235,236,237,242,244,245,248,249,251,255,259,260,261,266,267,268,272,274,275,279,280,281,285,286,287,291,292,296,297,298,302,303,304,308,309,310,314,315,316,320,321,322,326,330,331,335,339,340,341,346,347,349
-----computeFrom-----
24,25
24,26
75,76
75,77
100,101
100,102
106,107
106,108
114,115
114,116
153,154
153,155
161,162
161,163
186,187
186,188
221,222
221,223
228,229
228,230
-----guardedBy-----
102,116
196,212
195,215
190,206
236,267
235,266
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;UnaryExpression;IdExpression;Name;CompoundStatement;ReturnStatement;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ForStatement;NullStatement;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BreakStatement;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ContinueStatement;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;ContinueStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;ReturnStatement;LiteralExpression;
-----ast_node-----
int recv_data(int fd){	struct client *c;	ssize_t len;	c = client_find(fd);	if (!c) {#ifdef DEBUG		syslog(LOG_WARN, "could not find a client session for fd %d", fd);		int i;		for (i = 0; i < NUM_CLIENTS; i++) {			if (CLIENTS[i].fd == -1) continue;			syslog(LOG_WARN, " client[%d] fd = %d // %s", i,					CLIENTS[i].fd, CLIENTS[i].addr);		}#endif		return 0;	}	vdebug("reading from %s, fd %d", c->addr, fd);	for (;;) {		vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr);		len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);		if (len <= 0) {			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}		c->offset += len;		c->bytes += len;		vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr);		if (c->offset < sizeof(c->pdu)) {			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}		c->offset = 0;		if (pdu_unpack(&c->pdu) != 0) {			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}		syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);		iris_call_submit_result(&c->pdu);		memset(&c->pdu, 0, sizeof(c->pdu));	}	return 0;}
int
recv_data(int fd)
recv_data
int fd
int
fd
fd
{	struct client *c;	ssize_t len;	c = client_find(fd);	if (!c) {#ifdef DEBUG		syslog(LOG_WARN, "could not find a client session for fd %d", fd);		int i;		for (i = 0; i < NUM_CLIENTS; i++) {			if (CLIENTS[i].fd == -1) continue;			syslog(LOG_WARN, " client[%d] fd = %d // %s", i,					CLIENTS[i].fd, CLIENTS[i].addr);		}#endif		return 0;	}	vdebug("reading from %s, fd %d", c->addr, fd);	for (;;) {		vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr);		len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);		if (len <= 0) {			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}		c->offset += len;		c->bytes += len;		vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr);		if (c->offset < sizeof(c->pdu)) {			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}		c->offset = 0;		if (pdu_unpack(&c->pdu) != 0) {			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}		syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);		iris_call_submit_result(&c->pdu);		memset(&c->pdu, 0, sizeof(c->pdu));	}	return 0;}
struct client *c;
struct client *c;
struct client
client
*c
*
c
ssize_t len;
ssize_t len;
ssize_t
ssize_t
len
len
c = client_find(fd);
c = client_find(fd)
c
c
client_find(fd)
client_find
client_find
fd
fd
if (!c) {#ifdef DEBUG		syslog(LOG_WARN, "could not find a client session for fd %d", fd);		int i;		for (i = 0; i < NUM_CLIENTS; i++) {			if (CLIENTS[i].fd == -1) continue;			syslog(LOG_WARN, " client[%d] fd = %d // %s", i,					CLIENTS[i].fd, CLIENTS[i].addr);		}#endif		return 0;	}
!c
c
c
{#ifdef DEBUG		syslog(LOG_WARN, "could not find a client session for fd %d", fd);		int i;		for (i = 0; i < NUM_CLIENTS; i++) {			if (CLIENTS[i].fd == -1) continue;			syslog(LOG_WARN, " client[%d] fd = %d // %s", i,					CLIENTS[i].fd, CLIENTS[i].addr);		}#endif		return 0;	}
return 0;
0
vdebug("reading from %s, fd %d", c->addr, fd);
vdebug("reading from %s, fd %d", c->addr, fd)
vdebug
vdebug
"reading from %s, fd %d"
c->addr
c
c
addr
fd
fd
for (;;) {		vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr);		len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);		if (len <= 0) {			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}		c->offset += len;		c->bytes += len;		vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr);		if (c->offset < sizeof(c->pdu)) {			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}		c->offset = 0;		if (pdu_unpack(&c->pdu) != 0) {			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}		syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);		iris_call_submit_result(&c->pdu);		memset(&c->pdu, 0, sizeof(c->pdu));	}
;
{		vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr);		len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);		if (len <= 0) {			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}		c->offset += len;		c->bytes += len;		vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr);		if (c->offset < sizeof(c->pdu)) {			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}		c->offset = 0;		if (pdu_unpack(&c->pdu) != 0) {			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}		syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);		iris_call_submit_result(&c->pdu);		memset(&c->pdu, 0, sizeof(c->pdu));	}
vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr);
vdebug("IRIS >> fd(%d): have %d bytes, want %lu total for %s",				fd, c->offset, sizeof(c->pdu), c->addr)
vdebug
vdebug
"IRIS >> fd(%d): have %d bytes, want %lu total for %s"
fd
fd
c->offset
c
c
offset
sizeof(c->pdu)
(c->pdu)
c->pdu
c
c
pdu
c->addr
c
c
addr
len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset);
len = pdu_read(fd, (uint8_t*)(&c->pdu), c->offset)
len
len
pdu_read(fd, (uint8_t*)(&c->pdu), c->offset)
pdu_read
pdu_read
fd
fd
(uint8_t*)(&c->pdu)
uint8_t*
uint8_t
uint8_t
*
*
(&c->pdu)
&c->pdu
c->pdu
c
c
pdu
c->offset
c
c
offset
if (len <= 0) {			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}
len <= 0
len
len
0
{			if (errno == EAGAIN) return 0;			if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));			client_close(fd);			break;		}
if (errno == EAGAIN) return 0;
errno == EAGAIN
errno
errno
EAGAIN
EAGAIN
return 0;
0
if (len == 0)				vdebug("EOF from %s, fd %d", c->addr, fd);			else				syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));
len == 0
len
len
0
vdebug("EOF from %s, fd %d", c->addr, fd);
vdebug("EOF from %s, fd %d", c->addr, fd)
vdebug
vdebug
"EOF from %s, fd %d"
c->addr
c
c
addr
fd
fd
syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno));
syslog(LOG_INFO, "failed to read from %s: %s",						c->addr, strerror(errno))
syslog
syslog
LOG_INFO
LOG_INFO
"failed to read from %s: %s"
c->addr
c
c
addr
strerror(errno)
strerror
strerror
errno
errno
client_close(fd);
client_close(fd)
client_close
client_close
fd
fd
break;
c->offset += len;
c->offset += len
c->offset
c
c
offset
len
len
c->bytes += len;
c->bytes += len
c->bytes
c
c
bytes
len
len
vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr);
vdebug("IRIS >> fd(%d): read %lu (for %d total) from %s",				fd, len, c->offset, c->addr)
vdebug
vdebug
"IRIS >> fd(%d): read %lu (for %d total) from %s"
fd
fd
len
len
c->offset
c
c
offset
c->addr
c
c
addr
if (c->offset < sizeof(c->pdu)) {			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}
c->offset < sizeof(c->pdu)
c->offset
c
c
offset
sizeof(c->pdu)
(c->pdu)
c->pdu
c
c
pdu
{			vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);			continue;		}
vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd);
vdebug("Read a partial PDU (%d/%lu bytes) from %s, fd %d",					c->offset, sizeof(c->pdu), c->addr, fd)
vdebug
vdebug
"Read a partial PDU (%d/%lu bytes) from %s, fd %d"
c->offset
c
c
offset
sizeof(c->pdu)
(c->pdu)
c->pdu
c
c
pdu
c->addr
c
c
addr
fd
fd
continue;
c->offset = 0;
c->offset = 0
c->offset
c
c
offset
0
if (pdu_unpack(&c->pdu) != 0) {			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}
pdu_unpack(&c->pdu) != 0
pdu_unpack(&c->pdu)
pdu_unpack
pdu_unpack
&c->pdu
c->pdu
c
c
pdu
0
{			syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);#ifdef DEBUG			uint8_t *byte = ((uint8_t*)(&c->pdu));			int off = 0;			for (off = 0; off < sizeof(c->pdu) && *(byte+off) == '\0'; off++)				;			vdebug("first non-null byte in %s recv buffer is at position %d\n", c->addr, off);#endif			memset(&c->pdu, 0, sizeof(c->pdu));			continue;		}
syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd);
syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd)
syslog
syslog
LOG_WARN
LOG_WARN
"discarding bogus packet from %s, fd %d"
c->addr
c
c
addr
fd
fd
memset(&c->pdu, 0, sizeof(c->pdu));
memset(&c->pdu, 0, sizeof(c->pdu))
memset
memset
&c->pdu
c->pdu
c
c
pdu
0
sizeof(c->pdu)
(c->pdu)
c->pdu
c
c
pdu
continue;
syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output);
syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'",				c->pdu.crc32, c->pdu.version, (uint32_t)c->pdu.ts,				c->pdu.host, c->pdu.service, c->pdu.rc, c->pdu.output)
syslog
syslog
LOG_RESULT
LOG_RESULT
"SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d) '%s'"
c->pdu.crc32
c->pdu
c
c
pdu
crc32
c->pdu.version
c->pdu
c
c
pdu
version
(uint32_t)c->pdu.ts
uint32_t
uint32_t
uint32_t

c->pdu.ts
c->pdu
c
c
pdu
ts
c->pdu.host
c->pdu
c
c
pdu
host
c->pdu.service
c->pdu
c
c
pdu
service
c->pdu.rc
c->pdu
c
c
pdu
rc
c->pdu.output
c->pdu
c
c
pdu
output
iris_call_submit_result(&c->pdu);
iris_call_submit_result(&c->pdu)
iris_call_submit_result
iris_call_submit_result
&c->pdu
c->pdu
c
c
pdu
memset(&c->pdu, 0, sizeof(c->pdu));
memset(&c->pdu, 0, sizeof(c->pdu))
memset
memset
&c->pdu
c->pdu
c
c
pdu
0
sizeof(c->pdu)
(c->pdu)
c->pdu
c
c
pdu
return 0;
0
-----joern-----
(281,24,0)
(100,114,0)
(111,278,0)
(239,128,0)
(51,208,0)
(155,152,0)
(194,248,0)
(271,42,0)
(24,157,0)
(81,287,0)
(156,74,0)
(82,164,0)
(131,116,0)
(22,208,0)
(114,195,0)
(288,256,0)
(58,280,0)
(10,80,0)
(14,279,0)
(145,202,0)
(214,98,0)
(179,90,0)
(146,185,0)
(244,250,0)
(171,98,0)
(215,13,0)
(147,106,0)
(149,79,0)
(47,137,0)
(118,7,0)
(262,21,0)
(141,82,0)
(257,156,0)
(116,274,0)
(204,5,0)
(200,106,0)
(231,253,0)
(219,243,0)
(7,255,0)
(191,248,0)
(165,100,0)
(116,157,0)
(287,157,0)
(222,82,0)
(192,152,0)
(6,59,0)
(87,225,0)
(202,21,0)
(279,157,0)
(108,213,0)
(47,113,0)
(237,89,0)
(234,82,0)
(98,104,0)
(89,237,0)
(279,26,0)
(158,74,0)
(265,164,0)
(253,26,0)
(269,144,0)
(77,234,0)
(143,283,0)
(79,149,0)
(275,74,0)
(264,71,0)
(83,141,0)
(122,68,0)
(106,200,0)
(135,164,0)
(66,233,0)
(250,244,0)
(74,158,0)
(96,185,0)
(73,82,0)
(270,222,0)
(163,82,0)
(139,14,0)
(54,72,0)
(21,262,0)
(253,104,0)
(251,236,0)
(138,32,0)
(144,152,0)
(196,113,0)
(220,61,0)
(71,229,0)
(121,200,0)
(145,280,0)
(258,202,0)
(72,157,0)
(151,255,0)
(279,120,0)
(166,82,0)
(48,117,0)
(0,245,0)
(250,82,0)
(255,64,0)
(211,82,0)
(237,28,0)
(3,148,0)
(129,145,0)
(149,82,0)
(211,100,0)
(137,47,0)
(220,287,0)
(11,68,0)
(105,208,0)
(43,116,0)
(276,228,0)
(159,210,0)
(91,64,0)
(224,202,0)
(12,65,0)
(119,64,0)
(156,257,0)
(189,82,0)
(202,224,0)
(181,283,0)
(35,1,0)
(255,259,0)
(170,102,0)
(234,85,0)
(18,233,0)
(175,92,0)
(224,241,0)
(89,59,0)
(100,81,0)
(97,182,0)
(172,148,0)
(169,254,0)
(285,257,0)
(92,117,0)
(193,250,0)
(140,245,0)
(92,266,0)
(217,96,0)
(8,196,0)
(202,258,0)
(10,233,0)
(196,61,0)
(65,262,0)
(62,49,0)
(257,82,0)
(123,116,0)
(96,1,0)
(38,212,0)
(287,1,0)
(262,65,0)
(126,24,0)
(85,80,0)
(276,107,0)
(107,32,0)
(117,59,0)
(236,132,0)
(222,133,0)
(148,5,0)
(272,244,0)
(246,181,0)
(208,233,0)
(173,250,0)
(279,14,0)
(134,89,0)
(287,64,0)
(283,181,0)
(197,81,0)
(76,255,0)
(100,42,0)
(101,132,0)
(227,195,0)
(81,100,0)
(214,96,0)
(74,64,0)
(249,163,0)
(45,157,0)
(168,164,0)
(157,279,0)
(113,47,0)
(205,64,0)
(274,82,0)
(263,89,0)
(85,234,0)
(71,82,0)
(70,137,0)
(266,92,0)
(21,202,0)
(235,200,0)
(124,237,0)
(88,234,0)
(158,182,0)
(148,164,0)
(274,116,0)
(115,66,0)
(114,100,0)
(187,276,0)
(127,150,0)
(86,149,0)
(68,59,0)
(1,61,0)
(258,256,0)
(125,11,0)
(153,109,0)
(29,104,0)
(161,1,0)
(94,211,0)
(5,82,0)
(214,161,0)
(81,61,0)
(141,128,0)
(75,104,0)
(133,222,0)
(202,236,0)
(255,26,0)
(245,82,0)
(31,181,0)
(284,82,0)
(286,82,0)
(30,253,0)
(102,170,0)
(229,109,0)
(9,7,0)
(189,46,0)
(278,208,0)
(202,79,0)
(220,82,0)
(69,279,0)
(181,228,0)
(93,182,0)
(194,46,0)
(17,233,0)
(21,203,0)
(116,64,0)
(4,117,0)
(136,28,0)
(144,26,0)
(202,145,0)
(140,14,0)
(195,82,0)
(150,225,0)
(267,202,0)
(188,284,0)
(130,5,0)
(154,222,0)
(102,228,0)
(243,59,0)
(157,64,0)
(170,284,0)
(290,82,0)
(181,233,0)
(142,287,0)
(37,286,0)
(244,185,0)
(113,196,0)
(282,66,0)
(261,79,0)
(266,90,0)
(27,210,0)
(49,228,0)
(223,258,0)
(67,10,0)
(7,82,0)
(109,233,0)
(137,82,0)
(65,82,0)
(2,284,0)
(161,185,0)
(57,280,0)
(14,139,0)
(112,245,0)
(230,137,0)
(150,82,0)
(167,274,0)
(244,157,0)
(255,7,0)
(283,82,0)
(39,253,0)
(120,279,0)
(41,233,0)
(132,236,0)
(221,28,0)
(61,64,0)
(15,28,0)
(132,82,0)
(178,164,0)
(245,140,0)
(102,209,0)
(84,254,0)
(276,10,0)
(238,84,0)
(36,211,0)
(53,166,0)
(180,100,0)
(166,84,0)
(84,166,0)
(226,152,0)
(199,161,0)
(28,213,0)
(185,287,0)
(256,82,0)
(195,114,0)
(207,80,0)
(32,209,0)
(109,133,0)
(32,107,0)
(110,132,0)
(80,10,0)
(52,262,0)
(200,82,0)
(176,189,0)
(74,156,0)
(277,241,0)
(239,64,0)
(182,82,0)
(241,82,0)
(225,202,0)
(100,211,0)
(55,163,0)
(14,140,0)
(163,259,0)
(174,120,0)
(120,287,0)
(280,82,0)
(107,276,0)
(202,225,0)
(81,82,0)
(232,220,0)
(209,32,0)
(206,73,0)
(255,286,0)
(96,164,0)
(25,141,0)
(183,257,0)
(280,145,0)
(99,195,0)
(185,82,0)
(103,283,0)
(133,109,0)
(186,256,0)
(244,1,0)
(50,166,0)
(160,65,0)
(162,220,0)
(259,255,0)
(148,26,0)
(203,21,0)
(40,59,0)
(79,202,0)
(259,163,0)
(286,287,0)
(287,250,0)
(218,196,0)
(182,158,0)
(109,229,0)
(286,61,0)
(161,250,0)
(82,73,0)
(196,82,0)
(287,185,0)
(46,189,0)
(196,287,0)
(240,71,0)
(229,71,0)
(1,82,0)
(80,85,0)
(220,116,0)
(68,11,0)
(11,28,0)
(116,220,0)
(28,11,0)
(28,59,0)
(46,194,0)
(252,286,0)
(177,243,0)
(241,224,0)
(90,266,0)
(242,228,0)
(201,102,0)
(273,1,0)
(256,258,0)
(248,194,0)
(289,274,0)
(120,82,0)
(216,278,0)
(286,255,0)
(96,250,0)
(278,82,0)
(28,237,0)
(268,84,0)
(34,81,0)
(254,84,0)
(33,150,0)
(116,26,0)
(184,72,0)
(20,61,0)
(13,59,0)
(56,120,0)
(209,102,0)
(208,26,0)
(128,141,0)
(198,224,0)
(202,64,0)
(244,64,0)
(106,26,0)
(117,92,0)
(212,82,0)
(5,148,0)
(236,202,0)
(128,239,0)
(247,106,0)
(260,276,0)
(44,202,0)
(63,185,0)
(100,26,0)
(80,207,0)
(23,233,0)
(95,228,0)
(60,68,0)
(120,61,0)
(73,26,0)
(16,241,0)
(225,150,0)
(208,278,0)
(284,170,0)
(19,189,0)
(190,149,0)
(255,259,1)
(92,117,1)
(211,82,1)
(125,68,1)
(153,133,1)
(11,125,1)
(276,187,1)
(131,123,1)
(150,82,1)
(159,27,1)
(196,82,1)
(224,198,1)
(243,59,1)
(141,83,1)
(33,21,1)
(120,82,1)
(109,229,1)
(181,31,1)
(6,253,1)
(21,203,1)
(242,66,1)
(283,82,1)
(149,82,1)
(89,263,1)
(215,78,1)
(190,225,1)
(173,193,1)
(182,93,1)
(148,26,1)
(149,86,1)
(87,150,1)
(115,282,1)
(76,148,1)
(86,190,1)
(241,16,1)
(278,82,1)
(165,211,1)
(277,267,1)
(263,134,1)
(235,147,1)
(154,270,1)
(257,82,1)
(222,82,1)
(259,163,1)
(106,200,1)
(1,35,1)
(17,109,1)
(267,44,1)
(225,150,1)
(81,287,1)
(9,259,1)
(234,77,1)
(253,26,1)
(81,82,1)
(16,277,1)
(100,26,1)
(189,19,1)
(45,255,1)
(80,207,1)
(12,258,1)
(150,127,1)
(208,26,1)
(27,72,1)
(146,63,1)
(236,132,1)
(39,30,1)
(28,237,1)
(38,82,1)
(244,250,1)
(95,242,1)
(255,26,1)
(48,4,1)
(276,228,1)
(40,6,1)
(78,266,1)
(120,61,1)
(244,157,1)
(209,32,1)
(157,279,1)
(264,240,1)
(99,81,1)
(129,280,1)
(245,82,1)
(286,82,1)
(145,129,1)
(287,185,1)
(65,82,1)
(204,130,1)
(161,185,1)
(89,59,1)
(137,82,1)
(21,262,1)
(286,37,1)
(103,246,1)
(266,90,1)
(102,228,1)
(248,191,1)
(196,61,1)
(237,89,1)
(268,24,1)
(175,117,1)
(237,124,1)
(148,5,1)
(255,7,1)
(244,272,1)
(85,234,1)
(195,227,1)
(241,82,1)
(138,107,1)
(94,114,1)
(121,235,1)
(174,56,1)
(0,69,1)
(96,217,1)
(253,39,1)
(260,102,1)
(83,25,1)
(236,251,1)
(147,24,1)
(127,33,1)
(81,197,1)
(53,50,1)
(214,161,1)
(234,82,1)
(219,59,1)
(60,122,1)
(167,289,1)
(181,283,1)
(71,264,1)
(100,165,1)
(202,79,1)
(148,3,1)
(247,200,1)
(80,85,1)
(274,82,1)
(35,273,1)
(225,87,1)
(158,182,1)
(284,82,1)
(126,210,1)
(57,236,1)
(282,10,1)
(221,136,1)
(25,202,1)
(15,266,1)
(98,171,1)
(240,153,1)
(266,92,1)
(183,239,1)
(163,82,1)
(227,99,1)
(34,180,1)
(289,220,1)
(63,72,1)
(133,222,1)
(202,225,1)
(255,286,1)
(288,186,1)
(123,244,1)
(72,184,1)
(130,172,1)
(279,14,1)
(76,17,1)
(102,170,1)
(13,215,1)
(286,287,1)
(79,261,1)
(160,12,1)
(202,258,1)
(161,199,1)
(246,209,1)
(120,174,1)
(218,8,1)
(249,55,1)
(188,201,1)
(262,52,1)
(244,185,1)
(107,276,1)
(74,158,1)
(68,60,1)
(270,181,1)
(217,155,1)
(93,97,1)
(36,94,1)
(254,169,1)
(181,228,1)
(117,59,1)
(286,61,1)
(287,157,1)
(61,20,1)
(132,101,1)
(220,162,1)
(71,82,1)
(284,2,1)
(231,212,1)
(200,82,1)
(124,89,1)
(116,220,1)
(214,98,1)
(84,254,1)
(184,54,1)
(2,188,1)
(101,110,1)
(220,61,1)
(206,290,1)
(105,248,1)
(177,219,1)
(58,57,1)
(208,278,1)
(44,248,1)
(230,196,1)
(134,11,1)
(55,286,1)
(280,58,1)
(151,76,1)
(5,204,1)
(170,284,1)
(214,96,1)
(13,59,1)
(232,43,1)
(88,67,1)
(132,82,1)
(201,228,1)
(100,211,1)
(65,160,1)
(3,5,1)
(189,82,1)
(222,154,1)
(191,194,1)
(141,82,1)
(69,45,1)
(137,70,1)
(82,73,1)
(73,26,1)
(32,138,1)
(244,1,1)
(161,250,1)
(20,1,1)
(280,82,1)
(155,144,1)
(273,113,1)
(7,82,1)
(212,82,1)
(196,218,1)
(51,278,1)
(162,232,1)
(287,250,1)
(8,116,1)
(14,139,1)
(220,82,1)
(128,141,1)
(287,1,1)
(47,137,1)
(116,26,1)
(120,287,1)
(252,151,1)
(187,260,1)
(279,26,1)
(28,59,1)
(281,126,1)
(43,131,1)
(185,146,1)
(283,143,1)
(111,22,1)
(116,157,1)
(106,247,1)
(117,48,1)
(144,26,1)
(50,238,1)
(118,9,1)
(7,118,1)
(49,62,1)
(136,15,1)
(112,0,1)
(248,194,1)
(285,183,1)
(199,210,1)
(224,241,1)
(84,166,1)
(109,133,1)
(216,111,1)
(185,82,1)
(156,257,1)
(182,82,1)
(278,216,1)
(172,212,1)
(219,13,1)
(212,38,1)
(211,36,1)
(163,249,1)
(59,40,1)
(56,14,1)
(202,145,1)
(245,112,1)
(161,1,1)
(169,166,1)
(100,114,1)
(37,252,1)
(202,224,1)
(54,157,1)
(275,156,1)
(269,84,1)
(195,82,1)
(96,185,1)
(171,243,1)
(5,82,1)
(257,285,1)
(209,102,1)
(272,250,1)
(143,103,1)
(166,82,1)
(229,71,1)
(200,121,1)
(179,92,1)
(106,26,1)
(193,287,1)
(142,185,1)
(22,105,1)
(11,68,1)
(186,224,1)
(114,195,1)
(274,167,1)
(110,79,1)
(210,159,1)
(258,256,1)
(4,243,1)
(116,274,1)
(223,256,1)
(32,107,1)
(239,128,1)
(198,241,1)
(287,142,1)
(269,106,1)
(10,80,1)
(70,230,1)
(97,275,1)
(28,11,1)
(122,221,1)
(228,95,1)
(46,189,1)
(250,82,1)
(31,283,1)
(24,157,1)
(256,288,1)
(166,53,1)
(113,47,1)
(220,287,1)
(145,280,1)
(96,250,1)
(100,81,1)
(74,156,1)
(196,287,1)
(201,49,1)
(202,21,1)
(261,149,1)
(251,132,1)
(208,51,1)
(81,61,1)
(279,120,1)
(52,65,1)
(1,82,1)
(92,175,1)
(238,268,1)
(73,206,1)
(215,28,1)
(68,59,1)
(30,231,1)
(202,236,1)
(140,245,1)
(194,46,1)
(276,10,1)
(256,82,1)
(271,100,1)
(262,65,1)
(258,223,1)
(250,173,1)
(96,1,1)
(77,88,1)
(72,157,1)
(197,34,1)
(49,228,1)
(176,61,1)
(76,74,1)
(113,196,1)
(19,176,1)
(76,271,1)
(14,140,1)
(66,115,1)
(62,209,1)
(67,208,1)
(24,281,1)
(90,179,1)
(180,113,1)
(243,177,1)
(144,269,1)
(79,149,1)
(8,72,2)
(216,248,2)
(74,156,2)
(128,141,2)
(84,254,2)
(279,72,2)
(170,284,2)
(69,212,2)
(122,266,2)
(259,163,2)
(229,71,2)
(101,248,2)
(13,243,2)
(211,113,2)
(165,113,2)
(181,283,2)
(222,248,2)
(95,248,2)
(76,212,2)
(74,248,2)
(286,287,2)
(186,248,2)
(218,72,2)
(1,82,2)
(255,26,2)
(157,279,2)
(260,102,2)
(90,243,2)
(136,266,2)
(54,72,2)
(46,189,2)
(7,72,2)
(273,113,2)
(236,248,2)
(5,212,2)
(107,276,2)
(130,212,2)
(261,248,2)
(286,72,2)
(50,24,2)
(20,113,2)
(202,21,2)
(244,157,2)
(52,248,2)
(141,82,2)
(124,266,2)
(285,248,2)
(1,113,2)
(258,248,2)
(133,248,2)
(256,248,2)
(194,113,2)
(140,245,2)
(148,26,2)
(120,61,2)
(257,82,2)
(100,113,2)
(198,248,2)
(77,248,2)
(177,243,2)
(96,210,2)
(239,248,2)
(266,243,2)
(61,113,2)
(66,248,2)
(31,248,2)
(287,72,2)
(106,26,2)
(189,113,2)
(244,250,2)
(79,149,2)
(123,72,2)
(81,287,2)
(7,212,2)
(35,113,2)
(33,248,2)
(234,82,2)
(74,158,2)
(163,212,2)
(7,82,2)
(100,26,2)
(267,248,2)
(278,82,2)
(3,212,2)
(36,113,2)
(144,210,2)
(131,72,2)
(242,248,2)
(219,212,2)
(176,113,2)
(268,24,2)
(245,212,2)
(219,243,2)
(217,210,2)
(177,212,2)
(225,248,2)
(10,248,2)
(62,209,2)
(28,237,2)
(34,113,2)
(158,248,2)
(6,212,2)
(82,73,2)
(45,212,2)
(237,89,2)
(175,243,2)
(137,82,2)
(214,98,2)
(223,248,2)
(161,210,2)
(255,212,2)
(72,157,2)
(147,24,2)
(55,72,2)
(184,212,2)
(220,61,2)
(145,248,2)
(287,185,2)
(12,248,2)
(125,266,2)
(84,24,2)
(264,248,2)
(9,72,2)
(107,102,2)
(92,117,2)
(96,1,2)
(252,72,2)
(21,248,2)
(32,102,2)
(116,26,2)
(55,212,2)
(237,266,2)
(247,24,2)
(220,287,2)
(287,157,2)
(188,209,2)
(132,82,2)
(151,72,2)
(116,72,2)
(76,72,2)
(127,248,2)
(22,248,2)
(157,212,2)
(262,65,2)
(158,182,2)
(170,209,2)
(195,82,2)
(220,82,2)
(148,5,2)
(228,248,2)
(200,82,2)
(99,113,2)
(202,224,2)
(243,59,2)
(63,72,2)
(120,287,2)
(150,82,2)
(112,212,2)
(16,248,2)
(214,161,2)
(89,59,2)
(256,82,2)
(166,24,2)
(32,107,2)
(249,72,2)
(71,248,2)
(259,72,2)
(11,68,2)
(60,266,2)
(118,72,2)
(266,90,2)
(200,24,2)
(14,140,2)
(194,46,2)
(49,209,2)
(116,157,2)
(14,72,2)
(157,72,2)
(189,82,2)
(146,72,2)
(150,248,2)
(89,266,2)
(9,212,2)
(287,1,2)
(199,210,2)
(266,92,2)
(140,212,2)
(244,72,2)
(212,82,2)
(126,210,2)
(57,248,2)
(81,113,2)
(270,248,2)
(179,243,2)
(235,24,2)
(110,248,2)
(196,72,2)
(156,248,2)
(197,113,2)
(105,248,2)
(28,11,2)
(14,139,2)
(0,72,2)
(115,248,2)
(67,248,2)
(11,266,2)
(251,248,2)
(132,248,2)
(245,72,2)
(255,7,2)
(21,203,2)
(163,82,2)
(230,72,2)
(276,102,2)
(142,72,2)
(274,72,2)
(243,243,2)
(68,266,2)
(117,59,2)
(65,248,2)
(87,248,2)
(0,212,2)
(241,82,2)
(81,61,2)
(138,102,2)
(93,248,2)
(182,82,2)
(188,248,2)
(272,72,2)
(238,24,2)
(78,266,2)
(278,248,2)
(241,248,2)
(279,14,2)
(191,113,2)
(114,113,2)
(190,248,2)
(106,200,2)
(134,266,2)
(24,157,2)
(24,210,2)
(201,209,2)
(47,137,2)
(196,61,2)
(37,212,2)
(129,248,2)
(167,72,2)
(100,81,2)
(120,212,2)
(255,259,2)
(286,82,2)
(163,72,2)
(144,26,2)
(279,120,2)
(145,280,2)
(289,72,2)
(169,24,2)
(174,212,2)
(258,256,2)
(149,82,2)
(120,72,2)
(56,72,2)
(254,24,2)
(161,1,2)
(184,72,2)
(269,210,2)
(112,72,2)
(202,248,2)
(183,248,2)
(248,194,2)
(94,113,2)
(43,72,2)
(120,82,2)
(180,113,2)
(143,248,2)
(286,61,2)
(116,274,2)
(83,248,2)
(100,114,2)
(225,150,2)
(202,145,2)
(283,248,2)
(276,10,2)
(252,212,2)
(284,209,2)
(98,212,2)
(202,258,2)
(81,82,2)
(25,248,2)
(274,82,2)
(250,82,2)
(227,113,2)
(103,248,2)
(113,72,2)
(80,207,2)
(40,212,2)
(121,24,2)
(96,185,2)
(170,248,2)
(185,82,2)
(181,248,2)
(209,209,2)
(56,212,2)
(73,26,2)
(161,250,2)
(245,82,2)
(100,211,2)
(80,248,2)
(224,248,2)
(210,212,2)
(111,248,2)
(249,212,2)
(280,248,2)
(116,220,2)
(102,209,2)
(15,266,2)
(221,266,2)
(30,212,2)
(282,248,2)
(2,209,2)
(39,212,2)
(276,228,2)
(84,166,2)
(259,212,2)
(234,248,2)
(208,278,2)
(21,262,2)
(257,248,2)
(102,228,2)
(13,59,2)
(240,248,2)
(149,248,2)
(96,250,2)
(171,212,2)
(174,72,2)
(280,82,2)
(229,248,2)
(102,170,2)
(79,248,2)
(160,248,2)
(45,72,2)
(113,196,2)
(201,248,2)
(281,210,2)
(72,212,2)
(284,248,2)
(196,82,2)
(214,96,2)
(288,248,2)
(102,248,2)
(279,26,2)
(161,185,2)
(236,132,2)
(69,72,2)
(28,266,2)
(153,248,2)
(141,248,2)
(113,47,2)
(253,26,2)
(109,229,2)
(85,248,2)
(85,234,2)
(68,59,2)
(244,185,2)
(211,82,2)
(148,212,2)
(28,59,2)
(222,82,2)
(182,248,2)
(232,72,2)
(173,72,2)
(244,1,2)
(72,72,2)
(209,248,2)
(44,248,2)
(202,79,2)
(27,212,2)
(97,248,2)
(202,236,2)
(166,82,2)
(187,102,2)
(162,72,2)
(155,210,2)
(287,250,2)
(109,248,2)
(220,72,2)
(58,248,2)
(202,225,2)
(106,24,2)
(277,248,2)
(263,266,2)
(4,243,2)
(48,243,2)
(209,32,2)
(88,248,2)
(70,72,2)
(253,212,2)
(279,212,2)
(283,82,2)
(185,72,2)
(86,248,2)
(128,248,2)
(49,228,2)
(151,212,2)
(181,228,2)
(133,222,2)
(172,212,2)
(204,212,2)
(71,82,2)
(215,243,2)
(284,82,2)
(209,102,2)
(262,248,2)
(231,212,2)
(109,133,2)
(14,212,2)
(140,72,2)
(118,212,2)
(114,195,2)
(248,113,2)
(59,212,2)
(5,82,2)
(271,113,2)
(246,248,2)
(2,248,2)
(193,72,2)
(243,212,2)
(159,212,2)
(46,113,2)
(47,72,2)
(65,82,2)
(37,72,2)
(208,248,2)
(196,287,2)
(156,257,2)
(54,212,2)
(286,212,2)
(275,248,2)
(92,243,2)
(250,72,2)
(195,113,2)
(208,26,2)
(17,248,2)
(51,248,2)
(224,241,2)
(239,128,2)
(80,85,2)
(53,24,2)
(19,113,2)
(10,80,2)
(137,72,2)
(255,72,2)
(154,248,2)
(117,243,2)
(255,286,2)
-----------------------------------
(0,c)
(1,c->offset)
(2,pdu)
(3,fd)
(4,CLIENTS)
(5,c->addr)
(6,i)
(7,c->addr)
(8,c)
(9,c)
(10,*byte = ((uint8_t*)
(11,CLIENTS[i].fd)
(12,c)
(13,i++)
(14,(uint8_t*)
(15,LOG_WARN)
(16,pdu)
(17,continue;)
(18,for (off = 0; off < sizeof(c->pdu)
(19,pdu)
(20,0)
(21,(uint32_t)
(22,"discarding bogus packet from %s, fd %d")
(23,byte)
(24,len == 0)
(25,c)
(26,int fd)
(27,errno)
(28,syslog(LOG_WARN, " client[%d] fd = %d // %s", i,\n\\n\\t\\t\\t\\t\\tCLIENTS[i].fd, CLIENTS[i].addr)
(29,for (i = 0; i < NUM_CLIENTS; i++)
(30,"could not find a client session for fd %d")
(31,off)
(32,*(byte+off)
(33,c)
(34,c)
(35,offset)
(36,addr)
(37,offset)
(38,c)
(39,fd)
(40,0)
(41,off)
(42,)
(43,len)
(44,LOG_RESULT)
(45,len)
(46,&c->pdu)
(47,sizeof(c->pdu)
(48,i)
(49,off++)
(50,c)
(51,fd)
(52,ts)
(53,addr)
(54,len)
(55,c)
(56,c)
(57,c)
(58,pdu)
(59,i = 0)
(60,i)
(61,c->offset = 0)
(62,off)
(63,c)
(64,)
(65,c->pdu)
(66,off = 0)
(67,byte)
(68,CLIENTS[i])
(69,fd)
(70,pdu)
(71,c->pdu)
(72,len <= 0)
(73,client_find(fd)
(74,memset(&c->pdu, 0, sizeof(c->pdu)
(75,i)
(76,"IRIS >> fd(%d)
(77,pdu)
(78,continue;)
(79,c->pdu.service)
(80,(uint8_t*)
(81,c->offset)
(82,c = client_find(fd)
(83,pdu)
(84,syslog(LOG_INFO, "failed to read from %s: %s",\n\\n\\t\\t\\t\\t\\t\\tc->addr, strerror(errno)
(85,&c->pdu)
(86,pdu)
(87,host)
(88,c)
(89,CLIENTS[i])
(90,-1)
(91,if (len <= 0)
(92,CLIENTS[i].fd)
(93,pdu)
(94,c)
(95,0)
(96,return 0;)
(97,c)
(98,return 0;)
(99,c)
(100,vdebug("Read a partial PDU (%d/%lu bytes)
(101,pdu)
(102,off < sizeof(c->pdu)
(103,c)
(104,)
(105,LOG_WARN)
(106,vdebug("EOF from %s, fd %d", c->addr, fd)
(107,*(byte+off)
(108,if (CLIENTS[i].fd == -1)
(109,memset(&c->pdu, 0, sizeof(c->pdu)
(110,c)
(111,c)
(112,pdu)
(113,c->offset < sizeof(c->pdu)
(114,sizeof(c->pdu)
(115,0)
(116,vdebug("IRIS >> fd(%d)
(117,CLIENTS[i])
(118,addr)
(119,if (pdu_unpack(&c->pdu)
(120,c->offset)
(121,addr)
(122,CLIENTS)
(123,"IRIS >> fd(%d)
(124,addr)
(125,fd)
(126,len)
(127,pdu)
(128,&c->pdu)
(129,output)
(130,c)
(131,fd)
(132,c->pdu)
(133,&c->pdu)
(134,CLIENTS)
(135,for (;;)
(136," client[%d] fd = %d // %s")
(137,c->pdu)
(138,\'\\0\')
(139,uint8_t*)
(140,&c->pdu)
(141,c->pdu)
(142,len)
(143,addr)
(144,client_close(fd)
(145,c->pdu.output)
(146,offset)
(147,"EOF from %s, fd %d")
(148,vdebug("reading from %s, fd %d", c->addr, fd)
(149,c->pdu)
(150,c->pdu)
(151,fd)
(152,)
(153,0)
(154,pdu)
(155,break;)
(156,&c->pdu)
(157,len = pdu_read(fd, (uint8_t*)
(158,sizeof(c->pdu)
(159,EAGAIN)
(160,pdu)
(161,return 0;)
(162,offset)
(163,c->pdu)
(164,)
(165,fd)
(166,c->addr)
(167,addr)
(168,c)
(169,errno)
(170,sizeof(c->pdu)
(171,0)
(172,"reading from %s, fd %d")
(173,bytes)
(174,offset)
(175,fd)
(176,c)
(177,NUM_CLIENTS)
(178,if (!c)
(179,1)
(180,"Read a partial PDU (%d/%lu bytes)
(181,vdebug("first non-null byte in %s recv buffer is at position %d\\n", c->addr, off)
(182,c->pdu)
(183,c)
(184,0)
(185,c->offset)
(186,c)
(187,off)
(188,c)
(189,c->pdu)
(190,c)
(191,0)
(192,if (len == 0)
(193,c)
(194,pdu_unpack(&c->pdu)
(195,c->pdu)
(196,c->offset)
(197,offset)
(198,crc32)
(199,0)
(200,c->addr)
(201,off)
(202,syslog(LOG_RESULT, "SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d)
(203,uint32_t)
(204,addr)
(205,if (c->offset < sizeof(c->pdu)
(206,fd)
(207,uint8_t*)
(208,syslog(LOG_WARN, "discarding bogus packet from %s, fd %d", c->addr, fd)
(209,off < sizeof(c->pdu)
(210,errno == EAGAIN)
(211,c->addr)
(212,!c)
(213,)
(214,RET)
(215,i)
(216,addr)
(217,0)
(218,offset)
(219,i)
(220,c->offset)
(221,i)
(222,c->pdu)
(223,version)
(224,c->pdu.crc32)
(225,c->pdu.host)
(226,if (errno == EAGAIN)
(227,pdu)
(228,off = 0)
(229,sizeof(c->pdu)
(230,c)
(231,LOG_WARN)
(232,c)
(233,)
(234,c->pdu)
(235,c)
(236,c->pdu.rc)
(237,CLIENTS[i].addr)
(238,"failed to read from %s: %s")
(239,iris_call_submit_result(&c->pdu)
(240,c)
(241,c->pdu)
(242,off)
(243,i < NUM_CLIENTS)
(244,c->bytes += len)
(245,c->pdu)
(246,"first non-null byte in %s recv buffer is at position %d\\n")
(247,fd)
(248,pdu_unpack(&c->pdu)
(249,pdu)
(250,c->bytes)
(251,rc)
(252,c)
(253,syslog(LOG_WARN, "could not find a client session for fd %d", fd)
(254,strerror(errno)
(255,vdebug("IRIS >> fd(%d)
(256,c->pdu)
(257,c->pdu)
(258,c->pdu.version)
(259,sizeof(c->pdu)
(260,byte)
(261,service)
(262,c->pdu.ts)
(263,i)
(264,pdu)
(265,len)
(266,CLIENTS[i].fd == -1)
(267,"SERVICE RESULT %08x v%d [%d] %s/%s (rc:%d)
(268,LOG_INFO)
(269,fd)
(270,c)
(271,continue;)
(272,len)
(273,c)
(274,c->addr)
(275,0)
(276,byte+off)
(277,c)
(278,c->addr)
(279,pdu_read(fd, (uint8_t*)
(280,c->pdu)
(281,0)
(282,off)
(283,c->addr)
(284,c->pdu)
(285,pdu)
(286,c->offset)
(287,c->offset += len)
(288,pdu)
(289,c)
(290,c)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^