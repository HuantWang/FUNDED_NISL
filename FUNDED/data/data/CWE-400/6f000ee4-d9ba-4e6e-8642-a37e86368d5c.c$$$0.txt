-----label-----
0
-----code-----
static int driver_forward_broadcast(Peer *sender, Message *message) {
        _c_cleanup_(c_list_flush) CList destinations = C_LIST_INIT(destinations);
        NameSet sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names);
        MatchOwner *match_owner;
        int r;

        bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata);

        while ((match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link))) {
                Peer *receiver = c_container_of(match_owner, Peer, owned_matches);
                NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);

                c_list_unlink(&match_owner->destinations_link);

                r = policy_snapshot_check_send(sender->policy,
                                               receiver->seclabel,
                                               &receiver_names,
                                               message->metadata.fields.interface,
                                               message->metadata.fields.member,
                                               message->metadata.fields.path,
                                               message->metadata.header.type,
                                               true,
                                               message->metadata.fields.unix_fds);
                if (r) {
                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)
                                continue;

                        return error_fold(r);
                }

                r = policy_snapshot_check_receive(receiver->policy,
                                                  &sender_names,
                                                  message->metadata.fields.interface,
                                                  message->metadata.fields.member,
                                                  message->metadata.fields.path,
                                                  message->metadata.header.type,
                                                  true,
                                                  message->metadata.fields.unix_fds);
                if (r) {
                        if (r == POLICY_E_ACCESS_DENIED)
                                continue;

                        return error_fold(r);
                }

                r = connection_queue(&receiver->connection, NULL, message);
                if (r) {
                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {
                                connection_shutdown(&receiver->connection);

                                log_append_here(sender->bus->log, LOG_WARNING, 0);
                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,
                                                           sender->policy->seclabel, receiver->policy->seclabel,
                                                           message);
                                if (r == CONNECTION_E_QUOTA)
                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);
                                else
                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);
                                if (r)
                                        return error_fold(r);
                        } else {
                                return error_fold(r);
                        }
                }
        }

        return 0;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
14,16
17,18
17,19
17,20
17,21
17,22
17,23
17,24
17,25
17,26
18,19
19,20
19,21
20,21
22,23
23,24
25,26
26,27
27,28
27,29
28,29
30,31
30,32
32,33
33,34
33,35
34,35
36,37
38,39
39,40
39,41
40,41
42,43
42,44
44,45
45,46
45,47
46,47
48,49
49,50
49,51
50,51
53,54
54,55
54,56
55,56
57,58
57,59
60,61
61,62
61,63
63,64
65,66
66,67
66,68
66,69
66,70
66,71
66,72
67,68
69,70
69,71
70,71
73,74
74,75
76,77
77,78
77,79
78,79
81,82
83,84
84,85
84,86
85,86
88,89
88,90
89,90
90,91
90,92
91,92
93,94
93,95
93,96
93,97
94,95
96,97
97,98
99,100
101,102
103,104
103,105
103,106
103,107
103,108
103,109
103,110
103,111
103,112
104,105
105,106
105,107
106,107
108,109
108,110
108,111
111,112
112,113
112,114
112,115
112,116
113,114
115,116
117,118
119,120
121,122
122,123
122,124
123,124
125,126
125,127
127,128
128,129
128,130
129,130
131,132
132,133
132,134
133,134
136,137
137,138
137,139
138,139
140,141
141,142
141,143
142,143
145,146
146,147
146,148
147,148
149,150
149,151
149,152
149,153
149,154
149,155
149,156
149,157
149,158
149,159
150,151
152,153
152,154
153,154
156,157
156,158
157,158
160,161
161,162
163,164
163,165
164,165
164,166
165,166
165,167
166,167
171,172
171,173
172,173
172,174
173,174
173,175
174,175
179,180
179,181
180,181
180,182
181,182
181,183
182,183
187,188
187,189
188,189
188,190
189,190
189,191
190,191
196,197
196,198
197,198
197,199
198,199
198,200
199,200
204,205
204,206
205,206
207,208
207,209
208,209
208,210
209,210
209,211
210,211
210,212
211,212
213,214
215,216
215,217
216,217
218,219
221,222
222,223
222,224
223,224
225,226
227,228
228,229
228,230
229,230
231,232
231,233
231,234
231,235
231,236
231,237
231,238
231,239
231,240
232,233
234,235
234,236
235,236
238,239
239,240
241,242
241,243
242,243
242,244
243,244
243,245
244,245
249,250
249,251
250,251
250,252
251,252
251,253
252,253
257,258
257,259
258,259
258,260
259,260
259,261
260,261
265,266
265,267
266,267
266,268
267,268
267,269
268,269
274,275
274,276
275,276
275,277
276,277
276,278
277,278
282,283
282,284
283,284
285,286
285,287
286,287
286,288
287,288
287,289
288,289
290,291
293,294
294,295
294,296
295,296
297,298
299,300
300,301
300,302
301,302
303,304
303,305
303,306
303,307
304,305
306,307
307,308
307,309
308,309
311,312
313,314
315,316
315,317
316,317
318,319
319,320
319,321
319,322
320,321
320,322
321,322
321,323
322,323
324,325
326,327
326,328
327,328
329,330
331,332
331,333
331,334
331,335
331,336
332,333
333,334
333,335
334,335
336,337
337,338
337,339
338,339
341,342
342,343
342,344
342,345
342,346
343,344
345,346
345,347
346,347
346,348
347,348
351,352
354,355
355,356
355,357
355,358
355,359
355,360
355,361
355,362
355,363
355,364
356,357
358,359
358,360
359,360
362,363
362,364
363,364
366,367
366,368
367,368
370,371
371,372
373,374
374,375
376,377
376,378
377,378
377,379
378,379
382,383
382,384
383,384
383,385
384,385
388,389
390,391
390,392
390,393
391,392
391,393
392,393
394,395
396,397
397,398
397,399
398,399
400,401
400,402
400,403
400,404
401,402
403,404
403,405
404,405
404,406
405,406
410,411
410,412
411,412
414,415
415,416
415,417
416,417
418,419
418,420
418,421
418,422
419,420
421,422
421,423
422,423
422,424
423,424
428,429
428,430
429,430
432,433
432,434
433,434
435,436
436,437
436,438
437,438
439,440
441,442
442,443
443,444
443,445
444,445
446,447
448,449
-----nextToken-----
2,4,7,9,10,13,15,16,21,24,29,31,35,37,41,43,47,51,52,56,58,59,62,64,68,71,72,75,79,80,82,86,87,92,95,98,100,102,107,109,110,114,116,118,120,124,126,130,134,135,139,143,144,148,151,154,155,158,159,162,167,168,169,170,175,176,177,178,183,184,185,186,191,192,193,194,195,200,201,202,203,206,212,214,217,219,220,224,226,230,233,236,237,240,245,246,247,248,253,254,255,256,261,262,263,264,269,270,271,272,273,278,279,280,281,284,289,291,292,296,298,302,305,309,310,312,314,317,323,325,328,330,335,339,340,344,348,349,350,352,353,357,360,361,364,365,368,369,372,375,379,380,381,385,386,387,389,393,395,399,402,406,407,408,409,412,413,417,420,424,425,426,427,430,431,434,438,440,445,447,449
-----computeFrom-----
90,91
90,92
146,147
146,148
209,210
209,211
210,211
210,212
215,216
215,217
228,229
228,230
287,288
287,289
300,301
300,302
320,321
320,322
321,322
321,323
326,327
326,328
391,392
391,393
397,398
397,399
415,416
415,417
-----guardedBy-----
328,440
325,395
393,399
-----guardedByNegation-----
328,447
393,417
-----lastLexicalUse-----
328,447
393,417
-----jump-----
328,447
393,417
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Declarator;Name;ProblemStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;UnaryExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;WhileStatement;UnaryExpression;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;UnaryExpression;IdExpression;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;LiteralExpression;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;IfStatement;IdExpression;Name;CompoundStatement;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ContinueStatement;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;UnaryExpression;IdExpression;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;LiteralExpression;FieldReference;FieldReference;FieldReference;IdExpression;Name;Name;Name;Name;IfStatement;IdExpression;Name;CompoundStatement;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ContinueStatement;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;CompoundStatement;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;UnaryExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;IfStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;LiteralExpression;
-----ast_node-----
static int driver_forward_broadcast(Peer *sender, Message *message) {        _c_cleanup_(c_list_flush) CList destinations = C_LIST_INIT(destinations);        NameSet sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names);        MatchOwner *match_owner;        int r;        bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata);        while ((match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link))) {                Peer *receiver = c_container_of(match_owner, Peer, owned_matches);                NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);                c_list_unlink(&match_owner->destinations_link);                r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = connection_queue(&receiver->connection, NULL, message);                if (r) {                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }        }        return 0;}
static int
driver_forward_broadcast(Peer *sender, Message *message)
driver_forward_broadcast
Peer *sender
Peer
Peer
*sender
*
sender
Message *message
Message
Message
*message
*
message
{        _c_cleanup_(c_list_flush) CList destinations = C_LIST_INIT(destinations);        NameSet sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names);        MatchOwner *match_owner;        int r;        bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata);        while ((match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link))) {                Peer *receiver = c_container_of(match_owner, Peer, owned_matches);                NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);                c_list_unlink(&match_owner->destinations_link);                r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = connection_queue(&receiver->connection, NULL, message);                if (r) {                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }        }        return 0;}
_c_cleanup_(c_list_flush)
_c_cleanup_(c_list_flush)
_c_cleanup_
_c_cleanup_
(c_list_flush)
c_list_flush
c_list_flush
)
CList destinations = C_LIST_INIT(destinations);
CList destinations = C_LIST_INIT(destinations);
CList
CList
destinations = C_LIST_INIT(destinations)
destinations
= C_LIST_INIT(destinations)
C_LIST_INIT(destinations)
C_LIST_INIT
C_LIST_INIT
destinations
destinations
NameSet sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names);
NameSet sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names);
NameSet
NameSet
sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names)
sender_names
= NAME_SET_INIT_FROM_OWNER(&sender->owned_names)
NAME_SET_INIT_FROM_OWNER(&sender->owned_names)
NAME_SET_INIT_FROM_OWNER
NAME_SET_INIT_FROM_OWNER
&sender->owned_names
sender->owned_names
sender
sender
owned_names
MatchOwner *match_owner;
MatchOwner *match_owner;
MatchOwner
MatchOwner
*match_owner
*
match_owner
int r;
int r;
int
r
r
bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata);
bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata)
bus_get_broadcast_destinations
bus_get_broadcast_destinations
sender->bus
sender
sender
bus
&destinations
destinations
destinations
&sender->sender_matches
sender->sender_matches
sender
sender
sender_matches
sender
sender
&message->metadata
message->metadata
message
message
metadata
while ((match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link))) {                Peer *receiver = c_container_of(match_owner, Peer, owned_matches);                NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);                c_list_unlink(&match_owner->destinations_link);                r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = connection_queue(&receiver->connection, NULL, message);                if (r) {                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }        }
(match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link))
match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link)
match_owner
match_owner
c_list_first_entry(&destinations, MatchOwner, destinations_link)
c_list_first_entry
c_list_first_entry
&destinations
destinations
destinations
MatchOwner
MatchOwner
destinations_link
destinations_link
{                Peer *receiver = c_container_of(match_owner, Peer, owned_matches);                NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);                c_list_unlink(&match_owner->destinations_link);                r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds);                if (r) {                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }                r = connection_queue(&receiver->connection, NULL, message);                if (r) {                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }        }
Peer *receiver = c_container_of(match_owner, Peer, owned_matches);
Peer *receiver = c_container_of(match_owner, Peer, owned_matches);
Peer
Peer
*receiver = c_container_of(match_owner, Peer, owned_matches)
*
receiver
= c_container_of(match_owner, Peer, owned_matches)
c_container_of(match_owner, Peer, owned_matches)
c_container_of
c_container_of
match_owner
match_owner
Peer
Peer
owned_matches
owned_matches
NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);
NameSet receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names);
NameSet
NameSet
receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names)
receiver_names
= NAME_SET_INIT_FROM_OWNER(&receiver->owned_names)
NAME_SET_INIT_FROM_OWNER(&receiver->owned_names)
NAME_SET_INIT_FROM_OWNER
NAME_SET_INIT_FROM_OWNER
&receiver->owned_names
receiver->owned_names
receiver
receiver
owned_names
c_list_unlink(&match_owner->destinations_link);
c_list_unlink(&match_owner->destinations_link)
c_list_unlink
c_list_unlink
&match_owner->destinations_link
match_owner->destinations_link
match_owner
match_owner
destinations_link
r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds);
r = policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds)
r
r
policy_snapshot_check_send(sender->policy,                                               receiver->seclabel,                                               &receiver_names,                                               message->metadata.fields.interface,                                               message->metadata.fields.member,                                               message->metadata.fields.path,                                               message->metadata.header.type,                                               true,                                               message->metadata.fields.unix_fds)
policy_snapshot_check_send
policy_snapshot_check_send
sender->policy
sender
sender
policy
receiver->seclabel
receiver
receiver
seclabel
&receiver_names
receiver_names
receiver_names
message->metadata.fields.interface
message->metadata.fields
message->metadata
message
message
metadata
fields
interface
message->metadata.fields.member
message->metadata.fields
message->metadata
message
message
metadata
fields
member
message->metadata.fields.path
message->metadata.fields
message->metadata
message
message
metadata
fields
path
message->metadata.header.type
message->metadata.header
message->metadata
message
message
metadata
header
type
true
message->metadata.fields.unix_fds
message->metadata.fields
message->metadata
message
message
metadata
fields
unix_fds
if (r) {                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }
r
r
{                        if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;                        return error_fold(r);                }
if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)                                continue;
r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED
r == POLICY_E_ACCESS_DENIED
r
r
POLICY_E_ACCESS_DENIED
POLICY_E_ACCESS_DENIED
r == POLICY_E_SELINUX_ACCESS_DENIED
r
r
POLICY_E_SELINUX_ACCESS_DENIED
POLICY_E_SELINUX_ACCESS_DENIED
continue;
return error_fold(r);
error_fold(r)
error_fold
error_fold
r
r
r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds);
r = policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds)
r
r
policy_snapshot_check_receive(receiver->policy,                                                  &sender_names,                                                  message->metadata.fields.interface,                                                  message->metadata.fields.member,                                                  message->metadata.fields.path,                                                  message->metadata.header.type,                                                  true,                                                  message->metadata.fields.unix_fds)
policy_snapshot_check_receive
policy_snapshot_check_receive
receiver->policy
receiver
receiver
policy
&sender_names
sender_names
sender_names
message->metadata.fields.interface
message->metadata.fields
message->metadata
message
message
metadata
fields
interface
message->metadata.fields.member
message->metadata.fields
message->metadata
message
message
metadata
fields
member
message->metadata.fields.path
message->metadata.fields
message->metadata
message
message
metadata
fields
path
message->metadata.header.type
message->metadata.header
message->metadata
message
message
metadata
header
type
true
message->metadata.fields.unix_fds
message->metadata.fields
message->metadata
message
message
metadata
fields
unix_fds
if (r) {                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }
r
r
{                        if (r == POLICY_E_ACCESS_DENIED)                                continue;                        return error_fold(r);                }
if (r == POLICY_E_ACCESS_DENIED)                                continue;
r == POLICY_E_ACCESS_DENIED
r
r
POLICY_E_ACCESS_DENIED
POLICY_E_ACCESS_DENIED
continue;
return error_fold(r);
error_fold(r)
error_fold
error_fold
r
r
r = connection_queue(&receiver->connection, NULL, message);
r = connection_queue(&receiver->connection, NULL, message)
r
r
connection_queue(&receiver->connection, NULL, message)
connection_queue
connection_queue
&receiver->connection
receiver->connection
receiver
receiver
connection
NULL
NULL
message
message
if (r) {                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }
r
r
{                        if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }                }
if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS) {                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        } else {                                return error_fold(r);                        }
r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS
r == CONNECTION_E_QUOTA
r
r
CONNECTION_E_QUOTA
CONNECTION_E_QUOTA
r == CONNECTION_E_UNEXPECTED_FDS
r
r
CONNECTION_E_UNEXPECTED_FDS
CONNECTION_E_UNEXPECTED_FDS
{                                connection_shutdown(&receiver->connection);                                log_append_here(sender->bus->log, LOG_WARNING, 0);                                bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);                                if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);                                if (r)                                        return error_fold(r);                        }
connection_shutdown(&receiver->connection);
connection_shutdown(&receiver->connection)
connection_shutdown
connection_shutdown
&receiver->connection
receiver->connection
receiver
receiver
connection
log_append_here(sender->bus->log, LOG_WARNING, 0);
log_append_here(sender->bus->log, LOG_WARNING, 0)
log_append_here
log_append_here
sender->bus->log
sender->bus
sender
sender
bus
log
LOG_WARNING
LOG_WARNING
0
bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message);
bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,                                                           sender->policy->seclabel, receiver->policy->seclabel,                                                           message)
bus_log_append_transaction
bus_log_append_transaction
sender->bus
sender
sender
bus
sender->id
sender
sender
id
receiver->id
receiver
receiver
id
&sender_names
sender_names
sender_names
&receiver_names
receiver_names
receiver_names
sender->policy->seclabel
sender->policy
sender
sender
policy
seclabel
receiver->policy->seclabel
receiver->policy
receiver
receiver
policy
seclabel
message
message
if (r == CONNECTION_E_QUOTA)                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);                                else                                        r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);
r == CONNECTION_E_QUOTA
r
r
CONNECTION_E_QUOTA
CONNECTION_E_QUOTA
r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id);
r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id)
r
r
log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id)
log_commitf
log_commitf
sender->bus->log
sender->bus
sender
sender
bus
log
"Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to."
receiver->id
receiver
receiver
id
r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id);
r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id)
r
r
log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id)
log_commitf
log_commitf
sender->bus->log
sender->bus
sender
sender
bus
log
"Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to."
receiver->id
receiver
receiver
id
if (r)                                        return error_fold(r);
r
r
return error_fold(r);
error_fold(r)
error_fold
error_fold
r
r
{                                return error_fold(r);                        }
return error_fold(r);
error_fold(r)
error_fold
error_fold
r
r
return 0;
0
-----joern-----
(154,153,0)
(234,48,0)
(186,84,0)
(39,255,0)
(174,165,0)
(48,43,0)
(226,121,0)
(220,158,0)
(199,265,0)
(233,110,0)
(69,26,0)
(123,29,0)
(204,166,0)
(222,181,0)
(189,90,0)
(255,55,0)
(23,55,0)
(199,214,0)
(227,37,0)
(113,218,0)
(275,154,0)
(230,68,0)
(61,267,0)
(201,228,0)
(101,187,0)
(108,5,0)
(59,164,0)
(157,187,0)
(28,158,0)
(132,181,0)
(195,189,0)
(82,170,0)
(96,89,0)
(120,239,0)
(57,183,0)
(89,158,0)
(150,158,0)
(193,153,0)
(11,208,0)
(185,208,0)
(95,65,0)
(11,158,0)
(165,273,0)
(16,11,0)
(262,57,0)
(38,10,0)
(132,51,0)
(29,267,0)
(100,218,0)
(94,92,0)
(54,130,0)
(194,185,0)
(250,225,0)
(27,209,0)
(148,28,0)
(277,74,0)
(70,164,0)
(22,29,0)
(241,202,0)
(158,78,0)
(92,94,0)
(153,202,0)
(209,273,0)
(119,167,0)
(132,179,0)
(183,57,0)
(83,172,0)
(46,91,0)
(154,123,0)
(187,157,0)
(206,87,0)
(208,128,0)
(63,32,0)
(121,226,0)
(94,253,0)
(89,265,0)
(198,92,0)
(169,69,0)
(244,164,0)
(219,102,0)
(103,11,0)
(265,89,0)
(176,273,0)
(131,167,0)
(31,200,0)
(6,167,0)
(85,262,0)
(152,128,0)
(30,240,0)
(117,169,0)
(202,153,0)
(276,240,0)
(202,149,0)
(271,177,0)
(132,81,0)
(254,123,0)
(110,43,0)
(221,239,0)
(132,30,0)
(243,220,0)
(79,50,0)
(116,154,0)
(242,178,0)
(130,91,0)
(277,10,0)
(154,116,0)
(144,112,0)
(129,121,0)
(238,57,0)
(65,130,0)
(25,78,0)
(91,130,0)
(147,112,0)
(208,106,0)
(163,89,0)
(187,26,0)
(245,69,0)
(174,82,0)
(78,158,0)
(249,42,0)
(160,140,0)
(161,267,0)
(69,169,0)
(151,98,0)
(137,170,0)
(35,32,0)
(57,164,0)
(44,177,0)
(62,139,0)
(116,131,0)
(158,167,0)
(168,33,0)
(107,230,0)
(208,36,0)
(21,104,0)
(183,104,0)
(98,185,0)
(170,82,0)
(131,53,0)
(81,164,0)
(60,119,0)
(136,195,0)
(134,21,0)
(106,203,0)
(190,212,0)
(144,26,0)
(139,64,0)
(0,149,0)
(212,68,0)
(88,78,0)
(50,68,0)
(195,158,0)
(42,167,0)
(231,83,0)
(222,114,0)
(169,66,0)
(255,264,0)
(178,32,0)
(97,239,0)
(110,172,0)
(154,119,0)
(135,116,0)
(265,13,0)
(108,65,0)
(125,230,0)
(165,74,0)
(29,123,0)
(50,208,0)
(162,7,0)
(171,199,0)
(99,157,0)
(220,226,0)
(130,65,0)
(98,158,0)
(208,50,0)
(75,98,0)
(128,57,0)
(51,12,0)
(82,174,0)
(253,94,0)
(3,42,0)
(106,208,0)
(165,84,0)
(208,230,0)
(24,66,0)
(264,68,0)
(149,202,0)
(273,209,0)
(262,165,0)
(265,199,0)
(119,154,0)
(77,158,0)
(18,222,0)
(77,37,0)
(208,26,0)
(71,195,0)
(225,166,0)
(10,26,0)
(2,154,0)
(178,37,0)
(53,56,0)
(1,253,0)
(153,154,0)
(127,154,0)
(270,203,0)
(141,218,0)
(90,177,0)
(21,68,0)
(260,205,0)
(205,51,0)
(154,66,0)
(72,149,0)
(37,178,0)
(40,167,0)
(138,220,0)
(86,33,0)
(118,37,0)
(73,212,0)
(253,114,0)
(205,42,0)
(127,157,0)
(156,131,0)
(133,27,0)
(209,27,0)
(5,6,0)
(200,64,0)
(272,69,0)
(264,255,0)
(123,154,0)
(268,12,0)
(203,106,0)
(142,28,0)
(56,53,0)
(43,110,0)
(172,110,0)
(53,131,0)
(104,183,0)
(112,147,0)
(229,108,0)
(218,113,0)
(165,174,0)
(14,50,0)
(90,189,0)
(87,56,0)
(66,154,0)
(170,26,0)
(140,154,0)
(33,114,0)
(166,164,0)
(114,167,0)
(188,200,0)
(84,158,0)
(124,10,0)
(256,167,0)
(266,170,0)
(56,87,0)
(74,277,0)
(181,47,0)
(204,110,0)
(165,42,0)
(208,185,0)
(239,26,0)
(154,2,0)
(104,21,0)
(246,164,0)
(37,118,0)
(109,81,0)
(10,277,0)
(258,27,0)
(223,253,0)
(126,77,0)
(93,264,0)
(41,164,0)
(34,84,0)
(5,108,0)
(143,118,0)
(49,48,0)
(19,140,0)
(140,68,0)
(166,225,0)
(257,114,0)
(78,65,0)
(48,68,0)
(211,277,0)
(165,262,0)
(32,68,0)
(7,119,0)
(207,139,0)
(2,113,0)
(208,177,0)
(155,249,0)
(149,26,0)
(232,214,0)
(267,29,0)
(189,195,0)
(6,5,0)
(9,208,0)
(37,77,0)
(185,98,0)
(121,114,0)
(67,108,0)
(173,120,0)
(215,82,0)
(139,119,0)
(4,87,0)
(15,36,0)
(66,169,0)
(228,165,0)
(55,255,0)
(154,140,0)
(92,114,0)
(64,200,0)
(175,2,0)
(110,68,0)
(91,166,0)
(36,208,0)
(112,144,0)
(226,220,0)
(191,121,0)
(203,68,0)
(84,165,0)
(145,144,0)
(128,208,0)
(113,2,0)
(165,228,0)
(197,167,0)
(146,112,0)
(165,147,0)
(147,165,0)
(20,92,0)
(239,120,0)
(74,165,0)
(182,174,0)
(154,28,0)
(28,154,0)
(216,74,0)
(64,139,0)
(114,121,0)
(228,120,0)
(121,26,0)
(17,144,0)
(274,249,0)
(267,26,0)
(248,214,0)
(45,264,0)
(251,13,0)
(184,21,0)
(8,78,0)
(213,83,0)
(122,127,0)
(115,147,0)
(120,228,0)
(218,26,0)
(269,167,0)
(208,11,0)
(263,113,0)
(196,77,0)
(236,179,0)
(200,119,0)
(192,165,0)
(43,48,0)
(87,158,0)
(7,30,0)
(210,204,0)
(110,204,0)
(214,68,0)
(212,110,0)
(110,164,0)
(180,130,0)
(273,165,0)
(235,265,0)
(36,131,0)
(252,167,0)
(110,212,0)
(32,178,0)
(236,13,0)
(83,26,0)
(214,199,0)
(154,127,0)
(13,265,0)
(247,236,0)
(261,187,0)
(230,208,0)
(259,166,0)
(105,106,0)
(157,127,0)
(236,118,0)
(76,209,0)
(42,165,0)
(55,177,0)
(172,83,0)
(27,26,0)
(58,203,0)
(80,55,0)
(118,37,1)
(61,153,1)
(191,226,1)
(202,149,1)
(178,242,1)
(134,238,1)
(27,26,1)
(119,154,1)
(267,161,1)
(266,262,1)
(165,174,1)
(257,111,1)
(74,216,1)
(4,206,1)
(91,46,1)
(229,131,1)
(260,249,1)
(72,0,1)
(90,189,1)
(205,42,1)
(212,190,1)
(114,121,1)
(132,30,1)
(248,251,1)
(144,26,1)
(28,158,1)
(49,204,1)
(277,10,1)
(95,217,1)
(46,95,1)
(88,25,1)
(223,1,1)
(62,207,1)
(217,114,1)
(2,175,1)
(5,108,1)
(169,117,1)
(20,253,1)
(189,195,1)
(149,72,1)
(267,26,1)
(109,65,1)
(121,26,1)
(270,58,1)
(171,214,1)
(173,239,1)
(192,228,1)
(264,93,1)
(255,264,1)
(98,158,1)
(190,73,1)
(208,9,1)
(81,109,1)
(180,91,1)
(254,29,1)
(170,137,1)
(11,158,1)
(242,32,1)
(108,67,1)
(108,65,1)
(154,66,1)
(99,187,1)
(75,151,1)
(232,248,1)
(80,255,1)
(162,64,1)
(32,35,1)
(249,42,1)
(37,77,1)
(161,61,1)
(253,114,1)
(110,172,1)
(170,26,1)
(69,26,1)
(188,139,1)
(95,159,1)
(194,98,1)
(247,224,1)
(10,124,1)
(132,179,1)
(121,129,1)
(19,160,1)
(92,198,1)
(53,56,1)
(22,267,1)
(198,20,1)
(166,225,1)
(163,235,1)
(2,113,1)
(95,237,1)
(174,82,1)
(157,99,1)
(175,113,1)
(208,36,1)
(23,80,1)
(101,261,1)
(58,36,1)
(201,120,1)
(153,193,1)
(52,119,1)
(149,26,1)
(140,68,1)
(21,184,1)
(187,101,1)
(263,218,1)
(63,143,1)
(208,185,1)
(226,220,1)
(214,68,1)
(193,202,1)
(126,196,1)
(196,227,1)
(78,65,1)
(202,241,1)
(28,148,1)
(86,168,1)
(154,127,1)
(127,157,1)
(195,158,1)
(123,29,1)
(25,8,1)
(199,214,1)
(243,138,1)
(112,146,1)
(89,96,1)
(132,181,1)
(154,2,1)
(218,26,1)
(7,162,1)
(89,158,1)
(66,169,1)
(38,174,1)
(146,144,1)
(199,171,1)
(231,233,1)
(98,75,1)
(153,202,1)
(112,144,1)
(233,43,1)
(236,247,1)
(1,217,1)
(261,275,1)
(176,209,1)
(220,243,1)
(208,230,1)
(130,91,1)
(183,104,1)
(222,114,1)
(87,158,1)
(128,152,1)
(110,204,1)
(235,199,1)
(236,118,1)
(83,213,1)
(127,122,1)
(145,17,1)
(17,74,1)
(216,277,1)
(224,118,1)
(239,26,1)
(128,57,1)
(255,39,1)
(132,51,1)
(18,94,1)
(24,169,1)
(129,191,1)
(239,221,1)
(9,185,1)
(110,43,1)
(185,98,1)
(215,170,1)
(220,158,1)
(178,32,1)
(262,85,1)
(15,128,1)
(97,147,1)
(124,38,1)
(186,3,1)
(71,136,1)
(225,250,1)
(157,187,1)
(165,228,1)
(147,115,1)
(106,105,1)
(45,90,1)
(203,68,1)
(212,68,1)
(55,255,1)
(78,88,1)
(48,234,1)
(57,183,1)
(50,68,1)
(74,277,1)
(137,266,1)
(151,106,1)
(104,21,1)
(200,31,1)
(139,119,1)
(172,83,1)
(208,11,1)
(43,48,1)
(204,166,1)
(218,141,1)
(131,53,1)
(56,87,1)
(156,158,1)
(94,253,1)
(236,13,1)
(29,22,1)
(195,71,1)
(141,100,1)
(222,18,1)
(230,125,1)
(200,119,1)
(69,245,1)
(111,42,1)
(110,212,1)
(113,263,1)
(67,229,1)
(65,130,1)
(113,218,1)
(35,63,1)
(77,126,1)
(117,69,1)
(143,33,1)
(168,208,1)
(159,64,1)
(116,131,1)
(8,150,1)
(207,52,1)
(277,211,1)
(154,153,1)
(39,264,1)
(154,28,1)
(209,76,1)
(106,203,1)
(105,203,1)
(31,188,1)
(208,26,1)
(92,114,1)
(64,200,1)
(208,50,1)
(79,14,1)
(36,131,1)
(29,267,1)
(203,270,1)
(122,157,1)
(33,114,1)
(204,210,1)
(83,26,1)
(100,123,1)
(73,57,1)
(50,79,1)
(55,23,1)
(148,142,1)
(130,54,1)
(265,199,1)
(66,24,1)
(82,170,1)
(245,272,1)
(11,16,1)
(182,82,1)
(30,7,1)
(0,116,1)
(60,6,1)
(165,262,1)
(48,68,1)
(32,68,1)
(76,27,1)
(187,26,1)
(93,45,1)
(87,4,1)
(250,259,1)
(14,55,1)
(33,86,1)
(84,34,1)
(228,201,1)
(120,173,1)
(275,66,1)
(165,74,1)
(91,166,1)
(133,192,1)
(51,205,1)
(165,84,1)
(6,5,1)
(123,254,1)
(184,134,1)
(227,178,1)
(253,223,1)
(142,140,1)
(211,10,1)
(132,81,1)
(205,260,1)
(37,178,1)
(251,33,1)
(135,28,1)
(241,149,1)
(185,194,1)
(84,158,1)
(230,68,1)
(36,15,1)
(115,112,1)
(154,140,1)
(206,156,1)
(110,68,1)
(213,231,1)
(237,249,1)
(13,265,1)
(3,52,1)
(121,226,1)
(7,119,1)
(138,257,1)
(214,232,1)
(77,158,1)
(34,186,1)
(116,135,1)
(10,26,1)
(274,111,1)
(224,13,1)
(165,273,1)
(208,128,1)
(265,89,1)
(228,120,1)
(16,103,1)
(238,166,1)
(94,92,1)
(82,215,1)
(107,50,1)
(210,212,1)
(42,165,1)
(174,182,1)
(209,27,1)
(273,176,1)
(262,57,1)
(169,69,1)
(208,106,1)
(179,236,1)
(258,133,1)
(158,78,1)
(125,107,1)
(165,147,1)
(154,116,1)
(139,62,1)
(96,163,1)
(234,49,1)
(95,224,1)
(85,84,1)
(154,123,1)
(136,94,1)
(249,155,1)
(103,230,1)
(54,180,1)
(140,19,1)
(147,112,1)
(27,258,1)
(64,139,1)
(264,68,1)
(221,97,1)
(273,209,1)
(160,60,1)
(144,145,1)
(152,11,1)
(95,110,1)
(272,2,1)
(21,68,1)
(150,65,1)
(155,274,1)
(120,239,1)
(181,222,1)
(54,217,2)
(15,94,2)
(170,26,2)
(95,217,2)
(54,249,2)
(126,33,2)
(32,33,2)
(255,264,2)
(56,87,2)
(180,249,2)
(84,158,2)
(265,89,2)
(31,139,2)
(155,111,2)
(72,65,2)
(2,113,2)
(245,65,2)
(186,52,2)
(142,65,2)
(179,224,2)
(11,158,2)
(71,94,2)
(203,94,2)
(92,114,2)
(153,202,2)
(87,65,2)
(254,65,2)
(4,65,2)
(198,253,2)
(199,33,2)
(165,74,2)
(52,65,2)
(200,119,2)
(91,217,2)
(91,249,2)
(185,98,2)
(65,249,2)
(152,94,2)
(262,57,2)
(114,111,2)
(36,131,2)
(57,183,2)
(153,65,2)
(111,52,2)
(208,185,2)
(199,214,2)
(209,52,2)
(88,65,2)
(204,166,2)
(110,43,2)
(226,220,2)
(35,33,2)
(8,65,2)
(137,52,2)
(103,94,2)
(65,217,2)
(74,277,2)
(121,111,2)
(37,33,2)
(42,52,2)
(243,111,2)
(95,249,2)
(205,42,2)
(130,91,2)
(28,65,2)
(98,94,2)
(136,94,2)
(267,65,2)
(34,52,2)
(165,84,2)
(144,52,2)
(264,94,2)
(221,52,2)
(274,111,2)
(260,249,2)
(222,94,2)
(277,52,2)
(239,26,2)
(253,217,2)
(175,65,2)
(191,111,2)
(180,64,2)
(89,158,2)
(223,217,2)
(154,153,2)
(140,68,2)
(208,26,2)
(202,65,2)
(53,65,2)
(230,94,2)
(82,52,2)
(170,52,2)
(249,42,2)
(77,33,2)
(141,65,2)
(117,65,2)
(189,94,2)
(7,119,2)
(77,158,2)
(46,217,2)
(119,65,2)
(83,26,2)
(208,50,2)
(261,65,2)
(130,224,2)
(132,179,2)
(116,131,2)
(264,68,2)
(224,94,2)
(178,33,2)
(132,81,2)
(187,65,2)
(37,77,2)
(173,52,2)
(275,65,2)
(228,52,2)
(33,94,2)
(208,94,2)
(45,94,2)
(28,158,2)
(267,26,2)
(192,52,2)
(242,33,2)
(82,170,2)
(154,65,2)
(212,68,2)
(129,111,2)
(169,65,2)
(55,255,2)
(18,94,2)
(1,217,2)
(69,26,2)
(98,158,2)
(92,253,2)
(247,224,2)
(6,65,2)
(22,65,2)
(133,52,2)
(208,106,2)
(154,66,2)
(16,94,2)
(90,189,2)
(58,94,2)
(214,33,2)
(208,36,2)
(165,174,2)
(19,65,2)
(162,64,2)
(241,65,2)
(135,65,2)
(32,68,2)
(105,94,2)
(218,26,2)
(130,249,2)
(229,65,2)
(165,262,2)
(66,169,2)
(251,33,2)
(165,147,2)
(178,32,2)
(43,48,2)
(62,52,2)
(195,158,2)
(106,203,2)
(17,52,2)
(23,94,2)
(183,104,2)
(230,68,2)
(96,33,2)
(121,226,2)
(85,52,2)
(25,65,2)
(63,33,2)
(69,65,2)
(128,94,2)
(61,65,2)
(132,181,2)
(54,64,2)
(123,29,2)
(154,2,2)
(97,52,2)
(188,139,2)
(131,65,2)
(91,64,2)
(265,199,2)
(201,52,2)
(165,273,2)
(208,230,2)
(143,33,2)
(149,26,2)
(87,158,2)
(203,68,2)
(120,239,2)
(9,94,2)
(154,123,2)
(207,52,2)
(182,52,2)
(24,65,2)
(157,65,2)
(51,249,2)
(94,253,2)
(236,13,2)
(99,65,2)
(64,139,2)
(20,253,2)
(132,30,2)
(118,37,2)
(76,52,2)
(185,94,2)
(91,166,2)
(122,65,2)
(239,52,2)
(80,94,2)
(273,52,2)
(112,52,2)
(39,94,2)
(140,65,2)
(13,265,2)
(94,217,2)
(90,94,2)
(10,52,2)
(113,218,2)
(121,26,2)
(145,52,2)
(160,65,2)
(74,52,2)
(36,94,2)
(65,224,2)
(66,65,2)
(115,52,2)
(222,114,2)
(258,52,2)
(114,121,2)
(29,267,2)
(93,94,2)
(211,52,2)
(147,52,2)
(46,224,2)
(128,57,2)
(30,64,2)
(209,27,2)
(156,65,2)
(147,112,2)
(181,94,2)
(217,111,2)
(180,224,2)
(172,83,2)
(110,212,2)
(266,52,2)
(48,68,2)
(110,68,2)
(193,65,2)
(214,68,2)
(168,94,2)
(138,111,2)
(86,94,2)
(227,33,2)
(189,195,2)
(139,119,2)
(53,56,2)
(249,111,2)
(67,65,2)
(169,69,2)
(154,127,2)
(216,52,2)
(56,65,2)
(131,53,2)
(194,94,2)
(108,65,2)
(226,111,2)
(124,52,2)
(120,52,2)
(109,65,2)
(159,64,2)
(270,94,2)
(118,33,2)
(165,228,2)
(154,140,2)
(127,157,2)
(273,209,2)
(112,144,2)
(0,65,2)
(119,154,2)
(176,52,2)
(33,114,2)
(46,64,2)
(101,65,2)
(163,33,2)
(150,65,2)
(272,65,2)
(166,225,2)
(27,52,2)
(187,26,2)
(5,108,2)
(206,65,2)
(125,94,2)
(50,94,2)
(116,65,2)
(13,33,2)
(146,52,2)
(27,26,2)
(202,149,2)
(11,94,2)
(110,172,2)
(78,65,2)
(65,64,2)
(255,94,2)
(65,130,2)
(89,33,2)
(104,21,2)
(235,33,2)
(215,52,2)
(14,94,2)
(237,249,2)
(5,65,2)
(253,114,2)
(208,128,2)
(79,94,2)
(7,64,2)
(6,5,2)
(3,52,2)
(236,118,2)
(158,65,2)
(154,28,2)
(157,187,2)
(174,82,2)
(127,65,2)
(42,165,2)
(195,94,2)
(10,26,2)
(154,116,2)
(220,158,2)
(81,65,2)
(174,52,2)
(100,65,2)
(220,111,2)
(208,11,2)
(64,52,2)
(95,224,2)
(94,92,2)
(107,94,2)
(2,65,2)
(232,33,2)
(148,65,2)
(158,78,2)
(91,224,2)
(165,52,2)
(236,224,2)
(171,33,2)
(123,65,2)
(29,65,2)
(130,217,2)
(139,52,2)
(265,33,2)
(263,65,2)
(248,33,2)
(84,52,2)
(50,68,2)
(64,200,2)
(113,65,2)
(21,68,2)
(151,94,2)
(54,224,2)
(205,249,2)
(38,52,2)
(144,26,2)
(180,217,2)
(132,51,2)
(200,139,2)
(75,94,2)
(95,64,2)
(161,65,2)
(149,65,2)
(218,65,2)
(130,64,2)
(257,111,2)
(60,65,2)
(55,94,2)
(277,10,2)
(106,94,2)
(228,120,2)
(196,33,2)
(110,204,2)
(262,52,2)
(37,178,2)
(46,249,2)
-----------------------------------
(0,message)
(1,r)
(2,message->metadata.fields.path)
(3,r)
(4,owned_names)
(5,&match_owner->destinations_link)
(6,c_list_unlink(&match_owner->destinations_link)
(7,error_fold(r)
(8,match_owner)
(9,message)
(10,message->metadata)
(11,receiver->id)
(12,)
(13,r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id)
(14,sender)
(15,receiver_names)
(16,id)
(17,message)
(18,r)
(19,policy)
(20,r)
(21,sender->owned_names)
(22,fields)
(23,0)
(24,type)
(25,Peer)
(26,Message *message)
(27,message->metadata)
(28,receiver->seclabel)
(29,message->metadata.fields)
(30,return error_fold(r)
(31,POLICY_E_SELINUX_ACCESS_DENIED)
(32,sender->bus)
(33,r == CONNECTION_E_QUOTA)
(34,policy)
(35,bus)
(36,&receiver_names)
(37,log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id)
(38,message)
(39,log)
(40,receiver_names)
(41,match_owner)
(42,r = policy_snapshot_check_receive(receiver->policy,\n\\n                                                  &sender_names,\n\\n                                                  message->metadata.fields.interface,\n\\n                                                  message->metadata.fields.member,\n\\n                                                  message->metadata.fields.path,\n\\n                                                  message->metadata.header.type,\n\\n                                                  true,\n\\n                                                  message->metadata.fields.unix_fds)
(43,&sender->sender_matches)
(44,if (r)
(45,sender)
(46,destinations)
(47,)
(48,sender->sender_matches)
(49,sender)
(50,sender->bus)
(51,return error_fold(r)
(52,r)
(53,NAME_SET_INIT_FROM_OWNER(&receiver->owned_names)
(54,destinations_link)
(55,log_append_here(sender->bus->log, LOG_WARNING, 0)
(56,&receiver->owned_names)
(57,sender_names = NAME_SET_INIT_FROM_OWNER(&sender->owned_names)
(58,sender)
(59,r)
(60,r)
(61,message)
(62,POLICY_E_ACCESS_DENIED)
(63,sender)
(64,r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)
(65,match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link)
(66,message->metadata.header.type)
(67,destinations_link)
(68,Peer *sender)
(69,message->metadata)
(70,destinations)
(71,connection)
(72,metadata)
(73,sender)
(74,message->metadata.fields.member)
(75,policy)
(76,fields)
(77,receiver->id)
(78,c_container_of(match_owner, Peer, owned_matches)
(79,bus)
(80,LOG_WARNING)
(81,return 0;)
(82,message->metadata.fields)
(83,message->metadata)
(84,receiver->policy)
(85,sender_names)
(86,CONNECTION_E_QUOTA)
(87,receiver->owned_names)
(88,owned_matches)
(89,receiver->id)
(90,connection_shutdown(&receiver->connection)
(91,&destinations)
(92,r == CONNECTION_E_UNEXPECTED_FDS)
(93,bus)
(94,r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS)
(95,match_owner)
(96,id)
(97,message)
(98,receiver->policy)
(99,fields)
(100,message)
(101,metadata)
(102,)
(103,receiver)
(104,&sender->owned_names)
(105,seclabel)
(106,sender->policy->seclabel)
(107,sender)
(108,match_owner->destinations_link)
(109,0)
(110,bus_get_broadcast_destinations(sender->bus, &destinations, &sender->sender_matches, sender, &message->metadata)
(111,r)
(112,message->metadata.fields)
(113,message->metadata.fields)
(114,r = connection_queue(&receiver->connection, NULL, message)
(115,path)
(116,&receiver_names)
(117,header)
(118,r = log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.", receiver->id)
(119,r = policy_snapshot_check_send(sender->policy,\n\\n                                               receiver->seclabel,\n\\n                                               &receiver_names,\n\\n                                               message->metadata.fields.interface,\n\\n                                               message->metadata.fields.member,\n\\n                                               message->metadata.fields.path,\n\\n                                               message->metadata.header.type,\n\\n                                               true,\n\\n                                               message->metadata.fields.unix_fds)
(120,message->metadata.header)
(121,connection_queue(&receiver->connection, NULL, message)
(122,unix_fds)
(123,message->metadata.fields.member)
(124,metadata)
(125,id)
(126,id)
(127,message->metadata.fields.unix_fds)
(128,&sender_names)
(129,message)
(130,c_list_first_entry(&destinations, MatchOwner, destinations_link)
(131,receiver_names = NAME_SET_INIT_FROM_OWNER(&receiver->owned_names)
(132,RET)
(133,message)
(134,sender)
(135,receiver_names)
(136,receiver)
(137,metadata)
(138,receiver)
(139,r == POLICY_E_ACCESS_DENIED)
(140,sender->policy)
(141,metadata)
(142,receiver)
(143,r)
(144,message->metadata)
(145,metadata)
(146,fields)
(147,message->metadata.fields.path)
(148,seclabel)
(149,message->metadata)
(150,receiver)
(151,receiver)
(152,sender_names)
(153,message->metadata.fields.interface)
(154,policy_snapshot_check_send(sender->policy,\n\\n                                               receiver->seclabel,\n\\n                                               &receiver_names,\n\\n                                               message->metadata.fields.interface,\n\\n                                               message->metadata.fields.member,\n\\n                                               message->metadata.fields.path,\n\\n                                               message->metadata.header.type,\n\\n                                               true,\n\\n                                               message->metadata.fields.unix_fds)
(155,POLICY_E_ACCESS_DENIED)
(156,receiver_names)
(157,message->metadata.fields)
(158,*receiver = c_container_of(match_owner, Peer, owned_matches)
(159,continue;)
(160,sender)
(161,metadata)
(162,r)
(163,receiver)
(164,)
(165,policy_snapshot_check_receive(receiver->policy,\n\\n                                                  &sender_names,\n\\n                                                  message->metadata.fields.interface,\n\\n                                                  message->metadata.fields.member,\n\\n                                                  message->metadata.fields.path,\n\\n                                                  message->metadata.header.type,\n\\n                                                  true,\n\\n                                                  message->metadata.fields.unix_fds)
(166,destinations = C_LIST_INIT(destinations)
(167,)
(168,r)
(169,message->metadata.header)
(170,message->metadata)
(171,log)
(172,&message->metadata)
(173,header)
(174,message->metadata.fields.interface)
(175,path)
(176,unix_fds)
(177,)
(178,sender->bus->log)
(179,return error_fold(r)
(180,MatchOwner)
(181,return error_fold(r)
(182,interface)
(183,NAME_SET_INIT_FROM_OWNER(&sender->owned_names)
(184,owned_names)
(185,receiver->policy->seclabel)
(186,receiver)
(187,message->metadata)
(188,r)
(189,&receiver->connection)
(190,bus)
(191,NULL)
(192,true)
(193,interface)
(194,seclabel)
(195,receiver->connection)
(196,receiver)
(197,if (r)
(198,CONNECTION_E_UNEXPECTED_FDS)
(199,sender->bus->log)
(200,r == POLICY_E_SELINUX_ACCESS_DENIED)
(201,type)
(202,message->metadata.fields)
(203,sender->policy)
(204,&destinations)
(205,error_fold(r)
(206,receiver)
(207,r)
(208,bus_log_append_transaction(sender->bus, sender->id, receiver->id, &sender_names, &receiver_names,\n\\n                                                           sender->policy->seclabel, receiver->policy->seclabel,\n\\n                                                           message)
(209,message->metadata.fields)
(210,destinations)
(211,fields)
(212,sender->bus)
(213,metadata)
(214,sender->bus)
(215,fields)
(216,member)
(217,r)
(218,message->metadata)
(219,if (r == CONNECTION_E_QUOTA || r == CONNECTION_E_UNEXPECTED_FDS)
(220,receiver->connection)
(221,metadata)
(222,error_fold(r)
(223,CONNECTION_E_QUOTA)
(224,r)
(225,C_LIST_INIT(destinations)
(226,&receiver->connection)
(227,"Peer :1.%llu is being disconnected as it does not have the resources to receive a signal it subscribed to.")
(228,message->metadata.header.type)
(229,match_owner)
(230,sender->id)
(231,message)
(232,bus)
(233,sender)
(234,sender_matches)
(235,"Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.")
(236,error_fold(r)
(237,continue;)
(238,sender_names)
(239,message->metadata)
(240,)
(241,fields)
(242,log)
(243,connection)
(244,sender_names)
(245,metadata)
(246,while ((match_owner = c_list_first_entry(&destinations, MatchOwner, destinations_link)
(247,r)
(248,sender)
(249,r == POLICY_E_ACCESS_DENIED)
(250,destinations)
(251,r)
(252,if (r)
(253,r == CONNECTION_E_QUOTA)
(254,member)
(255,sender->bus->log)
(256,if (r)
(257,r)
(258,metadata)
(259,destinations)
(260,r)
(261,message)
(262,&sender_names)
(263,fields)
(264,sender->bus)
(265,log_commitf(sender->bus->log, "Peer :1.%llu is being disconnected as it does not support receiveng the file descriptors it subscribed to.", receiver->id)
(266,message)
(267,message->metadata)
(268,if (r == POLICY_E_ACCESS_DENIED)
(269,receiver)
(270,policy)
(271,if (r == CONNECTION_E_QUOTA)
(272,message)
(273,message->metadata.fields.unix_fds)
(274,r)
(275,true)
(276,if (r == POLICY_E_ACCESS_DENIED || r == POLICY_E_SELINUX_ACCESS_DENIED)
(277,message->metadata.fields)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^