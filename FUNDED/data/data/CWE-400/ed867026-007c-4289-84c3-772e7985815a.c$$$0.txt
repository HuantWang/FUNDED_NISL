-----label-----
0
-----code-----
int
handle_value_request(u_char *packet, int size,
		     char *address, u_short port,
		     u_int8_t *schemes, u_int16_t ssize)

{
        struct packet_sub parts[] = {
	     { "Exchange Value", FLD_VARPRE, 0, 0, },
	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },
	     { NULL }
	};
	struct packet vr_msg = {
	     "Value Request",
	     VALUE_REQUEST_MIN, 0, parts
	};
	struct value_request *header;
	struct stateob *st;
	BIGNUM *test, *gen, *mod;
	u_int8_t *p, *modp, *refp, *genp = NULL;
	size_t sstart, vsize, modsize, modpsize, refpsize;
	int modflag;
	u_int8_t scheme_ref[2];
	u_int8_t rcookie[COOKIE_SIZE];

	if (size < VALUE_REQUEST_MIN)
	     return (-1);	/* packet too small  */

	if (packet_check(packet, size, &vr_msg) == -1) {
	     log_print("bad packet structure in handle_value_request()");
	     return (-1);
	}

	header = (struct value_request *) packet;

	st = state_find_cookies(address, header->icookie, header->rcookie);
	if (st == NULL) {
	     struct stateob tempst;
	     bzero((char *)&tempst, sizeof(tempst)); /* Set up temp. state */ 
	     tempst.initiator = 0;                   /* We are the Responder */ 
	     bcopy(header->icookie, tempst.icookie, COOKIE_SIZE); 
	     strncpy(tempst.address, address, 15); 
	     tempst.port = global_port; 
	     tempst.counter = header->counter;
	     
	     cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize); 

	     /* Check for invalid cookie */
	     if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {
		  packet_size = PACKET_BUFFER_SIZE;
		  photuris_error_message(&tempst, packet_buffer, &packet_size,
					 header->icookie, header->rcookie,
					 header->counter, BAD_COOKIE);
		  send_packet();
		  return (0);
	     }

	     /* Check exchange value - XXX doesn't check long form */
	     vsize = parts[0].size;

	     /* Check schemes - selected length is in exchange value*/
	     sstart = 0;
	     modflag = 0;
	     refp = modp = NULL;
	     *(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));
	     while (sstart < ssize) {
		  p = scheme_get_mod(schemes + sstart);
		  modsize = varpre2octets(p);
		  if (!bcmp(header->scheme, schemes + sstart, 2)) {
		       modflag = 1;
		       if (modsize == vsize) {
			    genp = scheme_get_gen(schemes+sstart);
			    modp = p;
			    modpsize = modsize;
			    break;  /* On right scheme + right size */
		       } else if (modsize <= 2 && refp != NULL) {
			    modp = refp;
			    modpsize = refpsize;
			    break;
		       }
		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&
			     modsize == vsize) {
		       genp = scheme_get_gen(schemes + sstart);
		       if (modflag) {
			    modp = p;
			    modpsize = modsize;
			    break;
		       }
		       refp = p;
		       refpsize = modsize;
		  }
		  
		  sstart += scheme_get_len(schemes+sstart);
	     }
	     if (sstart >= ssize)
		  return (-1);   /* Did not find a scheme - XXX log */

	     /* now check the exchange value */
	     test = BN_new();
	     if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {
		     BN_free(test);
		     return (-1);
	     }

	     mod = BN_new();
	     if (BN_varpre2bn(modp, modpsize, mod) == NULL) {
		     BN_free(test);
		     BN_free(mod);
		     return (-1);
	     }

	     gen = BN_new();
	     if (exchange_set_generator(gen, header->scheme, genp) == -1 ||
		 !exchange_check_value(test, gen, mod)) {
		  BN_free(test);
		  BN_free(gen);
		  BN_free(mod);
		  return 0;
	     }
	     BN_free(test);
	     BN_free(gen);
	     BN_free(mod);

	     if ((st = state_new()) == NULL)
		     goto resourcefail;

	     /* Default options */
	     st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;

	     /* Fill the state object */
	     st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));
             if (st->uSPIoattrib == NULL) {
                  state_value_reset(st);
		  goto resourcefail;
	     }
             bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);  
             st->uSPIoattribsize = parts[1].size;  

	     /* Save scheme, which will be used by both parties */
	     vsize = 2 + varpre2octets(modp);

	     /* XXX - VPN - only support two octets */
	     if (genp != NULL)
		  vsize += 2 + varpre2octets(genp);

	     st->scheme = calloc(vsize, sizeof(u_int8_t));
	     if (st->scheme == NULL) {
                  state_value_reset(st); 
                  goto resourcefail; 
             } 
             bcopy(header->scheme, st->scheme, 2);
	     if (genp != NULL) {
		  st->scheme[2] = (vsize-4) >> 8;
		  st->scheme[3] = (vsize-4) & 0xFF;
		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));
	     }
	     bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),
		   varpre2octets(modp));;
		   
             st->schemesize = vsize;

#ifdef DEBUG
	     {
		  int i = BUFFER_SIZE;
		  bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)));
		  printf("Got exchange value 0x%s\n", buffer);
	     }
#endif

	     /* Set exchange value */
	     st->texchangesize = parts[0].size;
	     st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));
	     if (st->texchange == NULL) {
		  log_error("calloc() in handle_value_request()");
		  state_value_reset(st);
		  goto resourcefail;
	     }
	     bcopy(parts[0].where, st->texchange, st->texchangesize);


	     /* Fill in the state object with generic data */
             strncpy(st->address, address, 15);  
             st->port = port;  
	     st->counter = header->counter;
             bcopy(header->icookie, st->icookie, COOKIE_SIZE);  
             bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);  
	     bcopy(&header->counter, st->uSPITBV, 3);

	     if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {
		  log_error("calloc() in handle_value_request()");
		  state_value_reset(st);
		  goto resourcefail;
	     }
	     bcopy(schemes, st->roschemes, ssize);
	     st->roschemesize = ssize;

	     if (pick_attrib(st, &(st->oSPIoattrib), 
			     &(st->oSPIoattribsize)) == -1) {
		  state_value_reset(st);
		  goto resourcefail;
	     }

	     st->lifetime = exchange_timeout + time(NULL);

	     /* Now put the filled state object in the chain */
	     state_insert(st);
	} else if (st->phase != VALUE_RESPONSE) {
		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__
			 ": value request from %s, but we are in state %d",
			 st->address, st->phase));
		return (-1);
	}
	     
	packet_size = PACKET_BUFFER_SIZE;
	if (photuris_value_response(st, packet_buffer, &packet_size) == -1)
	     return (-1);

	send_packet();

        /* Compute the shared secret now */
        compute_shared_secret(st, &(st->shared), &(st->sharedsize));
#ifdef DEBUG   
	{
	     int i = BUFFER_SIZE;
	     bin2hex(buffer, &i, st->shared, st->sharedsize);
	     printf("Shared secret is: 0x%s\n", buffer);   
	}
#endif   

	if (st->oSPIprivacyctx == NULL) {
	     /* Initialize Privacy Keys from Exchange Values */
	     init_privacy_key(st, 0);   /* User -> Owner direction */
	     init_privacy_key(st, 1);   /* Owner -> User direction */
	}

	st->retries = 0;
	st->phase = VALUE_RESPONSE;
	return (0);

 resourcefail:
	packet_size = PACKET_BUFFER_SIZE;
	photuris_error_message(st, packet_buffer, &packet_size,
			       header->icookie, header->rcookie,
			       header->counter, RESOURCE_LIMIT);
	send_packet();
	return (0);
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
3,8
3,9
3,10
5,6
5,7
6,7
8,9
8,10
11,12
11,13
13,14
15,16
15,17
17,18
17,19
20,21
20,22
21,22
23,24
25,26
25,27
26,27
28,29
28,30
31,32
31,33
32,33
34,35
36,37
36,38
36,39
36,40
36,41
36,42
36,43
36,44
36,45
36,46
36,47
36,48
36,49
36,50
36,51
36,52
36,53
36,54
36,55
36,56
36,57
36,58
36,59
36,60
36,61
36,62
36,63
37,38
38,39
38,40
39,40
41,42
41,43
41,44
44,45
45,46
45,47
45,48
46,47
46,48
46,49
46,50
48,49
52,53
52,54
52,55
52,56
54,55
56,57
59,60
60,61
62,63
63,64
63,65
64,65
66,67
66,68
68,69
69,70
69,71
69,72
69,73
71,72
74,75
76,77
77,78
77,79
78,79
80,81
80,82
83,84
84,85
84,86
85,86
87,88
87,89
90,91
91,92
91,93
91,94
91,95
92,93
94,95
94,96
97,98
97,99
100,101
100,102
103,104
104,105
104,106
104,107
104,108
104,109
105,106
107,108
107,109
110,111
110,112
113,114
113,115
116,117
116,118
116,119
119,120
120,121
122,123
123,124
123,125
123,126
123,127
123,128
123,129
124,125
126,127
128,129
130,131
132,133
134,135
136,137
137,138
137,139
139,140
141,142
142,143
142,144
143,144
145,146
145,147
147,148
149,150
150,151
150,152
151,152
153,154
153,155
155,156
156,157
158,159
158,160
159,160
159,161
160,161
162,163
164,165
165,166
166,167
168,169
168,170
169,170
169,171
170,171
170,172
170,173
170,174
171,172
173,174
175,176
177,178
178,179
180,181
182,183
182,184
183,184
184,185
184,186
185,186
188,189
189,190
190,191
192,193
193,194
193,195
194,195
196,197
196,198
197,198
197,199
198,199
200,201
202,203
204,205
205,206
205,207
206,207
208,209
208,210
208,211
208,212
209,210
211,212
213,214
213,215
214,215
217,218
217,219
218,219
221,222
221,223
221,224
222,223
222,224
223,224
225,226
227,228
227,229
227,230
227,231
227,232
227,233
227,234
227,235
227,236
227,237
227,238
227,239
227,240
227,241
227,242
227,243
227,244
227,245
227,246
227,247
227,248
227,249
227,250
227,251
227,252
227,253
227,254
227,255
227,256
227,257
227,258
227,259
227,260
227,261
227,262
227,263
227,264
227,265
227,266
227,267
227,268
227,269
227,270
227,271
227,272
227,273
227,274
227,275
227,276
227,277
227,278
227,279
227,280
227,281
227,282
227,283
228,229
229,230
229,231
230,231
232,233
234,235
235,236
235,237
235,238
236,237
238,239
238,240
239,240
239,241
241,242
243,244
244,245
246,247
247,248
248,249
250,251
251,252
251,253
252,253
252,254
253,254
257,258
258,259
258,260
258,261
258,262
259,260
261,262
261,263
262,263
265,266
265,267
266,267
269,270
271,272
272,273
272,274
272,275
272,276
273,274
275,276
275,277
276,277
279,280
282,283
283,284
283,285
284,285
284,286
285,286
288,289
290,291
291,292
291,293
292,293
292,294
293,294
296,297
296,298
297,298
300,301
301,302
301,303
301,304
301,305
301,306
301,307
302,303
304,305
305,306
307,308
309,310
311,312
313,314
315,316
315,317
316,317
316,318
316,319
316,320
317,318
319,320
321,322
321,323
322,323
325,326
327,328
327,329
327,330
327,331
328,329
329,330
329,331
330,331
332,333
334,335
335,336
335,337
335,338
335,339
335,340
335,341
335,342
335,343
336,337
338,339
339,340
341,342
343,344
344,345
346,347
346,348
347,348
350,351
350,352
351,352
354,355
354,356
355,356
358,359
360,361
361,362
362,363
364,365
365,366
367,368
368,369
368,370
369,370
371,372
371,373
372,373
372,374
373,374
377,378
378,379
378,380
379,380
382,383
383,384
383,385
384,385
387,388
388,389
388,390
389,390
391,392
391,393
392,393
394,395
396,397
397,398
397,399
398,399
399,400
399,401
400,401
400,402
401,402
403,404
405,406
407,408
407,409
408,409
410,411
410,412
411,412
413,414
413,415
414,415
417,418
417,419
418,419
418,420
419,420
421,422
423,424
423,425
423,426
423,427
424,425
425,426
425,427
426,427
428,429
428,430
429,430
431,432
431,433
432,433
434,435
436,437
437,438
437,439
438,439
440,441
440,442
441,442
443,444
445,446
445,447
445,448
446,447
447,448
447,449
447,450
447,451
448,449
450,451
450,452
451,452
454,455
454,456
455,456
457,458
460,461
460,462
461,462
462,463
462,464
463,464
466,467
466,468
466,469
467,468
467,469
468,469
470,471
472,473
472,474
472,475
472,476
473,474
474,475
474,476
475,476
477,478
477,479
478,479
480,481
480,482
481,482
483,484
485,486
486,487
486,488
487,488
489,490
491,492
492,493
492,494
493,494
495,496
498,499
498,500
499,500
499,501
500,501
500,502
501,502
504,505
504,506
505,506
507,508
509,510
509,511
509,512
510,511
511,512
511,513
512,513
514,515
516,517
517,518
517,519
518,519
520,521
523,524
523,525
524,525
524,526
525,526
526,527
526,528
526,529
526,530
527,528
529,530
531,532
531,533
532,533
534,535
537,538
537,539
538,539
540,541
542,543
542,544
542,545
542,546
543,544
544,545
544,546
545,546
547,548
547,549
548,549
550,551
550,552
551,552
553,554
555,556
555,557
556,557
558,559
558,560
558,561
559,560
560,561
560,562
561,562
563,564
565,566
566,567
566,568
567,568
569,570
572,573
573,574
573,575
574,575
576,577
578,579
579,580
579,581
580,581
582,583
584,585
585,586
585,587
586,587
588,589
588,590
589,590
591,592
591,593
592,593
594,595
596,597
596,598
597,598
597,599
598,599
600,601
602,603
603,604
604,605
606,607
607,608
607,609
608,609
610,611
611,612
613,614
613,615
614,615
614,616
615,616
615,617
615,618
615,619
616,617
618,619
618,620
619,620
619,621
620,621
624,625
624,626
625,626
625,627
626,627
630,631
632,633
634,635
634,636
635,636
636,637
636,638
637,638
639,640
641,642
642,643
643,644
645,646
646,647
646,648
647,648
649,650
650,651
652,653
652,654
653,654
653,655
654,655
654,656
654,657
654,658
655,656
657,658
659,660
661,662
663,664
665,666
665,667
665,668
666,667
667,668
667,669
668,669
670,671
672,673
673,674
673,675
674,675
676,677
678,679
679,680
680,681
682,683
683,684
683,685
684,685
686,687
687,688
689,690
689,691
690,691
690,692
691,692
691,693
692,693
692,694
692,695
692,696
693,694
695,696
697,698
697,699
698,699
701,702
703,704
705,706
706,707
706,708
706,709
706,710
707,708
709,710
711,712
713,714
715,716
715,717
715,718
715,719
716,717
717,718
717,719
718,719
720,721
722,723
723,724
723,725
724,725
726,727
728,729
729,730
729,731
730,731
732,733
734,735
736,737
737,738
737,739
738,739
740,741
742,743
743,744
743,745
744,745
746,747
748,749
749,750
749,751
750,751
752,753
754,755
754,756
755,756
755,757
756,757
757,758
757,759
758,759
760,761
761,762
763,764
765,766
767,768
768,769
768,770
769,770
769,771
770,771
773,774
773,775
774,775
776,777
778,779
779,780
779,781
780,781
780,782
781,782
784,785
784,786
784,787
785,786
787,788
787,789
788,789
788,790
789,790
793,794
794,795
794,796
795,796
798,799
798,800
799,800
799,801
800,801
800,802
801,802
804,805
806,807
806,808
807,808
808,809
808,810
809,810
811,812
813,814
815,816
816,817
816,818
816,819
816,820
817,818
819,820
819,821
820,821
820,822
821,822
825,826
825,827
826,827
829,830
829,831
830,831
830,832
831,832
835,836
836,837
836,838
837,838
837,839
838,839
841,842
841,843
842,843
842,844
843,844
847,848
848,849
848,850
849,850
851,852
851,853
853,854
853,855
854,855
856,857
858,859
858,860
859,860
859,861
860,861
862,863
864,865
865,866
865,867
866,867
868,869
868,870
870,871
870,872
871,872
873,874
875,876
876,877
876,878
877,878
877,879
878,879
881,882
881,883
881,884
882,883
884,885
886,887
887,888
887,889
888,889
891,892
891,893
892,893
892,894
893,894
893,895
894,895
897,898
899,900
899,901
900,901
901,902
901,903
902,903
904,905
906,907
908,909
909,910
909,911
909,912
909,913
910,911
912,913
912,914
913,914
916,917
916,918
917,918
921,922
921,923
922,923
922,924
923,924
925,926
927,928
927,929
927,930
928,929
929,930
929,931
930,931
930,932
931,932
931,933
932,933
936,937
936,938
937,938
938,939
938,940
939,940
943,944
944,945
944,946
945,946
945,947
946,947
946,948
947,948
951,952
951,953
952,953
953,954
953,955
954,955
958,959
959,960
959,961
959,962
959,963
960,961
962,963
964,965
964,966
965,966
965,967
966,967
966,968
967,968
972,973
972,974
973,974
975,976
977,978
978,979
978,980
978,981
978,982
979,980
981,982
983,984
983,985
984,985
984,986
985,986
985,987
986,987
990,991
991,992
991,993
991,994
992,993
992,994
993,994
995,996
998,999
998,1000
1000,1001
1000,1002
1001,1002
1003,1004
1005,1006
1005,1007
1006,1007
1008,1009
1011,1012
1012,1013
1012,1014
1013,1014
1013,1015
1014,1015
1017,1018
1019,1020
1020,1021
1020,1022
1021,1022
1021,1023
1022,1023
1025,1026
1025,1027
1026,1027
1026,1028
1027,1028
1031,1032
1032,1033
1032,1034
1033,1034
1033,1035
1034,1035
1037,1038
1037,1039
1037,1040
1038,1039
1040,1041
1040,1042
1041,1042
1044,1045
1045,1046
1045,1047
1046,1047
1049,1050
1049,1051
1050,1051
1050,1052
1051,1052
1051,1053
1052,1053
1055,1056
1057,1058
1057,1059
1057,1060
1058,1059
1059,1060
1059,1061
1060,1061
1063,1064
1064,1065
1064,1066
1065,1066
1067,1068
1069,1070
1071,1072
1072,1073
1072,1074
1072,1075
1072,1076
1073,1074
1075,1076
1075,1077
1076,1077
1076,1078
1077,1078
1081,1082
1081,1083
1082,1083
1085,1086
1085,1087
1086,1087
1089,1090
1090,1091
1090,1092
1090,1093
1090,1094
1091,1092
1093,1094
1093,1095
1094,1095
1097,1098
1100,1101
1101,1102
1101,1103
1102,1103
1102,1104
1103,1104
1106,1107
1108,1109
1109,1110
1109,1111
1110,1111
1110,1112
1111,1112
1114,1115
1114,1116
1115,1116
1118,1119
1119,1120
1119,1121
1119,1122
1119,1123
1120,1121
1122,1123
1122,1124
1123,1124
1126,1127
1126,1128
1127,1128
1130,1131
1132,1133
1133,1134
1133,1135
1133,1136
1133,1137
1134,1135
1136,1137
1136,1138
1137,1138
1140,1141
1140,1142
1141,1142
1144,1145
1146,1147
1147,1148
1147,1149
1147,1150
1147,1151
1148,1149
1150,1151
1151,1152
1151,1153
1152,1153
1155,1156
1155,1157
1156,1157
1160,1161
1160,1162
1161,1162
1161,1163
1162,1163
1163,1164
1163,1165
1164,1165
1164,1166
1165,1166
1168,1169
1168,1170
1168,1171
1169,1170
1171,1172
1173,1174
1174,1175
1174,1176
1175,1176
1178,1179
1180,1181
1180,1182
1180,1183
1181,1182
1182,1183
1182,1184
1183,1184
1186,1187
1187,1188
1187,1189
1188,1189
1190,1191
1192,1193
1194,1195
1195,1196
1195,1197
1195,1198
1195,1199
1196,1197
1198,1199
1200,1201
1200,1202
1201,1202
1204,1205
1206,1207
1207,1208
1207,1209
1208,1209
1208,1210
1209,1210
1212,1213
1214,1215
1214,1216
1215,1216
1215,1217
1216,1217
1216,1218
1216,1219
1216,1220
1217,1218
1219,1220
1221,1222
1222,1223
1223,1224
1223,1225
1224,1225
1227,1228
1228,1229
1229,1230
1229,1231
1230,1231
1233,1234
1235,1236
1235,1237
1236,1237
1237,1238
1237,1239
1238,1239
1240,1241
1242,1243
1244,1245
1245,1246
1245,1247
1246,1247
1246,1248
1247,1248
1250,1251
1250,1252
1251,1252
1253,1254
1253,1255
1254,1255
1256,1257
1258,1259
1259,1260
1259,1261
1260,1261
1262,1263
1264,1265
1264,1266
1265,1266
1265,1267
1266,1267
1266,1268
1267,1268
1270,1271
1272,1273
1272,1274
1273,1274
1274,1275
1275,1276
1276,1277
1278,1279
1279,1280
1279,1281
1280,1281
1282,1283
1284,1285
1284,1286
1285,1286
1285,1287
1286,1287
1286,1288
1286,1289
1286,1290
1287,1288
1289,1290
1291,1292
1293,1294
1294,1295
1296,1297
1298,1299
1299,1300
1300,1301
1302,1303
1303,1304
1304,1305
1306,1307
1307,1308
1307,1309
1307,1310
1307,1311
1308,1309
1310,1311
1312,1313
1313,1314
1314,1315
1314,1316
1315,1316
1318,1319
1319,1320
1320,1321
1320,1322
1321,1322
1324,1325
1324,1326
1325,1326
1325,1327
1326,1327
1326,1328
1327,1328
1330,1331
1332,1333
1332,1334
1333,1334
1334,1335
1334,1336
1334,1337
1335,1336
1337,1338
1340,1341
1341,1342
1341,1343
1341,1344
1342,1343
1344,1345
1347,1348
1348,1349
1348,1350
1349,1350
1349,1351
1350,1351
1354,1355
1355,1356
1355,1357
1356,1357
1356,1358
1357,1358
1360,1361
1362,1363
1363,1364
1365,1366
1365,1367
1367,1368
1368,1369
1368,1370
1369,1370
1371,1372
1373,1374
1374,1375
1374,1376
1374,1377
1374,1378
1374,1379
1374,1380
1374,1381
1374,1382
1375,1376
1377,1378
1379,1380
1381,1382
1382,1383
1384,1385
1384,1386
1385,1386
1388,1389
1388,1390
1389,1390
1392,1393
1392,1394
1393,1394
1396,1397
1398,1399
1399,1400
1400,1401
1402,1403
1403,1404
-----nextToken-----
2,4,7,9,10,12,14,16,18,19,22,24,27,29,30,33,35,40,42,43,47,49,50,51,53,55,57,58,61,65,67,70,72,73,75,79,81,82,86,88,89,93,95,96,98,99,101,102,106,108,109,111,112,114,115,117,118,121,125,127,129,131,133,135,138,140,144,146,148,152,154,157,161,163,167,172,174,176,179,181,186,187,191,195,199,201,203,207,210,212,215,216,219,220,224,226,231,233,237,240,242,245,249,254,255,256,260,263,264,267,268,270,274,277,278,280,281,286,287,289,294,295,298,299,303,306,308,310,312,314,318,320,323,324,326,331,333,337,340,342,345,348,349,352,353,356,357,359,363,366,370,374,375,376,380,381,385,386,390,393,395,402,404,406,409,412,415,416,420,422,427,430,433,435,439,442,444,449,452,453,456,458,459,464,465,469,471,476,479,482,484,488,490,494,496,497,502,503,506,508,513,515,519,521,522,528,530,533,535,536,539,541,546,549,552,554,557,562,564,568,570,571,575,577,581,583,587,590,593,595,599,601,605,609,612,617,621,622,623,627,628,629,631,633,638,640,644,648,651,656,658,660,662,664,669,671,675,677,681,685,688,694,696,699,700,702,704,708,710,712,714,719,721,725,727,731,733,735,739,741,745,747,751,753,759,762,764,766,771,772,775,777,782,783,786,790,791,792,796,797,802,803,805,810,812,814,818,822,823,824,827,828,832,833,834,839,840,844,845,846,850,852,855,857,861,863,867,869,872,874,879,880,883,885,889,890,895,896,898,903,905,907,911,914,915,918,919,920,924,926,933,934,935,940,941,942,948,949,950,955,956,957,961,963,968,969,970,971,974,976,980,982,987,988,989,994,996,997,999,1002,1004,1007,1009,1010,1015,1016,1018,1023,1024,1028,1029,1030,1035,1036,1039,1042,1043,1047,1048,1053,1054,1056,1061,1062,1066,1068,1070,1074,1078,1079,1080,1083,1084,1087,1088,1092,1095,1096,1098,1099,1104,1105,1107,1112,1113,1116,1117,1121,1124,1125,1128,1129,1131,1135,1138,1139,1142,1143,1145,1149,1153,1154,1157,1158,1159,1166,1167,1170,1172,1176,1177,1179,1184,1185,1189,1191,1193,1197,1199,1202,1203,1205,1210,1211,1213,1218,1220,1225,1226,1231,1232,1234,1239,1241,1243,1248,1249,1252,1255,1257,1261,1263,1268,1269,1271,1277,1281,1283,1288,1290,1292,1295,1297,1301,1305,1309,1311,1316,1317,1322,1323,1328,1329,1331,1336,1338,1339,1343,1345,1346,1351,1352,1353,1358,1359,1361,1364,1366,1370,1372,1376,1378,1380,1383,1386,1387,1390,1391,1394,1395,1397,1401,1404
-----computeFrom-----
159,160
159,161
169,170
169,171
193,194
193,195
205,206
205,207
222,223
222,224
251,252
251,253
283,284
283,285
291,292
291,293
329,330
329,331
368,369
368,370
378,379
378,380
383,384
383,385
388,389
388,390
391,392
391,393
397,398
397,399
418,419
418,420
425,426
425,427
431,432
431,433
437,438
437,439
454,455
454,456
462,463
462,464
467,468
467,469
474,475
474,476
480,481
480,482
486,487
486,488
492,493
492,494
499,500
499,501
500,501
500,502
504,505
504,506
511,512
511,513
517,518
517,519
524,525
524,526
531,532
531,533
537,538
537,539
544,545
544,546
550,551
550,552
560,561
560,562
566,567
566,568
573,574
573,575
579,580
579,581
585,586
585,587
591,592
591,593
597,598
597,599
607,608
607,609
614,615
614,616
646,647
646,648
653,654
653,655
683,684
683,685
690,691
690,692
691,692
691,693
755,756
755,757
757,758
757,759
768,769
768,770
773,774
773,775
779,780
779,781
799,800
799,801
836,837
836,838
848,849
848,850
851,852
851,853
859,860
859,861
865,866
865,867
868,869
868,870
876,877
876,878
892,893
892,894
922,923
922,924
929,930
929,931
936,937
936,938
938,939
938,940
944,945
944,946
951,952
951,953
953,954
953,955
964,965
964,966
965,966
965,967
983,984
983,985
984,985
984,986
992,993
992,994
998,999
998,1000
1012,1013
1012,1014
1020,1021
1020,1022
1032,1033
1032,1034
1050,1051
1050,1052
1101,1102
1101,1103
1109,1110
1109,1111
1161,1162
1161,1163
1163,1164
1163,1165
1207,1208
1207,1209
1215,1216
1215,1217
1245,1246
1245,1247
1250,1251
1250,1252
1265,1266
1265,1267
1279,1280
1279,1281
1285,1286
1285,1287
1325,1326
1325,1327
1348,1349
1348,1350
1355,1356
1355,1357
1368,1369
1368,1370
-----guardedBy-----
224,1263
226,1257
469,496
506,515
535,554
533,552
539,583
631,640
662,677
712,727
714,733
710,721
802,812
861,874
895,905
924,976
1053,1068
1166,1191
1231,1241
1328,1345
-----guardedByNegation-----
224,1268
469,502
-----lastLexicalUse-----
224,1268
469,502
-----jump-----
224,1268
469,502
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;ArrayDeclarator;Name;ArrayModifier;EqualsInitializer;InitializerList;InitializerList;LiteralExpression;IdExpression;Name;LiteralExpression;LiteralExpression;InitializerList;LiteralExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;InitializerList;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;InitializerList;LiteralExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;Declarator;Pointer;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;Declarator;Pointer;Name;Declarator;Pointer;Name;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;Declarator;Name;Declarator;Name;Declarator;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;ElaboratedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;UnaryExpression;IdExpression;Name;UnaryExpression;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ReturnStatement;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;UnaryExpression;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;WhileStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;UnaryExpression;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;BreakStatement;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;BreakStatement;IfStatement;BinaryExpression;UnaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;BreakStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IfStatement;BinaryExpression;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;UnaryExpression;LiteralExpression;UnaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;UnaryExpression;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;TypeIdExpression;TypeId;NamedTypeSpecifier;Name;Declarator;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;LiteralExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;LiteralExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;TypeIdExpression;TypeId;NamedTypeSpecifier;Name;Declarator;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;BinaryExpression;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;BinaryExpression;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;LiteralExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;UnaryExpression;ConditionalExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;NullStatement;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;TypeIdExpression;TypeId;NamedTypeSpecifier;Name;Declarator;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;LiteralExpression;IfStatement;BinaryExpression;UnaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;TypeIdExpression;TypeId;NamedTypeSpecifier;Name;Declarator;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ProblemStatement;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ReturnStatement;UnaryExpression;UnaryExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ReturnStatement;UnaryExpression;LiteralExpression;LabelStatement;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ReturnStatement;UnaryExpression;LiteralExpression;
-----ast_node-----
inthandle_value_request(u_char *packet, int size,		     char *address, u_short port,		     u_int8_t *schemes, u_int16_t ssize){        struct packet_sub parts[] = {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	};	struct packet vr_msg = {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	};	struct value_request *header;	struct stateob *st;	BIGNUM *test, *gen, *mod;	u_int8_t *p, *modp, *refp, *genp = NULL;	size_t sstart, vsize, modsize, modpsize, refpsize;	int modflag;	u_int8_t scheme_ref[2];	u_int8_t rcookie[COOKIE_SIZE];	if (size < VALUE_REQUEST_MIN)	     return (-1);	/* packet too small  */	if (packet_check(packet, size, &vr_msg) == -1) {	     log_print("bad packet structure in handle_value_request()");	     return (-1);	}	header = (struct value_request *) packet;	st = state_find_cookies(address, header->icookie, header->rcookie);	if (st == NULL) {	     struct stateob tempst;	     bzero((char *)&tempst, sizeof(tempst)); /* Set up temp. state */ 	     tempst.initiator = 0;                   /* We are the Responder */ 	     bcopy(header->icookie, tempst.icookie, COOKIE_SIZE); 	     strncpy(tempst.address, address, 15); 	     tempst.port = global_port; 	     tempst.counter = header->counter;	     	     cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize); 	     /* Check for invalid cookie */	     if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }	     /* Check exchange value - XXX doesn't check long form */	     vsize = parts[0].size;	     /* Check schemes - selected length is in exchange value*/	     sstart = 0;	     modflag = 0;	     refp = modp = NULL;	     *(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));	     while (sstart < ssize) {		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }	     if (sstart >= ssize)		  return (-1);   /* Did not find a scheme - XXX log */	     /* now check the exchange value */	     test = BN_new();	     if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {		     BN_free(test);		     return (-1);	     }	     mod = BN_new();	     if (BN_varpre2bn(modp, modpsize, mod) == NULL) {		     BN_free(test);		     BN_free(mod);		     return (-1);	     }	     gen = BN_new();	     if (exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)) {		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }	     BN_free(test);	     BN_free(gen);	     BN_free(mod);	     if ((st = state_new()) == NULL)		     goto resourcefail;	     /* Default options */	     st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;	     /* Fill the state object */	     st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));             if (st->uSPIoattrib == NULL) {                  state_value_reset(st);		  goto resourcefail;	     }             bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);               st->uSPIoattribsize = parts[1].size;  	     /* Save scheme, which will be used by both parties */	     vsize = 2 + varpre2octets(modp);	     /* XXX - VPN - only support two octets */	     if (genp != NULL)		  vsize += 2 + varpre2octets(genp);	     st->scheme = calloc(vsize, sizeof(u_int8_t));	     if (st->scheme == NULL) {                  state_value_reset(st);                   goto resourcefail;              }              bcopy(header->scheme, st->scheme, 2);	     if (genp != NULL) {		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }	     bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp));;		                st->schemesize = vsize;#ifdef DEBUG	     {		  int i = BUFFER_SIZE;		  bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)));		  printf("Got exchange value 0x%s\n", buffer);	     }#endif	     /* Set exchange value */	     st->texchangesize = parts[0].size;	     st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));	     if (st->texchange == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(parts[0].where, st->texchange, st->texchangesize);	     /* Fill in the state object with generic data */             strncpy(st->address, address, 15);               st->port = port;  	     st->counter = header->counter;             bcopy(header->icookie, st->icookie, COOKIE_SIZE);               bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);  	     bcopy(&header->counter, st->uSPITBV, 3);	     if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(schemes, st->roschemes, ssize);	     st->roschemesize = ssize;	     if (pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1) {		  state_value_reset(st);		  goto resourcefail;	     }	     st->lifetime = exchange_timeout + time(NULL);	     /* Now put the filled state object in the chain */	     state_insert(st);	} else if (st->phase != VALUE_RESPONSE) {		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));		return (-1);	}	     	packet_size = PACKET_BUFFER_SIZE;	if (photuris_value_response(st, packet_buffer, &packet_size) == -1)	     return (-1);	send_packet();        /* Compute the shared secret now */        compute_shared_secret(st, &(st->shared), &(st->sharedsize));#ifdef DEBUG   	{	     int i = BUFFER_SIZE;	     bin2hex(buffer, &i, st->shared, st->sharedsize);	     printf("Shared secret is: 0x%s\n", buffer);   	}#endif   	if (st->oSPIprivacyctx == NULL) {	     /* Initialize Privacy Keys from Exchange Values */	     init_privacy_key(st, 0);   /* User -> Owner direction */	     init_privacy_key(st, 1);   /* Owner -> User direction */	}	st->retries = 0;	st->phase = VALUE_RESPONSE;	return (0); resourcefail:	packet_size = PACKET_BUFFER_SIZE;	photuris_error_message(st, packet_buffer, &packet_size,			       header->icookie, header->rcookie,			       header->counter, RESOURCE_LIMIT);	send_packet();	return (0);}
int
handle_value_request(u_char *packet, int size,		     char *address, u_short port,		     u_int8_t *schemes, u_int16_t ssize)
handle_value_request
u_char *packet
u_char
u_char
*packet
*
packet
int size
int
size
size
char *address
char
*address
*
address
u_short port
u_short
u_short
port
port
u_int8_t *schemes
u_int8_t
u_int8_t
*schemes
*
schemes
u_int16_t ssize
u_int16_t
u_int16_t
ssize
ssize
{        struct packet_sub parts[] = {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	};	struct packet vr_msg = {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	};	struct value_request *header;	struct stateob *st;	BIGNUM *test, *gen, *mod;	u_int8_t *p, *modp, *refp, *genp = NULL;	size_t sstart, vsize, modsize, modpsize, refpsize;	int modflag;	u_int8_t scheme_ref[2];	u_int8_t rcookie[COOKIE_SIZE];	if (size < VALUE_REQUEST_MIN)	     return (-1);	/* packet too small  */	if (packet_check(packet, size, &vr_msg) == -1) {	     log_print("bad packet structure in handle_value_request()");	     return (-1);	}	header = (struct value_request *) packet;	st = state_find_cookies(address, header->icookie, header->rcookie);	if (st == NULL) {	     struct stateob tempst;	     bzero((char *)&tempst, sizeof(tempst)); /* Set up temp. state */ 	     tempst.initiator = 0;                   /* We are the Responder */ 	     bcopy(header->icookie, tempst.icookie, COOKIE_SIZE); 	     strncpy(tempst.address, address, 15); 	     tempst.port = global_port; 	     tempst.counter = header->counter;	     	     cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize); 	     /* Check for invalid cookie */	     if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }	     /* Check exchange value - XXX doesn't check long form */	     vsize = parts[0].size;	     /* Check schemes - selected length is in exchange value*/	     sstart = 0;	     modflag = 0;	     refp = modp = NULL;	     *(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));	     while (sstart < ssize) {		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }	     if (sstart >= ssize)		  return (-1);   /* Did not find a scheme - XXX log */	     /* now check the exchange value */	     test = BN_new();	     if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {		     BN_free(test);		     return (-1);	     }	     mod = BN_new();	     if (BN_varpre2bn(modp, modpsize, mod) == NULL) {		     BN_free(test);		     BN_free(mod);		     return (-1);	     }	     gen = BN_new();	     if (exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)) {		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }	     BN_free(test);	     BN_free(gen);	     BN_free(mod);	     if ((st = state_new()) == NULL)		     goto resourcefail;	     /* Default options */	     st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;	     /* Fill the state object */	     st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));             if (st->uSPIoattrib == NULL) {                  state_value_reset(st);		  goto resourcefail;	     }             bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);               st->uSPIoattribsize = parts[1].size;  	     /* Save scheme, which will be used by both parties */	     vsize = 2 + varpre2octets(modp);	     /* XXX - VPN - only support two octets */	     if (genp != NULL)		  vsize += 2 + varpre2octets(genp);	     st->scheme = calloc(vsize, sizeof(u_int8_t));	     if (st->scheme == NULL) {                  state_value_reset(st);                   goto resourcefail;              }              bcopy(header->scheme, st->scheme, 2);	     if (genp != NULL) {		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }	     bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp));;		                st->schemesize = vsize;#ifdef DEBUG	     {		  int i = BUFFER_SIZE;		  bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)));		  printf("Got exchange value 0x%s\n", buffer);	     }#endif	     /* Set exchange value */	     st->texchangesize = parts[0].size;	     st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));	     if (st->texchange == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(parts[0].where, st->texchange, st->texchangesize);	     /* Fill in the state object with generic data */             strncpy(st->address, address, 15);               st->port = port;  	     st->counter = header->counter;             bcopy(header->icookie, st->icookie, COOKIE_SIZE);               bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);  	     bcopy(&header->counter, st->uSPITBV, 3);	     if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(schemes, st->roschemes, ssize);	     st->roschemesize = ssize;	     if (pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1) {		  state_value_reset(st);		  goto resourcefail;	     }	     st->lifetime = exchange_timeout + time(NULL);	     /* Now put the filled state object in the chain */	     state_insert(st);	} else if (st->phase != VALUE_RESPONSE) {		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));		return (-1);	}	     	packet_size = PACKET_BUFFER_SIZE;	if (photuris_value_response(st, packet_buffer, &packet_size) == -1)	     return (-1);	send_packet();        /* Compute the shared secret now */        compute_shared_secret(st, &(st->shared), &(st->sharedsize));#ifdef DEBUG   	{	     int i = BUFFER_SIZE;	     bin2hex(buffer, &i, st->shared, st->sharedsize);	     printf("Shared secret is: 0x%s\n", buffer);   	}#endif   	if (st->oSPIprivacyctx == NULL) {	     /* Initialize Privacy Keys from Exchange Values */	     init_privacy_key(st, 0);   /* User -> Owner direction */	     init_privacy_key(st, 1);   /* Owner -> User direction */	}	st->retries = 0;	st->phase = VALUE_RESPONSE;	return (0); resourcefail:	packet_size = PACKET_BUFFER_SIZE;	photuris_error_message(st, packet_buffer, &packet_size,			       header->icookie, header->rcookie,			       header->counter, RESOURCE_LIMIT);	send_packet();	return (0);}
struct packet_sub parts[] = {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	};
struct packet_sub parts[] = {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	};
struct packet_sub
packet_sub
parts[] = {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	}
parts
[]
= {	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	}
{	     { "Exchange Value", FLD_VARPRE, 0, 0, },	     { "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, },	     { NULL }	}
{ "Exchange Value", FLD_VARPRE, 0, 0, }
"Exchange Value"
FLD_VARPRE
FLD_VARPRE
0
0
{ "Offered Attributes", FLD_ATTRIB, FMD_ATT_FILL, 0, }
"Offered Attributes"
FLD_ATTRIB
FLD_ATTRIB
FMD_ATT_FILL
FMD_ATT_FILL
0
{ NULL }
NULL
NULL
struct packet vr_msg = {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	};
struct packet vr_msg = {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	};
struct packet
packet
vr_msg = {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	}
vr_msg
= {	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	}
{	     "Value Request",	     VALUE_REQUEST_MIN, 0, parts	}
"Value Request"
VALUE_REQUEST_MIN
VALUE_REQUEST_MIN
0
parts
parts
struct value_request *header;
struct value_request *header;
struct value_request
value_request
*header
*
header
struct stateob *st;
struct stateob *st;
struct stateob
stateob
*st
*
st
BIGNUM *test, *gen, *mod;
BIGNUM *test, *gen, *mod;
BIGNUM
BIGNUM
*test
*
test
*gen
*
gen
*mod
*
mod
u_int8_t *p, *modp, *refp, *genp = NULL;
u_int8_t *p, *modp, *refp, *genp = NULL;
u_int8_t
u_int8_t
*p
*
p
*modp
*
modp
*refp
*
refp
*genp = NULL
*
genp
= NULL
NULL
NULL
size_t sstart, vsize, modsize, modpsize, refpsize;
size_t sstart, vsize, modsize, modpsize, refpsize;
size_t
size_t
sstart
sstart
vsize
vsize
modsize
modsize
modpsize
modpsize
refpsize
refpsize
int modflag;
int modflag;
int
modflag
modflag
u_int8_t scheme_ref[2];
u_int8_t scheme_ref[2];
u_int8_t
u_int8_t
scheme_ref[2]
scheme_ref
[2]
2
u_int8_t rcookie[COOKIE_SIZE];
u_int8_t rcookie[COOKIE_SIZE];
u_int8_t
u_int8_t
rcookie[COOKIE_SIZE]
rcookie
[COOKIE_SIZE]
COOKIE_SIZE
COOKIE_SIZE
if (size < VALUE_REQUEST_MIN)	     return (-1);
size < VALUE_REQUEST_MIN
size
size
VALUE_REQUEST_MIN
VALUE_REQUEST_MIN
return (-1);
(-1)
-1
1
if (packet_check(packet, size, &vr_msg) == -1) {	     log_print("bad packet structure in handle_value_request()");	     return (-1);	}
packet_check(packet, size, &vr_msg) == -1
packet_check(packet, size, &vr_msg)
packet_check
packet_check
packet
packet
size
size
&vr_msg
vr_msg
vr_msg
-1
1
{	     log_print("bad packet structure in handle_value_request()");	     return (-1);	}
log_print("bad packet structure in handle_value_request()");
log_print("bad packet structure in handle_value_request()")
log_print
log_print
"bad packet structure in handle_value_request()"
return (-1);
(-1)
-1
1
header = (struct value_request *) packet;
header = (struct value_request *) packet
header
header
(struct value_request *) packet
struct value_request *
struct value_request
value_request
*
*
packet
packet
st = state_find_cookies(address, header->icookie, header->rcookie);
st = state_find_cookies(address, header->icookie, header->rcookie)
st
st
state_find_cookies(address, header->icookie, header->rcookie)
state_find_cookies
state_find_cookies
address
address
header->icookie
header
header
icookie
header->rcookie
header
header
rcookie
if (st == NULL) {	     struct stateob tempst;	     bzero((char *)&tempst, sizeof(tempst)); /* Set up temp. state */ 	     tempst.initiator = 0;                   /* We are the Responder */ 	     bcopy(header->icookie, tempst.icookie, COOKIE_SIZE); 	     strncpy(tempst.address, address, 15); 	     tempst.port = global_port; 	     tempst.counter = header->counter;	     	     cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize); 	     /* Check for invalid cookie */	     if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }	     /* Check exchange value - XXX doesn't check long form */	     vsize = parts[0].size;	     /* Check schemes - selected length is in exchange value*/	     sstart = 0;	     modflag = 0;	     refp = modp = NULL;	     *(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));	     while (sstart < ssize) {		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }	     if (sstart >= ssize)		  return (-1);   /* Did not find a scheme - XXX log */	     /* now check the exchange value */	     test = BN_new();	     if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {		     BN_free(test);		     return (-1);	     }	     mod = BN_new();	     if (BN_varpre2bn(modp, modpsize, mod) == NULL) {		     BN_free(test);		     BN_free(mod);		     return (-1);	     }	     gen = BN_new();	     if (exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)) {		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }	     BN_free(test);	     BN_free(gen);	     BN_free(mod);	     if ((st = state_new()) == NULL)		     goto resourcefail;	     /* Default options */	     st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;	     /* Fill the state object */	     st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));             if (st->uSPIoattrib == NULL) {                  state_value_reset(st);		  goto resourcefail;	     }             bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);               st->uSPIoattribsize = parts[1].size;  	     /* Save scheme, which will be used by both parties */	     vsize = 2 + varpre2octets(modp);	     /* XXX - VPN - only support two octets */	     if (genp != NULL)		  vsize += 2 + varpre2octets(genp);	     st->scheme = calloc(vsize, sizeof(u_int8_t));	     if (st->scheme == NULL) {                  state_value_reset(st);                   goto resourcefail;              }              bcopy(header->scheme, st->scheme, 2);	     if (genp != NULL) {		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }	     bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp));;		                st->schemesize = vsize;#ifdef DEBUG	     {		  int i = BUFFER_SIZE;		  bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)));		  printf("Got exchange value 0x%s\n", buffer);	     }#endif	     /* Set exchange value */	     st->texchangesize = parts[0].size;	     st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));	     if (st->texchange == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(parts[0].where, st->texchange, st->texchangesize);	     /* Fill in the state object with generic data */             strncpy(st->address, address, 15);               st->port = port;  	     st->counter = header->counter;             bcopy(header->icookie, st->icookie, COOKIE_SIZE);               bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);  	     bcopy(&header->counter, st->uSPITBV, 3);	     if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(schemes, st->roschemes, ssize);	     st->roschemesize = ssize;	     if (pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1) {		  state_value_reset(st);		  goto resourcefail;	     }	     st->lifetime = exchange_timeout + time(NULL);	     /* Now put the filled state object in the chain */	     state_insert(st);	} else if (st->phase != VALUE_RESPONSE) {		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));		return (-1);	}
st == NULL
st
st
NULL
NULL
{	     struct stateob tempst;	     bzero((char *)&tempst, sizeof(tempst)); /* Set up temp. state */ 	     tempst.initiator = 0;                   /* We are the Responder */ 	     bcopy(header->icookie, tempst.icookie, COOKIE_SIZE); 	     strncpy(tempst.address, address, 15); 	     tempst.port = global_port; 	     tempst.counter = header->counter;	     	     cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize); 	     /* Check for invalid cookie */	     if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }	     /* Check exchange value - XXX doesn't check long form */	     vsize = parts[0].size;	     /* Check schemes - selected length is in exchange value*/	     sstart = 0;	     modflag = 0;	     refp = modp = NULL;	     *(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));	     while (sstart < ssize) {		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }	     if (sstart >= ssize)		  return (-1);   /* Did not find a scheme - XXX log */	     /* now check the exchange value */	     test = BN_new();	     if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {		     BN_free(test);		     return (-1);	     }	     mod = BN_new();	     if (BN_varpre2bn(modp, modpsize, mod) == NULL) {		     BN_free(test);		     BN_free(mod);		     return (-1);	     }	     gen = BN_new();	     if (exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)) {		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }	     BN_free(test);	     BN_free(gen);	     BN_free(mod);	     if ((st = state_new()) == NULL)		     goto resourcefail;	     /* Default options */	     st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;	     /* Fill the state object */	     st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));             if (st->uSPIoattrib == NULL) {                  state_value_reset(st);		  goto resourcefail;	     }             bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);               st->uSPIoattribsize = parts[1].size;  	     /* Save scheme, which will be used by both parties */	     vsize = 2 + varpre2octets(modp);	     /* XXX - VPN - only support two octets */	     if (genp != NULL)		  vsize += 2 + varpre2octets(genp);	     st->scheme = calloc(vsize, sizeof(u_int8_t));	     if (st->scheme == NULL) {                  state_value_reset(st);                   goto resourcefail;              }              bcopy(header->scheme, st->scheme, 2);	     if (genp != NULL) {		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }	     bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp));;		                st->schemesize = vsize;#ifdef DEBUG	     {		  int i = BUFFER_SIZE;		  bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)));		  printf("Got exchange value 0x%s\n", buffer);	     }#endif	     /* Set exchange value */	     st->texchangesize = parts[0].size;	     st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));	     if (st->texchange == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(parts[0].where, st->texchange, st->texchangesize);	     /* Fill in the state object with generic data */             strncpy(st->address, address, 15);               st->port = port;  	     st->counter = header->counter;             bcopy(header->icookie, st->icookie, COOKIE_SIZE);               bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);  	     bcopy(&header->counter, st->uSPITBV, 3);	     if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }	     bcopy(schemes, st->roschemes, ssize);	     st->roschemesize = ssize;	     if (pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1) {		  state_value_reset(st);		  goto resourcefail;	     }	     st->lifetime = exchange_timeout + time(NULL);	     /* Now put the filled state object in the chain */	     state_insert(st);	}
struct stateob tempst;
struct stateob tempst;
struct stateob
stateob
tempst
tempst
bzero((char *)&tempst, sizeof(tempst));
bzero((char *)&tempst, sizeof(tempst))
bzero
bzero
(char *)&tempst
char *
char
*
*
&tempst
tempst
tempst
sizeof(tempst)
(tempst)
tempst
tempst
tempst.initiator = 0;
tempst.initiator = 0
tempst.initiator
tempst
tempst
initiator
0
bcopy(header->icookie, tempst.icookie, COOKIE_SIZE);
bcopy(header->icookie, tempst.icookie, COOKIE_SIZE)
bcopy
bcopy
header->icookie
header
header
icookie
tempst.icookie
tempst
tempst
icookie
COOKIE_SIZE
COOKIE_SIZE
strncpy(tempst.address, address, 15);
strncpy(tempst.address, address, 15)
strncpy
strncpy
tempst.address
tempst
tempst
address
address
address
15
tempst.port = global_port;
tempst.port = global_port
tempst.port
tempst
tempst
port
global_port
global_port
tempst.counter = header->counter;
tempst.counter = header->counter
tempst.counter
tempst
tempst
counter
header->counter
header
header
counter
cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize);
cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize)
cookie_generate
cookie_generate
&tempst
tempst
tempst
rcookie
rcookie
COOKIE_SIZE
COOKIE_SIZE
schemes
schemes
ssize
ssize
if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)) {		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }
bcmp(rcookie, header->rcookie, COOKIE_SIZE)
bcmp
bcmp
rcookie
rcookie
header->rcookie
header
header
rcookie
COOKIE_SIZE
COOKIE_SIZE
{		  packet_size = PACKET_BUFFER_SIZE;		  photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);		  send_packet();		  return (0);	     }
packet_size = PACKET_BUFFER_SIZE;
packet_size = PACKET_BUFFER_SIZE
packet_size
packet_size
PACKET_BUFFER_SIZE
PACKET_BUFFER_SIZE
photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE);
photuris_error_message(&tempst, packet_buffer, &packet_size,					 header->icookie, header->rcookie,					 header->counter, BAD_COOKIE)
photuris_error_message
photuris_error_message
&tempst
tempst
tempst
packet_buffer
packet_buffer
&packet_size
packet_size
packet_size
header->icookie
header
header
icookie
header->rcookie
header
header
rcookie
header->counter
header
header
counter
BAD_COOKIE
BAD_COOKIE
send_packet();
send_packet()
send_packet
send_packet
return (0);
(0)
0
vsize = parts[0].size;
vsize = parts[0].size
vsize
vsize
parts[0].size
parts[0]
parts
parts
0
size
sstart = 0;
sstart = 0
sstart
sstart
0
modflag = 0;
modflag = 0
modflag
modflag
0
refp = modp = NULL;
refp = modp = NULL
refp
refp
modp = NULL
modp
modp
NULL
NULL
*(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme));
*(u_int16_t *)scheme_ref = htons(scheme_get_ref(header->scheme))
*(u_int16_t *)scheme_ref
(u_int16_t *)scheme_ref
u_int16_t *
u_int16_t
u_int16_t
*
*
scheme_ref
scheme_ref
htons(scheme_get_ref(header->scheme))
htons
htons
scheme_get_ref(header->scheme)
scheme_get_ref
scheme_get_ref
header->scheme
header
header
scheme
while (sstart < ssize) {		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }
sstart < ssize
sstart
sstart
ssize
ssize
{		  p = scheme_get_mod(schemes + sstart);		  modsize = varpre2octets(p);		  if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }		  		  sstart += scheme_get_len(schemes+sstart);	     }
p = scheme_get_mod(schemes + sstart);
p = scheme_get_mod(schemes + sstart)
p
p
scheme_get_mod(schemes + sstart)
scheme_get_mod
scheme_get_mod
schemes + sstart
schemes
schemes
sstart
sstart
modsize = varpre2octets(p);
modsize = varpre2octets(p)
modsize
modsize
varpre2octets(p)
varpre2octets
varpre2octets
p
p
if (!bcmp(header->scheme, schemes + sstart, 2)) {		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  } else if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }
!bcmp(header->scheme, schemes + sstart, 2)
bcmp(header->scheme, schemes + sstart, 2)
bcmp
bcmp
header->scheme
header
header
scheme
schemes + sstart
schemes
schemes
sstart
sstart
2
{		       modflag = 1;		       if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }		  }
modflag = 1;
modflag = 1
modflag
modflag
1
if (modsize == vsize) {			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       } else if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }
modsize == vsize
modsize
modsize
vsize
vsize
{			    genp = scheme_get_gen(schemes+sstart);			    modp = p;			    modpsize = modsize;			    break;  /* On right scheme + right size */		       }
genp = scheme_get_gen(schemes+sstart);
genp = scheme_get_gen(schemes+sstart)
genp
genp
scheme_get_gen(schemes+sstart)
scheme_get_gen
scheme_get_gen
schemes+sstart
schemes
schemes
sstart
sstart
modp = p;
modp = p
modp
modp
p
p
modpsize = modsize;
modpsize = modsize
modpsize
modpsize
modsize
modsize
break;
if (modsize <= 2 && refp != NULL) {			    modp = refp;			    modpsize = refpsize;			    break;		       }
modsize <= 2 && refp != NULL
modsize <= 2
modsize
modsize
2
refp != NULL
refp
refp
NULL
NULL
{			    modp = refp;			    modpsize = refpsize;			    break;		       }
modp = refp;
modp = refp
modp
modp
refp
refp
modpsize = refpsize;
modpsize = refpsize
modpsize
modpsize
refpsize
refpsize
break;
if (!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize) {		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }
!bcmp(scheme_ref, schemes + sstart, 2) &&			     modsize == vsize
!bcmp(scheme_ref, schemes + sstart, 2)
bcmp(scheme_ref, schemes + sstart, 2)
bcmp
bcmp
scheme_ref
scheme_ref
schemes + sstart
schemes
schemes
sstart
sstart
2
modsize == vsize
modsize
modsize
vsize
vsize
{		       genp = scheme_get_gen(schemes + sstart);		       if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }		       refp = p;		       refpsize = modsize;		  }
genp = scheme_get_gen(schemes + sstart);
genp = scheme_get_gen(schemes + sstart)
genp
genp
scheme_get_gen(schemes + sstart)
scheme_get_gen
scheme_get_gen
schemes + sstart
schemes
schemes
sstart
sstart
if (modflag) {			    modp = p;			    modpsize = modsize;			    break;		       }
modflag
modflag
{			    modp = p;			    modpsize = modsize;			    break;		       }
modp = p;
modp = p
modp
modp
p
p
modpsize = modsize;
modpsize = modsize
modpsize
modpsize
modsize
modsize
break;
refp = p;
refp = p
refp
refp
p
p
refpsize = modsize;
refpsize = modsize
refpsize
refpsize
modsize
modsize
sstart += scheme_get_len(schemes+sstart);
sstart += scheme_get_len(schemes+sstart)
sstart
sstart
scheme_get_len(schemes+sstart)
scheme_get_len
scheme_get_len
schemes+sstart
schemes
schemes
sstart
sstart
if (sstart >= ssize)		  return (-1);
sstart >= ssize
sstart
sstart
ssize
ssize
return (-1);
(-1)
-1
1
test = BN_new();
test = BN_new()
test
test
BN_new()
BN_new
BN_new
if (BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL) {		     BN_free(test);		     return (-1);	     }
BN_varpre2bn(parts[0].where, parts[0].size, test) == NULL
BN_varpre2bn(parts[0].where, parts[0].size, test)
BN_varpre2bn
BN_varpre2bn
parts[0].where
parts[0]
parts
parts
0
where
parts[0].size
parts[0]
parts
parts
0
size
test
test
NULL
NULL
{		     BN_free(test);		     return (-1);	     }
BN_free(test);
BN_free(test)
BN_free
BN_free
test
test
return (-1);
(-1)
-1
1
mod = BN_new();
mod = BN_new()
mod
mod
BN_new()
BN_new
BN_new
if (BN_varpre2bn(modp, modpsize, mod) == NULL) {		     BN_free(test);		     BN_free(mod);		     return (-1);	     }
BN_varpre2bn(modp, modpsize, mod) == NULL
BN_varpre2bn(modp, modpsize, mod)
BN_varpre2bn
BN_varpre2bn
modp
modp
modpsize
modpsize
mod
mod
NULL
NULL
{		     BN_free(test);		     BN_free(mod);		     return (-1);	     }
BN_free(test);
BN_free(test)
BN_free
BN_free
test
test
BN_free(mod);
BN_free(mod)
BN_free
BN_free
mod
mod
return (-1);
(-1)
-1
1
gen = BN_new();
gen = BN_new()
gen
gen
BN_new()
BN_new
BN_new
if (exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)) {		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }
exchange_set_generator(gen, header->scheme, genp) == -1 ||		 !exchange_check_value(test, gen, mod)
exchange_set_generator(gen, header->scheme, genp) == -1
exchange_set_generator(gen, header->scheme, genp)
exchange_set_generator
exchange_set_generator
gen
gen
header->scheme
header
header
scheme
genp
genp
-1
1
!exchange_check_value(test, gen, mod)
exchange_check_value(test, gen, mod)
exchange_check_value
exchange_check_value
test
test
gen
gen
mod
mod
{		  BN_free(test);		  BN_free(gen);		  BN_free(mod);		  return 0;	     }
BN_free(test);
BN_free(test)
BN_free
BN_free
test
test
BN_free(gen);
BN_free(gen)
BN_free
BN_free
gen
gen
BN_free(mod);
BN_free(mod)
BN_free
BN_free
mod
mod
return 0;
0
BN_free(test);
BN_free(test)
BN_free
BN_free
test
test
BN_free(gen);
BN_free(gen)
BN_free
BN_free
gen
gen
BN_free(mod);
BN_free(mod)
BN_free
BN_free
mod
mod
if ((st = state_new()) == NULL)		     goto resourcefail;
(st = state_new()) == NULL
(st = state_new())
st = state_new()
st
st
state_new()
state_new
state_new
NULL
NULL
goto resourcefail;
resourcefail
st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH;
st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH
st->flags
st
st
flags
IPSEC_OPT_ENC|IPSEC_OPT_AUTH
IPSEC_OPT_ENC
IPSEC_OPT_ENC
IPSEC_OPT_AUTH
IPSEC_OPT_AUTH
st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t));
st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t))
st->uSPIoattrib
st
st
uSPIoattrib
calloc(parts[1].size, sizeof(u_int8_t))
calloc
calloc
parts[1].size
parts[1]
parts
parts
1
size
sizeof(u_int8_t)
u_int8_t
u_int8_t
u_int8_t

if (st->uSPIoattrib == NULL) {                  state_value_reset(st);		  goto resourcefail;	     }
st->uSPIoattrib == NULL
st->uSPIoattrib
st
st
uSPIoattrib
NULL
NULL
{                  state_value_reset(st);		  goto resourcefail;	     }
state_value_reset(st);
state_value_reset(st)
state_value_reset
state_value_reset
st
st
goto resourcefail;
resourcefail
bcopy(parts[1].where, st->uSPIoattrib, parts[1].size);
bcopy(parts[1].where, st->uSPIoattrib, parts[1].size)
bcopy
bcopy
parts[1].where
parts[1]
parts
parts
1
where
st->uSPIoattrib
st
st
uSPIoattrib
parts[1].size
parts[1]
parts
parts
1
size
st->uSPIoattribsize = parts[1].size;
st->uSPIoattribsize = parts[1].size
st->uSPIoattribsize
st
st
uSPIoattribsize
parts[1].size
parts[1]
parts
parts
1
size
vsize = 2 + varpre2octets(modp);
vsize = 2 + varpre2octets(modp)
vsize
vsize
2 + varpre2octets(modp)
2
varpre2octets(modp)
varpre2octets
varpre2octets
modp
modp
if (genp != NULL)		  vsize += 2 + varpre2octets(genp);
genp != NULL
genp
genp
NULL
NULL
vsize += 2 + varpre2octets(genp);
vsize += 2 + varpre2octets(genp)
vsize
vsize
2 + varpre2octets(genp)
2
varpre2octets(genp)
varpre2octets
varpre2octets
genp
genp
st->scheme = calloc(vsize, sizeof(u_int8_t));
st->scheme = calloc(vsize, sizeof(u_int8_t))
st->scheme
st
st
scheme
calloc(vsize, sizeof(u_int8_t))
calloc
calloc
vsize
vsize
sizeof(u_int8_t)
u_int8_t
u_int8_t
u_int8_t

if (st->scheme == NULL) {                  state_value_reset(st);                   goto resourcefail;              }
st->scheme == NULL
st->scheme
st
st
scheme
NULL
NULL
{                  state_value_reset(st);                   goto resourcefail;              }
state_value_reset(st);
state_value_reset(st)
state_value_reset
state_value_reset
st
st
goto resourcefail;
resourcefail
bcopy(header->scheme, st->scheme, 2);
bcopy(header->scheme, st->scheme, 2)
bcopy
bcopy
header->scheme
header
header
scheme
st->scheme
st
st
scheme
2
if (genp != NULL) {		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }
genp != NULL
genp
genp
NULL
NULL
{		  st->scheme[2] = (vsize-4) >> 8;		  st->scheme[3] = (vsize-4) & 0xFF;		  bcopy(genp, st->scheme+2+2, varpre2octets(genp));	     }
st->scheme[2] = (vsize-4) >> 8;
st->scheme[2] = (vsize-4) >> 8
st->scheme[2]
st->scheme
st
st
scheme
2
(vsize-4) >> 8
(vsize-4)
vsize-4
vsize
vsize
4
8
st->scheme[3] = (vsize-4) & 0xFF;
st->scheme[3] = (vsize-4) & 0xFF
st->scheme[3]
st->scheme
st
st
scheme
3
(vsize-4) & 0xFF
(vsize-4)
vsize-4
vsize
vsize
4
0xFF
bcopy(genp, st->scheme+2+2, varpre2octets(genp));
bcopy(genp, st->scheme+2+2, varpre2octets(genp))
bcopy
bcopy
genp
genp
st->scheme+2+2
st->scheme+2
st->scheme
st
st
scheme
2
2
varpre2octets(genp)
varpre2octets
varpre2octets
genp
genp
bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp));
bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)),		   varpre2octets(modp))
bcopy
bcopy
modp
modp
st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp))
st->scheme + 2
st->scheme
st
st
scheme
2
(genp == NULL ? 0 : 2 + varpre2octets(genp))
genp == NULL ? 0 : 2 + varpre2octets(genp)
genp == NULL
genp
genp
NULL
NULL
0
2 + varpre2octets(genp)
2
varpre2octets(genp)
varpre2octets
varpre2octets
genp
genp
varpre2octets(modp)
varpre2octets
varpre2octets
modp
modp
;
st->schemesize = vsize;
st->schemesize = vsize
st->schemesize
st
st
schemesize
vsize
vsize
st->texchangesize = parts[0].size;
st->texchangesize = parts[0].size
st->texchangesize
st
st
texchangesize
parts[0].size
parts[0]
parts
parts
0
size
st->texchange = calloc(st->texchangesize, sizeof(u_int8_t));
st->texchange = calloc(st->texchangesize, sizeof(u_int8_t))
st->texchange
st
st
texchange
calloc(st->texchangesize, sizeof(u_int8_t))
calloc
calloc
st->texchangesize
st
st
texchangesize
sizeof(u_int8_t)
u_int8_t
u_int8_t
u_int8_t

if (st->texchange == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }
st->texchange == NULL
st->texchange
st
st
texchange
NULL
NULL
{		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }
log_error("calloc() in handle_value_request()");
log_error("calloc() in handle_value_request()")
log_error
log_error
"calloc() in handle_value_request()"
state_value_reset(st);
state_value_reset(st)
state_value_reset
state_value_reset
st
st
goto resourcefail;
resourcefail
bcopy(parts[0].where, st->texchange, st->texchangesize);
bcopy(parts[0].where, st->texchange, st->texchangesize)
bcopy
bcopy
parts[0].where
parts[0]
parts
parts
0
where
st->texchange
st
st
texchange
st->texchangesize
st
st
texchangesize
strncpy(st->address, address, 15);
strncpy(st->address, address, 15)
strncpy
strncpy
st->address
st
st
address
address
address
15
st->port = port;
st->port = port
st->port
st
st
port
port
port
st->counter = header->counter;
st->counter = header->counter
st->counter
st
st
counter
header->counter
header
header
counter
bcopy(header->icookie, st->icookie, COOKIE_SIZE);
bcopy(header->icookie, st->icookie, COOKIE_SIZE)
bcopy
bcopy
header->icookie
header
header
icookie
st->icookie
st
st
icookie
COOKIE_SIZE
COOKIE_SIZE
bcopy(header->rcookie, st->rcookie, COOKIE_SIZE);
bcopy(header->rcookie, st->rcookie, COOKIE_SIZE)
bcopy
bcopy
header->rcookie
header
header
rcookie
st->rcookie
st
st
rcookie
COOKIE_SIZE
COOKIE_SIZE
bcopy(&header->counter, st->uSPITBV, 3);
bcopy(&header->counter, st->uSPITBV, 3)
bcopy
bcopy
&header->counter
header->counter
header
header
counter
st->uSPITBV
st
st
uSPITBV
3
if ((st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL) {		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }
(st->roschemes = calloc(ssize, sizeof(u_int8_t))) == NULL
(st->roschemes = calloc(ssize, sizeof(u_int8_t)))
st->roschemes = calloc(ssize, sizeof(u_int8_t))
st->roschemes
st
st
roschemes
calloc(ssize, sizeof(u_int8_t))
calloc
calloc
ssize
ssize
sizeof(u_int8_t)
u_int8_t
u_int8_t
u_int8_t

NULL
NULL
{		  log_error("calloc() in handle_value_request()");		  state_value_reset(st);		  goto resourcefail;	     }
log_error("calloc() in handle_value_request()");
log_error("calloc() in handle_value_request()")
log_error
log_error
"calloc() in handle_value_request()"
state_value_reset(st);
state_value_reset(st)
state_value_reset
state_value_reset
st
st
goto resourcefail;
resourcefail
bcopy(schemes, st->roschemes, ssize);
bcopy(schemes, st->roschemes, ssize)
bcopy
bcopy
schemes
schemes
st->roschemes
st
st
roschemes
ssize
ssize
st->roschemesize = ssize;
st->roschemesize = ssize
st->roschemesize
st
st
roschemesize
ssize
ssize
if (pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1) {		  state_value_reset(st);		  goto resourcefail;	     }
pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize)) == -1
pick_attrib(st, &(st->oSPIoattrib), 			     &(st->oSPIoattribsize))
pick_attrib
pick_attrib
st
st
&(st->oSPIoattrib)
(st->oSPIoattrib)
st->oSPIoattrib
st
st
oSPIoattrib
&(st->oSPIoattribsize)
(st->oSPIoattribsize)
st->oSPIoattribsize
st
st
oSPIoattribsize
-1
1
{		  state_value_reset(st);		  goto resourcefail;	     }
state_value_reset(st);
state_value_reset(st)
state_value_reset
state_value_reset
st
st
goto resourcefail;
resourcefail
st->lifetime = exchange_timeout + time(NULL);
st->lifetime = exchange_timeout + time(NULL)
st->lifetime
st
st
lifetime
exchange_timeout + time(NULL)
exchange_timeout
exchange_timeout
time(NULL)
time
time
NULL
NULL
state_insert(st);
state_insert(st)
state_insert
state_insert
st
st
if (st->phase != VALUE_RESPONSE) {		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));		return (-1);	}
st->phase != VALUE_RESPONSE
st->phase
st
st
phase
VALUE_RESPONSE
VALUE_RESPONSE
{		LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));		return (-1);	}
LOG_DBG((LOG_PROTOCOL, 55, __FUNCTION__			 ": value request from %s, but we are in state %d",			 st->address, st->phase));
return (-1);
(-1)
-1
1
packet_size = PACKET_BUFFER_SIZE;
packet_size = PACKET_BUFFER_SIZE
packet_size
packet_size
PACKET_BUFFER_SIZE
PACKET_BUFFER_SIZE
if (photuris_value_response(st, packet_buffer, &packet_size) == -1)	     return (-1);
photuris_value_response(st, packet_buffer, &packet_size) == -1
photuris_value_response(st, packet_buffer, &packet_size)
photuris_value_response
photuris_value_response
st
st
packet_buffer
packet_buffer
&packet_size
packet_size
packet_size
-1
1
return (-1);
(-1)
-1
1
send_packet();
send_packet()
send_packet
send_packet
compute_shared_secret(st, &(st->shared), &(st->sharedsize));
compute_shared_secret(st, &(st->shared), &(st->sharedsize))
compute_shared_secret
compute_shared_secret
st
st
&(st->shared)
(st->shared)
st->shared
st
st
shared
&(st->sharedsize)
(st->sharedsize)
st->sharedsize
st
st
sharedsize
if (st->oSPIprivacyctx == NULL) {	     /* Initialize Privacy Keys from Exchange Values */	     init_privacy_key(st, 0);   /* User -> Owner direction */	     init_privacy_key(st, 1);   /* Owner -> User direction */	}
st->oSPIprivacyctx == NULL
st->oSPIprivacyctx
st
st
oSPIprivacyctx
NULL
NULL
{	     /* Initialize Privacy Keys from Exchange Values */	     init_privacy_key(st, 0);   /* User -> Owner direction */	     init_privacy_key(st, 1);   /* Owner -> User direction */	}
init_privacy_key(st, 0);
init_privacy_key(st, 0)
init_privacy_key
init_privacy_key
st
st
0
init_privacy_key(st, 1);
init_privacy_key(st, 1)
init_privacy_key
init_privacy_key
st
st
1
st->retries = 0;
st->retries = 0
st->retries
st
st
retries
0
st->phase = VALUE_RESPONSE;
st->phase = VALUE_RESPONSE
st->phase
st
st
phase
VALUE_RESPONSE
VALUE_RESPONSE
return (0);
(0)
0
resourcefail:	packet_size = PACKET_BUFFER_SIZE;
resourcefail
packet_size = PACKET_BUFFER_SIZE;
packet_size = PACKET_BUFFER_SIZE
packet_size
packet_size
PACKET_BUFFER_SIZE
PACKET_BUFFER_SIZE
photuris_error_message(st, packet_buffer, &packet_size,			       header->icookie, header->rcookie,			       header->counter, RESOURCE_LIMIT);
photuris_error_message(st, packet_buffer, &packet_size,			       header->icookie, header->rcookie,			       header->counter, RESOURCE_LIMIT)
photuris_error_message
photuris_error_message
st
st
packet_buffer
packet_buffer
&packet_size
packet_size
packet_size
header->icookie
header
header
icookie
header->rcookie
header
header
rcookie
header->counter
header
header
counter
RESOURCE_LIMIT
RESOURCE_LIMIT
send_packet();
send_packet()
send_packet
send_packet
return (0);
(0)
0
-----joern-----
(487,153,0)
(634,143,0)
(635,310,0)
(222,400,0)
(406,559,0)
(55,672,0)
(618,634,0)
(695,118,0)
(98,705,0)
(183,619,0)
(376,439,0)
(60,445,0)
(655,148,0)
(744,454,0)
(760,366,0)
(482,585,0)
(331,600,0)
(410,439,0)
(454,166,0)
(100,134,0)
(235,101,0)
(652,642,0)
(205,781,0)
(415,439,0)
(702,118,0)
(784,400,0)
(651,400,0)
(281,378,0)
(42,89,0)
(193,706,0)
(136,261,0)
(297,451,0)
(610,702,0)
(100,242,0)
(519,560,0)
(493,552,0)
(378,400,0)
(46,470,0)
(741,471,0)
(273,454,0)
(429,525,0)
(198,182,0)
(279,764,0)
(503,114,0)
(5,533,0)
(394,704,0)
(326,34,0)
(80,400,0)
(758,529,0)
(388,431,0)
(279,9,0)
(117,198,0)
(553,768,0)
(230,118,0)
(757,109,0)
(88,759,0)
(116,307,0)
(570,198,0)
(158,187,0)
(572,607,0)
(339,527,0)
(412,491,0)
(514,439,0)
(187,439,0)
(626,118,0)
(733,9,0)
(532,766,0)
(491,412,0)
(91,387,0)
(259,295,0)
(45,55,0)
(739,702,0)
(403,375,0)
(269,766,0)
(691,696,0)
(262,263,0)
(431,388,0)
(583,642,0)
(68,498,0)
(492,352,0)
(256,366,0)
(769,583,0)
(264,432,0)
(297,96,0)
(371,252,0)
(649,303,0)
(671,759,0)
(197,446,0)
(31,1,0)
(367,737,0)
(524,400,0)
(582,106,0)
(506,560,0)
(317,279,0)
(303,541,0)
(128,263,0)
(738,630,0)
(666,54,0)
(397,673,0)
(78,630,0)
(568,482,0)
(115,50,0)
(462,118,0)
(620,577,0)
(175,370,0)
(2,530,0)
(634,568,0)
(736,78,0)
(549,130,0)
(117,118,0)
(145,230,0)
(274,579,0)
(356,153,0)
(737,110,0)
(583,118,0)
(735,391,0)
(537,437,0)
(392,243,0)
(238,118,0)
(3,249,0)
(169,204,0)
(717,451,0)
(350,471,0)
(172,422,0)
(456,230,0)
(145,174,0)
(774,50,0)
(145,192,0)
(735,366,0)
(143,577,0)
(446,516,0)
(26,55,0)
(735,696,0)
(123,375,0)
(579,274,0)
(478,606,0)
(710,158,0)
(145,570,0)
(662,170,0)
(44,639,0)
(324,9,0)
(108,137,0)
(747,54,0)
(321,118,0)
(422,400,0)
(386,537,0)
(174,706,0)
(532,118,0)
(726,536,0)
(175,626,0)
(388,660,0)
(451,759,0)
(704,366,0)
(778,22,0)
(671,118,0)
(581,400,0)
(175,99,0)
(756,98,0)
(114,383,0)
(107,139,0)
(248,339,0)
(171,650,0)
(694,399,0)
(593,99,0)
(424,630,0)
(780,1,0)
(641,471,0)
(99,201,0)
(705,98,0)
(774,596,0)
(488,274,0)
(415,603,0)
(179,581,0)
(419,382,0)
(1,31,0)
(113,695,0)
(522,527,0)
(768,201,0)
(242,100,0)
(560,439,0)
(605,541,0)
(502,741,0)
(345,738,0)
(250,441,0)
(653,400,0)
(779,143,0)
(474,601,0)
(409,387,0)
(451,297,0)
(68,77,0)
(454,320,0)
(55,55,0)
(84,238,0)
(31,400,0)
(132,287,0)
(153,356,0)
(165,261,0)
(114,624,0)
(130,118,0)
(91,18,0)
(627,544,0)
(708,696,0)
(741,261,0)
(436,585,0)
(487,340,0)
(732,242,0)
(104,174,0)
(290,678,0)
(118,364,0)
(170,406,0)
(100,371,0)
(543,170,0)
(627,611,0)
(731,287,0)
(481,306,0)
(423,400,0)
(482,568,0)
(120,366,0)
(650,509,0)
(781,400,0)
(589,17,0)
(490,399,0)
(642,652,0)
(529,704,0)
(137,471,0)
(694,776,0)
(91,315,0)
(556,429,0)
(146,34,0)
(350,391,0)
(682,111,0)
(767,343,0)
(438,500,0)
(735,512,0)
(639,44,0)
(233,781,0)
(236,195,0)
(145,17,0)
(389,642,0)
(315,439,0)
(693,480,0)
(145,703,0)
(154,150,0)
(175,391,0)
(41,712,0)
(468,42,0)
(703,759,0)
(650,642,0)
(312,366,0)
(9,324,0)
(768,541,0)
(182,787,0)
(585,637,0)
(419,75,0)
(624,351,0)
(446,400,0)
(332,462,0)
(359,68,0)
(542,314,0)
(355,370,0)
(244,677,0)
(126,743,0)
(616,337,0)
(389,118,0)
(432,383,0)
(392,751,0)
(231,187,0)
(499,702,0)
(527,156,0)
(516,73,0)
(494,478,0)
(624,400,0)
(715,640,0)
(82,412,0)
(96,759,0)
(597,201,0)
(707,118,0)
(491,678,0)
(486,31,0)
(603,415,0)
(752,308,0)
(223,405,0)
(221,522,0)
(521,223,0)
(166,118,0)
(282,118,0)
(249,484,0)
(558,287,0)
(676,212,0)
(663,236,0)
(195,243,0)
(9,372,0)
(308,175,0)
(44,0,0)
(305,86,0)
(459,197,0)
(108,65,0)
(162,91,0)
(528,446,0)
(462,328,0)
(163,55,0)
(316,451,0)
(700,600,0)
(659,400,0)
(505,400,0)
(495,774,0)
(223,759,0)
(782,610,0)
(675,759,0)
(24,1,0)
(482,704,0)
(631,366,0)
(558,400,0)
(399,781,0)
(611,672,0)
(530,45,0)
(611,627,0)
(301,672,0)
(679,606,0)
(233,536,0)
(464,288,0)
(108,136,0)
(261,0,0)
(453,694,0)
(630,338,0)
(18,91,0)
(139,439,0)
(147,31,0)
(485,729,0)
(533,191,0)
(153,487,0)
(524,184,0)
(447,548,0)
(78,581,0)
(283,103,0)
(145,682,0)
(145,612,0)
(175,570,0)
(422,410,0)
(496,189,0)
(52,400,0)
(430,704,0)
(406,764,0)
(608,733,0)
(482,406,0)
(530,101,0)
(313,105,0)
(777,652,0)
(445,446,0)
(111,474,0)
(175,174,0)
(562,448,0)
(677,501,0)
(216,611,0)
(550,9,0)
(604,303,0)
(500,352,0)
(295,366,0)
(96,118,0)
(172,118,0)
(176,707,0)
(750,423,0)
(118,681,0)
(159,366,0)
(785,681,0)
(50,774,0)
(590,366,0)
(327,366,0)
(673,588,0)
(303,400,0)
(22,778,0)
(263,307,0)
(701,581,0)
(696,118,0)
(137,112,0)
(194,320,0)
(461,306,0)
(130,22,0)
(175,261,0)
(202,469,0)
(401,439,0)
(498,637,0)
(448,624,0)
(74,400,0)
(385,321,0)
(273,194,0)
(68,313,0)
(544,627,0)
(58,110,0)
(66,77,0)
(79,603,0)
(455,605,0)
(158,759,0)
(137,391,0)
(788,106,0)
(536,726,0)
(430,529,0)
(353,294,0)
(349,337,0)
(322,366,0)
(138,388,0)
(735,174,0)
(533,118,0)
(296,88,0)
(291,9,0)
(6,671,0)
(560,91,0)
(721,439,0)
(190,103,0)
(187,158,0)
(37,695,0)
(451,717,0)
(628,98,0)
(673,397,0)
(239,400,0)
(175,212,0)
(179,383,0)
(577,143,0)
(674,89,0)
(681,118,0)
(600,55,0)
(563,321,0)
(555,498,0)
(694,498,0)
(192,118,0)
(210,776,0)
(94,704,0)
(721,408,0)
(94,552,0)
(529,509,0)
(223,118,0)
(12,235,0)
(539,747,0)
(625,650,0)
(747,118,0)
(516,446,0)
(192,197,0)
(63,88,0)
(685,471,0)
(411,94,0)
(414,386,0)
(483,401,0)
(96,297,0)
(610,541,0)
(145,370,0)
(607,328,0)
(220,753,0)
(602,118,0)
(138,375,0)
(127,550,0)
(87,179,0)
(203,601,0)
(551,768,0)
(91,401,0)
(338,630,0)
(191,533,0)
(633,164,0)
(370,118,0)
(469,118,0)
(396,685,0)
(450,443,0)
(399,522,0)
(191,240,0)
(688,172,0)
(65,150,0)
(735,99,0)
(480,400,0)
(288,464,0)
(145,471,0)
(695,198,0)
(620,642,0)
(619,158,0)
(300,675,0)
(57,586,0)
(626,472,0)
(219,253,0)
(189,439,0)
(138,704,0)
(42,647,0)
(165,237,0)
(375,138,0)
(443,510,0)
(83,78,0)
(573,366,0)
(601,474,0)
(740,493,0)
(354,70,0)
(475,366,0)
(155,366,0)
(454,671,0)
(226,404,0)
(635,774,0)
(170,585,0)
(776,399,0)
(39,99,0)
(730,430,0)
(157,163,0)
(78,624,0)
(326,26,0)
(498,527,0)
(108,685,0)
(318,79,0)
(26,672,0)
(243,400,0)
(175,471,0)
(175,583,0)
(696,369,0)
(76,400,0)
(603,79,0)
(133,288,0)
(17,751,0)
(19,398,0)
(712,509,0)
(386,118,0)
(517,437,0)
(647,42,0)
(658,366,0)
(145,391,0)
(163,672,0)
(166,759,0)
(357,233,0)
(324,527,0)
(547,91,0)
(433,552,0)
(778,225,0)
(274,142,0)
(399,105,0)
(745,452,0)
(182,198,0)
(379,532,0)
(319,145,0)
(342,60,0)
(92,703,0)
(145,212,0)
(224,139,0)
(441,118,0)
(225,778,0)
(508,405,0)
(91,606,0)
(33,389,0)
(610,400,0)
(685,212,0)
(339,699,0)
(40,313,0)
(163,101,0)
(664,400,0)
(56,652,0)
(532,323,0)
(103,406,0)
(565,410,0)
(652,56,0)
(418,415,0)
(78,83,0)
(652,493,0)
(697,682,0)
(180,514,0)
(559,406,0)
(776,694,0)
(68,624,0)
(314,704,0)
(48,726,0)
(337,349,0)
(93,789,0)
(320,366,0)
(42,468,0)
(167,620,0)
(787,182,0)
(237,165,0)
(145,583,0)
(591,626,0)
(350,212,0)
(290,60,0)
(776,205,0)
(47,764,0)
(188,400,0)
(280,404,0)
(529,406,0)
(639,753,0)
(301,55,0)
(175,612,0)
(0,400,0)
(344,295,0)
(230,224,0)
(108,350,0)
(335,112,0)
(410,422,0)
(23,771,0)
(73,498,0)
(108,735,0)
(650,118,0)
(175,696,0)
(600,672,0)
(458,570,0)
(768,551,0)
(68,86,0)
(266,303,0)
(175,17,0)
(375,439,0)
(528,412,0)
(647,743,0)
(464,510,0)
(299,366,0)
(106,382,0)
(670,282,0)
(761,298,0)
(285,699,0)
(286,787,0)
(509,650,0)
(449,533,0)
(254,733,0)
(108,175,0)
(717,441,0)
(652,446,0)
(89,400,0)
(528,493,0)
(94,585,0)
(545,391,0)
(119,581,0)
(580,262,0)
(50,473,0)
(69,129,0)
(648,705,0)
(17,118,0)
(51,781,0)
(484,249,0)
(644,10,0)
(623,194,0)
(512,118,0)
(530,55,0)
(686,366,0)
(185,225,0)
(73,516,0)
(471,378,0)
(434,603,0)
(638,703,0)
(442,397,0)
(138,581,0)
(326,102,0)
(374,579,0)
(177,672,0)
(235,156,0)
(0,44,0)
(605,672,0)
(323,532,0)
(735,17,0)
(694,205,0)
(293,469,0)
(145,223,0)
(474,111,0)
(360,366,0)
(738,489,0)
(95,235,0)
(520,570,0)
(170,704,0)
(534,133,0)
(34,439,0)
(28,240,0)
(388,138,0)
(228,320,0)
(274,400,0)
(315,91,0)
(607,118,0)
(102,326,0)
(552,493,0)
(275,551,0)
(314,406,0)
(515,230,0)
(59,22,0)
(85,192,0)
(723,512,0)
(683,343,0)
(581,119,0)
(605,55,0)
(592,382,0)
(261,165,0)
(689,366,0)
(108,145,0)
(243,392,0)
(398,439,0)
(73,205,0)
(714,52,0)
(201,597,0)
(277,626,0)
(136,471,0)
(141,660,0)
(512,524,0)
(116,9,0)
(148,640,0)
(692,522,0)
(770,612,0)
(753,439,0)
(588,673,0)
(241,482,0)
(451,118,0)
(196,253,0)
(137,212,0)
(387,91,0)
(109,707,0)
(212,52,0)
(404,472,0)
(413,356,0)
(479,165,0)
(685,391,0)
(771,366,0)
(143,634,0)
(381,138,0)
(665,789,0)
(80,581,0)
(773,389,0)
(448,400,0)
(611,101,0)
(21,78,0)
(646,627,0)
(579,118,0)
(607,759,0)
(133,118,0)
(786,79,0)
(640,232,0)
(661,249,0)
(35,80,0)
(766,439,0)
(163,755,0)
(743,647,0)
(83,431,0)
(181,474,0)
(8,583,0)
(600,101,0)
(614,604,0)
(201,768,0)
(468,674,0)
(380,771,0)
(199,350,0)
(108,164,0)
(781,205,0)
(729,118,0)
(632,153,0)
(467,252,0)
(497,774,0)
(238,110,0)
(340,487,0)
(437,537,0)
(235,672,0)
(765,366,0)
(762,130,0)
(702,610,0)
(156,235,0)
(369,761,0)
(783,584,0)
(268,400,0)
(243,789,0)
(452,320,0)
(759,366,0)
(742,116,0)
(441,717,0)
(335,630,0)
(610,101,0)
(776,498,0)
(526,274,0)
(191,695,0)
(306,240,0)
(425,528,0)
(140,647,0)
(229,366,0)
(584,118,0)
(557,225,0)
(99,118,0)
(362,133,0)
(754,620,0)
(558,470,0)
(617,761,0)
(303,101,0)
(734,86,0)
(630,400,0)
(278,445,0)
(145,261,0)
(384,550,0)
(451,366,0)
(14,624,0)
(168,17,0)
(55,372,0)
(705,439,0)
(741,212,0)
(156,527,0)
(724,437,0)
(412,528,0)
(420,386,0)
(480,630,0)
(349,118,0)
(564,673,0)
(554,89,0)
(439,721,0)
(469,182,0)
(612,321,0)
(533,369,0)
(149,759,0)
(640,354,0)
(550,62,0)
(361,389,0)
(751,400,0)
(298,761,0)
(531,656,0)
(510,443,0)
(707,109,0)
(145,366,0)
(225,439,0)
(634,170,0)
(343,400,0)
(73,399,0)
(303,604,0)
(7,303,0)
(538,578,0)
(392,118,0)
(457,753,0)
(145,99,0)
(346,78,0)
(260,93,0)
(675,698,0)
(145,626,0)
(423,541,0)
(121,34,0)
(613,773,0)
(174,290,0)
(267,310,0)
(600,559,0)
(62,544,0)
(55,45,0)
(568,634,0)
(22,130,0)
(175,729,0)
(687,324,0)
(289,619,0)
(728,537,0)
(304,339,0)
(214,138,0)
(249,118,0)
(138,406,0)
(94,406,0)
(61,307,0)
(735,612,0)
(292,270,0)
(671,454,0)
(510,464,0)
(302,498,0)
(31,142,0)
(428,154,0)
(599,366,0)
(271,372,0)
(751,419,0)
(619,439,0)
(726,9,0)
(341,633,0)
(444,579,0)
(529,430,0)
(97,117,0)
(232,465,0)
(68,733,0)
(42,19,0)
(594,637,0)
(158,142,0)
(518,464,0)
(153,759,0)
(103,585,0)
(191,400,0)
(211,610,0)
(430,406,0)
(330,721,0)
(735,729,0)
(476,445,0)
(213,315,0)
(504,674,0)
(166,454,0)
(421,377,0)
(64,166,0)
(682,118,0)
(287,118,0)
(73,339,0)
(144,558,0)
(656,624,0)
(246,303,0)
(351,624,0)
(323,439,0)
(270,137,0)
(636,273,0)
(668,129,0)
(706,642,0)
(718,233,0)
(136,391,0)
(139,224,0)
(775,514,0)
(218,512,0)
(680,366,0)
(537,386,0)
(719,735,0)
(735,583,0)
(437,439,0)
(393,726,0)
(772,212,0)
(578,366,0)
(667,163,0)
(709,675,0)
(151,194,0)
(263,262,0)
(621,340,0)
(364,118,0)
(197,400,0)
(702,201,0)
(620,118,0)
(136,212,0)
(11,172,0)
(224,400,0)
(333,65,0)
(672,400,0)
(257,244,0)
(440,465,0)
(371,400,0)
(186,232,0)
(145,578,0)
(426,313,0)
(514,239,0)
(509,529,0)
(595,465,0)
(587,366,0)
(465,232,0)
(255,301,0)
(422,172,0)
(325,26,0)
(735,192,0)
(22,400,0)
(454,273,0)
(789,243,0)
(523,568,0)
(131,205,0)
(34,326,0)
(217,223,0)
(29,392,0)
(569,415,0)
(258,42,0)
(470,558,0)
(138,585,0)
(473,366,0)
(62,550,0)
(685,261,0)
(566,698,0)
(175,192,0)
(763,298,0)
(20,26,0)
(464,118,0)
(108,741,0)
(307,400,0)
(15,532,0)
(735,771,0)
(276,279,0)
(522,764,0)
(735,212,0)
(30,611,0)
(170,634,0)
(598,422,0)
(321,642,0)
(389,773,0)
(251,166,0)
(435,704,0)
(761,369,0)
(615,68,0)
(790,366,0)
(720,682,0)
(91,560,0)
(207,56,0)
(334,429,0)
(175,512,0)
(198,400,0)
(470,439,0)
(111,400,0)
(27,323,0)
(301,541,0)
(588,400,0)
(527,372,0)
(748,766,0)
(493,446,0)
(386,642,0)
(175,230,0)
(282,586,0)
(358,96,0)
(460,192,0)
(466,743,0)
(654,686,0)
(398,19,0)
(197,493,0)
(694,339,0)
(4,446,0)
(200,401,0)
(540,189,0)
(77,68,0)
(603,400,0)
(19,42,0)
(43,398,0)
(26,326,0)
(161,578,0)
(152,105,0)
(532,377,0)
(530,672,0)
(391,239,0)
(288,133,0)
(695,191,0)
(206,153,0)
(145,729,0)
(431,83,0)
(189,532,0)
(265,93,0)
(178,70,0)
(81,335,0)
(577,620,0)
(336,410,0)
(67,468,0)
(284,397,0)
(741,489,0)
(427,195,0)
(464,484,0)
(567,298,0)
(122,607,0)
(204,53,0)
(419,751,0)
(370,588,0)
(774,635,0)
(733,637,0)
(134,100,0)
(160,326,0)
(347,205,0)
(373,349,0)
(243,195,0)
(32,187,0)
(776,339,0)
(585,755,0)
(725,400,0)
(759,158,0)
(432,630,0)
(71,366,0)
(735,261,0)
(622,528,0)
(60,290,0)
(609,399,0)
(669,18,0)
(706,118,0)
(727,400,0)
(713,75,0)
(350,606,0)
(195,236,0)
(463,349,0)
(240,306,0)
(694,577,0)
(329,323,0)
(26,101,0)
(10,117,0)
(477,400,0)
(208,400,0)
(660,388,0)
(311,471,0)
(532,366,0)
(402,441,0)
(645,729,0)
(550,307,0)
(416,705,0)
(472,400,0)
(574,236,0)
(685,383,0)
(735,471,0)
(25,627,0)
(309,707,0)
(711,674,0)
(232,640,0)
(371,100,0)
(234,314,0)
(310,635,0)
(247,524,0)
(774,408,0)
(576,721,0)
(137,261,0)
(532,189,0)
(529,585,0)
(125,366,0)
(577,694,0)
(382,419,0)
(612,491,0)
(70,354,0)
(707,751,0)
(90,53,0)
(484,464,0)
(405,366,0)
(441,759,0)
(239,514,0)
(509,712,0)
(314,585,0)
(690,315,0)
(430,585,0)
(753,639,0)
(766,532,0)
(135,597,0)
(548,136,0)
(124,55,0)
(390,671,0)
(735,230,0)
(643,462,0)
(640,148,0)
(348,392,0)
(252,371,0)
(684,70,0)
(382,106,0)
(253,89,0)
(16,391,0)
(559,600,0)
(363,301,0)
(552,94,0)
(108,677,0)
(401,91,0)
(445,60,0)
(746,406,0)
(584,400,0)
(729,423,0)
(175,682,0)
(703,686,0)
(377,532,0)
(544,62,0)
(561,530,0)
(68,399,0)
(86,699,0)
(175,578,0)
(182,469,0)
(204,118,0)
(511,116,0)
(741,391,0)
(611,55,0)
(472,404,0)
(703,118,0)
(469,369,0)
(535,354,0)
(735,570,0)
(68,339,0)
(349,759,0)
(209,605,0)
(706,174,0)
(313,279,0)
(407,532,0)
(49,370,0)
(789,93,0)
(158,619,0)
(722,366,0)
(716,502,0)
(75,419,0)
(173,295,0)
(755,163,0)
(72,333,0)
(439,366,0)
(629,68,0)
(227,516,0)
(640,630,0)
(233,522,0)
(507,73,0)
(721,330,0)
(445,493,0)
(36,470,0)
(240,191,0)
(86,9,0)
(395,527,0)
(307,263,0)
(354,640,0)
(462,759,0)
(365,96,0)
(287,558,0)
(657,366,0)
(13,139,0)
(153,118,0)
(694,400,0)
(294,53,0)
(529,678,0)
(570,118,0)
(321,612,0)
(513,478,0)
(145,696,0)
(272,473,0)
(103,704,0)
(735,370,0)
(117,10,0)
(755,585,0)
(235,55,0)
(45,530,0)
(536,233,0)
(350,478,0)
(369,400,0)
(735,626,0)
(575,117,0)
(546,262,0)
(571,672,0)
(145,512,0)
(129,596,0)
(749,452,0)
(38,525,0)
(368,706,0)
(417,712,0)
(656,112,0)
(537,400,0)
(698,675,0)
(642,400,0)
(500,118,0)
(68,205,0)
(263,128,1)
(279,9,1)
(532,189,1)
(721,330,1)
(205,347,1)
(735,17,1)
(638,92,1)
(530,672,1)
(175,230,1)
(346,388,1)
(145,703,1)
(108,164,1)
(108,136,1)
(685,391,1)
(50,115,1)
(283,537,1)
(426,40,1)
(321,563,1)
(445,446,1)
(258,674,1)
(628,303,1)
(224,139,1)
(704,394,1)
(73,507,1)
(67,258,1)
(686,654,1)
(303,101,1)
(749,454,1)
(682,118,1)
(136,212,1)
(288,133,1)
(517,724,1)
(508,223,1)
(351,14,1)
(165,237,1)
(326,160,1)
(650,642,1)
(506,315,1)
(735,583,1)
(148,655,1)
(735,261,1)
(212,676,1)
(542,446,1)
(564,397,1)
(68,498,1)
(307,263,1)
(96,759,1)
(375,123,1)
(605,541,1)
(710,149,1)
(702,201,1)
(621,153,1)
(636,744,1)
(741,261,1)
(769,8,1)
(761,617,1)
(610,541,1)
(735,471,1)
(566,675,1)
(661,3,1)
(600,101,1)
(610,101,1)
(313,426,1)
(164,633,1)
(243,789,1)
(568,482,1)
(253,219,1)
(410,439,1)
(652,493,1)
(619,439,1)
(620,642,1)
(656,531,1)
(735,696,1)
(720,510,1)
(122,337,1)
(504,711,1)
(448,562,1)
(757,707,1)
(597,201,1)
(425,612,1)
(140,743,1)
(303,541,1)
(238,84,1)
(575,198,1)
(580,546,1)
(499,782,1)
(199,679,1)
(33,642,1)
(735,626,1)
(1,24,1)
(165,479,1)
(363,152,1)
(292,656,1)
(209,55,1)
(412,528,1)
(398,439,1)
(479,781,1)
(145,512,1)
(96,358,1)
(494,513,1)
(695,198,1)
(673,397,1)
(502,716,1)
(255,363,1)
(97,575,1)
(671,118,1)
(726,9,1)
(444,191,1)
(647,140,1)
(529,704,1)
(635,774,1)
(498,527,1)
(31,142,1)
(73,498,1)
(227,4,1)
(451,717,1)
(463,452,1)
(532,15,1)
(326,26,1)
(510,464,1)
(614,239,1)
(771,23,1)
(144,287,1)
(153,356,1)
(92,405,1)
(168,472,1)
(80,35,1)
(550,127,1)
(694,339,1)
(741,502,1)
(774,596,1)
(26,325,1)
(420,437,1)
(430,585,1)
(685,471,1)
(735,370,1)
(482,585,1)
(137,212,1)
(375,439,1)
(605,672,1)
(527,156,1)
(166,251,1)
(403,214,1)
(681,118,1)
(718,357,1)
(513,98,1)
(687,291,1)
(45,530,1)
(308,752,1)
(618,170,1)
(68,339,1)
(619,183,1)
(175,261,1)
(708,691,1)
(643,607,1)
(75,713,1)
(345,148,1)
(685,396,1)
(131,51,1)
(158,187,1)
(570,118,1)
(455,209,1)
(145,578,1)
(626,118,1)
(172,11,1)
(590,487,1)
(290,60,1)
(175,570,1)
(68,359,1)
(610,211,1)
(490,609,1)
(482,406,1)
(514,439,1)
(145,370,1)
(79,786,1)
(752,487,1)
(460,694,1)
(119,701,1)
(282,118,1)
(440,595,1)
(157,436,1)
(705,648,1)
(219,196,1)
(132,731,1)
(8,314,1)
(770,321,1)
(303,246,1)
(300,709,1)
(747,118,1)
(36,422,1)
(777,583,1)
(432,264,1)
(472,404,1)
(175,174,1)
(429,334,1)
(470,439,1)
(421,379,1)
(306,461,1)
(401,483,1)
(117,198,1)
(533,118,1)
(244,257,1)
(662,543,1)
(303,604,1)
(572,122,1)
(417,41,1)
(530,55,1)
(128,262,1)
(370,355,1)
(321,118,1)
(235,672,1)
(667,157,1)
(518,423,1)
(185,558,1)
(136,261,1)
(419,75,1)
(774,408,1)
(249,661,1)
(603,415,1)
(605,455,1)
(655,640,1)
(532,766,1)
(758,491,1)
(465,440,1)
(449,695,1)
(170,704,1)
(136,391,1)
(136,548,1)
(446,516,1)
(175,370,1)
(276,522,1)
(63,296,1)
(280,626,1)
(113,37,1)
(529,406,1)
(756,705,1)
(204,169,1)
(137,391,1)
(124,536,1)
(695,113,1)
(535,70,1)
(68,205,1)
(214,581,1)
(393,48,1)
(663,109,1)
(287,132,1)
(149,439,1)
(558,470,1)
(669,478,1)
(735,174,1)
(399,490,1)
(145,391,1)
(503,179,1)
(152,313,1)
(40,399,1)
(31,147,1)
(91,401,1)
(616,349,1)
(625,758,1)
(688,410,1)
(250,402,1)
(648,416,1)
(666,747,1)
(225,439,1)
(406,559,1)
(183,289,1)
(135,201,1)
(98,705,1)
(274,579,1)
(42,647,1)
(314,585,1)
(404,226,1)
(175,578,1)
(335,81,1)
(691,253,1)
(392,118,1)
(190,283,1)
(285,86,1)
(555,585,1)
(545,16,1)
(487,340,1)
(378,281,1)
(175,729,1)
(66,68,1)
(242,732,1)
(26,101,1)
(111,474,1)
(613,389,1)
(22,130,1)
(138,585,1)
(733,9,1)
(735,99,1)
(714,212,1)
(544,627,1)
(701,77,1)
(73,339,1)
(634,568,1)
(473,272,1)
(319,686,1)
(108,65,1)
(753,439,1)
(301,255,1)
(174,706,1)
(676,772,1)
(180,391,1)
(581,119,1)
(589,168,1)
(50,473,1)
(354,535,1)
(410,565,1)
(109,707,1)
(437,439,1)
(211,702,1)
(382,592,1)
(399,522,1)
(100,242,1)
(104,706,1)
(537,437,1)
(549,778,1)
(464,484,1)
(776,339,1)
(296,759,1)
(422,172,1)
(560,439,1)
(301,541,1)
(158,619,1)
(782,597,1)
(363,285,1)
(138,704,1)
(707,176,1)
(583,118,1)
(652,446,1)
(114,624,1)
(26,672,1)
(594,733,1)
(145,570,1)
(605,55,1)
(698,675,1)
(100,134,1)
(324,687,1)
(615,629,1)
(571,177,1)
(236,574,1)
(389,361,1)
(73,205,1)
(441,759,1)
(773,613,1)
(145,230,1)
(608,498,1)
(197,493,1)
(585,755,1)
(223,521,1)
(511,742,1)
(439,721,1)
(629,624,1)
(543,779,1)
(415,439,1)
(301,55,1)
(466,468,1)
(563,385,1)
(431,388,1)
(561,124,1)
(139,439,1)
(172,118,1)
(217,462,1)
(524,247,1)
(385,290,1)
(702,739,1)
(767,672,1)
(438,109,1)
(64,671,1)
(735,192,1)
(381,375,1)
(70,684,1)
(609,536,1)
(279,317,1)
(85,460,1)
(428,635,1)
(284,370,1)
(234,542,1)
(349,373,1)
(526,488,1)
(309,751,1)
(396,114,1)
(145,729,1)
(223,118,1)
(68,733,1)
(338,424,1)
(68,624,1)
(350,471,1)
(294,353,1)
(0,44,1)
(121,146,1)
(660,141,1)
(469,293,1)
(369,761,1)
(10,644,1)
(57,282,1)
(118,364,1)
(191,533,1)
(750,729,1)
(748,269,1)
(399,781,1)
(741,471,1)
(99,118,1)
(533,369,1)
(200,560,1)
(257,698,1)
(645,485,1)
(694,498,1)
(627,25,1)
(742,429,1)
(521,217,1)
(35,480,1)
(314,704,1)
(175,17,1)
(550,307,1)
(430,730,1)
(496,323,1)
(487,153,1)
(115,495,1)
(442,284,1)
(537,728,1)
(483,200,1)
(174,104,1)
(124,279,1)
(233,522,1)
(735,771,1)
(654,703,1)
(137,471,1)
(650,118,1)
(147,486,1)
(133,534,1)
(386,642,1)
(712,417,1)
(29,348,1)
(600,55,1)
(713,382,1)
(509,712,1)
(339,248,1)
(84,737,1)
(705,439,1)
(462,759,1)
(751,419,1)
(529,430,1)
(632,578,1)
(350,391,1)
(450,464,1)
(430,406,1)
(181,682,1)
(763,567,1)
(462,118,1)
(532,118,1)
(46,36,1)
(10,117,1)
(677,244,1)
(730,509,1)
(673,564,1)
(768,541,1)
(639,753,1)
(226,280,1)
(498,302,1)
(557,185,1)
(91,315,1)
(238,118,1)
(270,292,1)
(333,72,1)
(707,751,1)
(108,145,1)
(331,746,1)
(106,582,1)
(248,304,1)
(387,409,1)
(37,240,1)
(761,298,1)
(640,630,1)
(640,354,1)
(685,212,1)
(175,612,1)
(696,118,1)
(717,441,1)
(130,118,1)
(230,118,1)
(459,192,1)
(138,375,1)
(373,463,1)
(768,551,1)
(318,415,1)
(607,118,1)
(584,783,1)
(550,9,1)
(539,773,1)
(99,39,1)
(108,677,1)
(282,670,1)
(293,202,1)
(103,406,1)
(391,545,1)
(388,138,1)
(546,61,1)
(679,91,1)
(117,97,1)
(656,624,1)
(94,704,1)
(482,704,1)
(415,418,1)
(409,162,1)
(766,748,1)
(488,579,1)
(690,213,1)
(469,118,1)
(693,431,1)
(482,241,1)
(350,212,1)
(275,553,1)
(468,67,1)
(145,682,1)
(94,585,1)
(534,362,1)
(354,70,1)
(103,585,1)
(240,28,1)
(454,166,1)
(776,210,1)
(138,581,1)
(261,165,1)
(475,532,1)
(243,392,1)
(191,695,1)
(485,610,1)
(137,261,1)
(109,757,1)
(116,511,1)
(531,335,1)
(697,720,1)
(390,6,1)
(500,438,1)
(187,32,1)
(311,371,1)
(670,510,1)
(481,10,1)
(68,86,1)
(431,83,1)
(233,781,1)
(78,630,1)
(116,307,1)
(87,432,1)
(315,690,1)
(445,493,1)
(278,174,1)
(240,306,1)
(675,759,1)
(741,391,1)
(251,64,1)
(552,94,1)
(61,98,1)
(107,13,1)
(23,380,1)
(88,759,1)
(744,194,1)
(65,333,1)
(69,704,1)
(358,365,1)
(735,570,1)
(301,672,1)
(560,519,1)
(335,630,1)
(246,7,1)
(682,697,1)
(225,557,1)
(746,62,1)
(245,681,1)
(186,465,1)
(187,439,1)
(392,751,1)
(357,726,1)
(736,21,1)
(350,478,1)
(786,318,1)
(528,446,1)
(422,598,1)
(532,323,1)
(62,544,1)
(15,189,1)
(130,762,1)
(145,471,1)
(707,118,1)
(579,374,1)
(430,704,1)
(94,406,1)
(603,434,1)
(94,411,1)
(570,520,1)
(593,22,1)
(206,632,1)
(59,130,1)
(650,171,1)
(60,342,1)
(191,240,1)
(91,18,1)
(706,118,1)
(641,311,1)
(8,493,1)
(145,583,1)
(348,195,1)
(302,555,1)
(445,476,1)
(17,589,1)
(44,639,1)
(6,273,1)
(778,225,1)
(273,636,1)
(386,118,1)
(424,301,1)
(154,428,1)
(175,212,1)
(355,49,1)
(721,576,1)
(127,384,1)
(694,577,1)
(175,583,1)
(291,527,1)
(719,475,1)
(649,266,1)
(361,33,1)
(114,503,1)
(73,399,1)
(451,759,1)
(407,771,1)
(389,118,1)
(453,103,1)
(380,90,1)
(145,612,1)
(145,99,1)
(170,662,1)
(58,238,1)
(592,106,1)
(610,702,1)
(371,100,1)
(642,652,1)
(456,524,1)
(512,723,1)
(577,143,1)
(179,581,1)
(48,116,1)
(326,34,1)
(422,410,1)
(218,274,1)
(182,787,1)
(623,451,1)
(492,500,1)
(484,249,1)
(380,58,1)
(138,406,1)
(27,766,1)
(88,63,1)
(434,79,1)
(192,118,1)
(759,158,1)
(427,236,1)
(305,734,1)
(265,392,1)
(145,17,1)
(731,470,1)
(202,570,1)
(196,42,1)
(213,387,1)
(716,738,1)
(340,621,1)
(755,163,1)
(533,5,1)
(486,1,1)
(304,215,1)
(160,26,1)
(233,718,1)
(55,672,1)
(161,584,1)
(772,31,1)
(738,630,1)
(371,252,1)
(175,696,1)
(781,205,1)
(600,672,1)
(703,759,1)
(34,439,1)
(476,278,1)
(195,236,1)
(583,769,1)
(773,389,1)
(145,319,1)
(683,767,1)
(367,597,1)
(602,448,1)
(441,118,1)
(537,386,1)
(336,224,1)
(323,439,1)
(91,560,1)
(576,376,1)
(42,19,1)
(314,406,1)
(210,577,1)
(788,17,1)
(620,754,1)
(783,111,1)
(510,443,1)
(90,204,1)
(209,0,1)
(254,608,1)
(451,297,1)
(239,514,1)
(77,68,1)
(2,561,1)
(11,688,1)
(153,759,1)
(297,96,1)
(286,469,1)
(197,459,1)
(136,471,1)
(711,197,1)
(519,506,1)
(16,52,1)
(207,777,1)
(738,345,1)
(370,118,1)
(559,600,1)
(274,142,1)
(523,170,1)
(77,66,1)
(235,101,1)
(175,682,1)
(153,118,1)
(78,736,1)
(702,118,1)
(108,175,1)
(774,50,1)
(441,250,1)
(96,118,1)
(516,73,1)
(78,581,1)
(175,512,1)
(558,144,1)
(14,148,1)
(247,512,1)
(443,450,1)
(82,528,1)
(612,770,1)
(740,314,1)
(530,101,1)
(220,261,1)
(721,408,1)
(81,77,1)
(674,504,1)
(163,672,1)
(532,377,1)
(273,194,1)
(192,85,1)
(671,759,1)
(735,230,1)
(252,467,1)
(108,685,1)
(386,414,1)
(528,493,1)
(611,101,1)
(447,301,1)
(611,55,1)
(374,444,1)
(108,741,1)
(43,647,1)
(39,593,1)
(630,338,1)
(597,135,1)
(681,785,1)
(189,439,1)
(558,287,1)
(263,262,1)
(706,193,1)
(353,10,1)
(277,591,1)
(611,30,1)
(341,129,1)
(412,82,1)
(313,279,1)
(735,391,1)
(548,447,1)
(507,227,1)
(316,590,1)
(382,106,1)
(471,641,1)
(175,471,1)
(148,640,1)
(635,310,1)
(337,616,1)
(377,421,1)
(611,672,1)
(380,492,1)
(55,55,1)
(493,552,1)
(634,618,1)
(379,407,1)
(17,118,1)
(158,142,1)
(737,367,1)
(230,515,1)
(231,619,1)
(392,29,1)
(362,518,1)
(665,93,1)
(419,382,1)
(416,628,1)
(706,642,1)
(193,368,1)
(235,12,1)
(785,118,1)
(432,630,1)
(178,232,1)
(298,763,1)
(394,435,1)
(108,137,1)
(747,539,1)
(223,759,1)
(388,660,1)
(729,645,1)
(491,412,1)
(741,212,1)
(522,527,1)
(762,549,1)
(274,526,1)
(562,80,1)
(182,469,1)
(397,442,1)
(314,234,1)
(423,541,1)
(123,403,1)
(520,458,1)
(436,116,1)
(675,300,1)
(30,216,1)
(528,622,1)
(451,118,1)
(5,449,1)
(175,99,1)
(232,465,1)
(497,129,1)
(198,182,1)
(133,118,1)
(607,572,1)
(723,218,1)
(129,596,1)
(241,523,1)
(452,745,1)
(349,118,1)
(129,668,1)
(584,118,1)
(627,611,1)
(166,118,1)
(453,529,1)
(22,59,1)
(171,625,1)
(524,184,1)
(91,547,1)
(646,102,1)
(62,550,1)
(332,643,1)
(743,126,1)
(469,369,1)
(671,390,1)
(703,118,1)
(640,232,1)
(464,288,1)
(162,18,1)
(339,527,1)
(567,696,1)
(402,297,1)
(9,324,1)
(652,56,1)
(766,439,1)
(216,646,1)
(647,743,1)
(95,395,1)
(151,623,1)
(529,585,1)
(454,273,1)
(145,261,1)
(529,509,1)
(368,103,1)
(145,696,1)
(68,313,1)
(600,700,1)
(145,223,1)
(735,719,1)
(612,321,1)
(514,775,1)
(692,221,1)
(684,178,1)
(588,673,1)
(60,445,1)
(49,243,1)
(364,602,1)
(734,339,1)
(536,233,1)
(138,381,1)
(601,203,1)
(28,306,1)
(201,768,1)
(423,750,1)
(624,351,1)
(137,270,1)
(55,45,1)
(595,630,1)
(540,496,1)
(51,343,1)
(464,118,1)
(24,780,1)
(324,527,1)
(98,756,1)
(709,88,1)
(42,468,1)
(139,107,1)
(176,309,1)
(269,377,1)
(698,566,1)
(448,624,1)
(108,350,1)
(478,494,1)
(32,231,1)
(126,466,1)
(672,571,1)
(145,626,1)
(175,391,1)
(68,399,1)
(579,118,1)
(384,544,1)
(454,671,1)
(232,186,1)
(530,2,1)
(389,642,1)
(13,230,1)
(607,759,1)
(102,326,1)
(787,286,1)
(715,354,1)
(577,620,1)
(310,267,1)
(350,199,1)
(337,349,1)
(21,346,1)
(414,420,1)
(789,93,1)
(103,704,1)
(3,288,1)
(553,99,1)
(4,588,1)
(103,190,1)
(91,387,1)
(161,698,1)
(622,425,1)
(776,399,1)
(329,27,1)
(565,336,1)
(735,512,1)
(633,341,1)
(753,457,1)
(266,604,1)
(163,667,1)
(480,693,1)
(411,433,1)
(349,759,1)
(166,759,1)
(323,329,1)
(83,78,1)
(729,118,1)
(457,220,1)
(556,102,1)
(18,669,1)
(461,481,1)
(19,398,1)
(72,154,1)
(745,749,1)
(626,277,1)
(380,57,1)
(735,612,1)
(163,55,1)
(522,692,1)
(145,192,1)
(732,88,1)
(733,254,1)
(175,192,1)
(124,62,1)
(598,172,1)
(380,666,1)
(735,729,1)
(80,581,1)
(321,642,1)
(363,594,1)
(634,170,1)
(145,174,1)
(644,117,1)
(116,9,1)
(380,245,1)
(512,118,1)
(243,195,1)
(495,497,1)
(215,406,1)
(617,298,1)
(267,774,1)
(117,118,1)
(204,118,1)
(26,55,1)
(249,118,1)
(695,118,1)
(480,630,1)
(620,118,1)
(25,611,1)
(703,638,1)
(395,605,1)
(547,401,1)
(582,788,1)
(603,79,1)
(728,386,1)
(108,735,1)
(170,585,1)
(574,663,1)
(179,87,1)
(93,260,1)
(509,650,1)
(221,215,1)
(334,556,1)
(169,294,1)
(197,446,1)
(41,650,1)
(700,331,1)
(342,445,1)
(141,138,1)
(20,34,1)
(359,615,1)
(145,212,1)
(177,307,1)
(433,740,1)
(217,337,1)
(726,393,1)
(347,131,1)
(418,569,1)
(694,776,1)
(789,665,1)
(86,305,1)
(462,332,1)
(536,726,1)
(474,601,1)
(195,427,1)
(515,456,1)
(551,275,1)
(235,55,1)
(591,681,1)
(739,499,1)
(776,205,1)
(343,683,1)
(146,9,1)
(468,674,1)
(163,101,1)
(604,614,1)
(398,43,1)
(167,453,1)
(500,118,1)
(7,649,1)
(685,261,1)
(435,473,1)
(170,406,1)
(413,206,1)
(694,205,1)
(775,180,1)
(175,626,1)
(156,235,1)
(52,714,1)
(694,399,1)
(569,378,1)
(143,634,1)
(189,540,1)
(175,308,1)
(356,413,1)
(325,20,1)
(317,276,1)
(365,316,1)
(696,708,1)
(203,181,1)
(363,605,1)
(315,439,1)
(289,710,1)
(735,212,1)
(467,100,1)
(401,439,1)
(56,207,1)
(287,118,1)
(470,46,1)
(779,620,1)
(86,9,1)
(376,635,1)
(31,1,1)
(538,161,1)
(264,431,1)
(578,538,1)
(281,471,1)
(776,498,1)
(458,369,1)
(493,446,1)
(22,778,1)
(405,508,1)
(640,715,1)
(12,95,1)
(437,517,1)
(668,69,1)
(262,580,1)
(78,624,1)
(194,151,1)
(34,121,1)
(780,603,1)
(260,265,1)
(724,773,1)
(754,167,1)
(499,597,2)
(96,487,2)
(236,109,2)
(356,510,2)
(774,50,2)
(138,704,2)
(703,759,2)
(496,510,2)
(240,10,2)
(145,487,2)
(190,773,2)
(269,597,2)
(348,109,2)
(109,707,2)
(558,10,2)
(27,681,2)
(768,541,2)
(610,597,2)
(212,88,2)
(605,536,2)
(161,698,2)
(4,109,2)
(433,314,2)
(163,101,2)
(189,10,2)
(102,326,2)
(15,510,2)
(369,773,2)
(166,487,2)
(514,88,2)
(529,406,2)
(546,98,2)
(482,170,2)
(301,98,2)
(62,102,2)
(592,681,2)
(382,106,2)
(124,536,2)
(141,77,2)
(174,706,2)
(619,635,2)
(718,726,2)
(192,118,2)
(158,142,2)
(735,230,2)
(732,88,2)
(108,677,2)
(118,364,2)
(93,109,2)
(193,103,2)
(419,75,2)
(681,431,2)
(216,102,2)
(258,773,2)
(154,635,2)
(514,439,2)
(755,116,2)
(451,297,2)
(430,406,2)
(421,681,2)
(602,431,2)
(83,78,2)
(724,773,2)
(129,596,2)
(694,399,2)
(73,498,2)
(771,681,2)
(293,773,2)
(56,109,2)
(496,597,2)
(642,109,2)
(170,406,2)
(399,536,2)
(610,541,2)
(748,681,2)
(721,408,2)
(496,773,2)
(381,77,2)
(482,406,2)
(100,88,2)
(549,10,2)
(77,148,2)
(292,77,2)
(26,101,2)
(759,158,2)
(264,431,2)
(421,597,2)
(145,570,2)
(454,487,2)
(52,88,2)
(73,109,2)
(80,431,2)
(478,98,2)
(67,773,2)
(589,681,2)
(326,34,2)
(519,98,2)
(717,441,2)
(532,766,2)
(688,10,2)
(493,446,2)
(497,129,2)
(72,635,2)
(238,118,2)
(454,166,2)
(250,487,2)
(17,118,2)
(145,223,2)
(475,681,2)
(706,642,2)
(379,681,2)
(389,642,2)
(31,142,2)
(600,55,2)
(277,681,2)
(294,10,2)
(442,109,2)
(407,773,2)
(311,88,2)
(15,597,2)
(80,581,2)
(647,743,2)
(288,597,2)
(528,103,2)
(145,578,2)
(14,148,2)
(179,431,2)
(605,541,2)
(550,9,2)
(324,527,2)
(451,717,2)
(318,88,2)
(421,10,2)
(75,681,2)
(409,98,2)
(781,98,2)
(269,10,2)
(605,672,2)
(91,315,2)
(757,681,2)
(354,70,2)
(581,119,2)
(88,759,2)
(735,729,2)
(153,510,2)
(451,487,2)
(153,698,2)
(735,612,2)
(540,10,2)
(132,10,2)
(261,165,2)
(721,635,2)
(532,681,2)
(415,88,2)
(536,233,2)
(108,65,2)
(706,103,2)
(111,510,2)
(491,103,2)
(638,487,2)
(465,301,2)
(78,630,2)
(261,98,2)
(607,337,2)
(705,88,2)
(68,624,2)
(303,88,2)
(136,261,2)
(55,672,2)
(337,349,2)
(225,10,2)
(774,596,2)
(314,704,2)
(42,468,2)
(94,314,2)
(740,314,2)
(591,681,2)
(673,397,2)
(529,103,2)
(349,487,2)
(314,585,2)
(502,148,2)
(19,773,2)
(202,773,2)
(766,510,2)
(747,118,2)
(0,44,2)
(623,487,2)
(108,145,2)
(160,605,2)
(350,212,2)
(130,10,2)
(77,68,2)
(367,597,2)
(303,541,2)
(329,10,2)
(276,215,2)
(578,510,2)
(423,541,2)
(416,88,2)
(60,445,2)
(221,215,2)
(178,301,2)
(694,205,2)
(374,10,2)
(445,493,2)
(694,339,2)
(421,109,2)
(189,597,2)
(145,729,2)
(640,630,2)
(35,431,2)
(137,391,2)
(766,597,2)
(317,215,2)
(145,261,2)
(187,635,2)
(207,109,2)
(73,339,2)
(611,101,2)
(263,98,2)
(742,102,2)
(639,98,2)
(84,597,2)
(168,681,2)
(611,672,2)
(469,369,2)
(576,635,2)
(260,109,2)
(297,96,2)
(776,399,2)
(209,98,2)
(96,759,2)
(130,118,2)
(362,597,2)
(431,77,2)
(136,391,2)
(532,377,2)
(628,88,2)
(7,88,2)
(756,88,2)
(175,391,2)
(37,10,2)
(401,98,2)
(696,773,2)
(529,509,2)
(534,597,2)
(103,585,2)
(504,773,2)
(652,109,2)
(511,102,2)
(719,597,2)
(287,10,2)
(735,771,2)
(748,10,2)
(145,192,2)
(737,597,2)
(36,10,2)
(144,10,2)
(516,73,2)
(481,10,2)
(215,62,2)
(675,88,2)
(170,585,2)
(399,781,2)
(349,118,2)
(530,536,2)
(480,630,2)
(165,237,2)
(133,118,2)
(559,62,2)
(379,10,2)
(471,88,2)
(407,597,2)
(762,10,2)
(440,301,2)
(468,773,2)
(715,301,2)
(470,439,2)
(565,10,2)
(329,109,2)
(613,109,2)
(145,583,2)
(588,673,2)
(29,109,2)
(695,118,2)
(452,487,2)
(153,356,2)
(671,118,2)
(146,605,2)
(652,56,2)
(578,698,2)
(15,773,2)
(411,314,2)
(717,487,2)
(472,681,2)
(392,751,2)
(735,696,2)
(323,681,2)
(28,10,2)
(26,672,2)
(772,88,2)
(68,313,2)
(255,98,2)
(114,624,2)
(694,776,2)
(386,118,2)
(572,337,2)
(252,88,2)
(245,681,2)
(458,773,2)
(270,77,2)
(323,773,2)
(537,773,2)
(618,170,2)
(695,10,2)
(369,761,2)
(388,138,2)
(687,605,2)
(766,109,2)
(570,773,2)
(434,88,2)
(377,109,2)
(198,182,2)
(164,129,2)
(475,597,2)
(476,103,2)
(777,109,2)
(736,388,2)
(528,493,2)
(300,88,2)
(785,431,2)
(407,681,2)
(371,88,2)
(274,579,2)
(441,759,2)
(230,118,2)
(733,116,2)
(610,101,2)
(655,301,2)
(251,487,2)
(371,100,2)
(163,55,2)
(175,192,2)
(577,620,2)
(106,681,2)
(567,773,2)
(55,55,2)
(642,652,2)
(789,109,2)
(249,118,2)
(766,773,2)
(608,116,2)
(447,301,2)
(49,109,2)
(145,696,2)
(175,487,2)
(445,446,2)
(487,340,2)
(40,536,2)
(540,773,2)
(149,635,2)
(241,170,2)
(325,605,2)
(138,585,2)
(55,45,2)
(594,116,2)
(175,512,2)
(661,597,2)
(496,681,2)
(307,263,2)
(12,605,2)
(585,116,2)
(630,338,2)
(97,773,2)
(140,773,2)
(413,698,2)
(370,109,2)
(532,773,2)
(422,410,2)
(475,109,2)
(346,388,2)
(510,464,2)
(285,215,2)
(455,536,2)
(34,439,2)
(568,482,2)
(124,215,2)
(201,10,2)
(94,406,2)
(444,10,2)
(238,597,2)
(453,773,2)
(108,136,2)
(627,611,2)
(263,262,2)
(568,170,2)
(340,698,2)
(233,781,2)
(118,431,2)
(392,118,2)
(2,62,2)
(314,109,2)
(284,109,2)
(345,148,2)
(500,109,2)
(575,773,2)
(536,116,2)
(209,62,2)
(288,133,2)
(774,408,2)
(239,514,2)
(705,439,2)
(232,465,2)
(711,773,2)
(387,98,2)
(336,10,2)
(43,773,2)
(789,93,2)
(108,735,2)
(391,88,2)
(460,773,2)
(395,605,2)
(380,773,2)
(23,681,2)
(333,635,2)
(350,471,2)
(181,510,2)
(508,487,2)
(609,536,2)
(9,324,2)
(788,681,2)
(428,635,2)
(469,118,2)
(136,212,2)
(377,597,2)
(719,773,2)
(235,605,2)
(166,118,2)
(137,77,2)
(748,597,2)
(197,773,2)
(145,230,2)
(735,681,2)
(695,198,2)
(282,510,2)
(63,635,2)
(91,18,2)
(230,10,2)
(119,77,2)
(55,215,2)
(145,626,2)
(68,399,2)
(542,109,2)
(356,698,2)
(524,184,2)
(532,189,2)
(635,310,2)
(313,279,2)
(735,17,2)
(199,98,2)
(432,431,2)
(723,10,2)
(138,77,2)
(735,510,2)
(23,510,2)
(50,473,2)
(583,118,2)
(538,698,2)
(577,143,2)
(719,510,2)
(266,88,2)
(339,527,2)
(491,412,2)
(412,103,2)
(191,533,2)
(510,443,2)
(776,498,2)
(556,102,2)
(94,585,2)
(562,431,2)
(510,597,2)
(191,240,2)
(45,536,2)
(555,116,2)
(719,10,2)
(254,116,2)
(620,642,2)
(425,103,2)
(145,370,2)
(731,10,2)
(550,307,2)
(412,528,2)
(389,109,2)
(206,698,2)
(561,62,2)
(20,605,2)
(464,597,2)
(386,642,2)
(693,431,2)
(385,103,2)
(379,597,2)
(735,512,2)
(27,10,2)
(64,487,2)
(741,471,2)
(563,103,2)
(771,10,2)
(148,640,2)
(5,10,2)
(778,225,2)
(512,10,2)
(455,215,2)
(249,597,2)
(55,536,2)
(734,215,2)
(729,118,2)
(27,773,2)
(500,118,2)
(634,170,2)
(479,98,2)
(388,660,2)
(698,675,2)
(560,439,2)
(484,249,2)
(540,510,2)
(45,215,2)
(401,439,2)
(462,759,2)
(443,597,2)
(206,510,2)
(536,726,2)
(242,88,2)
(735,212,2)
(483,98,2)
(334,102,2)
(746,62,2)
(123,77,2)
(91,560,2)
(786,88,2)
(82,103,2)
(27,510,2)
(131,98,2)
(630,301,2)
(398,439,2)
(321,642,2)
(430,585,2)
(553,10,2)
(470,10,2)
(634,568,2)
(323,597,2)
(529,430,2)
(626,118,2)
(205,98,2)
(761,298,2)
(133,597,2)
(605,55,2)
(126,773,2)
(527,605,2)
(771,109,2)
(170,773,2)
(402,487,2)
(684,301,2)
(309,681,2)
(466,773,2)
(735,583,2)
(179,581,2)
(269,773,2)
(488,10,2)
(666,773,2)
(566,88,2)
(530,215,2)
(463,487,2)
(124,62,2)
(382,681,2)
(636,487,2)
(622,103,2)
(78,388,2)
(61,98,2)
(548,301,2)
(375,77,2)
(156,605,2)
(377,681,2)
(289,635,2)
(60,103,2)
(547,98,2)
(81,77,2)
(719,681,2)
(145,471,2)
(607,118,2)
(646,102,2)
(189,439,2)
(59,10,2)
(201,768,2)
(162,98,2)
(716,148,2)
(770,103,2)
(451,759,2)
(291,605,2)
(451,118,2)
(189,109,2)
(175,612,2)
(48,116,2)
(588,109,2)
(213,98,2)
(377,510,2)
(143,773,2)
(200,98,2)
(335,77,2)
(365,487,2)
(42,773,2)
(183,635,2)
(211,597,2)
(448,431,2)
(321,118,2)
(493,314,2)
(531,77,2)
(639,753,2)
(407,109,2)
(175,230,2)
(233,726,2)
(522,215,2)
(595,301,2)
(290,60,2)
(730,103,2)
(171,103,2)
(26,605,2)
(275,10,2)
(487,698,2)
(626,681,2)
(305,215,2)
(2,536,2)
(698,88,2)
(42,19,2)
(8,109,2)
(102,605,2)
(62,550,2)
(58,597,2)
(368,103,2)
(532,118,2)
(457,98,2)
(68,148,2)
(419,681,2)
(611,55,2)
(147,88,2)
(532,10,2)
(323,510,2)
(667,116,2)
(403,77,2)
(410,439,2)
(676,88,2)
(496,10,2)
(191,695,2)
(459,773,2)
(308,487,2)
(439,721,2)
(632,698,2)
(521,487,2)
(721,330,2)
(581,77,2)
(347,98,2)
(350,478,2)
(707,118,2)
(329,597,2)
(186,301,2)
(198,773,2)
(677,698,2)
(407,510,2)
(380,597,2)
(741,148,2)
(1,88,2)
(743,773,2)
(461,10,2)
(282,118,2)
(686,487,2)
(679,98,2)
(702,597,2)
(269,510,2)
(749,487,2)
(773,109,2)
(714,88,2)
(616,487,2)
(68,205,2)
(22,10,2)
(108,137,2)
(223,759,2)
(632,510,2)
(422,10,2)
(10,773,2)
(68,86,2)
(364,431,2)
(775,88,2)
(283,773,2)
(343,98,2)
(68,339,2)
(108,175,2)
(57,510,2)
(379,109,2)
(324,605,2)
(103,704,2)
(45,62,2)
(303,101,2)
(604,88,2)
(635,774,2)
(754,773,2)
(175,570,2)
(273,487,2)
(702,201,2)
(773,389,2)
(540,681,2)
(533,118,2)
(482,704,2)
(22,778,2)
(421,773,2)
(776,205,2)
(341,129,2)
(537,386,2)
(537,437,2)
(116,102,2)
(750,597,2)
(561,536,2)
(701,77,2)
(733,9,2)
(441,118,2)
(681,118,2)
(329,681,2)
(281,88,2)
(371,252,2)
(392,109,2)
(138,375,2)
(27,597,2)
(627,102,2)
(612,321,2)
(95,605,2)
(194,487,2)
(652,446,2)
(163,672,2)
(41,103,2)
(468,674,2)
(644,773,2)
(286,773,2)
(116,9,2)
(528,446,2)
(393,116,2)
(3,597,2)
(529,585,2)
(218,10,2)
(91,387,2)
(713,681,2)
(726,116,2)
(279,9,2)
(380,10,2)
(598,10,2)
(91,401,2)
(329,773,2)
(464,118,2)
(87,431,2)
(223,118,2)
(301,541,2)
(128,98,2)
(223,487,2)
(739,597,2)
(24,88,2)
(18,98,2)
(674,773,2)
(527,156,2)
(153,759,2)
(561,215,2)
(735,261,2)
(427,109,2)
(98,88,2)
(696,118,2)
(79,88,2)
(529,704,2)
(532,597,2)
(741,391,2)
(600,62,2)
(314,406,2)
(204,118,2)
(702,118,2)
(32,635,2)
(523,170,2)
(580,98,2)
(779,773,2)
(685,212,2)
(145,212,2)
(145,391,2)
(605,215,2)
(301,672,2)
(225,439,2)
(759,635,2)
(26,55,2)
(351,148,2)
(279,215,2)
(31,88,2)
(774,129,2)
(485,597,2)
(397,109,2)
(377,10,2)
(671,487,2)
(16,88,2)
(455,98,2)
(421,510,2)
(495,129,2)
(31,1,2)
(319,487,2)
(191,10,2)
(389,118,2)
(640,354,2)
(748,109,2)
(180,88,2)
(748,510,2)
(621,510,2)
(420,773,2)
(304,215,2)
(493,552,2)
(175,261,2)
(735,109,2)
(62,544,2)
(648,88,2)
(545,88,2)
(515,10,2)
(104,103,2)
(88,635,2)
(195,109,2)
(103,406,2)
(73,399,2)
(697,510,2)
(441,487,2)
(239,88,2)
(748,773,2)
(121,605,2)
(398,773,2)
(446,109,2)
(169,10,2)
(620,773,2)
(117,773,2)
(340,510,2)
(710,635,2)
(113,10,2)
(217,487,2)
(439,635,2)
(358,487,2)
(323,109,2)
(583,109,2)
(175,174,2)
(516,109,2)
(363,98,2)
(780,88,2)
(426,536,2)
(656,77,2)
(663,109,2)
(600,672,2)
(585,755,2)
(349,759,2)
(550,544,2)
(92,487,2)
(373,487,2)
(114,431,2)
(778,10,2)
(44,98,2)
(323,10,2)
(274,10,2)
(540,109,2)
(148,301,2)
(559,600,2)
(39,10,2)
(675,759,2)
(23,773,2)
(767,98,2)
(137,471,2)
(86,215,2)
(234,109,2)
(331,62,2)
(647,773,2)
(431,83,2)
(45,530,2)
(771,597,2)
(490,536,2)
(640,232,2)
(310,129,2)
(584,118,2)
(735,570,2)
(768,10,2)
(603,88,2)
(65,635,2)
(753,98,2)
(517,773,2)
(494,98,2)
(640,301,2)
(158,635,2)
(315,98,2)
(25,102,2)
(316,487,2)
(769,109,2)
(520,773,2)
(607,759,2)
(68,733,2)
(6,487,2)
(357,726,2)
(321,103,2)
(624,148,2)
(641,88,2)
(176,681,2)
(735,99,2)
(240,306,2)
(353,10,2)
(375,439,2)
(423,597,2)
(196,773,2)
(90,10,2)
(298,773,2)
(530,101,2)
(34,605,2)
(145,174,2)
(337,487,2)
(220,98,2)
(670,510,2)
(735,192,2)
(108,741,2)
(729,597,2)
(107,10,2)
(10,117,2)
(512,118,2)
(296,635,2)
(683,98,2)
(195,236,2)
(475,773,2)
(315,439,2)
(430,103,2)
(232,301,2)
(379,510,2)
(257,698,2)
(404,681,2)
(380,681,2)
(66,148,2)
(449,10,2)
(643,337,2)
(273,194,2)
(413,510,2)
(726,9,2)
(42,647,2)
(44,639,2)
(185,10,2)
(235,55,2)
(219,773,2)
(484,597,2)
(380,109,2)
(509,650,2)
(571,98,2)
(448,624,2)
(574,109,2)
(335,630,2)
(175,212,2)
(558,287,2)
(708,773,2)
(560,98,2)
(137,261,2)
(751,681,2)
(98,705,2)
(614,88,2)
(235,672,2)
(187,439,2)
(582,681,2)
(656,624,2)
(332,337,2)
(424,301,2)
(175,578,2)
(709,88,2)
(145,682,2)
(231,635,2)
(406,62,2)
(247,10,2)
(136,471,2)
(302,116,2)
(167,773,2)
(158,187,2)
(86,9,2)
(538,510,2)
(564,109,2)
(720,510,2)
(27,109,2)
(359,148,2)
(23,10,2)
(745,487,2)
(111,474,2)
(2,215,2)
(526,10,2)
(771,510,2)
(243,195,2)
(752,487,2)
(145,99,2)
(611,102,2)
(103,773,2)
(227,109,2)
(728,773,2)
(462,118,2)
(751,419,2)
(151,487,2)
(376,635,2)
(600,101,2)
(23,597,2)
(301,55,2)
(532,109,2)
(386,773,2)
(278,103,2)
(776,339,2)
(735,773,2)
(350,391,2)
(700,62,2)
(509,103,2)
(78,624,2)
(384,544,2)
(350,98,2)
(445,103,2)
(454,273,2)
(482,585,2)
(377,773,2)
(210,773,2)
(551,10,2)
(472,404,2)
(455,62,2)
(533,10,2)
(11,10,2)
(741,261,2)
(467,88,2)
(487,153,2)
(175,471,2)
(530,672,2)
(175,370,2)
(557,10,2)
(244,698,2)
(280,681,2)
(579,118,2)
(612,103,2)
(370,118,2)
(23,109,2)
(172,118,2)
(766,681,2)
(243,789,2)
(617,773,2)
(269,109,2)
(161,510,2)
(175,583,2)
(243,392,2)
(145,512,2)
(30,102,2)
(182,787,2)
(707,681,2)
(430,704,2)
(55,62,2)
(182,469,2)
(99,118,2)
(224,10,2)
(685,431,2)
(694,498,2)
(436,116,2)
(492,109,2)
(685,261,2)
(83,388,2)
(175,17,2)
(682,510,2)
(226,681,2)
(170,704,2)
(781,205,2)
(354,301,2)
(682,118,2)
(691,773,2)
(290,103,2)
(776,773,2)
(21,388,2)
(506,98,2)
(524,10,2)
(197,493,2)
(719,109,2)
(143,634,2)
(422,172,2)
(189,773,2)
(122,337,2)
(597,10,2)
(584,510,2)
(544,627,2)
(650,118,2)
(306,10,2)
(108,164,2)
(246,88,2)
(763,773,2)
(248,215,2)
(620,118,2)
(768,551,2)
(182,773,2)
(474,510,2)
(379,773,2)
(70,301,2)
(685,471,2)
(634,773,2)
(783,510,2)
(735,391,2)
(532,323,2)
(650,642,2)
(189,510,2)
(533,369,2)
(153,118,2)
(738,630,2)
(139,439,2)
(407,10,2)
(782,597,2)
(629,148,2)
(355,109,2)
(15,10,2)
(139,10,2)
(480,431,2)
(625,103,2)
(269,681,2)
(469,773,2)
(399,522,2)
(166,759,2)
(513,98,2)
(137,212,2)
(496,109,2)
(605,98,2)
(758,103,2)
(303,604,2)
(673,109,2)
(735,174,2)
(544,102,2)
(388,77,2)
(100,134,2)
(601,510,2)
(735,370,2)
(203,510,2)
(503,431,2)
(175,729,2)
(117,198,2)
(108,685,2)
(192,773,2)
(766,10,2)
(652,493,2)
(197,446,2)
(135,10,2)
(649,88,2)
(265,109,2)
(741,212,2)
(17,681,2)
(703,118,2)
(432,630,2)
(755,163,2)
(177,98,2)
(509,712,2)
(209,536,2)
(603,415,2)
(671,759,2)
(605,62,2)
(156,235,2)
(552,314,2)
(498,527,2)
(597,201,2)
(209,215,2)
(51,98,2)
(99,10,2)
(378,88,2)
(243,109,2)
(117,118,2)
(127,544,2)
(518,597,2)
(475,510,2)
(603,79,2)
(431,388,2)
(486,88,2)
(313,536,2)
(446,516,2)
(297,487,2)
(462,337,2)
(233,522,2)
(163,116,2)
(380,510,2)
(342,103,2)
(152,536,2)
(46,10,2)
(766,439,2)
(735,626,2)
(410,10,2)
(418,88,2)
(475,10,2)
(450,597,2)
(694,577,2)
(456,10,2)
(633,129,2)
(569,88,2)
(522,527,2)
(787,773,2)
(108,350,2)
(78,581,2)
(590,487,2)
(419,382,2)
(438,109,2)
(9,605,2)
(326,26,2)
(429,102,2)
(654,487,2)
(692,215,2)
(13,10,2)
(621,698,2)
(406,559,2)
(454,671,2)
(735,10,2)
(175,626,2)
(417,103,2)
(22,130,2)
(138,581,2)
(323,439,2)
(145,612,2)
(665,109,2)
(672,98,2)
(593,10,2)
(158,619,2)
(85,773,2)
(94,704,2)
(761,773,2)
(396,431,2)
(15,109,2)
(253,773,2)
(507,109,2)
(329,510,2)
(175,696,2)
(235,101,2)
(577,773,2)
(610,702,2)
(145,703,2)
(109,681,2)
(145,17,2)
(771,773,2)
(115,129,2)
(138,406,2)
(558,470,2)
(543,773,2)
(204,10,2)
(287,118,2)
(415,439,2)
(33,109,2)
(744,487,2)
(214,77,2)
(175,682,2)
(735,597,2)
(645,597,2)
(570,118,2)
(540,597,2)
(474,601,2)
(274,142,2)
(624,351,2)
(635,129,2)
(706,118,2)
(338,301,2)
(307,98,2)
(326,605,2)
(532,510,2)
(405,487,2)
(464,484,2)
(116,307,2)
(539,773,2)
(189,681,2)
(50,129,2)
(68,498,2)
(660,77,2)
(694,773,2)
(96,118,2)
(690,98,2)
(73,205,2)
(498,116,2)
(712,103,2)
(735,471,2)
(707,751,2)
(19,398,2)
(650,103,2)
(703,487,2)
(174,103,2)
(535,301,2)
(165,98,2)
(0,98,2)
(414,773,2)
(662,773,2)
(738,148,2)
(224,139,2)
(262,98,2)
(619,439,2)
(487,510,2)
(747,773,2)
(437,439,2)
(361,109,2)
(157,116,2)
(530,55,2)
(172,10,2)
(390,487,2)
(669,98,2)
(136,301,2)
(552,94,2)
(267,129,2)
(15,681,2)
(464,288,2)
(91,98,2)
(175,99,2)
(753,439,2)
(437,773,2)
(615,148,2)
(685,391,2)
(530,62,2)
(339,215,2)
(100,242,2)
(579,10,2)
-----------------------------------
(0,*(u_int16_t *)
(1,tempst.address)
(2,sstart)
(3,st)
(4,vsize)
(5,texchangesize)
(6,st)
(7,schemes)
(8,st)
(9,modsize = varpre2octets(p)
(10,st->texchange == NULL)
(11,icookie)
(12,sstart)
(13,header)
(14,mod)
(15,RESOURCE_LIMIT)
(16,tempst)
(17,st->uSPIoattrib)
(18,&tempst)
(19,varpre2octets(VALUE_REQUEST_VALUE(header)
(20,schemes)
(21,gen)
(22,bcopy(&header->counter, st->uSPITBV, 3)
(23,PACKET_BUFFER_SIZE)
(24,address)
(25,2)
(26,schemes + sstart)
(27,header)
(28,where)
(29,uSPIoattrib)
(30,sstart)
(31,strncpy(tempst.address, address, 15)
(32,rcookie)
(33,st)
(34,header->scheme)
(35,gen)
(36,header)
(37,st)
(38,if (modsize == vsize)
(39,roschemes)
(40,modpsize)
(41,2)
(42,bin2hex(buffer, &i, parts[0].where, varpre2octets(VALUE_REQUEST_VALUE(header)
(43,header)
(44,htons(scheme_get_ref(header->scheme)
(45,scheme_get_len(schemes+sstart)
(46,rcookie)
(47,if (modflag)
(48,modsize)
(49,st)
(50,&vr_msg)
(51,refp)
(52,tempst.port = global_port)
(53,)
(54,)
(55,sstart += scheme_get_len(schemes+sstart)
(56,sizeof(u_int8_t)
(57,goto resourcefail;)
(58,goto resourcefail;)
(59,3)
(60,(vsize-4)
(61,vsize)
(62,!bcmp(scheme_ref, schemes + sstart, 2)
(63,NULL)
(64,st)
(65,return (-1)
(66,NULL)
(67,i)
(68,BN_varpre2bn(modp, modpsize, mod)
(69,size)
(70,parts[0])
(71,genp)
(72,1)
(73,varpre2octets(modp)
(74,if (bcmp(rcookie, header->rcookie, COOKIE_SIZE)
(75,sizeof(u_int8_t)
(76,if (st->scheme == NULL)
(77,BN_varpre2bn(modp, modpsize, mod)
(78,exchange_check_value(test, gen, mod)
(79,tempst.icookie)
(80,BN_free(gen)
(81,test)
(82,0xFF)
(83,!exchange_check_value(test, gen, mod)
(84,st)
(85,schemesize)
(86,modpsize = modsize)
(87,gen)
(88,st == NULL)
(89,)
(90,goto resourcefail;)
(91,photuris_error_message(&tempst, packet_buffer, &packet_size,\n\\n\\t\\t\\t\\t\\t header->icookie, header->rcookie,\n\\n\\t\\t\\t\\t\\t header->counter, BAD_COOKIE)
(92,st)
(93,parts[1])
(94,varpre2octets(genp)
(95,schemes)
(96,st->shared)
(97,texchange)
(98,bcmp(rcookie, header->rcookie, COOKIE_SIZE)
(99,st->roschemes)
(100,(char *)
(101,u_int8_t *schemes)
(102,!bcmp(header->scheme, schemes + sstart, 2)
(103,genp != NULL)
(104,2)
(105,)
(106,parts[1])
(107,counter)
(108,RET)
(109,st->uSPIoattrib == NULL)
(110,)
(111,st->lifetime = exchange_timeout + time(NULL)
(112,)
(113,texchange)
(114,BN_free(mod)
(115,vr_msg)
(116,modsize == vsize)
(117,st->texchange)
(118,st = state_new()
(119,BN_new()
(120,modsize)
(121,scheme)
(122,st)
(123,scheme)
(124,sstart)
(125,header)
(126,0)
(127,vsize)
(128,size)
(129,size < VALUE_REQUEST_MIN)
(130,st->uSPITBV)
(131,modp)
(132,rcookie)
(133,st->oSPIoattrib)
(134,char *)
(135,NULL)
(136,return (-1)
(137,return (-1)
(138,exchange_set_generator(gen, header->scheme, genp)
(139,header->counter)
(140,where)
(141,1)
(142,char *address)
(143,2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)
(144,COOKIE_SIZE)
(145,return (0)
(146,header)
(147,15)
(148,BN_varpre2bn(parts[0].where, parts[0].size, test)
(149,st)
(150,)
(151,BUFFER_SIZE)
(152,break;)
(153,photuris_value_response(st, packet_buffer, &packet_size)
(154,log_print("bad packet structure in handle_value_request()
(155,refpsize)
(156,scheme_get_mod(schemes + sstart)
(157,schemes)
(158,state_find_cookies(address, header->icookie, header->rcookie)
(159,gen)
(160,2)
(161,packet_size)
(162,packet_buffer)
(163,schemes+sstart)
(164,return (-1)
(165,(u_int16_t *)
(166,st->sharedsize)
(167,st)
(168,st)
(169,st)
(170,genp == NULL)
(171,scheme)
(172,st->icookie)
(173,)
(174,st->scheme[2])
(175,return (-1)
(176,uSPIoattrib)
(177,sstart)
(178,parts)
(179,BN_free(gen)
(180,header)
(181,exchange_timeout)
(182,calloc(st->texchangesize, sizeof(u_int8_t)
(183,icookie)
(184,u_short port)
(185,header)
(186,where)
(187,header->rcookie)
(188,tempst)
(189,header->counter)
(190,NULL)
(191,bcopy(parts[0].where, st->texchange, st->texchangesize)
(192,st->schemesize)
(193,scheme)
(194,i = BUFFER_SIZE)
(195,parts[1].where)
(196,"Got exchange value 0x%s\\n")
(197,st->schemesize = vsize)
(198,st->texchange = calloc(st->texchangesize, sizeof(u_int8_t)
(199,0)
(200,header)
(201,st->roschemes = calloc(ssize, sizeof(u_int8_t)
(202,st)
(203,NULL)
(204,state_value_reset(st)
(205,modp = NULL)
(206,packet_buffer)
(207,u_int8_t)
(208,if (pick_attrib(st, &(st->oSPIoattrib)
(209,sstart)
(210,modp)
(211,ssize)
(212,tempst.port)
(213,header)
(214,gen)
(215,modflag)
(216,schemes)
(217,st)
(218,st)
(219,buffer)
(220,header)
(221,refp)
(222,if (BN_varpre2bn(modp, modpsize, mod)
(223,st->retries)
(224,st->counter = header->counter)
(225,header->counter)
(226,IPSEC_OPT_AUTH)
(227,2)
(228,i)
(229,vr_msg)
(230,st->counter)
(231,header)
(232,parts[0].where)
(233,refp != NULL)
(234,NULL)
(235,schemes + sstart)
(236,parts[1])
(237,u_int16_t *)
(238,state_value_reset(st)
(239,tempst.counter = header->counter)
(240,parts[0].where)
(241,genp)
(242,&tempst)
(243,bcopy(parts[1].where, st->uSPIoattrib, parts[1].size)
(244,-1)
(245,goto resourcefail;)
(246,ssize)
(247,port)
(248,p)
(249,st->oSPIoattribsize)
(250,sharedsize)
(251,sharedsize)
(252,sizeof(tempst)
(253,printf("Got exchange value 0x%s\\n", buffer)
(254,modsize)
(255,ssize)
(256,modflag)
(257,1)
(258,buffer)
(259,)
(260,1)
(261,*(u_int16_t *)
(262,parts[0])
(263,parts[0].size)
(264,test)
(265,parts)
(266,rcookie)
(267,1)
(268,if ((st = state_new()
(269,header)
(270,-1)
(271,if (!bcmp(header->scheme, schemes + sstart, 2)
(272,vr_msg)
(273,&i)
(274,strncpy(st->address, address, 15)
(275,u_int8_t)
(276,refpsize)
(277,flags)
(278,vsize)
(279,refpsize = modsize)
(280,IPSEC_OPT_ENC)
(281,0)
(282,state_value_reset(st)
(283,genp)
(284,parts)
(285,break;)
(286,u_int8_t)
(287,st->rcookie)
(288,&(st->oSPIoattrib)
(289,header)
(290,st->scheme[2] = (vsize-4)
(291,modsize)
(292,1)
(293,texchangesize)
(294,log_error("calloc()
(295,)
(296,st)
(297,&(st->shared)
(298,parts[0])
(299,modpsize)
(300,phase)
(301,sstart >= ssize)
(302,p)
(303,cookie_generate(&tempst, rcookie, COOKIE_SIZE, schemes, ssize)
(304,modp)
(305,modsize)
(306,parts[0])
(307,vsize = parts[0].size)
(308,-1)
(309,st)
(310,-1)
(311,tempst)
(312,if (photuris_value_response(st, packet_buffer, &packet_size)
(313,modpsize = refpsize)
(314,genp != NULL)
(315,header->icookie)
(316,st)
(317,modsize)
(318,tempst)
(319,0)
(320,)
(321,st->scheme)
(322,mod)
(323,header->rcookie)
(324,varpre2octets(p)
(325,sstart)
(326,bcmp(header->scheme, schemes + sstart, 2)
(327,test)
(328,)
(329,rcookie)
(330,struct value_request *)
(331,schemes)
(332,1)
(333,-1)
(334,1)
(335,BN_free(test)
(336,header)
(337,st->oSPIprivacyctx == NULL)
(338,BN_new()
(339,modp = p)
(340,-1)
(341,1)
(342,8)
(343,modflag = 0)
(344,)
(345,test)
(346,test)
(347,NULL)
(348,st)
(349,st->oSPIprivacyctx)
(350,return (0)
(351,BN_new()
(352,)
(353,"calloc()
(354,parts[0].size)
(355,uSPIoattribsize)
(356,&packet_size)
(357,refp)
(358,shared)
(359,mod)
(360,rcookie)
(361,scheme)
(362,st)
(363,sstart)
(364,state_new()
(365,st)
(366,)
(367,"calloc()
(368,st)
(369,st->texchangesize = parts[0].size)
(370,st->uSPIoattribsize)
(371,bzero((char *)
(372,)
(373,oSPIprivacyctx)
(374,address)
(375,header->scheme)
(376,header)
(377,&packet_size)
(378,tempst.initiator = 0)
(379,packet_buffer)
(380,packet_size)
(381,genp)
(382,parts[1].size)
(383,)
(384,modsize)
(385,st)
(386,st->scheme)
(387,&packet_size)
(388,exchange_set_generator(gen, header->scheme, genp)
(389,st->scheme)
(390,shared)
(391,tempst.counter)
(392,st->uSPIoattrib)
(393,2)
(394,NULL)
(395,p)
(396,0)
(397,parts[1])
(398,VALUE_REQUEST_VALUE(header)
(399,modp = refp)
(400,)
(401,header->counter)
(402,st)
(403,header)
(404,IPSEC_OPT_ENC|IPSEC_OPT_AUTH)
(405,st->retries = 0)
(406,genp = scheme_get_gen(schemes + sstart)
(407,st)
(408,u_char *packet)
(409,packet_size)
(410,header->icookie)
(411,genp)
(412,(vsize-4)
(413,packet_size)
(414,scheme)
(415,header->icookie)
(416,header)
(417,2)
(418,icookie)
(419,calloc(parts[1].size, sizeof(u_int8_t)
(420,st)
(421,packet_size)
(422,bcopy(header->icookie, st->icookie, COOKIE_SIZE)
(423,st->roschemesize = ssize)
(424,test)
(425,vsize)
(426,refpsize)
(427,where)
(428,"bad packet structure in handle_value_request()
(429,modflag = 1)
(430,varpre2octets(genp)
(431,exchange_set_generator(gen, header->scheme, genp)
(432,BN_free(test)
(433,2)
(434,COOKIE_SIZE)
(435,genp)
(436,genp)
(437,header->scheme)
(438,st)
(439,header = (struct value_request *)
(440,0)
(441,st->sharedsize)
(442,1)
(443,-1)
(444,st)
(445,vsize-4)
(446,vsize = 2 + varpre2octets(modp)
(447,1)
(448,BN_free(mod)
(449,st)
(450,1)
(451,compute_shared_secret(st, &(st->shared)
(452,printf("Shared secret is: 0x%s\\n", buffer)
(453,modp)
(454,bin2hex(buffer, &i, st->shared, st->sharedsize)
(455,ssize)
(456,st)
(457,scheme)
(458,st)
(459,vsize)
(460,st)
(461,0)
(462,init_privacy_key(st, 1)
(463,st)
(464,pick_attrib(st, &(st->oSPIoattrib)
(465,parts[0])
(466,parts)
(467,tempst)
(468,&i)
(469,st->texchangesize)
(470,header->rcookie)
(471,tempst.initiator)
(472,st->flags = IPSEC_OPT_ENC|IPSEC_OPT_AUTH)
(473,vr_msg = {\n\\n\\t     "Value Request",\n\\n\\t     VALUE_REQUEST_MIN, 0, parts\n\\n\\t})
(474,exchange_timeout + time(NULL)
(475,send_packet()
(476,4)
(477,if (sstart >= ssize)
(478,packet_size = PACKET_BUFFER_SIZE)
(479,scheme_ref)
(480,BN_free(test)
(481,parts)
(482,varpre2octets(genp)
(483,counter)
(484,&(st->oSPIoattribsize)
(485,st)
(486,address)
(487,photuris_value_response(st, packet_buffer, &packet_size)
(488,address)
(489,)
(490,refp)
(491,st->scheme[3] = (vsize-4)
(492,goto resourcefail;)
(493,vsize += 2 + varpre2octets(genp)
(494,PACKET_BUFFER_SIZE)
(495,size)
(496,header)
(497,packet)
(498,modp = p)
(499,st)
(500,state_value_reset(st)
(501,)
(502,-1)
(503,mod)
(504,BUFFER_SIZE)
(505,if (st->texchange == NULL)
(506,header)
(507,modp)
(508,0)
(509,st->scheme+2+2)
(510,pick_attrib(st, &(st->oSPIoattrib)
(511,vsize)
(512,st->port)
(513,packet_size)
(514,header->counter)
(515,counter)
(516,2 + varpre2octets(modp)
(517,scheme)
(518,st)
(519,rcookie)
(520,texchange)
(521,retries)
(522,refp = p)
(523,2)
(524,st->port = port)
(525,)
(526,15)
(527,p = scheme_get_mod(schemes + sstart)
(528,vsize-4)
(529,bcopy(genp, st->scheme+2+2, varpre2octets(genp)
(530,schemes+sstart)
(531,mod)
(532,photuris_error_message(st, packet_buffer, &packet_size,\n\\n\\t\\t\\t       header->icookie, header->rcookie,\n\\n\\t\\t\\t       header->counter, RESOURCE_LIMIT)
(533,st->texchangesize)
(534,oSPIoattrib)
(535,size)
(536,modsize <= 2 && refp != NULL)
(537,bcopy(header->scheme, st->scheme, 2)
(538,PACKET_BUFFER_SIZE)
(539,st)
(540,counter)
(541,u_int16_t ssize)
(542,genp)
(543,genp)
(544,!bcmp(scheme_ref, schemes + sstart, 2)
(545,counter)
(546,parts)
(547,BAD_COOKIE)
(548,-1)
(549,st)
(550,modsize == vsize)
(551,sizeof(u_int8_t)
(552,2 + varpre2octets(genp)
(553,ssize)
(554,i)
(555,modp)
(556,modflag)
(557,counter)
(558,bcopy(header->rcookie, st->rcookie, COOKIE_SIZE)
(559,scheme_get_gen(schemes + sstart)
(560,header->rcookie)
(561,schemes)
(562,mod)
(563,scheme)
(564,size)
(565,icookie)
(566,VALUE_RESPONSE)
(567,parts)
(568,2 + varpre2octets(genp)
(569,header)
(570,st->texchange)
(571,0)
(572,0)
(573,st)
(574,1)
(575,st)
(576,packet)
(577,st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)
(578,packet_size = PACKET_BUFFER_SIZE)
(579,st->address)
(580,0)
(581,gen = BN_new()
(582,1)
(583,st->scheme)
(584,state_insert(st)
(585,genp = scheme_get_gen(schemes+sstart)
(586,)
(587,if (st == NULL)
(588,st->uSPIoattribsize = parts[1].size)
(589,uSPIoattrib)
(590,send_packet()
(591,st)
(592,size)
(593,st)
(594,break;)
(595,parts)
(596,int size)
(597,(st->roschemes = calloc(ssize, sizeof(u_int8_t)
(598,COOKIE_SIZE)
(599,if (packet_check(packet, size, &vr_msg)
(600,schemes + sstart)
(601,time(NULL)
(602,st)
(603,bcopy(header->icookie, tempst.icookie, COOKIE_SIZE)
(604,&tempst)
(605,sstart < ssize)
(606,)
(607,init_privacy_key(st, 0)
(608,modpsize)
(609,modp)
(610,bcopy(schemes, st->roschemes, ssize)
(611,schemes + sstart)
(612,st->scheme[3])
(613,NULL)
(614,tempst)
(615,modpsize)
(616,NULL)
(617,size)
(618,0)
(619,header->icookie)
(620,st->scheme)
(621,1)
(622,4)
(623,i)
(624,mod = BN_new()
(625,st)
(626,st->flags)
(627,bcmp(scheme_ref, schemes + sstart, 2)
(628,rcookie)
(629,modp)
(630,test = BN_new()
(631,p)
(632,st)
(633,-1)
(634,genp == NULL ? 0 : 2 + varpre2octets(genp)
(635,packet_check(packet, size, &vr_msg)
(636,i)
(637,)
(638,phase)
(639,scheme_get_ref(header->scheme)
(640,BN_varpre2bn(parts[0].where, parts[0].size, test)
(641,initiator)
(642,st->scheme = calloc(vsize, sizeof(u_int8_t)
(643,st)
(644,NULL)
(645,roschemesize)
(646,scheme_ref)
(647,parts[0].where)
(648,rcookie)
(649,COOKIE_SIZE)
(650,st->scheme)
(651,if (exchange_set_generator(gen, header->scheme, genp)
(652,calloc(vsize, sizeof(u_int8_t)
(653,if (BN_varpre2bn(parts[0].where, parts[0].size, test)
(654,VALUE_RESPONSE)
(655,NULL)
(656,BN_free(mod)
(657,if (st->oSPIprivacyctx == NULL)
(658,refp)
(659,while (sstart < ssize)
(660,-1)
(661,oSPIoattribsize)
(662,NULL)
(663,parts)
(664,if (st->uSPIoattrib == NULL)
(665,size)
(666,goto resourcefail;)
(667,sstart)
(668,VALUE_REQUEST_MIN)
(669,tempst)
(670,st)
(671,st->shared)
(672,sstart = 0)
(673,parts[1].size)
(674,i = BUFFER_SIZE)
(675,st->phase)
(676,port)
(677,return (-1)
(678,)
(679,send_packet()
(680,vsize)
(681,(st = state_new()
(682,st->lifetime)
(683,0)
(684,0)
(685,return 0;)
(686,st->phase = VALUE_RESPONSE)
(687,p)
(688,st)
(689,if (size < VALUE_REQUEST_MIN)
(690,icookie)
(691,st)
(692,p)
(693,test)
(694,bcopy(modp, st->scheme + 2 + (genp == NULL ? 0 : 2 + varpre2octets(genp)
(695,st->texchange)
(696,st->texchangesize)
(697,lifetime)
(698,st->phase != VALUE_RESPONSE)
(699,)
(700,sstart)
(701,gen)
(702,st->roschemes)
(703,st->phase)
(704,*genp = NULL)
(705,header->rcookie)
(706,st->scheme)
(707,st->uSPIoattrib)
(708,texchangesize)
(709,st)
(710,address)
(711,i)
(712,2+2)
(713,u_int8_t)
(714,global_port)
(715,test)
(716,1)
(717,&(st->sharedsize)
(718,NULL)
(719,0)
(720,st)
(721,(struct value_request *)
(722,scheme_ref)
(723,port)
(724,header)
(725,if (genp != NULL)
(726,modsize <= 2)
(727,if (genp != NULL)
(728,2)
(729,st->roschemesize)
(730,genp)
(731,st)
(732,tempst)
(733,modpsize = modsize)
(734,modpsize)
(735,return (0)
(736,mod)
(737,log_error("calloc()
(738,BN_free(test)
(739,roschemes)
(740,vsize)
(741,return (-1)
(742,modsize)
(743,parts[0])
(744,buffer)
(745,buffer)
(746,genp)
(747,state_value_reset(st)
(748,icookie)
(749,"Shared secret is: 0x%s\\n")
(750,ssize)
(751,st->uSPIoattrib = calloc(parts[1].size, sizeof(u_int8_t)
(752,1)
(753,header->scheme)
(754,scheme)
(755,scheme_get_gen(schemes+sstart)
(756,COOKIE_SIZE)
(757,NULL)
(758,genp)
(759,st = state_find_cookies(address, header->icookie, header->rcookie)
(760,resourcefail:)
(761,parts[0].size)
(762,uSPITBV)
(763,0)
(764,)
(765,sstart)
(766,header->icookie)
(767,modflag)
(768,calloc(ssize, sizeof(u_int8_t)
(769,scheme)
(770,3)
(771,packet_size = PACKET_BUFFER_SIZE)
(772,tempst)
(773,st->scheme == NULL)
(774,packet_check(packet, size, &vr_msg)
(775,counter)
(776,varpre2octets(modp)
(777,vsize)
(778,&header->counter)
(779,2)
(780,tempst)
(781,refp = modp = NULL)
(782,schemes)
(783,st)
(784,if ((st->roschemes = calloc(ssize, sizeof(u_int8_t)
(785,NULL)
(786,icookie)
(787,sizeof(u_int8_t)
(788,parts)
(789,parts[1].size)
(790,modp)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^