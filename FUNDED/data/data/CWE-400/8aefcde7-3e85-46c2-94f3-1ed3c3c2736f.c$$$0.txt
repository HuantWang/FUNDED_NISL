-----label-----
0
-----code-----
static int recv_data(int fd, uint8_t *buf, int len, bool oneshot, struct timeval *timeout)
{
	int ret = 0;
	int rcvd = 0;
	int flags = MSG_DONTWAIT;

#ifdef MSG_NOSIGNAL
	flags |= MSG_NOSIGNAL;
#endif

	while (rcvd < len) {
		/* Receive data. */
		ret = recv(fd, buf + rcvd, len - rcvd, flags);
		if (ret > 0) {
			rcvd += ret;
			/* One-shot recv() */
			if (oneshot) {
				return ret;
			} else {
				continue;
			}
		}
		/* Check for disconnected socket. */
		if (ret == 0) {
			return KNOT_ECONNREFUSED;
		}

		/* Check for no data available. */
		if (errno == EAGAIN || errno == EINTR) {
			/* Continue only if timeout didn't expire. */
			ret = wait_for_data(fd, timeout);
			if (ret > 0) {
				continue;
			} else {
				return KNOT_ETIMEOUT;
			}
		} else {
			return KNOT_ECONN;
		}
	}

	return rcvd;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
3,8
3,9
5,6
5,7
7,8
9,10
9,11
10,11
12,13
12,14
15,16
15,17
17,18
19,20
19,21
21,22
23,24
23,25
24,25
26,27
26,28
29,30
29,31
29,32
29,33
29,34
30,31
31,32
31,33
33,34
33,35
35,36
37,38
38,39
38,40
40,41
40,42
42,43
44,45
45,46
45,47
47,48
47,49
49,50
50,51
52,53
52,54
53,54
53,55
54,55
56,57
58,59
58,60
58,61
58,62
59,60
60,61
60,62
61,62
63,64
63,65
63,66
63,67
63,68
64,65
66,67
68,69
68,70
69,70
71,72
73,74
73,75
74,75
76,77
78,79
80,81
80,82
81,82
81,83
82,83
85,86
85,87
86,87
87,88
87,89
88,89
90,91
92,93
92,94
92,95
93,94
95,96
96,97
97,98
99,100
101,102
101,103
102,103
102,104
103,104
106,107
107,108
108,109
110,111
110,112
110,113
111,112
111,113
112,113
112,114
113,114
115,116
117,118
117,119
118,119
120,121
122,123
122,124
123,124
124,125
124,126
125,126
127,128
127,129
127,130
128,129
130,131
132,133
134,135
134,136
134,137
135,136
135,137
136,137
139,140
141,142
142,143
143,144
145,146
146,147
147,148
149,150
150,151
-----nextToken-----
2,4,6,8,11,13,14,16,18,20,22,25,27,28,32,34,36,39,41,43,46,48,51,55,57,62,65,67,70,72,75,77,79,83,84,89,91,94,98,100,104,105,109,114,116,119,121,126,129,131,133,137,138,140,144,148,151
-----computeFrom-----
53,54
53,55
60,61
60,62
68,69
68,70
73,74
73,75
81,82
81,83
87,88
87,89
102,103
102,104
111,112
111,113
112,113
112,114
117,118
117,119
124,125
124,126
135,136
135,137
-----guardedBy-----
83,98
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;IdExpression;Name;WhileStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;CompoundStatement;ReturnStatement;IdExpression;Name;CompoundStatement;ContinueStatement;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ReturnStatement;IdExpression;Name;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ContinueStatement;CompoundStatement;ReturnStatement;IdExpression;Name;CompoundStatement;ReturnStatement;IdExpression;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
static int recv_data(int fd, uint8_t *buf, int len, bool oneshot, struct timeval *timeout){	int ret = 0;	int rcvd = 0;	int flags = MSG_DONTWAIT;#ifdef MSG_NOSIGNAL	flags |= MSG_NOSIGNAL;#endif	while (rcvd < len) {		/* Receive data. */		ret = recv(fd, buf + rcvd, len - rcvd, flags);		if (ret > 0) {			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}		/* Check for disconnected socket. */		if (ret == 0) {			return KNOT_ECONNREFUSED;		}		/* Check for no data available. */		if (errno == EAGAIN || errno == EINTR) {			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		} else {			return KNOT_ECONN;		}	}	return rcvd;}
static int
recv_data(int fd, uint8_t *buf, int len, bool oneshot, struct timeval *timeout)
recv_data
int fd
int
fd
fd
uint8_t *buf
uint8_t
uint8_t
*buf
*
buf
int len
int
len
len
bool oneshot
bool
oneshot
oneshot
struct timeval *timeout
struct timeval
timeval
*timeout
*
timeout
{	int ret = 0;	int rcvd = 0;	int flags = MSG_DONTWAIT;#ifdef MSG_NOSIGNAL	flags |= MSG_NOSIGNAL;#endif	while (rcvd < len) {		/* Receive data. */		ret = recv(fd, buf + rcvd, len - rcvd, flags);		if (ret > 0) {			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}		/* Check for disconnected socket. */		if (ret == 0) {			return KNOT_ECONNREFUSED;		}		/* Check for no data available. */		if (errno == EAGAIN || errno == EINTR) {			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		} else {			return KNOT_ECONN;		}	}	return rcvd;}
int ret = 0;
int ret = 0;
int
ret = 0
ret
= 0
0
int rcvd = 0;
int rcvd = 0;
int
rcvd = 0
rcvd
= 0
0
int flags = MSG_DONTWAIT;
int flags = MSG_DONTWAIT;
int
flags = MSG_DONTWAIT
flags
= MSG_DONTWAIT
MSG_DONTWAIT
MSG_DONTWAIT
while (rcvd < len) {		/* Receive data. */		ret = recv(fd, buf + rcvd, len - rcvd, flags);		if (ret > 0) {			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}		/* Check for disconnected socket. */		if (ret == 0) {			return KNOT_ECONNREFUSED;		}		/* Check for no data available. */		if (errno == EAGAIN || errno == EINTR) {			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		} else {			return KNOT_ECONN;		}	}
rcvd < len
rcvd
rcvd
len
len
{		/* Receive data. */		ret = recv(fd, buf + rcvd, len - rcvd, flags);		if (ret > 0) {			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}		/* Check for disconnected socket. */		if (ret == 0) {			return KNOT_ECONNREFUSED;		}		/* Check for no data available. */		if (errno == EAGAIN || errno == EINTR) {			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		} else {			return KNOT_ECONN;		}	}
ret = recv(fd, buf + rcvd, len - rcvd, flags);
ret = recv(fd, buf + rcvd, len - rcvd, flags)
ret
ret
recv(fd, buf + rcvd, len - rcvd, flags)
recv
recv
fd
fd
buf + rcvd
buf
buf
rcvd
rcvd
len - rcvd
len
len
rcvd
rcvd
flags
flags
if (ret > 0) {			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}
ret > 0
ret
ret
0
{			rcvd += ret;			/* One-shot recv() */			if (oneshot) {				return ret;			} else {				continue;			}		}
rcvd += ret;
rcvd += ret
rcvd
rcvd
ret
ret
if (oneshot) {				return ret;			} else {				continue;			}
oneshot
oneshot
{				return ret;			}
return ret;
ret
ret
{				continue;			}
continue;
if (ret == 0) {			return KNOT_ECONNREFUSED;		}
ret == 0
ret
ret
0
{			return KNOT_ECONNREFUSED;		}
return KNOT_ECONNREFUSED;
KNOT_ECONNREFUSED
KNOT_ECONNREFUSED
if (errno == EAGAIN || errno == EINTR) {			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		} else {			return KNOT_ECONN;		}
errno == EAGAIN || errno == EINTR
errno == EAGAIN
errno
errno
EAGAIN
EAGAIN
errno == EINTR
errno
errno
EINTR
EINTR
{			/* Continue only if timeout didn't expire. */			ret = wait_for_data(fd, timeout);			if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}		}
ret = wait_for_data(fd, timeout);
ret = wait_for_data(fd, timeout)
ret
ret
wait_for_data(fd, timeout)
wait_for_data
wait_for_data
fd
fd
timeout
timeout
if (ret > 0) {				continue;			} else {				return KNOT_ETIMEOUT;			}
ret > 0
ret
ret
0
{				continue;			}
continue;
{				return KNOT_ETIMEOUT;			}
return KNOT_ETIMEOUT;
KNOT_ETIMEOUT
KNOT_ETIMEOUT
{			return KNOT_ECONN;		}
return KNOT_ECONN;
KNOT_ECONN
KNOT_ECONN
return rcvd;
rcvd
rcvd
-----joern-----
(55,80,0)
(1,57,0)
(85,75,0)
(57,1,0)
(69,0,0)
(41,19,0)
(80,38,0)
(68,10,0)
(56,49,0)
(16,10,0)
(10,59,0)
(1,7,0)
(16,17,0)
(84,0,0)
(58,11,0)
(34,59,0)
(36,0,0)
(49,20,0)
(15,20,0)
(35,40,0)
(85,38,0)
(76,75,0)
(62,17,0)
(28,85,0)
(75,59,0)
(4,12,0)
(27,13,0)
(38,57,0)
(71,59,0)
(46,49,0)
(20,49,0)
(45,35,0)
(20,63,0)
(54,13,0)
(23,1,0)
(49,7,0)
(30,32,0)
(1,80,0)
(76,1,0)
(36,59,0)
(33,37,0)
(31,66,0)
(48,81,0)
(17,5,0)
(17,57,0)
(22,59,0)
(76,38,0)
(24,57,0)
(77,57,0)
(80,6,0)
(38,37,0)
(1,36,0)
(10,38,0)
(76,39,0)
(21,24,0)
(38,38,0)
(60,58,0)
(74,32,0)
(14,35,0)
(53,75,0)
(70,26,0)
(2,4,0)
(19,59,0)
(8,36,0)
(25,20,0)
(3,72,0)
(67,24,0)
(66,57,0)
(61,76,0)
(73,38,0)
(80,1,0)
(79,63,0)
(83,1,0)
(86,3,0)
(9,85,0)
(29,13,0)
(40,32,0)
(64,66,0)
(85,39,0)
(82,38,0)
(57,13,0)
(16,3,0)
(1,76,0)
(44,80,0)
(43,75,0)
(38,75,0)
(42,36,0)
(0,59,0)
(18,76,0)
(32,40,0)
(16,58,0)
(80,75,0)
(10,75,0)
(16,4,0)
(47,25,0)
(65,25,0)
(52,19,0)
(51,59,0)
(49,50,0)
(40,35,0)
(4,2,1)
(80,75,1)
(40,35,1)
(85,39,1)
(61,80,1)
(85,9,1)
(64,31,1)
(68,85,1)
(49,56,1)
(1,7,1)
(38,38,1)
(76,75,1)
(48,78,1)
(76,38,1)
(9,28,1)
(49,7,1)
(28,70,1)
(10,75,1)
(17,57,1)
(1,76,1)
(70,25,1)
(57,1,1)
(56,46,1)
(42,8,1)
(77,85,1)
(16,58,1)
(49,50,1)
(45,24,1)
(62,78,1)
(76,39,1)
(73,82,1)
(3,86,1)
(80,6,1)
(15,40,1)
(18,61,1)
(36,0,1)
(55,83,1)
(75,43,1)
(38,75,1)
(76,18,1)
(80,38,1)
(19,52,1)
(30,35,1)
(65,47,1)
(17,62,1)
(69,84,1)
(67,66,1)
(83,77,1)
(16,10,1)
(24,21,1)
(16,4,1)
(2,40,1)
(38,57,1)
(31,57,1)
(35,14,1)
(1,80,1)
(78,38,1)
(36,42,1)
(38,73,1)
(10,38,1)
(44,55,1)
(1,36,1)
(10,68,1)
(8,0,1)
(60,24,1)
(85,75,1)
(24,57,1)
(74,30,1)
(85,38,1)
(47,20,1)
(25,65,1)
(43,53,1)
(86,25,1)
(66,64,1)
(52,41,1)
(20,49,1)
(46,15,1)
(53,19,1)
(58,60,1)
(21,67,1)
(0,69,1)
(16,17,1)
(14,45,1)
(25,20,1)
(80,44,1)
(66,57,1)
(32,74,1)
(23,76,1)
(84,75,1)
(40,32,1)
(82,66,1)
(28,48,1)
(1,23,1)
(16,3,1)
(28,36,1)
(76,38,2)
(40,35,2)
(76,75,2)
(70,25,2)
(49,40,2)
(2,40,2)
(61,85,2)
(10,38,2)
(28,25,2)
(57,85,2)
(1,36,2)
(24,57,2)
(38,57,2)
(17,57,2)
(25,40,2)
(85,25,2)
(38,66,2)
(38,75,2)
(9,25,2)
(67,66,2)
(4,40,2)
(40,32,2)
(20,49,2)
(82,66,2)
(86,25,2)
(62,78,2)
(10,85,2)
(49,50,2)
(16,17,2)
(10,75,2)
(16,4,2)
(68,85,2)
(25,20,2)
(80,75,2)
(74,35,2)
(48,78,2)
(1,85,2)
(32,35,2)
(85,39,2)
(21,66,2)
(57,1,2)
(16,3,2)
(80,38,2)
(3,25,2)
(55,85,2)
(58,24,2)
(23,85,2)
(47,40,2)
(66,57,2)
(15,40,2)
(83,85,2)
(44,85,2)
(76,85,2)
(30,35,2)
(40,24,2)
(60,24,2)
(78,66,2)
(9,78,2)
(66,85,2)
(14,24,2)
(1,7,2)
(80,6,2)
(85,78,2)
(77,85,2)
(85,38,2)
(80,85,2)
(20,40,2)
(36,0,2)
(49,7,2)
(45,24,2)
(38,38,2)
(31,85,2)
(46,40,2)
(16,10,2)
(18,85,2)
(1,80,2)
(16,58,2)
(24,66,2)
(17,78,2)
(1,76,2)
(64,85,2)
(73,66,2)
(85,75,2)
(28,78,2)
(76,39,2)
(35,24,2)
(56,40,2)
(65,40,2)
-----------------------------------
(0,flags = MSG_DONTWAIT)
(1,recv(fd, buf + rcvd, len - rcvd, flags)
(2,KNOT_ECONN)
(3,return KNOT_ETIMEOUT;)
(4,return KNOT_ECONN;)
(5,)
(6,uint8_t *buf)
(7,int fd)
(8,flags)
(9,len)
(10,return rcvd;)
(11,)
(12,)
(13,)
(14,EAGAIN)
(15,ret)
(16,RET)
(17,return ret;)
(18,rcvd)
(19,ret = 0)
(20,ret = wait_for_data(fd, timeout)
(21,0)
(22,flags)
(23,flags)
(24,ret == 0)
(25,ret > 0)
(26,)
(27,if (ret > 0)
(28,rcvd)
(29,if (errno == EAGAIN || errno == EINTR)
(30,errno)
(31,ret)
(32,errno == EINTR)
(33,if (oneshot)
(34,while (rcvd < len)
(35,errno == EAGAIN)
(36,flags |= MSG_NOSIGNAL)
(37,)
(38,rcvd += ret)
(39,int len)
(40,errno == EAGAIN || errno == EINTR)
(41,ret)
(42,MSG_NOSIGNAL)
(43,0)
(44,rcvd)
(45,errno)
(46,fd)
(47,ret)
(48,continue;)
(49,wait_for_data(fd, timeout)
(50,struct timeval *timeout)
(51,rcvd)
(52,0)
(53,rcvd)
(54,if (ret == 0)
(55,buf)
(56,timeout)
(57,ret = recv(fd, buf + rcvd, len - rcvd, flags)
(58,return KNOT_ECONNREFUSED;)
(59,)
(60,KNOT_ECONNREFUSED)
(61,len)
(62,ret)
(63,)
(64,0)
(65,0)
(66,ret > 0)
(67,ret)
(68,rcvd)
(69,MSG_DONTWAIT)
(70,continue;)
(71,ret)
(72,)
(73,ret)
(74,EINTR)
(75,rcvd = 0)
(76,len - rcvd)
(77,ret)
(78,oneshot)
(79,if (ret > 0)
(80,buf + rcvd)
(81,)
(82,rcvd)
(83,fd)
(84,flags)
(85,rcvd < len)
(86,KNOT_ETIMEOUT)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^