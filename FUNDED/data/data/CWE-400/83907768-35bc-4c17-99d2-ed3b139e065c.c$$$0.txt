-----label-----
1
-----code-----
static int
riemann_send(struct riemann_host *host, Msg const *msg)
{
	u_char *buffer;
	size_t  buffer_len;
	int status;

	pthread_mutex_lock (&host->lock);

	status = riemann_connect (host);
	if (status != 0)
	{
		pthread_mutex_unlock (&host->lock);
		return status;
	}

	buffer_len = msg__get_packed_size(msg);
	if (host->use_tcp)
		buffer_len += 4;

	buffer = malloc (buffer_len);
	if (buffer == NULL) {
		pthread_mutex_unlock (&host->lock);
		ERROR ("write_riemann plugin: malloc failed.");
		return ENOMEM;
	}
	memset (buffer, 0, buffer_len);

	if (host->use_tcp)
	{
		uint32_t length = htonl ((uint32_t) (buffer_len - 4));
		memcpy (buffer, &length, 4);
		msg__pack(msg, buffer + 4);
	}
	else
	{
		msg__pack(msg, buffer);
	}

	status = (int) swrite (host->s, buffer, buffer_len);
	if (status != 0)
	{
		char errbuf[1024];

		riemann_disconnect (host);
		pthread_mutex_unlock (&host->lock);

		ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",
				(host->node != NULL) ? host->node : RIEMANN_HOST,
				(host->service != NULL) ? host->service : RIEMANN_PORT,
				sstrerror (errno, errbuf, sizeof (errbuf)));
		sfree (buffer);
		return -1;
	}

	pthread_mutex_unlock (&host->lock);
	sfree (buffer);
	return 0;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
14,16
17,18
17,19
17,20
17,21
17,22
17,23
17,24
17,25
17,26
17,27
17,28
17,29
17,30
17,31
17,32
17,33
17,34
18,19
19,20
19,21
20,21
22,23
22,24
25,26
26,27
26,28
27,28
29,30
31,32
32,33
32,34
34,35
36,37
37,38
37,39
38,39
40,41
41,42
41,43
42,43
45,46
46,47
46,48
47,48
49,50
49,51
50,51
52,53
54,55
54,56
55,56
55,57
56,57
59,60
59,61
60,61
61,62
61,63
62,63
64,65
65,66
65,67
66,67
69,70
70,71
72,73
73,74
73,75
74,75
76,77
76,78
77,78
79,80
81,82
81,83
82,83
82,84
83,84
86,87
87,88
87,89
88,89
91,92
92,93
92,94
93,94
95,96
95,97
96,97
98,99
100,101
100,102
101,102
101,103
102,103
104,105
106,107
106,108
106,109
107,108
108,109
108,110
109,110
111,112
112,113
112,114
113,114
116,117
117,118
117,119
118,119
121,122
122,123
124,125
125,126
125,127
125,128
125,129
126,127
128,129
131,132
133,134
133,135
133,136
134,135
134,136
135,136
138,139
138,140
138,141
139,140
140,141
140,142
141,142
143,144
143,145
145,146
146,147
146,148
147,148
149,150
149,151
150,151
151,152
153,154
153,155
154,155
157,158
158,159
158,160
158,161
158,162
159,160
161,162
163,164
164,165
167,168
168,169
168,170
168,171
169,170
171,172
173,174
173,175
174,175
177,178
178,179
179,180
179,181
179,182
180,181
182,183
184,185
186,187
187,188
187,189
188,189
190,191
190,192
191,192
191,193
194,195
194,196
194,197
194,198
195,196
197,198
197,199
198,199
201,202
203,204
205,206
205,207
206,207
206,208
207,208
210,211
210,212
210,213
210,214
210,215
210,216
211,212
212,213
212,214
214,215
214,216
216,217
218,219
219,220
219,221
220,221
222,223
224,225
225,226
225,227
226,227
228,229
229,230
229,231
230,231
233,234
234,235
234,236
234,237
234,238
234,239
235,236
238,239
238,240
238,241
239,240
240,241
240,242
241,242
241,243
242,243
245,246
247,248
247,249
248,249
251,252
253,254
253,255
253,256
254,255
255,256
255,257
256,257
256,258
257,258
260,261
262,263
262,264
263,264
266,267
268,269
268,270
268,271
268,272
269,270
271,272
273,274
275,276
276,277
277,278
279,280
280,281
280,282
281,282
283,284
285,286
286,287
288,289
289,290
289,291
290,291
292,293
293,294
293,295
294,295
297,298
298,299
298,300
299,300
301,302
303,304
-----nextToken-----
2,4,7,9,10,13,15,16,21,23,24,28,30,33,35,39,43,44,48,51,53,57,58,63,67,68,71,75,78,80,84,85,89,90,94,97,99,103,105,110,114,115,119,120,123,127,129,130,132,136,137,142,144,148,152,155,156,160,162,165,166,170,172,175,176,181,183,185,189,192,193,196,199,200,202,204,208,209,213,215,217,221,223,227,231,232,236,237,243,244,246,249,250,252,258,259,261,264,265,267,270,272,274,278,282,284,287,291,295,296,300,302,304
-----computeFrom-----
46,47
46,48
55,56
55,57
73,74
73,75
87,88
87,89
92,93
92,94
101,102
101,103
153,154
153,155
173,174
173,175
187,188
187,189
206,207
206,208
240,241
240,242
255,256
255,257
-----guardedBy-----
57,71
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ReturnStatement;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IfStatement;FieldReference;IdExpression;Name;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;FunctionCallExpression;UnaryExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ConditionalExpression;UnaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ConditionalExpression;UnaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;LiteralExpression;
-----ast_node-----
static intriemann_send(struct riemann_host *host, Msg const *msg){	u_char *buffer;	size_t  buffer_len;	int status;	pthread_mutex_lock (&host->lock);	status = riemann_connect (host);	if (status != 0)	{		pthread_mutex_unlock (&host->lock);		return status;	}	buffer_len = msg__get_packed_size(msg);	if (host->use_tcp)		buffer_len += 4;	buffer = malloc (buffer_len);	if (buffer == NULL) {		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: malloc failed.");		return ENOMEM;	}	memset (buffer, 0, buffer_len);	if (host->use_tcp)	{		uint32_t length = htonl ((uint32_t) (buffer_len - 4));		memcpy (buffer, &length, 4);		msg__pack(msg, buffer + 4);	}	else	{		msg__pack(msg, buffer);	}	status = (int) swrite (host->s, buffer, buffer_len);	if (status != 0)	{		char errbuf[1024];		riemann_disconnect (host);		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)));		sfree (buffer);		return -1;	}	pthread_mutex_unlock (&host->lock);	sfree (buffer);	return 0;}
static int
riemann_send(struct riemann_host *host, Msg const *msg)
riemann_send
struct riemann_host *host
struct riemann_host
riemann_host
*host
*
host
Msg const *msg
Msg const
Msg
*msg
*
msg
{	u_char *buffer;	size_t  buffer_len;	int status;	pthread_mutex_lock (&host->lock);	status = riemann_connect (host);	if (status != 0)	{		pthread_mutex_unlock (&host->lock);		return status;	}	buffer_len = msg__get_packed_size(msg);	if (host->use_tcp)		buffer_len += 4;	buffer = malloc (buffer_len);	if (buffer == NULL) {		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: malloc failed.");		return ENOMEM;	}	memset (buffer, 0, buffer_len);	if (host->use_tcp)	{		uint32_t length = htonl ((uint32_t) (buffer_len - 4));		memcpy (buffer, &length, 4);		msg__pack(msg, buffer + 4);	}	else	{		msg__pack(msg, buffer);	}	status = (int) swrite (host->s, buffer, buffer_len);	if (status != 0)	{		char errbuf[1024];		riemann_disconnect (host);		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)));		sfree (buffer);		return -1;	}	pthread_mutex_unlock (&host->lock);	sfree (buffer);	return 0;}
u_char *buffer;
u_char *buffer;
u_char
u_char
*buffer
*
buffer
size_t  buffer_len;
size_t  buffer_len;
size_t
size_t
buffer_len
buffer_len
int status;
int status;
int
status
status
pthread_mutex_lock (&host->lock);
pthread_mutex_lock (&host->lock)
pthread_mutex_lock
pthread_mutex_lock
&host->lock
host->lock
host
host
lock
status = riemann_connect (host);
status = riemann_connect (host)
status
status
riemann_connect (host)
riemann_connect
riemann_connect
host
host
if (status != 0)	{		pthread_mutex_unlock (&host->lock);		return status;	}
status != 0
status
status
0
{		pthread_mutex_unlock (&host->lock);		return status;	}
pthread_mutex_unlock (&host->lock);
pthread_mutex_unlock (&host->lock)
pthread_mutex_unlock
pthread_mutex_unlock
&host->lock
host->lock
host
host
lock
return status;
status
status
buffer_len = msg__get_packed_size(msg);
buffer_len = msg__get_packed_size(msg)
buffer_len
buffer_len
msg__get_packed_size(msg)
msg__get_packed_size
msg__get_packed_size
msg
msg
if (host->use_tcp)		buffer_len += 4;
host->use_tcp
host
host
use_tcp
buffer_len += 4;
buffer_len += 4
buffer_len
buffer_len
4
buffer = malloc (buffer_len);
buffer = malloc (buffer_len)
buffer
buffer
malloc (buffer_len)
malloc
malloc
buffer_len
buffer_len
if (buffer == NULL) {		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: malloc failed.");		return ENOMEM;	}
buffer == NULL
buffer
buffer
NULL
NULL
{		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: malloc failed.");		return ENOMEM;	}
pthread_mutex_unlock (&host->lock);
pthread_mutex_unlock (&host->lock)
pthread_mutex_unlock
pthread_mutex_unlock
&host->lock
host->lock
host
host
lock
ERROR ("write_riemann plugin: malloc failed.");
ERROR ("write_riemann plugin: malloc failed.")
ERROR
ERROR
"write_riemann plugin: malloc failed."
return ENOMEM;
ENOMEM
ENOMEM
memset (buffer, 0, buffer_len);
memset (buffer, 0, buffer_len)
memset
memset
buffer
buffer
0
buffer_len
buffer_len
if (host->use_tcp)	{		uint32_t length = htonl ((uint32_t) (buffer_len - 4));		memcpy (buffer, &length, 4);		msg__pack(msg, buffer + 4);	}	else	{		msg__pack(msg, buffer);	}
host->use_tcp
host
host
use_tcp
{		uint32_t length = htonl ((uint32_t) (buffer_len - 4));		memcpy (buffer, &length, 4);		msg__pack(msg, buffer + 4);	}
uint32_t length = htonl ((uint32_t) (buffer_len - 4));
uint32_t length = htonl ((uint32_t) (buffer_len - 4));
uint32_t
uint32_t
length = htonl ((uint32_t) (buffer_len - 4))
length
= htonl ((uint32_t) (buffer_len - 4))
htonl ((uint32_t) (buffer_len - 4))
htonl
htonl
(uint32_t) (buffer_len - 4)
(uint32_t)
uint32_t
uint32_t
buffer_len - 4
buffer_len
buffer_len
4
memcpy (buffer, &length, 4);
memcpy (buffer, &length, 4)
memcpy
memcpy
buffer
buffer
&length
length
length
4
msg__pack(msg, buffer + 4);
msg__pack(msg, buffer + 4)
msg__pack
msg__pack
msg
msg
buffer + 4
buffer
buffer
4
{		msg__pack(msg, buffer);	}
msg__pack(msg, buffer);
msg__pack(msg, buffer)
msg__pack
msg__pack
msg
msg
buffer
buffer
status = (int) swrite (host->s, buffer, buffer_len);
status = (int) swrite (host->s, buffer, buffer_len)
status
status
(int) swrite (host->s, buffer, buffer_len)
int
int

swrite (host->s, buffer, buffer_len)
swrite
swrite
host->s
host
host
s
buffer
buffer
buffer_len
buffer_len
if (status != 0)	{		char errbuf[1024];		riemann_disconnect (host);		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)));		sfree (buffer);		return -1;	}
status != 0
status
status
0
{		char errbuf[1024];		riemann_disconnect (host);		pthread_mutex_unlock (&host->lock);		ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)));		sfree (buffer);		return -1;	}
char errbuf[1024];
char errbuf[1024];
char
errbuf[1024]
errbuf
[1024]
1024
riemann_disconnect (host);
riemann_disconnect (host)
riemann_disconnect
riemann_disconnect
host
host
pthread_mutex_unlock (&host->lock);
pthread_mutex_unlock (&host->lock)
pthread_mutex_unlock
pthread_mutex_unlock
&host->lock
host->lock
host
host
lock
ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)));
ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",				(host->node != NULL) ? host->node : RIEMANN_HOST,				(host->service != NULL) ? host->service : RIEMANN_PORT,				sstrerror (errno, errbuf, sizeof (errbuf)))
ERROR
ERROR
"write_riemann plugin: Sending to Riemann at %s:%s failed: %s"
(host->node != NULL) ? host->node : RIEMANN_HOST
(host->node != NULL)
host->node != NULL
host->node
host
host
node
NULL
NULL
host->node
host
host
node
RIEMANN_HOST
RIEMANN_HOST
(host->service != NULL) ? host->service : RIEMANN_PORT
(host->service != NULL)
host->service != NULL
host->service
host
host
service
NULL
NULL
host->service
host
host
service
RIEMANN_PORT
RIEMANN_PORT
sstrerror (errno, errbuf, sizeof (errbuf))
sstrerror
sstrerror
errno
errno
errbuf
errbuf
sizeof (errbuf)
(errbuf)
errbuf
errbuf
sfree (buffer);
sfree (buffer)
sfree
sfree
buffer
buffer
return -1;
-1
1
pthread_mutex_unlock (&host->lock);
pthread_mutex_unlock (&host->lock)
pthread_mutex_unlock
pthread_mutex_unlock
&host->lock
host->lock
host
host
lock
sfree (buffer);
sfree (buffer)
sfree
sfree
buffer
buffer
return 0;
0
-----joern-----
(142,91,0)
(123,120,0)
(100,42,0)
(139,69,0)
(101,45,0)
(112,139,0)
(115,32,0)
(47,150,0)
(133,149,0)
(33,50,0)
(87,71,0)
(66,124,0)
(46,69,0)
(55,91,0)
(53,1,0)
(8,91,0)
(125,69,0)
(148,61,0)
(147,81,0)
(50,18,0)
(25,63,0)
(39,114,0)
(50,90,0)
(42,126,0)
(39,1,0)
(62,150,0)
(102,106,0)
(30,2,0)
(146,69,0)
(11,86,0)
(91,54,0)
(76,69,0)
(48,16,0)
(81,149,0)
(117,112,0)
(129,107,0)
(63,124,0)
(92,69,0)
(148,69,0)
(79,60,0)
(113,74,0)
(127,149,0)
(111,108,0)
(46,47,0)
(71,69,0)
(10,119,0)
(109,106,0)
(95,98,0)
(16,48,0)
(2,150,0)
(68,150,0)
(7,67,0)
(6,82,0)
(108,119,0)
(18,83,0)
(60,83,0)
(88,101,0)
(17,126,0)
(26,120,0)
(1,126,0)
(151,69,0)
(20,68,0)
(77,61,0)
(97,120,0)
(71,87,0)
(32,86,0)
(99,139,0)
(74,69,0)
(108,98,0)
(19,119,0)
(16,47,0)
(47,16,0)
(16,110,0)
(122,124,0)
(63,150,0)
(136,46,0)
(15,34,0)
(1,52,0)
(2,83,0)
(18,32,0)
(75,82,0)
(18,50,0)
(32,115,0)
(130,71,0)
(47,54,0)
(56,62,0)
(96,51,0)
(140,115,0)
(150,133,0)
(27,87,0)
(15,5,0)
(63,25,0)
(135,118,0)
(36,149,0)
(139,112,0)
(64,50,0)
(40,92,0)
(90,50,0)
(81,54,0)
(146,7,0)
(137,79,0)
(12,63,0)
(51,66,0)
(81,5,0)
(82,48,0)
(67,7,0)
(115,74,0)
(150,120,0)
(65,5,0)
(118,116,0)
(128,54,0)
(78,114,0)
(126,120,0)
(92,40,0)
(133,150,0)
(23,46,0)
(47,149,0)
(141,25,0)
(73,133,0)
(98,108,0)
(24,40,0)
(36,116,0)
(28,47,0)
(24,45,0)
(61,148,0)
(61,77,0)
(13,150,0)
(22,47,0)
(41,151,0)
(51,150,0)
(94,83,0)
(18,108,0)
(89,86,0)
(104,34,0)
(126,42,0)
(77,120,0)
(43,92,0)
(106,69,0)
(39,107,0)
(66,51,0)
(84,120,0)
(118,31,0)
(105,18,0)
(34,15,0)
(138,17,0)
(34,124,0)
(119,108,0)
(32,18,0)
(48,120,0)
(110,16,0)
(29,126,0)
(143,148,0)
(93,36,0)
(58,32,0)
(149,36,0)
(144,71,0)
(80,66,0)
(74,115,0)
(54,149,0)
(39,60,0)
(66,116,0)
(86,69,0)
(133,54,0)
(91,120,0)
(72,120,0)
(47,46,0)
(21,120,0)
(42,69,0)
(5,15,0)
(44,74,0)
(98,151,0)
(5,81,0)
(134,146,0)
(86,32,0)
(152,48,0)
(7,146,0)
(5,65,0)
(112,117,0)
(118,150,0)
(145,92,0)
(49,76,0)
(107,45,0)
(0,139,0)
(108,18,0)
(14,90,0)
(103,120,0)
(149,120,0)
(35,151,0)
(38,125,0)
(121,81,0)
(57,118,0)
(27,52,0)
(68,120,0)
(67,83,0)
(85,63,0)
(117,120,0)
(59,54,0)
(37,120,0)
(119,69,0)
(9,51,0)
(91,150,0)
(4,76,0)
(25,34,0)
(3,146,0)
(91,149,0)
(151,98,0)
(131,148,0)
(40,24,0)
(125,83,0)
(132,62,0)
(70,17,0)
(87,27,0)
(114,120,0)
(43,62,1)
(145,43,1)
(30,18,1)
(47,46,1)
(134,125,1)
(91,150,1)
(76,4,1)
(82,48,1)
(90,14,1)
(99,82,1)
(23,136,1)
(50,90,1)
(91,54,1)
(16,110,1)
(81,149,1)
(18,50,1)
(133,149,1)
(22,28,1)
(104,106,1)
(36,116,1)
(133,54,1)
(42,100,1)
(118,57,1)
(112,139,1)
(82,6,1)
(36,93,1)
(76,69,1)
(98,95,1)
(1,53,1)
(73,13,1)
(130,144,1)
(119,19,1)
(135,106,1)
(106,109,1)
(5,65,1)
(47,54,1)
(139,0,1)
(18,32,1)
(87,71,1)
(4,49,1)
(67,7,1)
(63,12,1)
(34,15,1)
(75,48,1)
(114,78,1)
(151,69,1)
(3,134,1)
(133,73,1)
(71,130,1)
(63,150,1)
(93,127,1)
(54,149,1)
(17,70,1)
(49,149,1)
(92,69,1)
(119,69,1)
(24,40,1)
(46,69,1)
(129,101,1)
(151,41,1)
(81,121,1)
(59,128,1)
(63,25,1)
(58,115,1)
(19,10,1)
(147,104,1)
(68,150,1)
(14,64,1)
(12,25,1)
(41,35,1)
(18,108,1)
(91,149,1)
(92,145,1)
(39,107,1)
(91,142,1)
(5,81,1)
(152,118,1)
(29,77,1)
(152,66,1)
(107,129,1)
(16,47,1)
(95,151,1)
(66,116,1)
(64,33,1)
(0,99,1)
(33,32,1)
(47,22,1)
(47,149,1)
(61,148,1)
(28,46,1)
(118,150,1)
(78,68,1)
(60,79,1)
(11,89,1)
(40,92,1)
(57,135,1)
(46,23,1)
(126,42,1)
(68,20,1)
(108,98,1)
(13,76,1)
(47,150,1)
(79,137,1)
(150,133,1)
(62,132,1)
(138,126,1)
(142,55,1)
(7,146,1)
(148,69,1)
(44,108,1)
(86,69,1)
(80,63,1)
(1,126,1)
(74,69,1)
(10,98,1)
(100,29,1)
(115,74,1)
(109,102,1)
(88,24,1)
(148,131,1)
(6,75,1)
(137,2,1)
(51,150,1)
(66,51,1)
(13,54,1)
(144,17,1)
(113,44,1)
(141,85,1)
(117,112,1)
(146,3,1)
(48,16,1)
(54,59,1)
(56,150,1)
(115,140,1)
(39,114,1)
(32,115,1)
(77,61,1)
(106,69,1)
(132,56,1)
(27,87,1)
(8,62,1)
(127,17,1)
(85,34,1)
(149,36,1)
(62,150,1)
(108,111,1)
(25,34,1)
(96,80,1)
(139,69,1)
(39,60,1)
(105,67,1)
(2,30,1)
(121,147,1)
(39,1,1)
(17,126,1)
(71,69,1)
(131,143,1)
(146,69,1)
(98,151,1)
(111,98,1)
(89,115,1)
(74,113,1)
(101,88,1)
(86,11,1)
(70,138,1)
(15,5,1)
(55,8,1)
(2,150,1)
(38,82,1)
(128,76,1)
(42,69,1)
(102,91,1)
(118,116,1)
(140,74,1)
(20,117,1)
(81,54,1)
(9,96,1)
(125,38,1)
(125,69,1)
(32,58,1)
(32,86,1)
(108,119,1)
(51,9,1)
(35,105,1)
(53,27,1)
(25,141,1)
(136,152,1)
(117,82,2)
(3,82,2)
(144,17,2)
(139,69,2)
(67,82,2)
(57,106,2)
(81,149,2)
(30,82,2)
(18,32,2)
(115,74,2)
(43,62,2)
(86,69,2)
(133,54,2)
(5,81,2)
(19,98,2)
(61,148,2)
(20,82,2)
(14,82,2)
(117,112,2)
(6,62,2)
(4,17,2)
(92,69,2)
(128,76,2)
(121,106,2)
(47,54,2)
(25,106,2)
(49,17,2)
(27,17,2)
(46,62,2)
(87,17,2)
(151,82,2)
(109,62,2)
(136,62,2)
(54,149,2)
(62,150,2)
(50,90,2)
(113,82,2)
(93,17,2)
(80,106,2)
(23,62,2)
(2,150,2)
(9,106,2)
(48,16,2)
(142,62,2)
(53,17,2)
(125,69,2)
(108,119,2)
(115,82,2)
(18,50,2)
(112,82,2)
(92,62,2)
(95,82,2)
(146,82,2)
(63,150,2)
(28,62,2)
(149,17,2)
(74,82,2)
(76,17,2)
(96,106,2)
(118,150,2)
(66,51,2)
(35,82,2)
(98,151,2)
(5,65,2)
(54,76,2)
(81,106,2)
(145,62,2)
(15,5,2)
(127,17,2)
(66,116,2)
(78,82,2)
(39,107,2)
(86,115,2)
(85,106,2)
(79,82,2)
(81,54,2)
(38,82,2)
(137,82,2)
(15,106,2)
(91,149,2)
(152,62,2)
(149,36,2)
(32,82,2)
(36,116,2)
(40,62,2)
(147,106,2)
(47,149,2)
(22,62,2)
(148,69,2)
(91,150,2)
(41,82,2)
(32,86,2)
(48,62,2)
(82,48,2)
(7,146,2)
(18,82,2)
(11,115,2)
(71,17,2)
(130,17,2)
(17,126,2)
(64,82,2)
(101,62,2)
(140,82,2)
(114,82,2)
(67,7,2)
(16,110,2)
(63,106,2)
(62,17,2)
(150,133,2)
(1,126,2)
(24,40,2)
(24,62,2)
(99,82,2)
(104,106,2)
(56,17,2)
(50,82,2)
(106,62,2)
(105,82,2)
(106,69,2)
(134,82,2)
(34,15,2)
(42,69,2)
(47,150,2)
(16,47,2)
(102,62,2)
(32,115,2)
(76,69,2)
(112,139,2)
(118,106,2)
(58,115,2)
(10,98,2)
(68,82,2)
(73,17,2)
(47,46,2)
(132,17,2)
(7,82,2)
(0,82,2)
(82,62,2)
(27,87,2)
(135,106,2)
(90,82,2)
(91,54,2)
(111,98,2)
(108,98,2)
(55,62,2)
(25,34,2)
(44,82,2)
(87,71,2)
(129,62,2)
(1,17,2)
(16,62,2)
(150,17,2)
(77,61,2)
(146,69,2)
(47,62,2)
(68,150,2)
(5,106,2)
(2,82,2)
(51,106,2)
(89,115,2)
(63,25,2)
(13,17,2)
(36,17,2)
(59,76,2)
(18,108,2)
(51,150,2)
(60,82,2)
(139,82,2)
(71,69,2)
(34,106,2)
(108,82,2)
(119,98,2)
(133,149,2)
(12,106,2)
(133,17,2)
(46,69,2)
(33,82,2)
(141,106,2)
(75,62,2)
(39,114,2)
(8,62,2)
(88,62,2)
(74,69,2)
(39,1,2)
(107,62,2)
(125,82,2)
(40,92,2)
(126,42,2)
(119,69,2)
(91,62,2)
(39,60,2)
(151,69,2)
(118,116,2)
(98,82,2)
(66,106,2)
-----------------------------------
(0,lock)
(1,return status;)
(2,sfree (buffer)
(3,lock)
(4,use_tcp)
(5,(uint32_t)
(6,0)
(7,&host->lock)
(8,buffer)
(9,4)
(10,host)
(11,service)
(12,4)
(13,buffer)
(14,errbuf)
(15,htonl ((uint32_t)
(16,(int)
(17,status != 0)
(18,ERROR ("write_riemann plugin: Sending to Riemann at %s:%s failed: %s",\n\\n\\t\\t\\t\\t(host->node != NULL)
(19,node)
(20,buffer)
(21,if (status != 0)
(22,buffer_len)
(23,s)
(24,pthread_mutex_unlock (&host->lock)
(25,&length)
(26,if (host->use_tcp)
(27,pthread_mutex_unlock (&host->lock)
(28,buffer)
(29,status)
(30,buffer)
(31,)
(32,(host->service != NULL)
(33,errno)
(34,length = htonl ((uint32_t)
(35,host)
(36,msg__get_packed_size(msg)
(37,buffer)
(38,host)
(39,RET)
(40,&host->lock)
(41,node)
(42,riemann_connect (host)
(43,host)
(44,host)
(45,)
(46,host->s)
(47,swrite (host->s, buffer, buffer_len)
(48,status = (int)
(49,host)
(50,sstrerror (errno, errbuf, sizeof (errbuf)
(51,buffer + 4)
(52,)
(53,status)
(54,buffer_len += 4)
(55,0)
(56,buffer)
(57,buffer)
(58,RIEMANN_PORT)
(59,4)
(60,return -1;)
(61,&host->lock)
(62,buffer == NULL)
(63,memcpy (buffer, &length, 4)
(64,errbuf)
(65,uint32_t)
(66,msg__pack(msg, buffer + 4)
(67,pthread_mutex_unlock (&host->lock)
(68,sfree (buffer)
(69,struct riemann_host *host)
(70,0)
(71,host->lock)
(72,if (buffer == NULL)
(73,buffer_len)
(74,host->service)
(75,status)
(76,host->use_tcp)
(77,pthread_mutex_lock (&host->lock)
(78,0)
(79,-1)
(80,msg)
(81,buffer_len - 4)
(82,status != 0)
(83,)
(84,if (host->use_tcp)
(85,buffer)
(86,host->service)
(87,&host->lock)
(88,"write_riemann plugin: malloc failed.")
(89,host)
(90,sizeof (errbuf)
(91,memset (buffer, 0, buffer_len)
(92,host->lock)
(93,msg)
(94,errbuf)
(95,NULL)
(96,buffer)
(97,buffer_len)
(98,host->node != NULL)
(99,host)
(100,host)
(101,ERROR ("write_riemann plugin: malloc failed.")
(102,host)
(103,if (status != 0)
(104,length)
(105,"write_riemann plugin: Sending to Riemann at %s:%s failed: %s")
(106,host->use_tcp)
(107,return ENOMEM;)
(108,(host->node != NULL)
(109,use_tcp)
(110,int)
(111,RIEMANN_HOST)
(112,&host->lock)
(113,service)
(114,return 0;)
(115,host->service != NULL)
(116,Msg const *msg)
(117,pthread_mutex_unlock (&host->lock)
(118,msg__pack(msg, buffer)
(119,host->node)
(120,)
(121,4)
(122,length)
(123,status)
(124,)
(125,riemann_disconnect (host)
(126,status = riemann_connect (host)
(127,buffer_len)
(128,buffer_len)
(129,ENOMEM)
(130,lock)
(131,lock)
(132,NULL)
(133,malloc (buffer_len)
(134,host)
(135,msg)
(136,host)
(137,1)
(138,status)
(139,host->lock)
(140,NULL)
(141,length)
(142,buffer_len)
(143,host)
(144,host)
(145,lock)
(146,host->lock)
(147,buffer_len)
(148,host->lock)
(149,buffer_len = msg__get_packed_size(msg)
(150,buffer = malloc (buffer_len)
(151,host->node)
(152,status)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^