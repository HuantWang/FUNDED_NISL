-----label-----
1
-----code-----
static void dump_instr(const char *lvl, struct pt_regs *regs)
{
	unsigned long addr = instruction_pointer(regs);
	const int thumb = thumb_mode(regs);
	const int width = thumb ? 4 : 8;
	mm_segment_t fs;
	char str[sizeof("00000000 ") * 5 + 2 + 1], *p = str;
	int i;

	/*
	 * We need to switch to kernel mode so that we can use __get_user
	 * to safely read from kernel space.  Note that we now dump the
	 * code first, just in case the backtrace kills us.
	 */
	fs = get_fs();
	set_fs(KERNEL_DS);

	for (i = -4; i < 1 + !!thumb; i++) {
		unsigned int val, bad;

		if (thumb)
			bad = __get_user(val, &((u16 *)addr)[i]);
		else
			bad = __get_user(val, &((u32 *)addr)[i]);

		if (!bad)
			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",
					width, val);
		else {
			p += sprintf(p, "bad PC value");
			break;
		}
	}
	printk("%sCode: %s\n", lvl, str);

	set_fs(fs);
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
5,6
5,7
7,8
7,9
10,11
10,12
11,12
13,14
13,15
16,17
16,18
16,19
16,20
16,21
16,22
16,23
16,24
16,25
16,26
16,27
17,18
18,19
18,20
20,21
20,22
22,23
23,24
23,25
24,25
26,27
28,29
29,30
29,31
31,32
31,33
33,34
34,35
34,36
35,36
37,38
39,40
40,41
40,42
42,43
42,44
44,45
45,46
45,47
45,48
46,47
50,51
51,52
51,53
52,53
54,55
56,57
57,58
57,59
57,60
59,60
59,61
61,62
62,63
62,64
63,64
63,65
64,65
64,66
65,66
66,67
71,72
71,73
71,74
74,75
75,76
77,78
78,79
78,80
80,81
82,83
83,84
83,85
84,85
86,87
87,88
89,90
90,91
90,92
91,92
93,94
94,95
96,97
96,98
96,99
96,100
97,98
98,99
98,100
99,100
101,102
103,104
103,105
104,105
106,107
106,108
108,109
109,110
110,111
112,113
113,114
115,116
115,117
115,118
116,117
117,118
117,119
117,120
119,120
121,122
123,124
123,125
123,126
124,125
126,127
127,128
127,129
128,129
130,131
130,132
130,133
131,132
133,134
135,136
136,137
136,138
137,138
138,139
138,140
139,140
139,141
140,141
142,143
144,145
146,147
148,149
149,150
149,151
150,151
152,153
152,154
152,155
153,154
155,156
157,158
158,159
158,160
159,160
160,161
160,162
161,162
161,163
162,163
164,165
166,167
168,169
170,171
170,172
170,173
171,172
172,173
174,175
175,176
175,177
176,177
178,179
178,180
178,181
178,182
178,183
179,180
181,182
183,184
183,185
183,186
184,185
184,186
185,186
190,191
192,193
194,195
194,196
195,196
196,197
196,198
197,198
199,200
199,201
199,202
200,201
202,203
206,207
207,208
207,209
207,210
207,211
208,209
211,212
213,214
215,216
216,217
216,218
217,218
219,220
-----nextToken-----
2,4,6,8,9,12,14,15,19,21,25,27,30,32,36,38,41,43,47,48,49,53,55,58,60,67,68,69,70,72,73,76,79,81,85,88,92,95,100,102,105,107,111,114,118,120,122,125,129,132,134,141,143,145,147,151,154,156,163,165,167,169,173,177,180,182,186,187,188,189,191,193,198,201,203,204,205,209,210,212,214,218,220
-----computeFrom-----
62,63
62,64
63,64
63,65
64,65
64,66
83,84
83,85
98,99
98,100
103,104
103,105
106,107
106,108
127,128
127,129
149,150
149,151
175,176
175,177
184,185
184,186
196,197
196,198
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;ConditionalExpression;IdExpression;Name;LiteralExpression;LiteralExpression;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;BinaryExpression;BinaryExpression;BinaryExpression;UnaryExpression;UnaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;LiteralExpression;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Declarator;Name;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;BinaryExpression;IdExpression;Name;BinaryExpression;LiteralExpression;UnaryExpression;UnaryExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;Declarator;Name;IfStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;ArraySubscriptExpression;UnaryExpression;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;ArraySubscriptExpression;UnaryExpression;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;IdExpression;Name;IfStatement;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ConditionalExpression;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;LiteralExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BreakStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
static void dump_instr(const char *lvl, struct pt_regs *regs){	unsigned long addr = instruction_pointer(regs);	const int thumb = thumb_mode(regs);	const int width = thumb ? 4 : 8;	mm_segment_t fs;	char str[sizeof("00000000 ") * 5 + 2 + 1], *p = str;	int i;	/*	 * We need to switch to kernel mode so that we can use __get_user	 * to safely read from kernel space.  Note that we now dump the	 * code first, just in case the backtrace kills us.	 */	fs = get_fs();	set_fs(KERNEL_DS);	for (i = -4; i < 1 + !!thumb; i++) {		unsigned int val, bad;		if (thumb)			bad = __get_user(val, &((u16 *)addr)[i]);		else			bad = __get_user(val, &((u32 *)addr)[i]);		if (!bad)			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);		else {			p += sprintf(p, "bad PC value");			break;		}	}	printk("%sCode: %s\n", lvl, str);	set_fs(fs);}
static void
dump_instr(const char *lvl, struct pt_regs *regs)
dump_instr
const char *lvl
const char
*lvl
*
lvl
struct pt_regs *regs
struct pt_regs
pt_regs
*regs
*
regs
{	unsigned long addr = instruction_pointer(regs);	const int thumb = thumb_mode(regs);	const int width = thumb ? 4 : 8;	mm_segment_t fs;	char str[sizeof("00000000 ") * 5 + 2 + 1], *p = str;	int i;	/*	 * We need to switch to kernel mode so that we can use __get_user	 * to safely read from kernel space.  Note that we now dump the	 * code first, just in case the backtrace kills us.	 */	fs = get_fs();	set_fs(KERNEL_DS);	for (i = -4; i < 1 + !!thumb; i++) {		unsigned int val, bad;		if (thumb)			bad = __get_user(val, &((u16 *)addr)[i]);		else			bad = __get_user(val, &((u32 *)addr)[i]);		if (!bad)			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);		else {			p += sprintf(p, "bad PC value");			break;		}	}	printk("%sCode: %s\n", lvl, str);	set_fs(fs);}
unsigned long addr = instruction_pointer(regs);
unsigned long addr = instruction_pointer(regs);
unsigned long
addr = instruction_pointer(regs)
addr
= instruction_pointer(regs)
instruction_pointer(regs)
instruction_pointer
instruction_pointer
regs
regs
const int thumb = thumb_mode(regs);
const int thumb = thumb_mode(regs);
const int
thumb = thumb_mode(regs)
thumb
= thumb_mode(regs)
thumb_mode(regs)
thumb_mode
thumb_mode
regs
regs
const int width = thumb ? 4 : 8;
const int width = thumb ? 4 : 8;
const int
width = thumb ? 4 : 8
width
= thumb ? 4 : 8
thumb ? 4 : 8
thumb
thumb
4
8
mm_segment_t fs;
mm_segment_t fs;
mm_segment_t
mm_segment_t
fs
fs
char str[sizeof("00000000 ") * 5 + 2 + 1], *p = str;
char str[sizeof("00000000 ") * 5 + 2 + 1], *p = str;
char
str[sizeof("00000000 ") * 5 + 2 + 1]
str
[sizeof("00000000 ") * 5 + 2 + 1]
sizeof("00000000 ") * 5 + 2 + 1
sizeof("00000000 ") * 5 + 2
sizeof("00000000 ") * 5
sizeof("00000000 ")
("00000000 ")
"00000000 "
5
2
1
*p = str
*
p
= str
str
str
int i;
int i;
int
i
i
fs = get_fs();
fs = get_fs()
fs
fs
get_fs()
get_fs
get_fs
set_fs(KERNEL_DS);
set_fs(KERNEL_DS);
set_fs
set_fs
(KERNEL_DS)
KERNEL_DS
KERNEL_DS
for (i = -4; i < 1 + !!thumb; i++) {		unsigned int val, bad;		if (thumb)			bad = __get_user(val, &((u16 *)addr)[i]);		else			bad = __get_user(val, &((u32 *)addr)[i]);		if (!bad)			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);		else {			p += sprintf(p, "bad PC value");			break;		}	}
i = -4;
i = -4
i
i
-4
4
i < 1 + !!thumb
i
i
1 + !!thumb
1
!!thumb
!thumb
thumb
thumb
i++
i
i
{		unsigned int val, bad;		if (thumb)			bad = __get_user(val, &((u16 *)addr)[i]);		else			bad = __get_user(val, &((u32 *)addr)[i]);		if (!bad)			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);		else {			p += sprintf(p, "bad PC value");			break;		}	}
unsigned int val, bad;
unsigned int val, bad;
unsigned int
val
val
bad
bad
if (thumb)			bad = __get_user(val, &((u16 *)addr)[i]);		else			bad = __get_user(val, &((u32 *)addr)[i]);
thumb
thumb
bad = __get_user(val, &((u16 *)addr)[i]);
bad = __get_user(val, &((u16 *)addr)[i])
bad
bad
__get_user(val, &((u16 *)addr)[i])
__get_user
__get_user
val
val
&((u16 *)addr)[i]
((u16 *)addr)[i]
((u16 *)addr)
(u16 *)addr
u16 *
u16
u16
*
*
addr
addr
i
i
bad = __get_user(val, &((u32 *)addr)[i]);
bad = __get_user(val, &((u32 *)addr)[i])
bad
bad
__get_user(val, &((u32 *)addr)[i])
__get_user
__get_user
val
val
&((u32 *)addr)[i]
((u32 *)addr)[i]
((u32 *)addr)
(u32 *)addr
u32 *
u32
u32
*
*
addr
addr
i
i
if (!bad)			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);		else {			p += sprintf(p, "bad PC value");			break;		}
!bad
bad
bad
p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val);
p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val)
p
p
sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",					width, val)
sprintf
sprintf
p
p
i == 0 ? "(%0*x) " : "%0*x "
i == 0
i
i
0
"(%0*x) "
"%0*x "
width
width
val
val
{			p += sprintf(p, "bad PC value");			break;		}
p += sprintf(p, "bad PC value");
p += sprintf(p, "bad PC value")
p
p
sprintf(p, "bad PC value")
sprintf
sprintf
p
p
"bad PC value"
break;
printk("%sCode: %s\n", lvl, str);
printk("%sCode: %s\n", lvl, str)
printk
printk
"%sCode: %s\n"
lvl
lvl
str
str
set_fs(fs);
set_fs(fs)
set_fs
set_fs
fs
fs
-----joern-----
(68,81,0)
(7,35,0)
(89,64,0)
(22,70,0)
(93,71,0)
(37,81,0)
(25,61,0)
(91,86,0)
(80,2,0)
(58,70,0)
(56,59,0)
(23,72,0)
(34,81,0)
(57,18,0)
(17,52,0)
(74,68,0)
(64,89,0)
(68,62,0)
(2,69,0)
(10,6,0)
(45,26,0)
(26,45,0)
(71,39,0)
(72,11,0)
(54,17,0)
(94,7,0)
(35,17,0)
(85,32,0)
(51,39,0)
(8,11,0)
(32,11,0)
(57,59,0)
(55,32,0)
(59,56,0)
(46,24,0)
(5,87,0)
(34,37,0)
(68,37,0)
(18,57,0)
(71,26,0)
(46,56,0)
(12,18,0)
(66,11,0)
(78,84,0)
(92,97,0)
(82,84,0)
(28,87,0)
(35,7,0)
(6,10,0)
(73,52,0)
(79,71,0)
(44,11,0)
(31,84,0)
(72,87,0)
(19,11,0)
(69,2,0)
(29,84,0)
(39,11,0)
(33,81,0)
(4,34,0)
(54,90,0)
(39,71,0)
(14,45,0)
(2,24,0)
(7,69,0)
(75,35,0)
(97,6,0)
(50,6,0)
(58,49,0)
(86,89,0)
(9,0,0)
(88,59,0)
(24,2,0)
(48,11,0)
(15,49,0)
(26,11,0)
(32,20,0)
(35,99,0)
(60,17,0)
(61,11,0)
(30,32,0)
(18,89,0)
(49,81,0)
(47,58,0)
(45,95,0)
(3,37,0)
(53,11,0)
(13,54,0)
(69,7,0)
(36,81,0)
(96,89,0)
(90,54,0)
(49,58,0)
(83,56,0)
(37,37,0)
(40,34,0)
(6,97,0)
(54,18,0)
(59,57,0)
(49,37,0)
(70,89,0)
(76,11,0)
(38,70,0)
(0,10,0)
(67,64,0)
(99,35,0)
(37,49,0)
(18,54,0)
(17,11,0)
(1,26,0)
(21,49,0)
(97,89,0)
(52,95,0)
(16,58,0)
(52,17,0)
(41,24,0)
(70,58,0)
(0,26,0)
(87,28,0)
(42,11,0)
(49,39,0)
(81,11,0)
(63,71,0)
(87,11,0)
(43,62,0)
(77,46,0)
(10,0,0)
(65,49,0)
(34,68,0)
(7,89,0)
(68,34,0)
(26,45,1)
(28,5,1)
(63,51,1)
(70,89,1)
(24,2,1)
(52,95,1)
(38,15,1)
(56,59,1)
(55,85,1)
(35,17,1)
(87,28,1)
(25,87,1)
(58,47,1)
(3,46,1)
(22,38,1)
(75,80,1)
(46,77,1)
(68,34,1)
(12,54,1)
(61,25,1)
(49,37,1)
(54,13,1)
(74,46,1)
(83,27,1)
(23,32,1)
(2,69,1)
(58,70,1)
(37,37,1)
(1,17,1)
(73,60,1)
(71,79,1)
(4,40,1)
(16,70,1)
(46,56,1)
(54,90,1)
(27,97,1)
(64,67,1)
(33,36,1)
(65,21,1)
(18,54,1)
(81,33,1)
(45,95,1)
(10,0,1)
(32,20,1)
(54,17,1)
(92,86,1)
(21,58,1)
(69,7,1)
(71,26,1)
(0,9,1)
(71,93,1)
(7,89,1)
(5,81,1)
(91,37,1)
(49,81,1)
(52,73,1)
(80,41,1)
(46,24,1)
(30,43,1)
(7,94,1)
(68,81,1)
(17,52,1)
(97,6,1)
(93,63,1)
(45,14,1)
(35,99,1)
(50,92,1)
(72,87,1)
(15,3,1)
(94,35,1)
(34,81,1)
(85,30,1)
(67,96,1)
(51,26,1)
(77,56,1)
(49,65,1)
(98,72,1)
(40,74,1)
(72,23,1)
(70,22,1)
(57,18,1)
(13,88,1)
(7,35,1)
(59,57,1)
(96,61,1)
(89,64,1)
(68,37,1)
(43,68,1)
(86,91,1)
(18,89,1)
(47,70,1)
(9,50,1)
(34,4,1)
(41,27,1)
(88,83,1)
(58,16,1)
(32,55,1)
(36,39,1)
(39,71,1)
(79,63,1)
(34,37,1)
(97,89,1)
(49,39,1)
(6,10,1)
(18,12,1)
(14,1,1)
(49,58,1)
(37,81,1)
(92,89,1)
(35,75,1)
(86,89,1)
(77,24,1)
(30,97,1)
(37,49,1)
(0,26,1)
(37,37,2)
(15,46,2)
(43,46,2)
(21,46,2)
(92,46,2)
(49,81,2)
(39,71,2)
(22,46,2)
(65,46,2)
(35,99,2)
(0,46,2)
(46,97,2)
(10,0,2)
(32,20,2)
(4,46,2)
(35,27,2)
(80,27,2)
(68,46,2)
(49,46,2)
(37,46,2)
(18,89,2)
(86,89,2)
(57,27,2)
(34,46,2)
(2,69,2)
(54,17,2)
(6,46,2)
(56,27,2)
(58,70,2)
(46,24,2)
(37,81,2)
(49,37,2)
(24,27,2)
(2,27,2)
(49,58,2)
(7,27,2)
(94,27,2)
(79,63,2)
(45,95,2)
(68,81,2)
(35,17,2)
(12,27,2)
(9,46,2)
(69,7,2)
(6,10,2)
(54,27,2)
(47,70,2)
(97,89,2)
(93,63,2)
(26,45,2)
(70,89,2)
(34,81,2)
(97,6,2)
(71,26,2)
(7,89,2)
(16,70,2)
(56,59,2)
(68,34,2)
(87,28,2)
(58,46,2)
(59,27,2)
(77,97,2)
(49,39,2)
(10,46,2)
(40,46,2)
(68,37,2)
(75,27,2)
(97,46,2)
(54,90,2)
(41,27,2)
(38,46,2)
(24,2,2)
(37,49,2)
(91,46,2)
(89,64,2)
(27,97,2)
(86,46,2)
(52,95,2)
(17,52,2)
(46,56,2)
(69,27,2)
(13,27,2)
(34,37,2)
(59,57,2)
(3,46,2)
(70,46,2)
(18,54,2)
(0,26,2)
(74,46,2)
(7,35,2)
(72,87,2)
(57,18,2)
(88,27,2)
(50,46,2)
(18,27,2)
(83,27,2)
-----------------------------------
(0,!thumb)
(1,thumb)
(2,__get_user(val, &((u16 *)
(3,p)
(4,"bad PC value")
(5,fs)
(6,1 + !!thumb)
(7,((u16 *)
(8,fs)
(9,thumb)
(10,!!thumb)
(11,)
(12,i)
(13,addr)
(14,regs)
(15,p)
(16,"(%0*x)
(17,addr = instruction_pointer(regs)
(18,((u32 *)
(19,p)
(20,const char *lvl)
(21,width)
(22,0)
(23,fs)
(24,bad = __get_user(val, &((u16 *)
(25,KERNEL_DS)
(26,thumb = thumb_mode(regs)
(27,thumb)
(28,get_fs()
(29,bad)
(30,"%sCode: %s\\n")
(31,if (!bad)
(32,printk("%sCode: %s\\n", lvl, str)
(33,str)
(34,sprintf(p, "bad PC value")
(35,(u16 *)
(36,p)
(37,p += sprintf(p, i == 0 ? "(%0*x)
(38,i)
(39,width = thumb ? 4 : 8)
(40,p)
(41,bad)
(42,thumb)
(43,break;)
(44,addr)
(45,thumb_mode(regs)
(46,!bad)
(47,"%0*x ")
(48,width)
(49,sprintf(p, i == 0 ? "(%0*x)
(50,1)
(51,width)
(52,instruction_pointer(regs)
(53,str)
(54,(u32 *)
(55,str)
(56,bad = __get_user(val, &((u32 *)
(57,&((u32 *)
(58,i == 0 ? "(%0*x)
(59,__get_user(val, &((u32 *)
(60,addr)
(61,set_fs(KERNEL_DS)
(62,)
(63,thumb)
(64,-4)
(65,val)
(66,for (i = -4; i < 1 + !!thumb; i++)
(67,4)
(68,p += sprintf(p, "bad PC value")
(69,&((u16 *)
(70,i == 0)
(71,thumb ? 4 : 8)
(72,set_fs(fs)
(73,regs)
(74,p)
(75,addr)
(76,i)
(77,bad)
(78,if (thumb)
(79,8)
(80,val)
(81,*p = str)
(82,val)
(83,bad)
(84,)
(85,lvl)
(86,i++)
(87,fs = get_fs()
(88,val)
(89,i = -4)
(90,u32 *)
(91,i)
(92,i)
(93,4)
(94,i)
(95,struct pt_regs *regs)
(96,i)
(97,i < 1 + !!thumb)
(98,RET)
(99,u16 *)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^