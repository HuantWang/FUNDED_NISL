-----label-----
0
-----code-----
static int gfs2_write_end(struct file *file, struct address_space *mapping,
			  loff_t pos, unsigned len, unsigned copied,
			  struct page *page, void *fsdata)
{
	struct inode *inode = page->mapping->host;
	struct gfs2_inode *ip = GFS2_I(inode);
	struct gfs2_sbd *sdp = GFS2_SB(inode);
	struct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);
	struct buffer_head *dibh;
	unsigned int from = pos & (PAGE_CACHE_SIZE - 1);
	unsigned int to = from + len;
	int ret;
	struct gfs2_trans *tr = current->journal_info;
	BUG_ON(!tr);

	BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl) == NULL);

	ret = gfs2_meta_inode_buffer(ip, &dibh);
	if (unlikely(ret)) {
		unlock_page(page);
		page_cache_release(page);
		goto failed;
	}

	if (gfs2_is_stuffed(ip))
		return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page);

	if (!gfs2_is_writeback(ip))
		gfs2_page_add_databufs(ip, page, from, to);

	ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata);
	if (tr->tr_num_buf_new)
		__mark_inode_dirty(inode, I_DIRTY_DATASYNC);
	else
		gfs2_trans_add_meta(ip->i_gl, dibh);


	if (inode == sdp->sd_rindex) {
		adjust_fs_space(inode);
		sdp->sd_rindex_uptodate = 0;
	}

	brelse(dibh);
failed:
	gfs2_trans_end(sdp);
	gfs2_inplace_release(ip);
	if (ip->i_qadata && ip->i_qadata->qa_qd_num)
		gfs2_quota_unlock(ip);
	if (inode == sdp->sd_rindex) {
		gfs2_glock_dq(&m_ip->i_gh);
		gfs2_holder_uninit(&m_ip->i_gh);
	}
	gfs2_glock_dq(&ip->i_gh);
	gfs2_holder_uninit(&ip->i_gh);
	return ret;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
3,8
3,9
3,10
3,11
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
14,16
17,18
17,19
18,19
20,21
22,23
22,24
24,25
26,27
26,28
28,29
30,31
30,32
31,32
33,34
33,35
36,37
36,38
38,39
38,40
41,42
41,43
41,44
41,45
41,46
41,47
41,48
41,49
41,50
41,51
41,52
41,53
41,54
41,55
41,56
41,57
41,58
41,59
41,60
41,61
41,62
41,63
41,64
41,65
41,66
41,67
42,43
43,44
43,45
44,45
46,47
46,48
46,49
49,50
50,51
50,52
51,52
51,53
52,53
56,57
57,58
57,59
58,59
60,61
60,62
60,63
63,64
64,65
64,66
65,66
67,68
69,70
70,71
70,72
71,72
73,74
73,75
73,76
76,77
77,78
77,79
78,79
80,81
82,83
83,84
83,85
84,85
86,87
86,88
86,89
89,90
90,91
90,92
91,92
93,94
93,95
94,95
97,98
98,99
98,100
99,100
101,102
101,103
104,105
105,106
105,107
107,108
107,109
109,110
110,111
110,112
111,112
113,114
114,115
114,116
115,116
118,119
119,120
119,121
121,122
121,123
123,124
124,125
124,126
125,126
127,128
129,130
130,131
130,132
132,133
134,135
135,136
135,137
136,137
138,139
138,140
138,141
141,142
142,143
142,144
143,144
146,147
147,148
147,149
148,149
150,151
151,152
153,154
154,155
154,156
155,156
157,158
157,159
158,159
158,160
159,160
161,162
161,163
162,163
165,166
167,168
168,169
168,170
169,170
171,172
171,173
171,174
172,173
174,175
176,177
177,178
179,180
179,181
180,181
180,182
181,182
183,184
185,186
185,187
185,188
186,187
187,188
187,189
188,189
190,191
192,193
193,194
193,195
194,195
196,197
198,199
200,201
200,202
201,202
201,203
202,203
204,205
206,207
207,208
207,209
207,210
207,211
207,212
207,213
207,214
208,209
210,211
212,213
214,215
216,217
218,219
220,221
222,223
222,224
223,224
224,225
224,226
225,226
227,228
229,230
230,231
230,232
230,233
230,234
230,235
231,232
233,234
235,236
237,238
239,240
241,242
242,243
242,244
243,244
245,246
245,247
245,248
245,249
245,250
245,251
245,252
245,253
246,247
248,249
250,251
252,253
254,255
256,257
258,259
260,261
262,263
262,264
262,265
263,264
263,265
264,265
267,268
268,269
268,270
268,271
269,270
271,272
273,274
275,276
276,277
276,278
276,279
277,278
279,280
279,281
280,281
283,284
285,286
285,287
286,287
286,288
287,288
289,290
289,291
290,291
293,294
293,295
294,295
295,296
295,297
296,297
298,299
300,301
301,302
301,303
302,303
302,304
303,304
307,308
308,309
308,310
309,310
311,312
313,314
313,315
315,316
316,317
316,318
317,318
319,320
321,322
322,323
322,324
323,324
325,326
327,328
327,329
328,329
328,330
329,330
329,331
330,331
333,334
333,335
334,335
334,336
335,336
339,340
340,341
340,342
341,342
343,344
345,346
345,347
346,347
346,348
347,348
349,350
349,351
350,351
353,354
353,355
354,355
355,356
355,357
356,357
358,359
359,360
359,361
360,361
363,364
364,365
364,366
365,366
367,368
368,369
368,370
369,370
372,373
373,374
373,375
374,375
376,377
377,378
377,379
378,379
381,382
382,383
382,384
383,384
385,386
386,387
386,388
387,388
390,391
391,392
-----nextToken-----
2,4,7,9,10,13,15,16,19,21,23,25,27,29,32,34,35,37,39,40,45,47,48,53,54,55,59,61,62,66,68,72,74,75,79,81,85,87,88,92,95,96,100,102,103,106,108,112,116,117,120,122,126,128,131,133,137,139,140,144,145,149,152,156,160,163,164,166,170,173,175,178,182,184,189,191,195,197,199,203,205,209,211,213,215,217,219,221,226,228,232,234,236,238,240,244,247,249,251,253,255,257,259,261,265,266,270,272,274,278,281,282,284,288,291,292,297,299,304,305,306,310,312,314,318,320,324,326,331,332,336,337,338,342,344,348,351,352,357,361,362,366,370,371,375,379,380,384,388,389,392
-----computeFrom-----
110,111
110,112
114,115
114,116
124,125
124,126
157,158
157,159
168,169
168,170
242,243
242,244
286,287
286,288
301,302
301,303
328,329
328,330
346,347
346,348
-----guardedBy-----
288,299
291,304
336,344
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;FieldReference;IdExpression;Name;Name;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;BinaryExpression;IdExpression;Name;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;BinaryExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;GotoStatement;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;UnaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LabelStatement;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;FieldReference;IdExpression;Name;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
static int gfs2_write_end(struct file *file, struct address_space *mapping,			  loff_t pos, unsigned len, unsigned copied,			  struct page *page, void *fsdata){	struct inode *inode = page->mapping->host;	struct gfs2_inode *ip = GFS2_I(inode);	struct gfs2_sbd *sdp = GFS2_SB(inode);	struct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);	struct buffer_head *dibh;	unsigned int from = pos & (PAGE_CACHE_SIZE - 1);	unsigned int to = from + len;	int ret;	struct gfs2_trans *tr = current->journal_info;	BUG_ON(!tr);	BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl) == NULL);	ret = gfs2_meta_inode_buffer(ip, &dibh);	if (unlikely(ret)) {		unlock_page(page);		page_cache_release(page);		goto failed;	}	if (gfs2_is_stuffed(ip))		return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page);	if (!gfs2_is_writeback(ip))		gfs2_page_add_databufs(ip, page, from, to);	ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata);	if (tr->tr_num_buf_new)		__mark_inode_dirty(inode, I_DIRTY_DATASYNC);	else		gfs2_trans_add_meta(ip->i_gl, dibh);	if (inode == sdp->sd_rindex) {		adjust_fs_space(inode);		sdp->sd_rindex_uptodate = 0;	}	brelse(dibh);failed:	gfs2_trans_end(sdp);	gfs2_inplace_release(ip);	if (ip->i_qadata && ip->i_qadata->qa_qd_num)		gfs2_quota_unlock(ip);	if (inode == sdp->sd_rindex) {		gfs2_glock_dq(&m_ip->i_gh);		gfs2_holder_uninit(&m_ip->i_gh);	}	gfs2_glock_dq(&ip->i_gh);	gfs2_holder_uninit(&ip->i_gh);	return ret;}
static int
gfs2_write_end(struct file *file, struct address_space *mapping,			  loff_t pos, unsigned len, unsigned copied,			  struct page *page, void *fsdata)
gfs2_write_end
struct file *file
struct file
file
*file
*
file
struct address_space *mapping
struct address_space
address_space
*mapping
*
mapping
loff_t pos
loff_t
loff_t
pos
pos
unsigned len
unsigned
len
len
unsigned copied
unsigned
copied
copied
struct page *page
struct page
page
*page
*
page
void *fsdata
void
*fsdata
*
fsdata
{	struct inode *inode = page->mapping->host;	struct gfs2_inode *ip = GFS2_I(inode);	struct gfs2_sbd *sdp = GFS2_SB(inode);	struct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);	struct buffer_head *dibh;	unsigned int from = pos & (PAGE_CACHE_SIZE - 1);	unsigned int to = from + len;	int ret;	struct gfs2_trans *tr = current->journal_info;	BUG_ON(!tr);	BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl) == NULL);	ret = gfs2_meta_inode_buffer(ip, &dibh);	if (unlikely(ret)) {		unlock_page(page);		page_cache_release(page);		goto failed;	}	if (gfs2_is_stuffed(ip))		return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page);	if (!gfs2_is_writeback(ip))		gfs2_page_add_databufs(ip, page, from, to);	ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata);	if (tr->tr_num_buf_new)		__mark_inode_dirty(inode, I_DIRTY_DATASYNC);	else		gfs2_trans_add_meta(ip->i_gl, dibh);	if (inode == sdp->sd_rindex) {		adjust_fs_space(inode);		sdp->sd_rindex_uptodate = 0;	}	brelse(dibh);failed:	gfs2_trans_end(sdp);	gfs2_inplace_release(ip);	if (ip->i_qadata && ip->i_qadata->qa_qd_num)		gfs2_quota_unlock(ip);	if (inode == sdp->sd_rindex) {		gfs2_glock_dq(&m_ip->i_gh);		gfs2_holder_uninit(&m_ip->i_gh);	}	gfs2_glock_dq(&ip->i_gh);	gfs2_holder_uninit(&ip->i_gh);	return ret;}
struct inode *inode = page->mapping->host;
struct inode *inode = page->mapping->host;
struct inode
inode
*inode = page->mapping->host
*
inode
= page->mapping->host
page->mapping->host
page->mapping
page
page
mapping
host
struct gfs2_inode *ip = GFS2_I(inode);
struct gfs2_inode *ip = GFS2_I(inode);
struct gfs2_inode
gfs2_inode
*ip = GFS2_I(inode)
*
ip
= GFS2_I(inode)
GFS2_I(inode)
GFS2_I
GFS2_I
inode
inode
struct gfs2_sbd *sdp = GFS2_SB(inode);
struct gfs2_sbd *sdp = GFS2_SB(inode);
struct gfs2_sbd
gfs2_sbd
*sdp = GFS2_SB(inode)
*
sdp
= GFS2_SB(inode)
GFS2_SB(inode)
GFS2_SB
GFS2_SB
inode
inode
struct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);
struct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);
struct gfs2_inode
gfs2_inode
*m_ip = GFS2_I(sdp->sd_statfs_inode)
*
m_ip
= GFS2_I(sdp->sd_statfs_inode)
GFS2_I(sdp->sd_statfs_inode)
GFS2_I
GFS2_I
sdp->sd_statfs_inode
sdp
sdp
sd_statfs_inode
struct buffer_head *dibh;
struct buffer_head *dibh;
struct buffer_head
buffer_head
*dibh
*
dibh
unsigned int from = pos & (PAGE_CACHE_SIZE - 1);
unsigned int from = pos & (PAGE_CACHE_SIZE - 1);
unsigned int
from = pos & (PAGE_CACHE_SIZE - 1)
from
= pos & (PAGE_CACHE_SIZE - 1)
pos & (PAGE_CACHE_SIZE - 1)
pos
pos
(PAGE_CACHE_SIZE - 1)
PAGE_CACHE_SIZE - 1
PAGE_CACHE_SIZE
PAGE_CACHE_SIZE
1
unsigned int to = from + len;
unsigned int to = from + len;
unsigned int
to = from + len
to
= from + len
from + len
from
from
len
len
int ret;
int ret;
int
ret
ret
struct gfs2_trans *tr = current->journal_info;
struct gfs2_trans *tr = current->journal_info;
struct gfs2_trans
gfs2_trans
*tr = current->journal_info
*
tr
= current->journal_info
current->journal_info
current
current
journal_info
BUG_ON(!tr);
BUG_ON(!tr)
BUG_ON
BUG_ON
!tr
tr
tr
BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl) == NULL);
BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl) == NULL)
BUG_ON
BUG_ON
gfs2_glock_is_locked_by_me(ip->i_gl) == NULL
gfs2_glock_is_locked_by_me(ip->i_gl)
gfs2_glock_is_locked_by_me
gfs2_glock_is_locked_by_me
ip->i_gl
ip
ip
i_gl
NULL
NULL
ret = gfs2_meta_inode_buffer(ip, &dibh);
ret = gfs2_meta_inode_buffer(ip, &dibh)
ret
ret
gfs2_meta_inode_buffer(ip, &dibh)
gfs2_meta_inode_buffer
gfs2_meta_inode_buffer
ip
ip
&dibh
dibh
dibh
if (unlikely(ret)) {		unlock_page(page);		page_cache_release(page);		goto failed;	}
unlikely(ret)
unlikely
unlikely
ret
ret
{		unlock_page(page);		page_cache_release(page);		goto failed;	}
unlock_page(page);
unlock_page(page)
unlock_page
unlock_page
page
page
page_cache_release(page);
page_cache_release(page)
page_cache_release
page_cache_release
page
page
goto failed;
failed
if (gfs2_is_stuffed(ip))		return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page);
gfs2_is_stuffed(ip)
gfs2_is_stuffed
gfs2_is_stuffed
ip
ip
return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page);
gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page)
gfs2_stuffed_write_end
gfs2_stuffed_write_end
inode
inode
dibh
dibh
pos
pos
len
len
copied
copied
page
page
if (!gfs2_is_writeback(ip))		gfs2_page_add_databufs(ip, page, from, to);
!gfs2_is_writeback(ip)
gfs2_is_writeback(ip)
gfs2_is_writeback
gfs2_is_writeback
ip
ip
gfs2_page_add_databufs(ip, page, from, to);
gfs2_page_add_databufs(ip, page, from, to)
gfs2_page_add_databufs
gfs2_page_add_databufs
ip
ip
page
page
from
from
to
to
ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata);
ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata)
ret
ret
generic_write_end(file, mapping, pos, len, copied, page, fsdata)
generic_write_end
generic_write_end
file
file
mapping
mapping
pos
pos
len
len
copied
copied
page
page
fsdata
fsdata
if (tr->tr_num_buf_new)		__mark_inode_dirty(inode, I_DIRTY_DATASYNC);	else		gfs2_trans_add_meta(ip->i_gl, dibh);
tr->tr_num_buf_new
tr
tr
tr_num_buf_new
__mark_inode_dirty(inode, I_DIRTY_DATASYNC);
__mark_inode_dirty(inode, I_DIRTY_DATASYNC)
__mark_inode_dirty
__mark_inode_dirty
inode
inode
I_DIRTY_DATASYNC
I_DIRTY_DATASYNC
gfs2_trans_add_meta(ip->i_gl, dibh);
gfs2_trans_add_meta(ip->i_gl, dibh)
gfs2_trans_add_meta
gfs2_trans_add_meta
ip->i_gl
ip
ip
i_gl
dibh
dibh
if (inode == sdp->sd_rindex) {		adjust_fs_space(inode);		sdp->sd_rindex_uptodate = 0;	}
inode == sdp->sd_rindex
inode
inode
sdp->sd_rindex
sdp
sdp
sd_rindex
{		adjust_fs_space(inode);		sdp->sd_rindex_uptodate = 0;	}
adjust_fs_space(inode);
adjust_fs_space(inode)
adjust_fs_space
adjust_fs_space
inode
inode
sdp->sd_rindex_uptodate = 0;
sdp->sd_rindex_uptodate = 0
sdp->sd_rindex_uptodate
sdp
sdp
sd_rindex_uptodate
0
brelse(dibh);
brelse(dibh)
brelse
brelse
dibh
dibh
failed:	gfs2_trans_end(sdp);
failed
gfs2_trans_end(sdp);
gfs2_trans_end(sdp)
gfs2_trans_end
gfs2_trans_end
sdp
sdp
gfs2_inplace_release(ip);
gfs2_inplace_release(ip)
gfs2_inplace_release
gfs2_inplace_release
ip
ip
if (ip->i_qadata && ip->i_qadata->qa_qd_num)		gfs2_quota_unlock(ip);
ip->i_qadata && ip->i_qadata->qa_qd_num
ip->i_qadata
ip
ip
i_qadata
ip->i_qadata->qa_qd_num
ip->i_qadata
ip
ip
i_qadata
qa_qd_num
gfs2_quota_unlock(ip);
gfs2_quota_unlock(ip)
gfs2_quota_unlock
gfs2_quota_unlock
ip
ip
if (inode == sdp->sd_rindex) {		gfs2_glock_dq(&m_ip->i_gh);		gfs2_holder_uninit(&m_ip->i_gh);	}
inode == sdp->sd_rindex
inode
inode
sdp->sd_rindex
sdp
sdp
sd_rindex
{		gfs2_glock_dq(&m_ip->i_gh);		gfs2_holder_uninit(&m_ip->i_gh);	}
gfs2_glock_dq(&m_ip->i_gh);
gfs2_glock_dq(&m_ip->i_gh)
gfs2_glock_dq
gfs2_glock_dq
&m_ip->i_gh
m_ip->i_gh
m_ip
m_ip
i_gh
gfs2_holder_uninit(&m_ip->i_gh);
gfs2_holder_uninit(&m_ip->i_gh)
gfs2_holder_uninit
gfs2_holder_uninit
&m_ip->i_gh
m_ip->i_gh
m_ip
m_ip
i_gh
gfs2_glock_dq(&ip->i_gh);
gfs2_glock_dq(&ip->i_gh)
gfs2_glock_dq
gfs2_glock_dq
&ip->i_gh
ip->i_gh
ip
ip
i_gh
gfs2_holder_uninit(&ip->i_gh);
gfs2_holder_uninit(&ip->i_gh)
gfs2_holder_uninit
gfs2_holder_uninit
&ip->i_gh
ip->i_gh
ip
ip
i_gh
return ret;
ret
ret
-----joern-----
(23,125,0)
(168,106,0)
(39,125,0)
(43,174,0)
(180,132,0)
(92,106,0)
(9,35,0)
(105,182,0)
(173,133,0)
(152,132,0)
(52,22,0)
(125,81,0)
(181,168,0)
(68,108,0)
(51,153,0)
(44,70,0)
(117,18,0)
(45,93,0)
(155,22,0)
(116,128,0)
(147,157,0)
(159,24,0)
(109,170,0)
(56,132,0)
(55,68,0)
(102,143,0)
(131,82,0)
(79,175,0)
(102,53,0)
(71,132,0)
(164,56,0)
(140,148,0)
(7,62,0)
(157,106,0)
(51,17,0)
(174,182,0)
(167,17,0)
(158,108,0)
(146,106,0)
(35,145,0)
(55,106,0)
(66,168,0)
(57,78,0)
(168,70,0)
(121,20,0)
(102,77,0)
(55,120,0)
(73,4,0)
(35,136,0)
(96,132,0)
(138,21,0)
(118,89,0)
(18,106,0)
(31,88,0)
(22,93,0)
(160,125,0)
(44,132,0)
(176,73,0)
(41,62,0)
(105,172,0)
(59,88,0)
(149,98,0)
(101,125,0)
(22,89,0)
(122,132,0)
(123,21,0)
(112,56,0)
(184,102,0)
(115,102,0)
(47,12,0)
(77,132,0)
(48,106,0)
(60,144,0)
(16,75,0)
(24,132,0)
(98,93,0)
(11,33,0)
(50,4,0)
(32,26,0)
(72,148,0)
(111,55,0)
(36,120,0)
(103,109,0)
(141,67,0)
(38,0,0)
(142,36,0)
(125,119,0)
(2,16,0)
(108,68,0)
(182,132,0)
(1,48,0)
(113,140,0)
(128,56,0)
(127,132,0)
(78,132,0)
(88,132,0)
(148,140,0)
(4,106,0)
(173,7,0)
(8,80,0)
(93,98,0)
(91,48,0)
(17,51,0)
(134,100,0)
(156,112,0)
(55,53,0)
(70,168,0)
(74,77,0)
(77,102,0)
(37,33,0)
(67,56,0)
(82,59,0)
(28,132,0)
(140,132,0)
(89,56,0)
(131,133,0)
(130,132,0)
(136,132,0)
(139,144,0)
(69,132,0)
(7,173,0)
(65,55,0)
(98,56,0)
(46,132,0)
(3,132,0)
(29,120,0)
(62,7,0)
(108,81,0)
(5,112,0)
(163,100,0)
(94,102,0)
(178,102,0)
(30,59,0)
(88,170,0)
(11,53,0)
(90,34,0)
(93,132,0)
(106,132,0)
(56,67,0)
(125,53,0)
(42,132,0)
(170,88,0)
(124,125,0)
(59,82,0)
(114,0,0)
(100,134,0)
(45,132,0)
(21,123,0)
(20,67,0)
(102,135,0)
(67,20,0)
(125,126,0)
(107,100,0)
(128,12,0)
(137,109,0)
(63,92,0)
(157,75,0)
(57,126,0)
(177,148,0)
(82,131,0)
(26,106,0)
(27,55,0)
(80,106,0)
(123,132,0)
(4,73,0)
(85,80,0)
(36,68,0)
(125,135,0)
(13,110,0)
(110,140,0)
(145,48,0)
(179,17,0)
(171,132,0)
(180,106,0)
(145,35,0)
(87,110,0)
(97,132,0)
(0,108,0)
(36,119,0)
(129,68,0)
(102,64,0)
(75,16,0)
(134,56,0)
(48,145,0)
(21,140,0)
(102,81,0)
(165,132,0)
(161,11,0)
(106,34,0)
(105,106,0)
(166,134,0)
(102,40,0)
(15,132,0)
(84,105,0)
(34,56,0)
(136,35,0)
(100,93,0)
(54,157,0)
(14,180,0)
(154,132,0)
(95,92,0)
(68,132,0)
(150,125,0)
(175,53,0)
(170,109,0)
(99,93,0)
(144,47,0)
(108,0,0)
(61,20,0)
(76,36,0)
(92,16,0)
(153,132,0)
(20,53,0)
(102,119,0)
(120,36,0)
(19,102,0)
(78,77,0)
(83,47,0)
(109,93,0)
(86,182,0)
(153,51,0)
(162,45,0)
(169,172,0)
(17,106,0)
(104,78,0)
(120,132,0)
(175,33,0)
(172,105,0)
(144,93,0)
(62,88,0)
(10,62,0)
(75,157,0)
(58,55,0)
(89,22,0)
(70,44,0)
(16,92,0)
(34,106,0)
(182,105,0)
(49,132,0)
(183,4,0)
(25,102,0)
(6,102,0)
(80,8,0)
(125,56,0)
(151,59,0)
(78,182,0)
(125,56,1)
(91,123,1)
(58,27,1)
(99,106,1)
(1,91,1)
(117,174,1)
(59,151,1)
(93,98,1)
(82,59,1)
(6,94,1)
(102,119,1)
(172,169,1)
(102,135,1)
(180,14,1)
(182,105,1)
(102,143,1)
(62,88,1)
(116,134,1)
(26,32,1)
(4,106,1)
(75,16,1)
(17,106,1)
(35,145,1)
(16,2,1)
(126,125,1)
(38,158,1)
(150,23,1)
(74,55,1)
(59,88,1)
(102,64,1)
(125,124,1)
(108,0,1)
(11,53,1)
(124,39,1)
(157,147,1)
(113,120,1)
(22,52,1)
(110,140,1)
(166,73,1)
(20,53,1)
(174,43,1)
(10,131,1)
(156,110,1)
(19,74,1)
(161,174,1)
(125,135,1)
(125,81,1)
(89,56,1)
(80,85,1)
(179,44,1)
(55,58,1)
(62,41,1)
(61,164,1)
(128,56,1)
(139,60,1)
(98,149,1)
(90,146,1)
(11,161,1)
(157,106,1)
(68,108,1)
(120,36,1)
(48,1,1)
(74,8,1)
(112,56,1)
(109,93,1)
(102,40,1)
(115,6,1)
(178,184,1)
(45,162,1)
(153,51,1)
(101,150,1)
(159,134,1)
(7,62,1)
(34,90,1)
(23,18,1)
(39,160,1)
(87,77,1)
(26,106,1)
(110,13,1)
(102,81,1)
(66,181,1)
(140,148,1)
(173,7,1)
(17,167,1)
(158,129,1)
(92,63,1)
(48,106,1)
(47,83,1)
(141,20,1)
(136,35,1)
(56,67,1)
(86,136,1)
(16,92,1)
(106,34,1)
(60,128,1)
(100,163,1)
(114,38,1)
(83,144,1)
(54,180,1)
(98,56,1)
(162,37,1)
(102,53,1)
(55,106,1)
(27,65,1)
(57,126,1)
(21,138,1)
(29,68,1)
(77,102,1)
(168,66,1)
(36,68,1)
(73,176,1)
(128,116,1)
(118,75,1)
(21,140,1)
(8,80,1)
(88,170,1)
(107,166,1)
(73,4,1)
(155,118,1)
(166,112,1)
(111,8,1)
(168,106,1)
(55,120,1)
(14,45,1)
(118,26,1)
(181,89,1)
(9,145,1)
(18,117,1)
(79,11,1)
(103,137,1)
(70,168,1)
(129,88,1)
(174,182,1)
(55,68,1)
(24,159,1)
(78,182,1)
(13,87,1)
(4,183,1)
(170,109,1)
(85,18,1)
(52,155,1)
(22,93,1)
(109,103,1)
(121,61,1)
(78,77,1)
(167,179,1)
(108,81,1)
(34,56,1)
(44,70,1)
(84,86,1)
(67,20,1)
(146,56,1)
(134,100,1)
(183,50,1)
(145,48,1)
(102,115,1)
(63,95,1)
(92,106,1)
(181,173,1)
(175,53,1)
(18,106,1)
(50,110,1)
(148,72,1)
(169,84,1)
(43,182,1)
(45,93,1)
(159,47,1)
(57,78,1)
(144,139,1)
(72,177,1)
(160,101,1)
(144,93,1)
(147,54,1)
(55,53,1)
(180,106,1)
(37,175,1)
(65,111,1)
(163,107,1)
(75,157,1)
(123,21,1)
(131,82,1)
(137,31,1)
(5,156,1)
(138,140,1)
(162,24,1)
(0,114,1)
(76,142,1)
(142,29,1)
(176,4,1)
(112,5,1)
(125,53,1)
(41,10,1)
(94,178,1)
(80,106,1)
(20,121,1)
(32,75,1)
(25,19,1)
(104,153,1)
(177,113,1)
(149,99,1)
(175,79,1)
(105,172,1)
(100,93,1)
(134,56,1)
(89,22,1)
(95,157,1)
(31,93,1)
(78,104,1)
(30,89,1)
(2,92,1)
(151,30,1)
(35,9,1)
(36,119,1)
(67,141,1)
(51,17,1)
(36,76,1)
(125,119,1)
(105,106,1)
(184,25,1)
(67,20,2)
(102,119,2)
(184,18,2)
(78,18,2)
(125,53,2)
(5,110,2)
(147,18,2)
(180,174,2)
(108,81,2)
(36,119,2)
(162,18,2)
(104,174,2)
(18,174,2)
(22,174,2)
(145,48,2)
(120,36,2)
(26,106,2)
(70,168,2)
(44,70,2)
(183,110,2)
(52,18,2)
(118,18,2)
(45,18,2)
(23,18,2)
(8,80,2)
(181,18,2)
(100,18,2)
(2,157,2)
(105,172,2)
(6,18,2)
(178,18,2)
(181,174,2)
(163,18,2)
(134,56,2)
(161,174,2)
(100,93,2)
(166,18,2)
(8,18,2)
(110,140,2)
(168,106,2)
(37,174,2)
(106,34,2)
(92,106,2)
(111,8,2)
(153,51,2)
(176,110,2)
(44,174,2)
(56,67,2)
(182,105,2)
(73,110,2)
(108,0,2)
(102,81,2)
(50,110,2)
(101,18,2)
(14,174,2)
(89,22,2)
(62,88,2)
(125,56,2)
(85,18,2)
(112,56,2)
(68,108,2)
(134,100,2)
(55,8,2)
(153,174,2)
(118,174,2)
(180,106,2)
(140,148,2)
(139,134,2)
(27,8,2)
(134,18,2)
(156,110,2)
(136,35,2)
(78,174,2)
(48,106,2)
(65,8,2)
(116,134,2)
(144,134,2)
(115,18,2)
(131,82,2)
(21,140,2)
(117,174,2)
(19,18,2)
(157,106,2)
(75,157,2)
(22,18,2)
(150,18,2)
(70,18,2)
(17,106,2)
(14,18,2)
(32,75,2)
(162,174,2)
(179,18,2)
(4,106,2)
(180,18,2)
(10,89,2)
(102,40,2)
(153,18,2)
(110,18,2)
(11,53,2)
(82,89,2)
(74,18,2)
(167,174,2)
(36,68,2)
(55,120,2)
(170,109,2)
(173,7,2)
(125,81,2)
(54,18,2)
(30,89,2)
(55,68,2)
(55,106,2)
(18,106,2)
(75,18,2)
(168,174,2)
(147,174,2)
(83,134,2)
(89,56,2)
(131,89,2)
(16,92,2)
(107,18,2)
(47,134,2)
(41,89,2)
(57,78,2)
(144,93,2)
(157,18,2)
(4,110,2)
(123,21,2)
(173,89,2)
(11,174,2)
(59,89,2)
(128,134,2)
(109,93,2)
(20,53,2)
(102,18,2)
(16,157,2)
(75,174,2)
(62,89,2)
(24,18,2)
(13,18,2)
(95,157,2)
(26,75,2)
(155,18,2)
(54,174,2)
(77,18,2)
(104,18,2)
(7,89,2)
(66,174,2)
(89,18,2)
(98,56,2)
(89,174,2)
(39,18,2)
(126,18,2)
(94,18,2)
(102,53,2)
(174,182,2)
(59,88,2)
(80,106,2)
(175,53,2)
(70,174,2)
(88,170,2)
(155,174,2)
(57,126,2)
(55,53,2)
(175,174,2)
(60,134,2)
(102,64,2)
(93,98,2)
(25,18,2)
(179,174,2)
(51,17,2)
(159,18,2)
(78,182,2)
(125,135,2)
(78,77,2)
(82,59,2)
(102,143,2)
(167,18,2)
(73,4,2)
(157,174,2)
(34,56,2)
(125,119,2)
(44,18,2)
(17,18,2)
(160,18,2)
(45,93,2)
(51,174,2)
(75,16,2)
(17,174,2)
(102,135,2)
(58,8,2)
(80,18,2)
(66,18,2)
(51,18,2)
(128,56,2)
(77,102,2)
(45,174,2)
(112,110,2)
(63,157,2)
(168,18,2)
(7,62,2)
(79,174,2)
(125,18,2)
(151,89,2)
(35,145,2)
(105,106,2)
(52,174,2)
(92,157,2)
(87,18,2)
(124,18,2)
(22,93,2)
-----------------------------------
(0,PAGE_CACHE_SIZE - 1)
(1,i_gl)
(2,qa_qd_num)
(3,ip)
(4,ip->i_gl)
(5,I_DIRTY_DATASYNC)
(6,page)
(7,&m_ip->i_gh)
(8,!gfs2_is_writeback(ip)
(9,NULL)
(10,m_ip)
(11,unlock_page(page)
(12,)
(13,tr_num_buf_new)
(14,ip)
(15,m_ip)
(16,ip->i_qadata->qa_qd_num)
(17,ip->i_gh)
(18,gfs2_is_stuffed(ip)
(19,file)
(20,page->mapping)
(21,!tr)
(22,sdp->sd_rindex)
(23,inode)
(24,brelse(dibh)
(25,mapping)
(26,gfs2_quota_unlock(ip)
(27,from)
(28,inode)
(29,to)
(30,m_ip)
(31,m_ip)
(32,ip)
(33,)
(34,GFS2_I(inode)
(35,gfs2_glock_is_locked_by_me(ip->i_gl)
(36,from + len)
(37,goto failed;)
(38,PAGE_CACHE_SIZE)
(39,copied)
(40,struct address_space *mapping)
(41,i_gh)
(42,if (inode == sdp->sd_rindex)
(43,ret)
(44,gfs2_glock_dq(&ip->i_gh)
(45,gfs2_trans_end(sdp)
(46,if (inode == sdp->sd_rindex)
(47,sdp->sd_rindex_uptodate = 0)
(48,ip->i_gl)
(49,if (ip->i_qadata && ip->i_qadata->qa_qd_num)
(50,ip)
(51,&ip->i_gh)
(52,sd_rindex)
(53,struct page *page)
(54,ip)
(55,gfs2_page_add_databufs(ip, page, from, to)
(56,*inode = page->mapping->host)
(57,RET)
(58,to)
(59,m_ip->i_gh)
(60,sdp)
(61,page)
(62,m_ip->i_gh)
(63,i_qadata)
(64,void *fsdata)
(65,page)
(66,i_gh)
(67,page->mapping->host)
(68,from = pos & (PAGE_CACHE_SIZE - 1)
(69,from)
(70,&ip->i_gh)
(71,if (!gfs2_is_writeback(ip)
(72,journal_info)
(73,gfs2_trans_add_meta(ip->i_gl, dibh)
(74,ret)
(75,ip->i_qadata && ip->i_qadata->qa_qd_num)
(76,len)
(77,ret = generic_write_end(file, mapping, pos, len, copied, page, fsdata)
(78,return ret;)
(79,page)
(80,gfs2_is_writeback(ip)
(81,loff_t pos)
(82,&m_ip->i_gh)
(83,0)
(84,ip)
(85,ip)
(86,ret)
(87,tr)
(88,*m_ip = GFS2_I(sdp->sd_statfs_inode)
(89,inode == sdp->sd_rindex)
(90,inode)
(91,ip)
(92,ip->i_qadata)
(93,*sdp = GFS2_SB(inode)
(94,copied)
(95,ip)
(96,failed:)
(97,tr)
(98,GFS2_SB(inode)
(99,sdp)
(100,sdp->sd_rindex)
(101,pos)
(102,generic_write_end(file, mapping, pos, len, copied, page, fsdata)
(103,sd_statfs_inode)
(104,ret)
(105,gfs2_meta_inode_buffer(ip, &dibh)
(106,*ip = GFS2_I(inode)
(107,sdp)
(108,pos & (PAGE_CACHE_SIZE - 1)
(109,sdp->sd_statfs_inode)
(110,tr->tr_num_buf_new)
(111,ip)
(112,__mark_inode_dirty(inode, I_DIRTY_DATASYNC)
(113,tr)
(114,1)
(115,fsdata)
(116,inode)
(117,ip)
(118,inode)
(119,unsigned len)
(120,to = from + len)
(121,mapping)
(122,ret)
(123,BUG_ON(!tr)
(124,page)
(125,gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page)
(126,return gfs2_stuffed_write_end(inode, dibh, pos, len, copied, page)
(127,to)
(128,adjust_fs_space(inode)
(129,from)
(130,if (unlikely(ret)
(131,gfs2_glock_dq(&m_ip->i_gh)
(132,)
(133,)
(134,inode == sdp->sd_rindex)
(135,unsigned copied)
(136,BUG_ON(gfs2_glock_is_locked_by_me(ip->i_gl)
(137,sdp)
(138,tr)
(139,sd_rindex_uptodate)
(140,*tr = current->journal_info)
(141,host)
(142,from)
(143,struct file *file)
(144,sdp->sd_rindex_uptodate)
(145,gfs2_glock_is_locked_by_me(ip->i_gl)
(146,ip)
(147,i_qadata)
(148,current->journal_info)
(149,inode)
(150,dibh)
(151,i_gh)
(152,sdp)
(153,gfs2_holder_uninit(&ip->i_gh)
(154,if (tr->tr_num_buf_new)
(155,sdp)
(156,inode)
(157,ip->i_qadata)
(158,pos)
(159,dibh)
(160,len)
(161,page)
(162,sdp)
(163,sd_rindex)
(164,inode)
(165,dibh)
(166,inode)
(167,i_gh)
(168,ip->i_gh)
(169,dibh)
(170,GFS2_I(sdp->sd_statfs_inode)
(171,if (gfs2_is_stuffed(ip)
(172,&dibh)
(173,gfs2_holder_uninit(&m_ip->i_gh)
(174,unlikely(ret)
(175,page_cache_release(page)
(176,dibh)
(177,current)
(178,len)
(179,ip)
(180,gfs2_inplace_release(ip)
(181,ip)
(182,ret = gfs2_meta_inode_buffer(ip, &dibh)
(183,i_gl)
(184,pos)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^