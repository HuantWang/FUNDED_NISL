-----label-----
1
-----code-----
VOS_STATUS
WLANBAP_XlateTxDataPkt
(
    ptBtampHandle     btampHandle,  /* Used by BAP to identify the actual session
                                      and therefore addresses */
    v_U8_t            phy_link_handle,  /* Used by BAP to indentify the WLAN assoc. (StaId) */
    WLANTL_ACEnumType    *pucAC,        /* Return the AC here */
    WLANTL_MetaInfoType  *tlMetaInfo, /* Return the MetaInfo here. An assist to WLANBAP_STAFetchPktCBType */
    vos_pkt_t        *vosDataBuff
)
{
    ptBtampContext           pBtampCtx = (ptBtampContext) btampHandle;
    tpBtampLogLinkCtx        pLogLinkContext;
    WLANBAP_8023HeaderType   w8023Header;
    WLANBAP_HCIACLHeaderType hciACLHeader;
    v_U8_t                   aucLLCHeader[WLANBAP_LLC_HEADER_LEN];
    VOS_STATUS               vosStatus;
    v_U8_t                   ucSTAId;  /* The StaId (used by TL, PE, and HAL) */
    v_PVOID_t                pHddHdl; /* Handle to return BSL context in */
    v_U16_t                  headerLength;  /* The 802.3 frame length*/
    v_U16_t                  protoType = WLANBAP_BT_AMP_TYPE_DATA;  /* The protocol type bytes*/
    v_U32_t                  value = 0;
    /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/


    /*------------------------------------------------------------------------
        Sanity check params
      ------------------------------------------------------------------------*/
    if ( NULL == pBtampCtx)
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,
                     "Invalid BAP handle value in %s", __func__);
        return VOS_STATUS_E_FAULT;
    }

    // Here, I have to make the assumption that this is an
    // HCI ACL Data packet that I am being handed.
    vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN);

    if ( VOS_STATUS_SUCCESS != vosStatus )
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,
                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",
                  vosStatus);

        return vosStatus;
    }

    // JEZ081003: Remove this after debugging
    // Sanity check the phy_link_handle value

    if ( phy_link_handle != hciACLHeader.phyLinkHandle )
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,
                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",
                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);
        return VOS_STATUS_E_INVAL;
    }


    /* Lookup the StaId using the phy_link_handle and the BAP context */

    vosStatus = WLANBAP_GetStaIdFromLinkCtx (
            btampHandle,  /* btampHandle value in  */
            phy_link_handle,  /* phy_link_handle value in */
            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */
            &pHddHdl); /* Handle to return BSL context */
    if ( VOS_STATUS_SUCCESS != vosStatus )
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,
                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);
        return VOS_STATUS_E_FAULT;
    }

    // JEZ081003: Remove this after debugging
    // Sanity check the log_link_handle value
    if (!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle))
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,
                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",
                hciACLHeader.logLinkHandle,
                __func__);

        // JEZ090123: Insure that the logical link value is good
        hciACLHeader.logLinkHandle = 1;
        //return VOS_STATUS_E_INVAL;
    }

    /* Use the log_link_handle to retrieve the logical link context */
    /* JEZ081006: abstract this with a proc.  So you can change the impl later */
    pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ]);

    // JEZ081003: Remove this after debugging
    // Sanity check the log_link_handle value
    // JEZ081113: I changed this to fail on an UNOCCUPIED entry
    if ( pLogLinkContext->present != VOS_TRUE)
    {
        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,
                "WLAN BAP: Invalid logical link entry in %s",
                __func__);

        return VOS_STATUS_E_INVAL;
    }

    // Return the AC and MetaInfo

    // Now copy the AC values from the Logical Link context
    *pucAC = pLogLinkContext->btampAC;
    // Now copy the values from the Logical Link context to the MetaInfo
    tlMetaInfo->ucTID = pLogLinkContext->ucTID;
    tlMetaInfo->ucUP = pLogLinkContext->ucUP;
    tlMetaInfo->ucIsEapol = VOS_FALSE;
    tlMetaInfo->ucDisableFrmXtl = VOS_FALSE;
    tlMetaInfo->ucBcast = VOS_FALSE; /* hciACLHeader.BCFlag; */ /* Don't I want to use the BCFlag? */
    tlMetaInfo->ucMcast = VOS_FALSE;
    tlMetaInfo->ucType = 0x00;  /* What is this really ?? */
//    tlMetaInfo->usTimeStamp = 0x00;  /* Ravi, shouldn't you be setting this?  It's in the VOS packet.  */

    // Form the 802.3 header

    vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE);
    vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE);

    /* Now this length passed down in HCI...is in little-endian */
    headerLength = vos_le16_to_cpu(hciACLHeader.dataLength);
    headerLength += WLANBAP_LLC_HEADER_LEN;
    /* Now the 802.3 length field is big-endian?! */
    w8023Header.usLenType = vos_cpu_to_be16(headerLength);

    /* Now adjust the protocol type bytes*/
    protoType = vos_cpu_to_be16( protoType);

    /* Now form the LLC header */
    vos_mem_copy(aucLLCHeader,
            WLANBAP_LLC_HEADER,
            sizeof(WLANBAP_LLC_HEADER));
    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],
            WLANBAP_BT_AMP_OUI,
            WLANBAP_LLC_OUI_SIZE);
    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],
            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA
            WLANBAP_LLC_PROTO_TYPE_SIZE);

    /* Push on the LLC header */
    vos_pkt_push_head(vosDataBuff,
            aucLLCHeader,
            WLANBAP_LLC_HEADER_LEN);

    /* Push on the 802.3 header */
    vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header));


    /*Set the logical link handle as user data so that we can retrieve it on
      Tx Complete */
    value = (v_U32_t)hciACLHeader.logLinkHandle;
    vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,
                               (v_VOID_t *)value);

    return VOS_STATUS_SUCCESS;
}
-----children-----
1,2
1,3
1,4
2,3
4,5
4,6
4,7
4,8
4,9
4,10
6,7
6,8
7,8
9,10
11,12
11,13
12,13
14,15
16,17
16,18
17,18
19,20
19,21
22,23
22,24
23,24
25,26
25,27
28,29
28,30
29,30
31,32
31,33
34,35
34,36
34,37
34,38
34,39
34,40
34,41
34,42
34,43
34,44
34,45
34,46
34,47
34,48
34,49
34,50
34,51
34,52
34,53
34,54
34,55
34,56
34,57
34,58
34,59
34,60
34,61
34,62
34,63
34,64
34,65
34,66
34,67
34,68
34,69
34,70
34,71
34,72
34,73
34,74
34,75
34,76
35,36
36,37
36,38
37,38
39,40
39,41
41,42
42,43
42,44
43,44
43,45
44,45
47,48
49,50
50,51
50,52
51,52
53,54
55,56
56,57
56,58
57,58
59,60
61,62
62,63
62,64
63,64
65,66
67,68
68,69
68,70
69,70
71,72
71,73
73,74
74,75
76,77
77,78
77,79
78,79
80,81
82,83
83,84
83,85
84,85
86,87
88,89
89,90
89,91
90,91
92,93
94,95
95,96
95,97
96,97
98,99
100,101
101,102
101,103
102,103
104,105
104,106
106,107
107,108
109,110
110,111
110,112
111,112
113,114
113,115
115,116
117,118
117,119
118,119
118,120
119,120
121,122
123,124
123,125
124,125
125,126
125,127
125,128
125,129
125,130
126,127
128,129
130,131
133,134
135,136
136,137
138,139
139,140
139,141
140,141
142,143
142,144
142,145
142,146
143,144
145,146
147,148
148,149
150,151
152,153
152,154
153,154
153,155
154,155
156,157
158,159
158,160
159,160
160,161
160,162
160,163
160,164
160,165
161,162
163,164
165,166
168,169
170,171
171,172
173,174
173,175
174,175
174,176
175,176
177,178
177,179
178,179
181,182
181,183
182,183
183,184
183,185
183,186
183,187
183,188
183,189
183,190
184,185
186,187
188,189
191,192
193,194
195,196
195,197
196,197
199,200
200,201
202,203
203,204
203,205
204,205
206,207
206,208
206,209
206,210
206,211
207,208
209,210
211,212
213,214
214,215
216,217
217,218
219,220
219,221
220,221
220,222
221,222
223,224
225,226
225,227
226,227
227,228
227,229
227,230
227,231
227,232
228,229
230,231
232,233
235,236
237,238
238,239
240,241
240,242
241,242
242,243
242,244
243,244
245,246
245,247
246,247
249,250
249,251
250,251
251,252
251,253
251,254
251,255
251,256
251,257
252,253
254,255
256,257
259,260
259,261
260,261
263,264
265,266
266,267
266,268
267,268
267,269
268,269
272,273
273,274
273,275
274,275
276,277
277,278
278,279
278,280
279,280
279,281
280,281
283,284
283,285
284,285
287,288
287,289
288,289
288,290
289,290
289,291
290,291
293,294
295,296
295,297
296,297
297,298
297,299
297,300
297,301
297,302
298,299
300,301
302,303
305,306
307,308
308,309
310,311
311,312
311,313
312,313
313,314
315,316
315,317
316,317
319,320
320,321
320,322
321,322
321,323
322,323
325,326
325,327
326,327
329,330
330,331
330,332
331,332
331,333
332,333
335,336
335,337
336,337
339,340
340,341
340,342
341,342
341,343
342,343
345,346
347,348
348,349
348,350
349,350
349,351
350,351
353,354
355,356
356,357
356,358
357,358
357,359
358,359
361,362
363,364
364,365
364,366
365,366
365,367
366,367
369,370
371,372
372,373
372,374
373,374
373,375
374,375
378,379
379,380
379,381
379,382
379,383
380,381
382,383
382,384
383,384
386,387
386,388
387,388
390,391
392,393
393,394
393,395
393,396
393,397
394,395
396,397
396,398
397,398
400,401
400,402
401,402
404,405
406,407
407,408
407,409
408,409
410,411
410,412
411,412
413,414
413,415
414,415
417,418
418,419
418,420
419,420
421,422
423,424
424,425
424,426
425,426
425,427
426,427
429,430
429,431
430,431
432,433
434,435
435,436
435,437
436,437
438,439
438,440
439,440
441,442
443,444
444,445
444,446
444,447
444,448
445,446
447,448
449,450
451,452
452,453
452,454
453,454
456,457
457,458
457,459
457,460
457,461
458,459
460,461
461,462
461,463
462,463
464,465
466,467
468,469
470,471
471,472
471,473
471,474
471,475
472,473
474,475
475,476
475,477
476,477
478,479
480,481
481,482
483,484
485,486
486,487
486,488
486,489
486,490
487,488
489,490
491,492
493,494
495,496
496,497
496,498
496,499
496,500
497,498
499,500
501,502
502,503
504,505
505,506
506,507
508,509
509,510
509,511
510,511
512,513
512,514
513,514
513,515
514,515
517,518
517,519
518,519
521,522
522,523
522,524
522,525
522,526
523,524
525,526
527,528
529,530
529,531
530,531
530,532
531,532
533,534
535,536
537,538
538,539
-----nextToken-----
3,5,8,10,13,15,18,20,21,24,26,27,30,32,33,38,40,45,46,48,52,54,58,60,64,66,70,72,75,79,81,85,87,91,93,97,99,103,105,108,112,114,116,120,122,127,129,131,132,134,137,141,144,146,149,151,155,157,162,164,166,167,169,172,176,179,180,185,187,189,190,192,194,197,198,201,205,208,210,212,215,218,222,224,229,231,233,234,236,239,244,247,248,253,255,257,258,261,262,264,269,270,271,275,281,282,285,286,291,292,294,299,301,303,304,306,309,314,317,318,323,324,327,328,333,334,337,338,343,344,346,351,352,354,359,360,362,367,368,370,375,376,377,381,384,385,388,389,391,395,398,399,402,403,405,409,412,415,416,420,422,427,428,431,433,437,440,442,446,448,450,454,455,459,463,465,467,469,473,477,479,482,484,488,490,492,494,498,500,503,507,511,515,516,519,520,524,526,528,532,534,536,539
-----computeFrom-----
118,119
118,120
139,140
139,141
153,154
153,155
174,175
174,176
203,204
203,205
220,221
220,222
266,267
266,268
273,274
273,275
288,289
288,290
311,312
311,313
320,321
320,322
330,331
330,332
340,341
340,342
348,349
348,350
356,357
356,358
364,365
364,366
372,373
372,374
407,408
407,409
418,419
418,420
424,425
424,426
435,436
435,437
509,510
509,511
-----guardedBy-----
157,172
179,197
176,194
180,198
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;NamedTypeSpecifier;Name;FunctionDeclarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ReturnStatement;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ReturnStatement;IdExpression;Name;IfStatement;UnaryExpression;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;UnaryExpression;ArraySubscriptExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;TypeIdExpression;TypeId;NamedTypeSpecifier;Name;Declarator;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;UnaryExpression;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
VOS_STATUSWLANBAP_XlateTxDataPkt(    ptBtampHandle     btampHandle,  /* Used by BAP to identify the actual session                                      and therefore addresses */    v_U8_t            phy_link_handle,  /* Used by BAP to indentify the WLAN assoc. (StaId) */    WLANTL_ACEnumType    *pucAC,        /* Return the AC here */    WLANTL_MetaInfoType  *tlMetaInfo, /* Return the MetaInfo here. An assist to WLANBAP_STAFetchPktCBType */    vos_pkt_t        *vosDataBuff){    ptBtampContext           pBtampCtx = (ptBtampContext) btampHandle;    tpBtampLogLinkCtx        pLogLinkContext;    WLANBAP_8023HeaderType   w8023Header;    WLANBAP_HCIACLHeaderType hciACLHeader;    v_U8_t                   aucLLCHeader[WLANBAP_LLC_HEADER_LEN];    VOS_STATUS               vosStatus;    v_U8_t                   ucSTAId;  /* The StaId (used by TL, PE, and HAL) */    v_PVOID_t                pHddHdl; /* Handle to return BSL context in */    v_U16_t                  headerLength;  /* The 802.3 frame length*/    v_U16_t                  protoType = WLANBAP_BT_AMP_TYPE_DATA;  /* The protocol type bytes*/    v_U32_t                  value = 0;    /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/    /*------------------------------------------------------------------------        Sanity check params      ------------------------------------------------------------------------*/    if ( NULL == pBtampCtx)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__);        return VOS_STATUS_E_FAULT;    }    // Here, I have to make the assumption that this is an    // HCI ACL Data packet that I am being handed.    vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN);    if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus);        return vosStatus;    }    // JEZ081003: Remove this after debugging    // Sanity check the phy_link_handle value    if ( phy_link_handle != hciACLHeader.phyLinkHandle )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);        return VOS_STATUS_E_INVAL;    }    /* Lookup the StaId using the phy_link_handle and the BAP context */    vosStatus = WLANBAP_GetStaIdFromLinkCtx (            btampHandle,  /* btampHandle value in  */            phy_link_handle,  /* phy_link_handle value in */            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */            &pHddHdl); /* Handle to return BSL context */    if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);        return VOS_STATUS_E_FAULT;    }    // JEZ081003: Remove this after debugging    // Sanity check the log_link_handle value    if (!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle))    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__);        // JEZ090123: Insure that the logical link value is good        hciACLHeader.logLinkHandle = 1;        //return VOS_STATUS_E_INVAL;    }    /* Use the log_link_handle to retrieve the logical link context */    /* JEZ081006: abstract this with a proc.  So you can change the impl later */    pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ]);    // JEZ081003: Remove this after debugging    // Sanity check the log_link_handle value    // JEZ081113: I changed this to fail on an UNOCCUPIED entry    if ( pLogLinkContext->present != VOS_TRUE)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__);        return VOS_STATUS_E_INVAL;    }    // Return the AC and MetaInfo    // Now copy the AC values from the Logical Link context    *pucAC = pLogLinkContext->btampAC;    // Now copy the values from the Logical Link context to the MetaInfo    tlMetaInfo->ucTID = pLogLinkContext->ucTID;    tlMetaInfo->ucUP = pLogLinkContext->ucUP;    tlMetaInfo->ucIsEapol = VOS_FALSE;    tlMetaInfo->ucDisableFrmXtl = VOS_FALSE;    tlMetaInfo->ucBcast = VOS_FALSE; /* hciACLHeader.BCFlag; */ /* Don't I want to use the BCFlag? */    tlMetaInfo->ucMcast = VOS_FALSE;    tlMetaInfo->ucType = 0x00;  /* What is this really ?? *///    tlMetaInfo->usTimeStamp = 0x00;  /* Ravi, shouldn't you be setting this?  It's in the VOS packet.  */    // Form the 802.3 header    vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE);    vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE);    /* Now this length passed down in HCI...is in little-endian */    headerLength = vos_le16_to_cpu(hciACLHeader.dataLength);    headerLength += WLANBAP_LLC_HEADER_LEN;    /* Now the 802.3 length field is big-endian?! */    w8023Header.usLenType = vos_cpu_to_be16(headerLength);    /* Now adjust the protocol type bytes*/    protoType = vos_cpu_to_be16( protoType);    /* Now form the LLC header */    vos_mem_copy(aucLLCHeader,            WLANBAP_LLC_HEADER,            sizeof(WLANBAP_LLC_HEADER));    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],            WLANBAP_BT_AMP_OUI,            WLANBAP_LLC_OUI_SIZE);    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA            WLANBAP_LLC_PROTO_TYPE_SIZE);    /* Push on the LLC header */    vos_pkt_push_head(vosDataBuff,            aucLLCHeader,            WLANBAP_LLC_HEADER_LEN);    /* Push on the 802.3 header */    vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header));    /*Set the logical link handle as user data so that we can retrieve it on      Tx Complete */    value = (v_U32_t)hciACLHeader.logLinkHandle;    vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,                               (v_VOID_t *)value);    return VOS_STATUS_SUCCESS;}
VOS_STATUS
VOS_STATUS
WLANBAP_XlateTxDataPkt(    ptBtampHandle     btampHandle,  /* Used by BAP to identify the actual session                                      and therefore addresses */    v_U8_t            phy_link_handle,  /* Used by BAP to indentify the WLAN assoc. (StaId) */    WLANTL_ACEnumType    *pucAC,        /* Return the AC here */    WLANTL_MetaInfoType  *tlMetaInfo, /* Return the MetaInfo here. An assist to WLANBAP_STAFetchPktCBType */    vos_pkt_t        *vosDataBuff)
WLANBAP_XlateTxDataPkt
ptBtampHandle     btampHandle
ptBtampHandle
ptBtampHandle
btampHandle
btampHandle
v_U8_t            phy_link_handle
v_U8_t
v_U8_t
phy_link_handle
phy_link_handle
WLANTL_ACEnumType    *pucAC
WLANTL_ACEnumType
WLANTL_ACEnumType
*pucAC
*
pucAC
WLANTL_MetaInfoType  *tlMetaInfo
WLANTL_MetaInfoType
WLANTL_MetaInfoType
*tlMetaInfo
*
tlMetaInfo
vos_pkt_t        *vosDataBuff
vos_pkt_t
vos_pkt_t
*vosDataBuff
*
vosDataBuff
{    ptBtampContext           pBtampCtx = (ptBtampContext) btampHandle;    tpBtampLogLinkCtx        pLogLinkContext;    WLANBAP_8023HeaderType   w8023Header;    WLANBAP_HCIACLHeaderType hciACLHeader;    v_U8_t                   aucLLCHeader[WLANBAP_LLC_HEADER_LEN];    VOS_STATUS               vosStatus;    v_U8_t                   ucSTAId;  /* The StaId (used by TL, PE, and HAL) */    v_PVOID_t                pHddHdl; /* Handle to return BSL context in */    v_U16_t                  headerLength;  /* The 802.3 frame length*/    v_U16_t                  protoType = WLANBAP_BT_AMP_TYPE_DATA;  /* The protocol type bytes*/    v_U32_t                  value = 0;    /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/    /*------------------------------------------------------------------------        Sanity check params      ------------------------------------------------------------------------*/    if ( NULL == pBtampCtx)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__);        return VOS_STATUS_E_FAULT;    }    // Here, I have to make the assumption that this is an    // HCI ACL Data packet that I am being handed.    vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN);    if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus);        return vosStatus;    }    // JEZ081003: Remove this after debugging    // Sanity check the phy_link_handle value    if ( phy_link_handle != hciACLHeader.phyLinkHandle )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);        return VOS_STATUS_E_INVAL;    }    /* Lookup the StaId using the phy_link_handle and the BAP context */    vosStatus = WLANBAP_GetStaIdFromLinkCtx (            btampHandle,  /* btampHandle value in  */            phy_link_handle,  /* phy_link_handle value in */            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */            &pHddHdl); /* Handle to return BSL context */    if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);        return VOS_STATUS_E_FAULT;    }    // JEZ081003: Remove this after debugging    // Sanity check the log_link_handle value    if (!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle))    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__);        // JEZ090123: Insure that the logical link value is good        hciACLHeader.logLinkHandle = 1;        //return VOS_STATUS_E_INVAL;    }    /* Use the log_link_handle to retrieve the logical link context */    /* JEZ081006: abstract this with a proc.  So you can change the impl later */    pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ]);    // JEZ081003: Remove this after debugging    // Sanity check the log_link_handle value    // JEZ081113: I changed this to fail on an UNOCCUPIED entry    if ( pLogLinkContext->present != VOS_TRUE)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__);        return VOS_STATUS_E_INVAL;    }    // Return the AC and MetaInfo    // Now copy the AC values from the Logical Link context    *pucAC = pLogLinkContext->btampAC;    // Now copy the values from the Logical Link context to the MetaInfo    tlMetaInfo->ucTID = pLogLinkContext->ucTID;    tlMetaInfo->ucUP = pLogLinkContext->ucUP;    tlMetaInfo->ucIsEapol = VOS_FALSE;    tlMetaInfo->ucDisableFrmXtl = VOS_FALSE;    tlMetaInfo->ucBcast = VOS_FALSE; /* hciACLHeader.BCFlag; */ /* Don't I want to use the BCFlag? */    tlMetaInfo->ucMcast = VOS_FALSE;    tlMetaInfo->ucType = 0x00;  /* What is this really ?? *///    tlMetaInfo->usTimeStamp = 0x00;  /* Ravi, shouldn't you be setting this?  It's in the VOS packet.  */    // Form the 802.3 header    vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE);    vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE);    /* Now this length passed down in HCI...is in little-endian */    headerLength = vos_le16_to_cpu(hciACLHeader.dataLength);    headerLength += WLANBAP_LLC_HEADER_LEN;    /* Now the 802.3 length field is big-endian?! */    w8023Header.usLenType = vos_cpu_to_be16(headerLength);    /* Now adjust the protocol type bytes*/    protoType = vos_cpu_to_be16( protoType);    /* Now form the LLC header */    vos_mem_copy(aucLLCHeader,            WLANBAP_LLC_HEADER,            sizeof(WLANBAP_LLC_HEADER));    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],            WLANBAP_BT_AMP_OUI,            WLANBAP_LLC_OUI_SIZE);    vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA            WLANBAP_LLC_PROTO_TYPE_SIZE);    /* Push on the LLC header */    vos_pkt_push_head(vosDataBuff,            aucLLCHeader,            WLANBAP_LLC_HEADER_LEN);    /* Push on the 802.3 header */    vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header));    /*Set the logical link handle as user data so that we can retrieve it on      Tx Complete */    value = (v_U32_t)hciACLHeader.logLinkHandle;    vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,                               (v_VOID_t *)value);    return VOS_STATUS_SUCCESS;}
ptBtampContext           pBtampCtx = (ptBtampContext) btampHandle;
ptBtampContext           pBtampCtx = (ptBtampContext) btampHandle;
ptBtampContext
ptBtampContext
pBtampCtx = (ptBtampContext) btampHandle
pBtampCtx
= (ptBtampContext) btampHandle
(ptBtampContext) btampHandle
ptBtampContext
ptBtampContext
ptBtampContext

btampHandle
btampHandle
tpBtampLogLinkCtx        pLogLinkContext;
tpBtampLogLinkCtx        pLogLinkContext;
tpBtampLogLinkCtx
tpBtampLogLinkCtx
pLogLinkContext
pLogLinkContext
WLANBAP_8023HeaderType   w8023Header;
WLANBAP_8023HeaderType   w8023Header;
WLANBAP_8023HeaderType
WLANBAP_8023HeaderType
w8023Header
w8023Header
WLANBAP_HCIACLHeaderType hciACLHeader;
WLANBAP_HCIACLHeaderType hciACLHeader;
WLANBAP_HCIACLHeaderType
WLANBAP_HCIACLHeaderType
hciACLHeader
hciACLHeader
v_U8_t                   aucLLCHeader[WLANBAP_LLC_HEADER_LEN];
v_U8_t                   aucLLCHeader[WLANBAP_LLC_HEADER_LEN];
v_U8_t
v_U8_t
aucLLCHeader[WLANBAP_LLC_HEADER_LEN]
aucLLCHeader
[WLANBAP_LLC_HEADER_LEN]
WLANBAP_LLC_HEADER_LEN
WLANBAP_LLC_HEADER_LEN
VOS_STATUS               vosStatus;
VOS_STATUS               vosStatus;
VOS_STATUS
VOS_STATUS
vosStatus
vosStatus
v_U8_t                   ucSTAId;
v_U8_t                   ucSTAId;
v_U8_t
v_U8_t
ucSTAId
ucSTAId
v_PVOID_t                pHddHdl;
v_PVOID_t                pHddHdl;
v_PVOID_t
v_PVOID_t
pHddHdl
pHddHdl
v_U16_t                  headerLength;
v_U16_t                  headerLength;
v_U16_t
v_U16_t
headerLength
headerLength
v_U16_t                  protoType = WLANBAP_BT_AMP_TYPE_DATA;
v_U16_t                  protoType = WLANBAP_BT_AMP_TYPE_DATA;
v_U16_t
v_U16_t
protoType = WLANBAP_BT_AMP_TYPE_DATA
protoType
= WLANBAP_BT_AMP_TYPE_DATA
WLANBAP_BT_AMP_TYPE_DATA
WLANBAP_BT_AMP_TYPE_DATA
v_U32_t                  value = 0;
v_U32_t                  value = 0;
v_U32_t
v_U32_t
value = 0
value
= 0
0
if ( NULL == pBtampCtx)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__);        return VOS_STATUS_E_FAULT;    }
NULL == pBtampCtx
NULL
NULL
pBtampCtx
pBtampCtx
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__);        return VOS_STATUS_E_FAULT;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                     "Invalid BAP handle value in %s", __func__)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_ERROR
VOS_TRACE_LEVEL_ERROR
"Invalid BAP handle value in %s"
__func__
__func__
return VOS_STATUS_E_FAULT;
VOS_STATUS_E_FAULT
VOS_STATUS_E_FAULT
vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN);
vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN)
vosStatus
vosStatus
vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN)
vos_pkt_pop_head
vos_pkt_pop_head
vosDataBuff
vosDataBuff
&hciACLHeader
hciACLHeader
hciACLHeader
WLANBAP_HCI_ACL_HEADER_LEN
WLANBAP_HCI_ACL_HEADER_LEN
if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus);        return vosStatus;    }
VOS_STATUS_SUCCESS != vosStatus
VOS_STATUS_SUCCESS
VOS_STATUS_SUCCESS
vosStatus
vosStatus
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus);        return vosStatus;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",                  vosStatus)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_ERROR
VOS_TRACE_LEVEL_ERROR
"WLAN BAP: Failed to pop HCI ACL header from packet %d"
vosStatus
vosStatus
return vosStatus;
vosStatus
vosStatus
if ( phy_link_handle != hciACLHeader.phyLinkHandle )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);        return VOS_STATUS_E_INVAL;    }
phy_link_handle != hciACLHeader.phyLinkHandle
phy_link_handle
phy_link_handle
hciACLHeader.phyLinkHandle
hciACLHeader
hciACLHeader
phyLinkHandle
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);        return VOS_STATUS_E_INVAL;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",                __func__, phy_link_handle, hciACLHeader.phyLinkHandle)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_ERROR
VOS_TRACE_LEVEL_ERROR
"WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d"
__func__
__func__
phy_link_handle
phy_link_handle
hciACLHeader.phyLinkHandle
hciACLHeader
hciACLHeader
phyLinkHandle
return VOS_STATUS_E_INVAL;
VOS_STATUS_E_INVAL
VOS_STATUS_E_INVAL
vosStatus = WLANBAP_GetStaIdFromLinkCtx (            btampHandle,  /* btampHandle value in  */            phy_link_handle,  /* phy_link_handle value in */            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */            &pHddHdl);
vosStatus = WLANBAP_GetStaIdFromLinkCtx (            btampHandle,  /* btampHandle value in  */            phy_link_handle,  /* phy_link_handle value in */            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */            &pHddHdl)
vosStatus
vosStatus
WLANBAP_GetStaIdFromLinkCtx (            btampHandle,  /* btampHandle value in  */            phy_link_handle,  /* phy_link_handle value in */            &ucSTAId,  /* The StaId (used by TL, PE, and HAL) */            &pHddHdl)
WLANBAP_GetStaIdFromLinkCtx
WLANBAP_GetStaIdFromLinkCtx
btampHandle
btampHandle
phy_link_handle
phy_link_handle
&ucSTAId
ucSTAId
ucSTAId
&pHddHdl
pHddHdl
pHddHdl
if ( VOS_STATUS_SUCCESS != vosStatus )    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);        return VOS_STATUS_E_FAULT;    }
VOS_STATUS_SUCCESS != vosStatus
VOS_STATUS_SUCCESS
VOS_STATUS_SUCCESS
vosStatus
vosStatus
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);        return VOS_STATUS_E_FAULT;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_INFO
VOS_TRACE_LEVEL_INFO
"Unable to retrieve STA Id from BAP context and phy_link_handle in %s"
__func__
__func__
return VOS_STATUS_E_FAULT;
VOS_STATUS_E_FAULT
VOS_STATUS_E_FAULT
if (!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle))    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__);        // JEZ090123: Insure that the logical link value is good        hciACLHeader.logLinkHandle = 1;        //return VOS_STATUS_E_INVAL;    }
!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle)
BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle)
BTAMP_VALID_LOG_LINK
BTAMP_VALID_LOG_LINK
hciACLHeader.logLinkHandle
hciACLHeader
hciACLHeader
logLinkHandle
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__);        // JEZ090123: Insure that the logical link value is good        hciACLHeader.logLinkHandle = 1;        //return VOS_STATUS_E_INVAL;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link handle (%d) in %s. Corrected.",                hciACLHeader.logLinkHandle,                __func__)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_ERROR
VOS_TRACE_LEVEL_ERROR
"WLAN BAP: Invalid logical link handle (%d) in %s. Corrected."
hciACLHeader.logLinkHandle
hciACLHeader
hciACLHeader
logLinkHandle
__func__
__func__
hciACLHeader.logLinkHandle = 1;
hciACLHeader.logLinkHandle = 1
hciACLHeader.logLinkHandle
hciACLHeader
hciACLHeader
logLinkHandle
1
pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ]);
pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
pLogLinkContext
pLogLinkContext
&(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ]
pBtampCtx->btampLogLinkCtx
pBtampCtx
pBtampCtx
btampLogLinkCtx
hciACLHeader.logLinkHandle
hciACLHeader
hciACLHeader
logLinkHandle
if ( pLogLinkContext->present != VOS_TRUE)    {        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__);        return VOS_STATUS_E_INVAL;    }
pLogLinkContext->present != VOS_TRUE
pLogLinkContext->present
pLogLinkContext
pLogLinkContext
present
VOS_TRUE
VOS_TRUE
{        VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__);        return VOS_STATUS_E_INVAL;    }
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__);
VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,                "WLAN BAP: Invalid logical link entry in %s",                __func__)
VOS_TRACE
VOS_TRACE
VOS_MODULE_ID_BAP
VOS_MODULE_ID_BAP
VOS_TRACE_LEVEL_ERROR
VOS_TRACE_LEVEL_ERROR
"WLAN BAP: Invalid logical link entry in %s"
__func__
__func__
return VOS_STATUS_E_INVAL;
VOS_STATUS_E_INVAL
VOS_STATUS_E_INVAL
*pucAC = pLogLinkContext->btampAC;
*pucAC = pLogLinkContext->btampAC
*pucAC
pucAC
pucAC
pLogLinkContext->btampAC
pLogLinkContext
pLogLinkContext
btampAC
tlMetaInfo->ucTID = pLogLinkContext->ucTID;
tlMetaInfo->ucTID = pLogLinkContext->ucTID
tlMetaInfo->ucTID
tlMetaInfo
tlMetaInfo
ucTID
pLogLinkContext->ucTID
pLogLinkContext
pLogLinkContext
ucTID
tlMetaInfo->ucUP = pLogLinkContext->ucUP;
tlMetaInfo->ucUP = pLogLinkContext->ucUP
tlMetaInfo->ucUP
tlMetaInfo
tlMetaInfo
ucUP
pLogLinkContext->ucUP
pLogLinkContext
pLogLinkContext
ucUP
tlMetaInfo->ucIsEapol = VOS_FALSE;
tlMetaInfo->ucIsEapol = VOS_FALSE
tlMetaInfo->ucIsEapol
tlMetaInfo
tlMetaInfo
ucIsEapol
VOS_FALSE
VOS_FALSE
tlMetaInfo->ucDisableFrmXtl = VOS_FALSE;
tlMetaInfo->ucDisableFrmXtl = VOS_FALSE
tlMetaInfo->ucDisableFrmXtl
tlMetaInfo
tlMetaInfo
ucDisableFrmXtl
VOS_FALSE
VOS_FALSE
tlMetaInfo->ucBcast = VOS_FALSE;
tlMetaInfo->ucBcast = VOS_FALSE
tlMetaInfo->ucBcast
tlMetaInfo
tlMetaInfo
ucBcast
VOS_FALSE
VOS_FALSE
tlMetaInfo->ucMcast = VOS_FALSE;
tlMetaInfo->ucMcast = VOS_FALSE
tlMetaInfo->ucMcast
tlMetaInfo
tlMetaInfo
ucMcast
VOS_FALSE
VOS_FALSE
tlMetaInfo->ucType = 0x00;
tlMetaInfo->ucType = 0x00
tlMetaInfo->ucType
tlMetaInfo
tlMetaInfo
ucType
0x00
vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE);
vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE)
vos_mem_copy
vos_mem_copy
w8023Header.vDA
w8023Header
w8023Header
vDA
pBtampCtx->peer_mac_addr
pBtampCtx
pBtampCtx
peer_mac_addr
VOS_MAC_ADDR_SIZE
VOS_MAC_ADDR_SIZE
vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE);
vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE)
vos_mem_copy
vos_mem_copy
w8023Header.vSA
w8023Header
w8023Header
vSA
pBtampCtx->self_mac_addr
pBtampCtx
pBtampCtx
self_mac_addr
VOS_MAC_ADDR_SIZE
VOS_MAC_ADDR_SIZE
headerLength = vos_le16_to_cpu(hciACLHeader.dataLength);
headerLength = vos_le16_to_cpu(hciACLHeader.dataLength)
headerLength
headerLength
vos_le16_to_cpu(hciACLHeader.dataLength)
vos_le16_to_cpu
vos_le16_to_cpu
hciACLHeader.dataLength
hciACLHeader
hciACLHeader
dataLength
headerLength += WLANBAP_LLC_HEADER_LEN;
headerLength += WLANBAP_LLC_HEADER_LEN
headerLength
headerLength
WLANBAP_LLC_HEADER_LEN
WLANBAP_LLC_HEADER_LEN
w8023Header.usLenType = vos_cpu_to_be16(headerLength);
w8023Header.usLenType = vos_cpu_to_be16(headerLength)
w8023Header.usLenType
w8023Header
w8023Header
usLenType
vos_cpu_to_be16(headerLength)
vos_cpu_to_be16
vos_cpu_to_be16
headerLength
headerLength
protoType = vos_cpu_to_be16( protoType);
protoType = vos_cpu_to_be16( protoType)
protoType
protoType
vos_cpu_to_be16( protoType)
vos_cpu_to_be16
vos_cpu_to_be16
protoType
protoType
vos_mem_copy(aucLLCHeader,            WLANBAP_LLC_HEADER,            sizeof(WLANBAP_LLC_HEADER));
vos_mem_copy(aucLLCHeader,            WLANBAP_LLC_HEADER,            sizeof(WLANBAP_LLC_HEADER))
vos_mem_copy
vos_mem_copy
aucLLCHeader
aucLLCHeader
WLANBAP_LLC_HEADER
WLANBAP_LLC_HEADER
sizeof(WLANBAP_LLC_HEADER)
WLANBAP_LLC_HEADER
WLANBAP_LLC_HEADER
WLANBAP_LLC_HEADER

vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],            WLANBAP_BT_AMP_OUI,            WLANBAP_LLC_OUI_SIZE);
vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],            WLANBAP_BT_AMP_OUI,            WLANBAP_LLC_OUI_SIZE)
vos_mem_copy
vos_mem_copy
&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET]
aucLLCHeader[WLANBAP_LLC_OUI_OFFSET]
aucLLCHeader
aucLLCHeader
WLANBAP_LLC_OUI_OFFSET
WLANBAP_LLC_OUI_OFFSET
WLANBAP_BT_AMP_OUI
WLANBAP_BT_AMP_OUI
WLANBAP_LLC_OUI_SIZE
WLANBAP_LLC_OUI_SIZE
vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA            WLANBAP_LLC_PROTO_TYPE_SIZE);
vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA            WLANBAP_LLC_PROTO_TYPE_SIZE)
vos_mem_copy
vos_mem_copy
&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET]
aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET]
aucLLCHeader
aucLLCHeader
WLANBAP_LLC_PROTO_TYPE_OFFSET
WLANBAP_LLC_PROTO_TYPE_OFFSET
&protoType
protoType
protoType
WLANBAP_LLC_PROTO_TYPE_SIZE
WLANBAP_LLC_PROTO_TYPE_SIZE
vos_pkt_push_head(vosDataBuff,            aucLLCHeader,            WLANBAP_LLC_HEADER_LEN);
vos_pkt_push_head(vosDataBuff,            aucLLCHeader,            WLANBAP_LLC_HEADER_LEN)
vos_pkt_push_head
vos_pkt_push_head
vosDataBuff
vosDataBuff
aucLLCHeader
aucLLCHeader
WLANBAP_LLC_HEADER_LEN
WLANBAP_LLC_HEADER_LEN
vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header));
vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header))
vos_pkt_push_head
vos_pkt_push_head
vosDataBuff
vosDataBuff
&w8023Header
w8023Header
w8023Header
sizeof(w8023Header)
(w8023Header)
w8023Header
w8023Header
value = (v_U32_t)hciACLHeader.logLinkHandle;
value = (v_U32_t)hciACLHeader.logLinkHandle
value
value
(v_U32_t)hciACLHeader.logLinkHandle
v_U32_t
v_U32_t
v_U32_t

hciACLHeader.logLinkHandle
hciACLHeader
hciACLHeader
logLinkHandle
vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,                               (v_VOID_t *)value);
vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,                               (v_VOID_t *)value)
vos_pkt_set_user_data_ptr
vos_pkt_set_user_data_ptr
vosDataBuff
vosDataBuff
VOS_PKT_USER_DATA_ID_BAP
VOS_PKT_USER_DATA_ID_BAP
(v_VOID_t *)value
v_VOID_t *
v_VOID_t
v_VOID_t
*
*
value
value
return VOS_STATUS_SUCCESS;
VOS_STATUS_SUCCESS
VOS_STATUS_SUCCESS
-----joern-----
(5,3,0)
(140,93,0)
(100,142,0)
(26,84,0)
(219,223,0)
(128,38,0)
(89,64,0)
(124,3,0)
(80,59,0)
(60,73,0)
(227,157,0)
(173,14,0)
(242,7,0)
(263,104,0)
(72,126,0)
(98,90,0)
(239,151,0)
(43,98,0)
(150,187,0)
(121,106,0)
(50,109,0)
(73,60,0)
(241,107,0)
(74,224,0)
(112,34,0)
(12,215,0)
(180,265,0)
(225,261,0)
(109,215,0)
(175,91,0)
(233,43,0)
(104,263,0)
(76,3,0)
(133,3,0)
(120,185,0)
(186,121,0)
(182,34,0)
(133,252,0)
(244,171,0)
(149,87,0)
(162,93,0)
(228,257,0)
(210,265,0)
(61,3,0)
(28,254,0)
(79,113,0)
(142,151,0)
(160,84,0)
(265,3,0)
(127,224,0)
(168,137,0)
(209,159,0)
(122,69,0)
(261,203,0)
(174,3,0)
(148,173,0)
(228,180,0)
(126,183,0)
(18,3,0)
(15,64,0)
(5,93,0)
(116,89,0)
(262,3,0)
(25,257,0)
(72,157,0)
(107,42,0)
(99,173,0)
(55,245,0)
(136,246,0)
(69,115,0)
(77,3,0)
(249,4,0)
(251,180,0)
(266,201,0)
(131,209,0)
(21,3,0)
(78,161,0)
(7,3,0)
(98,248,0)
(85,153,0)
(236,64,0)
(24,164,0)
(16,103,0)
(207,60,0)
(226,69,0)
(178,236,0)
(98,3,0)
(215,231,0)
(154,147,0)
(63,61,0)
(115,69,0)
(113,3,0)
(45,15,0)
(188,261,0)
(68,212,0)
(201,14,0)
(103,64,0)
(9,73,0)
(189,120,0)
(45,145,0)
(60,3,0)
(120,164,0)
(193,98,0)
(185,151,0)
(105,201,0)
(155,203,0)
(180,228,0)
(263,52,0)
(141,214,0)
(199,254,0)
(106,121,0)
(111,263,0)
(250,203,0)
(19,145,0)
(202,126,0)
(147,111,0)
(83,236,0)
(7,242,0)
(37,3,0)
(8,31,0)
(1,3,0)
(160,130,0)
(48,153,0)
(59,5,0)
(4,3,0)
(157,3,0)
(53,185,0)
(95,209,0)
(242,171,0)
(198,110,0)
(117,121,0)
(115,3,0)
(203,231,0)
(20,199,0)
(256,203,0)
(223,92,0)
(206,199,0)
(257,215,0)
(85,61,0)
(183,228,0)
(96,169,0)
(91,31,0)
(252,36,0)
(216,3,0)
(163,111,0)
(126,3,0)
(11,5,0)
(212,90,0)
(6,38,0)
(221,3,0)
(153,3,0)
(145,159,0)
(101,252,0)
(139,137,0)
(220,34,0)
(49,263,0)
(0,36,0)
(169,90,0)
(232,9,0)
(31,215,0)
(54,9,0)
(35,164,0)
(81,209,0)
(260,50,0)
(209,161,0)
(65,3,0)
(42,107,0)
(94,245,0)
(45,28,0)
(184,31,0)
(107,265,0)
(82,92,0)
(227,192,0)
(134,89,0)
(87,169,0)
(120,109,0)
(75,151,0)
(36,3,0)
(229,3,0)
(113,39,0)
(217,257,0)
(78,27,0)
(110,151,0)
(29,72,0)
(87,76,0)
(113,214,0)
(62,153,0)
(218,239,0)
(185,4,0)
(115,210,0)
(238,64,0)
(120,142,0)
(10,3,0)
(110,6,0)
(129,75,0)
(40,127,0)
(84,160,0)
(75,77,0)
(248,98,0)
(197,28,0)
(172,106,0)
(41,199,0)
(34,166,0)
(258,3,0)
(22,127,0)
(213,15,0)
(237,133,0)
(190,52,0)
(125,263,0)
(146,203,0)
(123,103,0)
(187,236,0)
(56,3,0)
(173,151,0)
(45,50,0)
(15,108,0)
(211,115,0)
(61,85,0)
(30,84,0)
(169,87,0)
(245,209,0)
(111,3,0)
(152,142,0)
(14,201,0)
(137,39,0)
(170,21,0)
(234,265,0)
(120,227,0)
(46,74,0)
(135,34,0)
(209,245,0)
(246,3,0)
(223,126,0)
(5,59,0)
(177,169,0)
(200,7,0)
(98,43,0)
(121,3,0)
(183,126,0)
(50,166,0)
(253,27,0)
(91,76,0)
(181,127,0)
(71,103,0)
(103,108,0)
(120,110,0)
(39,137,0)
(91,175,0)
(236,90,0)
(263,97,0)
(44,76,0)
(191,3,0)
(32,110,0)
(179,36,0)
(144,212,0)
(120,237,0)
(257,228,0)
(176,171,0)
(267,212,0)
(222,265,0)
(73,9,0)
(45,120,0)
(38,126,0)
(33,21,0)
(157,72,0)
(120,173,0)
(67,72,0)
(196,147,0)
(45,74,0)
(194,38,0)
(2,210,0)
(107,97,0)
(263,111,0)
(51,191,0)
(228,183,0)
(240,199,0)
(27,78,0)
(36,60,0)
(52,263,0)
(102,7,0)
(214,113,0)
(120,3,0)
(156,85,0)
(143,237,0)
(31,91,0)
(167,209,0)
(252,133,0)
(247,109,0)
(70,3,0)
(264,227,0)
(204,210,0)
(164,151,0)
(76,91,0)
(236,187,0)
(23,127,0)
(205,59,0)
(212,3,0)
(14,3,0)
(130,160,0)
(47,3,0)
(119,234,0)
(64,236,0)
(38,6,0)
(57,223,0)
(120,75,0)
(235,87,0)
(88,78,0)
(86,234,0)
(214,61,0)
(195,3,0)
(158,180,0)
(58,103,0)
(132,216,0)
(66,3,0)
(118,109,0)
(93,265,0)
(39,113,0)
(165,237,0)
(114,27,0)
(64,3,0)
(259,239,0)
(120,239,0)
(13,75,0)
(169,3,0)
(210,115,0)
(263,161,0)
(243,209,0)
(255,3,0)
(230,248,0)
(87,149,0)
(17,77,0)
(164,216,0)
(6,3,0)
(208,185,0)
(171,242,0)
(201,126,0)
(203,261,0)
(92,223,0)
(239,246,0)
(142,191,0)
(265,107,0)
(93,5,0)
(138,104,0)
(62,48,1)
(130,160,1)
(84,30,1)
(191,51,1)
(22,181,1)
(127,40,1)
(7,102,1)
(4,249,1)
(236,90,1)
(120,185,1)
(98,248,1)
(14,201,1)
(87,149,1)
(145,19,1)
(115,211,1)
(205,115,1)
(7,242,1)
(119,86,1)
(28,197,1)
(110,198,1)
(72,67,1)
(69,226,1)
(29,227,1)
(31,215,1)
(184,8,1)
(196,154,1)
(85,156,1)
(79,214,1)
(267,144,1)
(82,223,1)
(23,22,1)
(173,151,1)
(236,178,1)
(131,243,1)
(120,227,1)
(89,64,1)
(210,265,1)
(147,196,1)
(238,234,1)
(5,93,1)
(180,265,1)
(219,57,1)
(203,155,1)
(208,191,1)
(88,89,1)
(86,21,1)
(11,93,1)
(95,131,1)
(155,261,1)
(248,230,1)
(45,74,1)
(123,71,1)
(57,126,1)
(227,192,1)
(203,261,1)
(25,180,1)
(120,189,1)
(24,35,1)
(102,200,1)
(228,257,1)
(112,135,1)
(257,217,1)
(34,220,1)
(129,13,1)
(152,77,1)
(33,170,1)
(147,111,1)
(263,52,1)
(144,68,1)
(49,163,1)
(223,126,1)
(188,256,1)
(101,237,1)
(263,97,1)
(16,58,1)
(164,24,1)
(215,12,1)
(100,152,1)
(120,239,1)
(20,41,1)
(142,151,1)
(214,61,1)
(50,109,1)
(45,50,1)
(266,105,1)
(181,147,1)
(163,78,1)
(26,147,1)
(55,167,1)
(21,33,1)
(0,60,1)
(206,240,1)
(234,119,1)
(242,171,1)
(71,89,1)
(6,38,1)
(54,207,1)
(85,153,1)
(180,251,1)
(120,164,1)
(253,114,1)
(93,162,1)
(167,81,1)
(32,14,1)
(207,5,1)
(40,23,1)
(148,99,1)
(137,168,1)
(233,248,1)
(197,199,1)
(234,265,1)
(227,264,1)
(146,130,1)
(73,9,1)
(120,110,1)
(8,44,1)
(126,183,1)
(17,75,1)
(93,265,1)
(204,69,1)
(63,133,1)
(51,142,1)
(128,110,1)
(110,151,1)
(83,238,1)
(250,146,1)
(235,177,1)
(246,136,1)
(59,80,1)
(251,158,1)
(138,125,1)
(31,184,1)
(164,151,1)
(96,76,1)
(134,116,1)
(214,141,1)
(107,42,1)
(243,78,1)
(45,145,1)
(185,151,1)
(241,222,1)
(257,215,1)
(177,96,1)
(50,260,1)
(91,175,1)
(132,164,1)
(182,112,1)
(213,103,1)
(78,161,1)
(194,128,1)
(5,59,1)
(153,62,1)
(230,193,1)
(91,31,1)
(178,187,1)
(236,187,1)
(120,237,1)
(30,26,1)
(2,204,1)
(75,129,1)
(115,69,1)
(74,46,1)
(212,267,1)
(171,176,1)
(162,140,1)
(256,250,1)
(12,109,1)
(220,182,1)
(252,36,1)
(135,92,1)
(173,148,1)
(179,0,1)
(118,247,1)
(201,266,1)
(98,43,1)
(170,153,1)
(187,150,1)
(45,120,1)
(133,252,1)
(61,85,1)
(263,104,1)
(77,17,1)
(169,90,1)
(78,27,1)
(165,36,1)
(209,245,1)
(45,15,1)
(89,134,1)
(107,97,1)
(115,210,1)
(15,64,1)
(245,94,1)
(186,117,1)
(104,138,1)
(38,126,1)
(122,246,1)
(58,123,1)
(72,126,1)
(125,49,1)
(111,263,1)
(252,101,1)
(45,28,1)
(106,172,1)
(38,194,1)
(247,203,1)
(15,213,1)
(68,113,1)
(98,90,1)
(193,212,1)
(81,95,1)
(67,29,1)
(156,63,1)
(265,107,1)
(223,219,1)
(39,137,1)
(141,39,1)
(116,64,1)
(76,91,1)
(216,132,1)
(109,118,1)
(154,111,1)
(103,16,1)
(240,234,1)
(139,7,1)
(19,209,1)
(259,4,1)
(92,82,1)
(140,59,1)
(189,169,1)
(114,88,1)
(160,84,1)
(136,239,1)
(201,126,1)
(263,161,1)
(185,53,1)
(36,179,1)
(260,34,1)
(87,235,1)
(5,11,1)
(52,190,1)
(232,54,1)
(169,87,1)
(150,83,1)
(198,32,1)
(217,25,1)
(107,241,1)
(264,92,1)
(120,109,1)
(9,232,1)
(168,139,1)
(202,130,1)
(41,206,1)
(53,208,1)
(157,72,1)
(225,188,1)
(92,223,1)
(75,151,1)
(261,225,1)
(99,157,1)
(113,214,1)
(249,185,1)
(120,173,1)
(239,151,1)
(212,90,1)
(44,98,1)
(48,265,1)
(202,215,1)
(226,122,1)
(172,186,1)
(211,210,1)
(94,55,1)
(209,161,1)
(176,244,1)
(239,218,1)
(117,61,1)
(120,75,1)
(103,64,1)
(64,236,1)
(143,165,1)
(46,127,1)
(27,253,1)
(105,173,1)
(80,205,1)
(43,233,1)
(228,180,1)
(36,60,1)
(121,106,1)
(87,76,1)
(244,121,1)
(237,143,1)
(60,73,1)
(35,6,1)
(218,259,1)
(13,216,1)
(142,100,1)
(190,104,1)
(113,39,1)
(199,20,1)
(183,228,1)
(200,242,1)
(158,202,1)
(120,142,1)
(210,2,1)
(113,79,1)
(55,78,2)
(81,78,2)
(210,92,2)
(35,92,2)
(22,147,2)
(182,92,2)
(239,92,2)
(243,78,2)
(120,164,2)
(91,92,2)
(14,201,2)
(75,92,2)
(261,130,2)
(220,92,2)
(212,90,2)
(121,92,2)
(245,78,2)
(13,92,2)
(115,69,2)
(43,92,2)
(76,92,2)
(16,89,2)
(223,147,2)
(19,78,2)
(148,92,2)
(30,147,2)
(177,92,2)
(120,109,2)
(145,78,2)
(98,43,2)
(120,227,2)
(263,161,2)
(235,92,2)
(45,74,2)
(160,84,2)
(107,42,2)
(201,126,2)
(213,89,2)
(251,147,2)
(147,78,2)
(45,50,2)
(6,92,2)
(31,92,2)
(26,147,2)
(5,92,2)
(38,126,2)
(109,130,2)
(143,92,2)
(69,92,2)
(238,234,2)
(196,78,2)
(126,183,2)
(118,130,2)
(201,92,2)
(46,147,2)
(144,92,2)
(216,92,2)
(139,92,2)
(85,153,2)
(211,92,2)
(173,92,2)
(120,237,2)
(101,92,2)
(96,92,2)
(115,210,2)
(28,234,2)
(128,92,2)
(209,245,2)
(111,263,2)
(2,92,2)
(264,92,2)
(207,92,2)
(212,92,2)
(36,60,2)
(98,90,2)
(178,234,2)
(60,92,2)
(185,92,2)
(247,130,2)
(14,92,2)
(6,38,2)
(93,265,2)
(263,104,2)
(120,75,2)
(183,228,2)
(236,234,2)
(205,92,2)
(45,28,2)
(206,234,2)
(152,92,2)
(31,215,2)
(204,92,2)
(252,92,2)
(129,92,2)
(91,31,2)
(8,92,2)
(78,27,2)
(187,234,2)
(103,89,2)
(203,130,2)
(202,147,2)
(64,234,2)
(134,234,2)
(87,149,2)
(183,147,2)
(248,92,2)
(164,151,2)
(80,92,2)
(27,89,2)
(75,151,2)
(112,92,2)
(250,130,2)
(180,265,2)
(92,223,2)
(208,92,2)
(91,175,2)
(89,64,2)
(36,92,2)
(240,234,2)
(140,92,2)
(103,64,2)
(83,234,2)
(176,92,2)
(50,109,2)
(78,161,2)
(120,110,2)
(92,147,2)
(194,92,2)
(15,89,2)
(98,92,2)
(263,52,2)
(242,92,2)
(197,234,2)
(249,92,2)
(215,130,2)
(157,92,2)
(102,92,2)
(84,147,2)
(228,180,2)
(53,92,2)
(225,130,2)
(185,151,2)
(236,187,2)
(198,92,2)
(73,92,2)
(57,147,2)
(45,145,2)
(168,92,2)
(135,92,2)
(171,92,2)
(133,92,2)
(95,78,2)
(217,147,2)
(49,78,2)
(256,130,2)
(199,234,2)
(113,92,2)
(181,147,2)
(107,97,2)
(72,126,2)
(209,78,2)
(99,92,2)
(120,92,2)
(160,147,2)
(219,147,2)
(162,92,2)
(110,92,2)
(234,265,2)
(146,130,2)
(110,151,2)
(218,92,2)
(257,215,2)
(116,234,2)
(89,234,2)
(210,265,2)
(203,261,2)
(74,147,2)
(130,147,2)
(32,92,2)
(88,89,2)
(189,92,2)
(227,92,2)
(34,92,2)
(79,92,2)
(68,92,2)
(184,92,2)
(186,92,2)
(257,147,2)
(253,89,2)
(223,126,2)
(115,92,2)
(58,89,2)
(169,90,2)
(25,147,2)
(155,130,2)
(242,171,2)
(138,78,2)
(106,92,2)
(120,185,2)
(236,90,2)
(45,120,2)
(165,92,2)
(179,92,2)
(105,92,2)
(87,76,2)
(113,39,2)
(93,92,2)
(230,92,2)
(40,147,2)
(263,78,2)
(104,78,2)
(98,248,2)
(7,242,2)
(64,236,2)
(4,92,2)
(123,89,2)
(265,107,2)
(77,92,2)
(85,92,2)
(71,89,2)
(94,78,2)
(29,92,2)
(142,151,2)
(7,92,2)
(24,92,2)
(127,147,2)
(237,92,2)
(147,111,2)
(228,147,2)
(63,92,2)
(164,92,2)
(157,72,2)
(122,92,2)
(72,92,2)
(44,92,2)
(158,147,2)
(117,92,2)
(180,147,2)
(252,36,2)
(228,257,2)
(244,92,2)
(191,92,2)
(39,137,2)
(263,97,2)
(9,92,2)
(169,92,2)
(121,106,2)
(52,78,2)
(141,92,2)
(11,92,2)
(120,239,2)
(76,91,2)
(260,92,2)
(173,151,2)
(188,130,2)
(23,147,2)
(20,234,2)
(73,9,2)
(232,92,2)
(15,64,2)
(131,78,2)
(51,92,2)
(126,147,2)
(190,78,2)
(163,78,2)
(61,92,2)
(38,92,2)
(113,214,2)
(227,192,2)
(120,142,2)
(172,92,2)
(59,92,2)
(200,92,2)
(5,59,2)
(45,15,2)
(0,92,2)
(169,87,2)
(87,92,2)
(267,92,2)
(259,92,2)
(214,92,2)
(50,92,2)
(156,92,2)
(114,89,2)
(214,61,2)
(154,78,2)
(39,92,2)
(60,73,2)
(125,78,2)
(137,92,2)
(133,252,2)
(82,147,2)
(5,93,2)
(246,92,2)
(193,92,2)
(41,234,2)
(136,92,2)
(233,92,2)
(132,92,2)
(12,130,2)
(209,161,2)
(17,92,2)
(54,92,2)
(111,78,2)
(266,92,2)
(226,92,2)
(142,92,2)
(100,92,2)
(167,78,2)
(67,92,2)
(130,160,2)
(61,85,2)
(120,173,2)
(150,234,2)
(78,89,2)
(239,151,2)
-----------------------------------
(0,headerLength)
(1,pBtampCtx)
(2,peer_mac_addr)
(3,)
(4,tlMetaInfo->ucMcast = VOS_FALSE)
(5,vos_mem_copy( w8023Header.vSA, pBtampCtx->self_mac_addr, VOS_MAC_ADDR_SIZE)
(6,tlMetaInfo->ucUP = pLogLinkContext->ucUP)
(7,vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET],\n\\n            WLANBAP_BT_AMP_OUI,\n\\n            WLANBAP_LLC_OUI_SIZE)
(8,hciACLHeader)
(9,hciACLHeader.dataLength)
(10,ucSTAId)
(11,VOS_MAC_ADDR_SIZE)
(12,1)
(13,tlMetaInfo)
(14,tlMetaInfo->ucTID = pLogLinkContext->ucTID)
(15,return vosStatus;)
(16,vosStatus)
(17,VOS_FALSE)
(18,vosStatus)
(19,VOS_STATUS_E_INVAL)
(20,__func__)
(21,value = 0)
(22,VOS_TRACE_LEVEL_INFO)
(23,"Unable to retrieve STA Id from BAP context and phy_link_handle in %s")
(24,ucIsEapol)
(25,hciACLHeader)
(26,hciACLHeader)
(27,hciACLHeader.phyLinkHandle)
(28,return VOS_STATUS_E_FAULT;)
(29,pLogLinkContext)
(30,logLinkHandle)
(31,hciACLHeader.logLinkHandle)
(32,tlMetaInfo)
(33,0)
(34,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,\n\\n                "WLAN BAP: Invalid logical link entry in %s",\n\\n                __func__)
(35,tlMetaInfo)
(36,headerLength += WLANBAP_LLC_HEADER_LEN)
(37,aucLLCHeader)
(38,pLogLinkContext->ucUP)
(39,&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET])
(40,__func__)
(41,"Invalid BAP handle value in %s")
(42,ptBtampContext)
(43,sizeof(w8023Header)
(44,value)
(45,RET)
(46,VOS_STATUS_E_FAULT)
(47,hciACLHeader)
(48,protoType)
(49,btampHandle)
(50,return VOS_STATUS_E_INVAL;)
(51,VOS_FALSE)
(52,&pHddHdl)
(53,ucMcast)
(54,hciACLHeader)
(55,hciACLHeader)
(56,pLogLinkContext)
(57,pLogLinkContext)
(58,"WLAN BAP: Failed to pop HCI ACL header from packet %d")
(59,w8023Header.vSA)
(60,headerLength = vos_le16_to_cpu(hciACLHeader.dataLength)
(61,protoType = vos_cpu_to_be16( protoType)
(62,WLANBAP_BT_AMP_TYPE_DATA)
(63,protoType)
(64,vosStatus = vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN)
(65,value)
(66,if ( pLogLinkContext->present != VOS_TRUE)
(67,btampAC)
(68,vosDataBuff)
(69,w8023Header.vDA)
(70,if ( VOS_STATUS_SUCCESS != vosStatus )
(71,VOS_MODULE_ID_BAP)
(72,pLogLinkContext->btampAC)
(73,vos_le16_to_cpu(hciACLHeader.dataLength)
(74,return VOS_STATUS_E_FAULT;)
(75,tlMetaInfo->ucDisableFrmXtl)
(76,value = (v_U32_t)
(77,tlMetaInfo->ucDisableFrmXtl = VOS_FALSE)
(78,phy_link_handle != hciACLHeader.phyLinkHandle)
(79,WLANBAP_LLC_PROTO_TYPE_SIZE)
(80,vSA)
(81,__func__)
(82,VOS_TRUE)
(83,vosDataBuff)
(84,hciACLHeader.logLinkHandle)
(85,vos_cpu_to_be16( protoType)
(86,NULL)
(87,(v_VOID_t *)
(88,phy_link_handle)
(89,VOS_STATUS_SUCCESS != vosStatus)
(90,vos_pkt_t        *vosDataBuff)
(91,(v_U32_t)
(92,pLogLinkContext->present != VOS_TRUE)
(93,pBtampCtx->self_mac_addr)
(94,phyLinkHandle)
(95,"WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d")
(96,vosDataBuff)
(97,ptBtampHandle     btampHandle)
(98,vos_pkt_push_head(vosDataBuff, &w8023Header, sizeof(w8023Header)
(99,tlMetaInfo)
(100,ucBcast)
(101,headerLength)
(102,WLANBAP_LLC_OUI_SIZE)
(103,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,\n\\n                  "WLAN BAP: Failed to pop HCI ACL header from packet %d",\n\\n                  vosStatus)
(104,&ucSTAId)
(105,pLogLinkContext)
(106,sizeof(WLANBAP_LLC_HEADER)
(107,(ptBtampContext)
(108,)
(109,hciACLHeader.logLinkHandle)
(110,tlMetaInfo->ucUP)
(111,vosStatus = WLANBAP_GetStaIdFromLinkCtx (\n\\n            btampHandle,  /* btampHandle value in  */\n\\n            phy_link_handle,  /* phy_link_handle value in */\n\\n            &ucSTAId,  /* The StaId (used by TL, PE, and HAL)
(112,VOS_TRACE_LEVEL_ERROR)
(113,vos_mem_copy(&aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET],\n\\n            &protoType,  //WLANBAP_BT_AMP_TYPE_DATA\n\\n            WLANBAP_LLC_PROTO_TYPE_SIZE)
(114,hciACLHeader)
(115,vos_mem_copy( w8023Header.vDA, pBtampCtx->peer_mac_addr, VOS_MAC_ADDR_SIZE)
(116,VOS_STATUS_SUCCESS)
(117,aucLLCHeader)
(118,logLinkHandle)
(119,pBtampCtx)
(120,return VOS_STATUS_SUCCESS;)
(121,vos_mem_copy(aucLLCHeader,\n\\n            WLANBAP_LLC_HEADER,\n\\n            sizeof(WLANBAP_LLC_HEADER)
(122,w8023Header)
(123,VOS_TRACE_LEVEL_ERROR)
(124,headerLength)
(125,phy_link_handle)
(126,pLogLinkContext = &(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
(127,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_INFO,\n\\n                     "Unable to retrieve STA Id from BAP context and phy_link_handle in %s", __func__)
(128,pLogLinkContext)
(129,ucDisableFrmXtl)
(130,!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle)
(131,VOS_TRACE_LEVEL_ERROR)
(132,VOS_FALSE)
(133,w8023Header.usLenType = vos_cpu_to_be16(headerLength)
(134,vosStatus)
(135,VOS_MODULE_ID_BAP)
(136,0x00)
(137,aucLLCHeader[WLANBAP_LLC_PROTO_TYPE_OFFSET])
(138,ucSTAId)
(139,aucLLCHeader)
(140,pBtampCtx)
(141,protoType)
(142,tlMetaInfo->ucBcast)
(143,usLenType)
(144,aucLLCHeader)
(145,return VOS_STATUS_E_INVAL;)
(146,VOS_MODULE_ID_BAP)
(147,VOS_STATUS_SUCCESS != vosStatus)
(148,ucTID)
(149,v_VOID_t *)
(150,hciACLHeader)
(151,WLANTL_MetaInfoType  *tlMetaInfo)
(152,tlMetaInfo)
(153,protoType = WLANBAP_BT_AMP_TYPE_DATA)
(154,VOS_STATUS_SUCCESS)
(155,__func__)
(156,protoType)
(157,*pucAC = pLogLinkContext->btampAC)
(158,pBtampCtx)
(159,)
(160,BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle)
(161,v_U8_t            phy_link_handle)
(162,self_mac_addr)
(163,vosStatus)
(164,tlMetaInfo->ucIsEapol)
(165,w8023Header)
(166,)
(167,phy_link_handle)
(168,WLANBAP_LLC_PROTO_TYPE_OFFSET)
(169,vos_pkt_set_user_data_ptr( vosDataBuff, VOS_PKT_USER_DATA_ID_BAP,\n\\n                               (v_VOID_t *)
(170,value)
(171,aucLLCHeader[WLANBAP_LLC_OUI_OFFSET])
(172,WLANBAP_LLC_HEADER)
(173,tlMetaInfo->ucTID)
(174,if ( VOS_STATUS_SUCCESS != vosStatus )
(175,v_U32_t)
(176,WLANBAP_LLC_OUI_OFFSET)
(177,VOS_PKT_USER_DATA_ID_BAP)
(178,WLANBAP_HCI_ACL_HEADER_LEN)
(179,WLANBAP_LLC_HEADER_LEN)
(180,pBtampCtx->btampLogLinkCtx)
(181,VOS_MODULE_ID_BAP)
(182,"WLAN BAP: Invalid logical link entry in %s")
(183,&(pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
(184,logLinkHandle)
(185,tlMetaInfo->ucMcast)
(186,WLANBAP_LLC_HEADER)
(187,&hciACLHeader)
(188,hciACLHeader)
(189,VOS_STATUS_SUCCESS)
(190,pHddHdl)
(191,tlMetaInfo->ucBcast = VOS_FALSE)
(192,WLANTL_ACEnumType    *pucAC)
(193,vosDataBuff)
(194,ucUP)
(195,pHddHdl)
(196,vosStatus)
(197,VOS_STATUS_E_FAULT)
(198,ucUP)
(199,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,\n\\n                     "Invalid BAP handle value in %s", __func__)
(200,WLANBAP_BT_AMP_OUI)
(201,pLogLinkContext->ucTID)
(202,pLogLinkContext)
(203,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,\n\\n                "WLAN BAP: Invalid logical link handle (%d)
(204,pBtampCtx)
(205,w8023Header)
(206,VOS_TRACE_LEVEL_ERROR)
(207,headerLength)
(208,tlMetaInfo)
(209,VOS_TRACE( VOS_MODULE_ID_BAP, VOS_TRACE_LEVEL_ERROR,\n\\n                "WLAN BAP: phy_link_handle mismatch in %s phy_link_handle=%d hciACLHeader.phyLinkHandle=%d",\n\\n                __func__, phy_link_handle, hciACLHeader.phyLinkHandle)
(210,pBtampCtx->peer_mac_addr)
(211,VOS_MAC_ADDR_SIZE)
(212,vos_pkt_push_head(vosDataBuff,\n\\n            aucLLCHeader,\n\\n            WLANBAP_LLC_HEADER_LEN)
(213,vosStatus)
(214,&protoType)
(215,hciACLHeader.logLinkHandle = 1)
(216,tlMetaInfo->ucIsEapol = VOS_FALSE)
(217,logLinkHandle)
(218,ucType)
(219,present)
(220,__func__)
(221,if (!BTAMP_VALID_LOG_LINK( hciACLHeader.logLinkHandle)
(222,pBtampCtx)
(223,pLogLinkContext->present)
(224,)
(225,logLinkHandle)
(226,vDA)
(227,*pucAC)
(228,pBtampCtx->btampLogLinkCtx[ hciACLHeader.logLinkHandle ])
(229,w8023Header)
(230,w8023Header)
(231,)
(232,dataLength)
(233,w8023Header)
(234,NULL == pBtampCtx)
(235,value)
(236,vos_pkt_pop_head( vosDataBuff, &hciACLHeader, WLANBAP_HCI_ACL_HEADER_LEN)
(237,w8023Header.usLenType)
(238,vosStatus)
(239,tlMetaInfo->ucType)
(240,VOS_MODULE_ID_BAP)
(241,btampHandle)
(242,&aucLLCHeader[WLANBAP_LLC_OUI_OFFSET])
(243,VOS_MODULE_ID_BAP)
(244,aucLLCHeader)
(245,hciACLHeader.phyLinkHandle)
(246,tlMetaInfo->ucType = 0x00)
(247,hciACLHeader)
(248,&w8023Header)
(249,VOS_FALSE)
(250,VOS_TRACE_LEVEL_ERROR)
(251,btampLogLinkCtx)
(252,vos_cpu_to_be16(headerLength)
(253,phyLinkHandle)
(254,)
(255,if ( phy_link_handle != hciACLHeader.phyLinkHandle )
(256,"WLAN BAP: Invalid logical link handle (%d)
(257,hciACLHeader.logLinkHandle)
(258,protoType)
(259,tlMetaInfo)
(260,VOS_STATUS_E_INVAL)
(261,hciACLHeader.logLinkHandle)
(262,if ( NULL == pBtampCtx)
(263,WLANBAP_GetStaIdFromLinkCtx (\n\\n            btampHandle,  /* btampHandle value in  */\n\\n            phy_link_handle,  /* phy_link_handle value in */\n\\n            &ucSTAId,  /* The StaId (used by TL, PE, and HAL)
(264,pucAC)
(265,pBtampCtx = (ptBtampContext)
(266,ucTID)
(267,WLANBAP_LLC_HEADER_LEN)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^