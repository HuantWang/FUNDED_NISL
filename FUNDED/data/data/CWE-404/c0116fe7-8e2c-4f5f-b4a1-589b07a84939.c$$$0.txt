-----label-----
0
-----code-----
static int cciss_ioctl(struct block_device *bdev, fmode_t mode,
	unsigned int cmd, unsigned long arg)
{
	struct gendisk *disk = bdev->bd_disk;
	ctlr_info_t *h = get_host(disk);
	void __user *argp = (void __user *)arg;

	dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\n",
		cmd, arg);
	switch (cmd) {
	case CCISS_GETPCIINFO:
		return cciss_getpciinfo(h, argp);
	case CCISS_GETINTINFO:
		return cciss_getintinfo(h, argp);
	case CCISS_SETINTINFO:
		return cciss_setintinfo(h, argp);
	case CCISS_GETNODENAME:
		return cciss_getnodename(h, argp);
	case CCISS_SETNODENAME:
		return cciss_setnodename(h, argp);
	case CCISS_GETHEARTBEAT:
		return cciss_getheartbeat(h, argp);
	case CCISS_GETBUSTYPES:
		return cciss_getbustypes(h, argp);
	case CCISS_GETFIRMVER:
		return cciss_getfirmver(h, argp);
	case CCISS_GETDRIVVER:
		return cciss_getdrivver(h, argp);
	case CCISS_DEREGDISK:
	case CCISS_REGNEWD:
	case CCISS_REVALIDVOLS:
		return rebuild_lun_table(h, 0, 1);
	case CCISS_GETLUNINFO:
		return cciss_getluninfo(h, disk, argp);
	case CCISS_PASSTHRU:
		return cciss_passthru(h, argp);
	case CCISS_BIG_PASSTHRU:
		return cciss_bigpassthru(h, argp);

	/* scsi_cmd_ioctl handles these, below, though some are not */
	/* very meaningful for cciss.  SG_IO is the main one people want. */

	case SG_GET_VERSION_NUM:
	case SG_SET_TIMEOUT:
	case SG_GET_TIMEOUT:
	case SG_GET_RESERVED_SIZE:
	case SG_SET_RESERVED_SIZE:
	case SG_EMULATED_HOST:
	case SG_IO:
	case SCSI_IOCTL_SEND_COMMAND:
		return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);

	/* scsi_cmd_ioctl would normally handle these, below, but */
	/* they aren't a good fit for cciss, as CD-ROMs are */
	/* not supported, and we don't have any bus/target/lun */
	/* which we present to the kernel. */

	case CDROM_SEND_PACKET:
	case CDROMCLOSETRAY:
	case CDROMEJECT:
	case SCSI_IOCTL_GET_IDLUN:
	case SCSI_IOCTL_GET_BUS_NUMBER:
	default:
		return -ENOTTY;
	}
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
3,8
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
16,17
16,18
18,19
20,21
20,22
22,23
24,25
24,26
24,27
24,28
24,29
24,30
24,31
25,26
26,27
26,28
27,28
29,30
29,31
29,32
32,33
33,34
33,35
34,35
37,38
38,39
38,40
39,40
41,42
41,43
41,44
44,45
45,46
45,47
46,47
48,49
50,51
51,52
51,53
53,54
55,56
56,57
57,58
58,59
58,60
58,61
58,62
58,63
59,60
61,62
62,63
62,64
63,64
63,65
64,65
69,70
71,72
73,74
73,75
74,75
76,77
76,78
76,79
76,80
76,81
76,82
76,83
76,84
76,85
76,86
76,87
76,88
76,89
76,90
76,91
76,92
76,93
76,94
76,95
76,96
76,97
76,98
76,99
76,100
76,101
76,102
76,103
76,104
76,105
76,106
76,107
76,108
76,109
76,110
76,111
76,112
76,113
76,114
76,115
76,116
76,117
76,118
76,119
76,120
77,78
78,79
80,81
81,82
81,83
81,84
82,83
84,85
86,87
88,89
89,90
91,92
92,93
92,94
92,95
93,94
95,96
97,98
99,100
100,101
102,103
103,104
103,105
103,106
104,105
106,107
108,109
110,111
111,112
113,114
114,115
114,116
114,117
115,116
117,118
119,120
121,122
122,123
124,125
125,126
125,127
125,128
126,127
128,129
130,131
132,133
133,134
135,136
136,137
136,138
136,139
137,138
139,140
141,142
143,144
144,145
146,147
147,148
147,149
147,150
148,149
150,151
152,153
154,155
155,156
157,158
158,159
158,160
158,161
159,160
161,162
163,164
165,166
166,167
168,169
169,170
169,171
169,172
170,171
172,173
174,175
176,177
177,178
179,180
180,181
182,183
183,184
185,186
186,187
186,188
186,189
186,190
187,188
189,190
193,194
194,195
196,197
197,198
197,199
197,200
197,201
198,199
200,201
202,203
204,205
206,207
207,208
209,210
210,211
210,212
210,213
211,212
213,214
215,216
217,218
218,219
220,221
221,222
221,223
221,224
222,223
224,225
226,227
228,229
229,230
231,232
232,233
234,235
235,236
237,238
238,239
240,241
241,242
243,244
244,245
246,247
247,248
249,250
250,251
252,253
253,254
253,255
253,256
253,257
253,258
253,259
254,255
256,257
256,258
257,258
260,261
262,263
264,265
266,267
268,269
269,270
271,272
272,273
274,275
275,276
277,278
278,279
280,281
281,282
284,285
285,286
286,287
-----nextToken-----
2,4,7,9,10,13,15,17,19,21,23,28,30,31,35,36,40,42,43,47,49,52,54,60,65,66,67,68,70,72,75,79,83,85,87,90,94,96,98,101,105,107,109,112,116,118,120,123,127,129,131,134,138,140,142,145,149,151,153,156,160,162,164,167,171,173,175,178,181,184,188,190,191,192,195,199,201,203,205,208,212,214,216,219,223,225,227,230,233,236,239,242,245,248,251,255,258,259,261,263,265,267,270,273,276,279,282,283,287
-----computeFrom-----
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ProblemStatement;ProblemStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;SwitchStatement;IdExpression;Name;CompoundStatement;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;LiteralExpression;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;CaseStatement;IdExpression;Name;DefaultStatement;ReturnStatement;UnaryExpression;IdExpression;Name;
-----ast_node-----
static int cciss_ioctl(struct block_device *bdev, fmode_t mode,	unsigned int cmd, unsigned long arg){	struct gendisk *disk = bdev->bd_disk;	ctlr_info_t *h = get_host(disk);	void __user *argp = (void __user *)arg;	dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\n",		cmd, arg);	switch (cmd) {	case CCISS_GETPCIINFO:		return cciss_getpciinfo(h, argp);	case CCISS_GETINTINFO:		return cciss_getintinfo(h, argp);	case CCISS_SETINTINFO:		return cciss_setintinfo(h, argp);	case CCISS_GETNODENAME:		return cciss_getnodename(h, argp);	case CCISS_SETNODENAME:		return cciss_setnodename(h, argp);	case CCISS_GETHEARTBEAT:		return cciss_getheartbeat(h, argp);	case CCISS_GETBUSTYPES:		return cciss_getbustypes(h, argp);	case CCISS_GETFIRMVER:		return cciss_getfirmver(h, argp);	case CCISS_GETDRIVVER:		return cciss_getdrivver(h, argp);	case CCISS_DEREGDISK:	case CCISS_REGNEWD:	case CCISS_REVALIDVOLS:		return rebuild_lun_table(h, 0, 1);	case CCISS_GETLUNINFO:		return cciss_getluninfo(h, disk, argp);	case CCISS_PASSTHRU:		return cciss_passthru(h, argp);	case CCISS_BIG_PASSTHRU:		return cciss_bigpassthru(h, argp);	/* scsi_cmd_ioctl handles these, below, though some are not */	/* very meaningful for cciss.  SG_IO is the main one people want. */	case SG_GET_VERSION_NUM:	case SG_SET_TIMEOUT:	case SG_GET_TIMEOUT:	case SG_GET_RESERVED_SIZE:	case SG_SET_RESERVED_SIZE:	case SG_EMULATED_HOST:	case SG_IO:	case SCSI_IOCTL_SEND_COMMAND:		return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);	/* scsi_cmd_ioctl would normally handle these, below, but */	/* they aren't a good fit for cciss, as CD-ROMs are */	/* not supported, and we don't have any bus/target/lun */	/* which we present to the kernel. */	case CDROM_SEND_PACKET:	case CDROMCLOSETRAY:	case CDROMEJECT:	case SCSI_IOCTL_GET_IDLUN:	case SCSI_IOCTL_GET_BUS_NUMBER:	default:		return -ENOTTY;	}}
static int
cciss_ioctl(struct block_device *bdev, fmode_t mode,	unsigned int cmd, unsigned long arg)
cciss_ioctl
struct block_device *bdev
struct block_device
block_device
*bdev
*
bdev
fmode_t mode
fmode_t
fmode_t
mode
mode
unsigned int cmd
unsigned int
cmd
cmd
unsigned long arg
unsigned long
arg
arg
{	struct gendisk *disk = bdev->bd_disk;	ctlr_info_t *h = get_host(disk);	void __user *argp = (void __user *)arg;	dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\n",		cmd, arg);	switch (cmd) {	case CCISS_GETPCIINFO:		return cciss_getpciinfo(h, argp);	case CCISS_GETINTINFO:		return cciss_getintinfo(h, argp);	case CCISS_SETINTINFO:		return cciss_setintinfo(h, argp);	case CCISS_GETNODENAME:		return cciss_getnodename(h, argp);	case CCISS_SETNODENAME:		return cciss_setnodename(h, argp);	case CCISS_GETHEARTBEAT:		return cciss_getheartbeat(h, argp);	case CCISS_GETBUSTYPES:		return cciss_getbustypes(h, argp);	case CCISS_GETFIRMVER:		return cciss_getfirmver(h, argp);	case CCISS_GETDRIVVER:		return cciss_getdrivver(h, argp);	case CCISS_DEREGDISK:	case CCISS_REGNEWD:	case CCISS_REVALIDVOLS:		return rebuild_lun_table(h, 0, 1);	case CCISS_GETLUNINFO:		return cciss_getluninfo(h, disk, argp);	case CCISS_PASSTHRU:		return cciss_passthru(h, argp);	case CCISS_BIG_PASSTHRU:		return cciss_bigpassthru(h, argp);	/* scsi_cmd_ioctl handles these, below, though some are not */	/* very meaningful for cciss.  SG_IO is the main one people want. */	case SG_GET_VERSION_NUM:	case SG_SET_TIMEOUT:	case SG_GET_TIMEOUT:	case SG_GET_RESERVED_SIZE:	case SG_SET_RESERVED_SIZE:	case SG_EMULATED_HOST:	case SG_IO:	case SCSI_IOCTL_SEND_COMMAND:		return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);	/* scsi_cmd_ioctl would normally handle these, below, but */	/* they aren't a good fit for cciss, as CD-ROMs are */	/* not supported, and we don't have any bus/target/lun */	/* which we present to the kernel. */	case CDROM_SEND_PACKET:	case CDROMCLOSETRAY:	case CDROMEJECT:	case SCSI_IOCTL_GET_IDLUN:	case SCSI_IOCTL_GET_BUS_NUMBER:	default:		return -ENOTTY;	}}
struct gendisk *disk = bdev->bd_disk;
struct gendisk *disk = bdev->bd_disk;
struct gendisk
gendisk
*disk = bdev->bd_disk
*
disk
= bdev->bd_disk
bdev->bd_disk
bdev
bdev
bd_disk
ctlr_info_t *h = get_host(disk);
ctlr_info_t *h = get_host(disk);
ctlr_info_t
ctlr_info_t
*h = get_host(disk)
*
h
= get_host(disk)
get_host(disk)
get_host
get_host
disk
disk
void __user
void __user
void
__user
__user
r
*argp = (void __user *)arg;
dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\n",		cmd, arg);
dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\n",		cmd, arg)
dev_dbg
dev_dbg
&h->pdev->dev
h->pdev->dev
h->pdev
h
h
pdev
dev
"cciss_ioctl: Called with cmd=%x %lx\n"
cmd
cmd
arg
arg
switch (cmd) {	case CCISS_GETPCIINFO:		return cciss_getpciinfo(h, argp);	case CCISS_GETINTINFO:		return cciss_getintinfo(h, argp);	case CCISS_SETINTINFO:		return cciss_setintinfo(h, argp);	case CCISS_GETNODENAME:		return cciss_getnodename(h, argp);	case CCISS_SETNODENAME:		return cciss_setnodename(h, argp);	case CCISS_GETHEARTBEAT:		return cciss_getheartbeat(h, argp);	case CCISS_GETBUSTYPES:		return cciss_getbustypes(h, argp);	case CCISS_GETFIRMVER:		return cciss_getfirmver(h, argp);	case CCISS_GETDRIVVER:		return cciss_getdrivver(h, argp);	case CCISS_DEREGDISK:	case CCISS_REGNEWD:	case CCISS_REVALIDVOLS:		return rebuild_lun_table(h, 0, 1);	case CCISS_GETLUNINFO:		return cciss_getluninfo(h, disk, argp);	case CCISS_PASSTHRU:		return cciss_passthru(h, argp);	case CCISS_BIG_PASSTHRU:		return cciss_bigpassthru(h, argp);	/* scsi_cmd_ioctl handles these, below, though some are not */	/* very meaningful for cciss.  SG_IO is the main one people want. */	case SG_GET_VERSION_NUM:	case SG_SET_TIMEOUT:	case SG_GET_TIMEOUT:	case SG_GET_RESERVED_SIZE:	case SG_SET_RESERVED_SIZE:	case SG_EMULATED_HOST:	case SG_IO:	case SCSI_IOCTL_SEND_COMMAND:		return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);	/* scsi_cmd_ioctl would normally handle these, below, but */	/* they aren't a good fit for cciss, as CD-ROMs are */	/* not supported, and we don't have any bus/target/lun */	/* which we present to the kernel. */	case CDROM_SEND_PACKET:	case CDROMCLOSETRAY:	case CDROMEJECT:	case SCSI_IOCTL_GET_IDLUN:	case SCSI_IOCTL_GET_BUS_NUMBER:	default:		return -ENOTTY;	}
cmd
cmd
{	case CCISS_GETPCIINFO:		return cciss_getpciinfo(h, argp);	case CCISS_GETINTINFO:		return cciss_getintinfo(h, argp);	case CCISS_SETINTINFO:		return cciss_setintinfo(h, argp);	case CCISS_GETNODENAME:		return cciss_getnodename(h, argp);	case CCISS_SETNODENAME:		return cciss_setnodename(h, argp);	case CCISS_GETHEARTBEAT:		return cciss_getheartbeat(h, argp);	case CCISS_GETBUSTYPES:		return cciss_getbustypes(h, argp);	case CCISS_GETFIRMVER:		return cciss_getfirmver(h, argp);	case CCISS_GETDRIVVER:		return cciss_getdrivver(h, argp);	case CCISS_DEREGDISK:	case CCISS_REGNEWD:	case CCISS_REVALIDVOLS:		return rebuild_lun_table(h, 0, 1);	case CCISS_GETLUNINFO:		return cciss_getluninfo(h, disk, argp);	case CCISS_PASSTHRU:		return cciss_passthru(h, argp);	case CCISS_BIG_PASSTHRU:		return cciss_bigpassthru(h, argp);	/* scsi_cmd_ioctl handles these, below, though some are not */	/* very meaningful for cciss.  SG_IO is the main one people want. */	case SG_GET_VERSION_NUM:	case SG_SET_TIMEOUT:	case SG_GET_TIMEOUT:	case SG_GET_RESERVED_SIZE:	case SG_SET_RESERVED_SIZE:	case SG_EMULATED_HOST:	case SG_IO:	case SCSI_IOCTL_SEND_COMMAND:		return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);	/* scsi_cmd_ioctl would normally handle these, below, but */	/* they aren't a good fit for cciss, as CD-ROMs are */	/* not supported, and we don't have any bus/target/lun */	/* which we present to the kernel. */	case CDROM_SEND_PACKET:	case CDROMCLOSETRAY:	case CDROMEJECT:	case SCSI_IOCTL_GET_IDLUN:	case SCSI_IOCTL_GET_BUS_NUMBER:	default:		return -ENOTTY;	}
case CCISS_GETPCIINFO:
CCISS_GETPCIINFO
CCISS_GETPCIINFO
return cciss_getpciinfo(h, argp);
cciss_getpciinfo(h, argp)
cciss_getpciinfo
cciss_getpciinfo
h
h
argp
argp
case CCISS_GETINTINFO:
CCISS_GETINTINFO
CCISS_GETINTINFO
return cciss_getintinfo(h, argp);
cciss_getintinfo(h, argp)
cciss_getintinfo
cciss_getintinfo
h
h
argp
argp
case CCISS_SETINTINFO:
CCISS_SETINTINFO
CCISS_SETINTINFO
return cciss_setintinfo(h, argp);
cciss_setintinfo(h, argp)
cciss_setintinfo
cciss_setintinfo
h
h
argp
argp
case CCISS_GETNODENAME:
CCISS_GETNODENAME
CCISS_GETNODENAME
return cciss_getnodename(h, argp);
cciss_getnodename(h, argp)
cciss_getnodename
cciss_getnodename
h
h
argp
argp
case CCISS_SETNODENAME:
CCISS_SETNODENAME
CCISS_SETNODENAME
return cciss_setnodename(h, argp);
cciss_setnodename(h, argp)
cciss_setnodename
cciss_setnodename
h
h
argp
argp
case CCISS_GETHEARTBEAT:
CCISS_GETHEARTBEAT
CCISS_GETHEARTBEAT
return cciss_getheartbeat(h, argp);
cciss_getheartbeat(h, argp)
cciss_getheartbeat
cciss_getheartbeat
h
h
argp
argp
case CCISS_GETBUSTYPES:
CCISS_GETBUSTYPES
CCISS_GETBUSTYPES
return cciss_getbustypes(h, argp);
cciss_getbustypes(h, argp)
cciss_getbustypes
cciss_getbustypes
h
h
argp
argp
case CCISS_GETFIRMVER:
CCISS_GETFIRMVER
CCISS_GETFIRMVER
return cciss_getfirmver(h, argp);
cciss_getfirmver(h, argp)
cciss_getfirmver
cciss_getfirmver
h
h
argp
argp
case CCISS_GETDRIVVER:
CCISS_GETDRIVVER
CCISS_GETDRIVVER
return cciss_getdrivver(h, argp);
cciss_getdrivver(h, argp)
cciss_getdrivver
cciss_getdrivver
h
h
argp
argp
case CCISS_DEREGDISK:
CCISS_DEREGDISK
CCISS_DEREGDISK
case CCISS_REGNEWD:
CCISS_REGNEWD
CCISS_REGNEWD
case CCISS_REVALIDVOLS:
CCISS_REVALIDVOLS
CCISS_REVALIDVOLS
return rebuild_lun_table(h, 0, 1);
rebuild_lun_table(h, 0, 1)
rebuild_lun_table
rebuild_lun_table
h
h
0
1
case CCISS_GETLUNINFO:
CCISS_GETLUNINFO
CCISS_GETLUNINFO
return cciss_getluninfo(h, disk, argp);
cciss_getluninfo(h, disk, argp)
cciss_getluninfo
cciss_getluninfo
h
h
disk
disk
argp
argp
case CCISS_PASSTHRU:
CCISS_PASSTHRU
CCISS_PASSTHRU
return cciss_passthru(h, argp);
cciss_passthru(h, argp)
cciss_passthru
cciss_passthru
h
h
argp
argp
case CCISS_BIG_PASSTHRU:
CCISS_BIG_PASSTHRU
CCISS_BIG_PASSTHRU
return cciss_bigpassthru(h, argp);
cciss_bigpassthru(h, argp)
cciss_bigpassthru
cciss_bigpassthru
h
h
argp
argp
case SG_GET_VERSION_NUM:
SG_GET_VERSION_NUM
SG_GET_VERSION_NUM
case SG_SET_TIMEOUT:
SG_SET_TIMEOUT
SG_SET_TIMEOUT
case SG_GET_TIMEOUT:
SG_GET_TIMEOUT
SG_GET_TIMEOUT
case SG_GET_RESERVED_SIZE:
SG_GET_RESERVED_SIZE
SG_GET_RESERVED_SIZE
case SG_SET_RESERVED_SIZE:
SG_SET_RESERVED_SIZE
SG_SET_RESERVED_SIZE
case SG_EMULATED_HOST:
SG_EMULATED_HOST
SG_EMULATED_HOST
case SG_IO:
SG_IO
SG_IO
case SCSI_IOCTL_SEND_COMMAND:
SCSI_IOCTL_SEND_COMMAND
SCSI_IOCTL_SEND_COMMAND
return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp);
scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp)
scsi_cmd_ioctl
scsi_cmd_ioctl
disk->queue
disk
disk
queue
disk
disk
mode
mode
cmd
cmd
argp
argp
case CDROM_SEND_PACKET:
CDROM_SEND_PACKET
CDROM_SEND_PACKET
case CDROMCLOSETRAY:
CDROMCLOSETRAY
CDROMCLOSETRAY
case CDROMEJECT:
CDROMEJECT
CDROMEJECT
case SCSI_IOCTL_GET_IDLUN:
SCSI_IOCTL_GET_IDLUN
SCSI_IOCTL_GET_IDLUN
case SCSI_IOCTL_GET_BUS_NUMBER:
SCSI_IOCTL_GET_BUS_NUMBER
SCSI_IOCTL_GET_BUS_NUMBER
default:
return -ENOTTY;
-ENOTTY
ENOTTY
ENOTTY
-----joern-----
(128,47,0)
(59,106,0)
(66,0,0)
(103,57,0)
(128,56,0)
(67,58,0)
(23,82,0)
(129,0,0)
(25,52,0)
(39,56,0)
(99,61,0)
(97,91,0)
(40,114,0)
(82,0,0)
(12,0,0)
(36,39,0)
(53,2,0)
(117,61,0)
(28,127,0)
(61,63,0)
(128,50,0)
(23,106,0)
(42,68,0)
(106,2,0)
(128,63,0)
(60,25,0)
(40,106,0)
(68,58,0)
(83,23,0)
(34,0,0)
(3,0,0)
(39,25,0)
(18,111,0)
(58,127,0)
(119,0,0)
(78,52,0)
(114,0,0)
(60,106,0)
(8,106,0)
(37,52,0)
(16,68,0)
(92,60,0)
(9,42,0)
(7,118,0)
(68,106,0)
(130,25,0)
(68,96,0)
(20,52,0)
(89,23,0)
(130,13,0)
(80,51,0)
(64,118,0)
(69,0,0)
(39,106,0)
(122,39,0)
(40,25,0)
(73,6,0)
(81,0,0)
(113,0,0)
(70,0,0)
(65,0,0)
(21,25,0)
(127,58,0)
(44,0,0)
(33,0,0)
(22,0,0)
(88,130,0)
(60,77,0)
(128,4,0)
(96,0,0)
(57,79,0)
(31,0,0)
(128,82,0)
(91,52,0)
(61,106,0)
(2,106,0)
(21,106,0)
(38,40,0)
(85,0,0)
(108,40,0)
(104,21,0)
(105,57,0)
(101,0,0)
(128,31,0)
(91,109,0)
(46,0,0)
(100,0,0)
(91,79,0)
(79,57,0)
(42,58,0)
(54,52,0)
(8,81,0)
(98,127,0)
(75,0,0)
(111,4,0)
(120,8,0)
(21,50,0)
(110,0,0)
(128,13,0)
(14,0,0)
(6,0,0)
(50,0,0)
(111,25,0)
(79,91,0)
(61,25,0)
(128,6,0)
(45,0,0)
(93,0,0)
(90,59,0)
(26,0,0)
(128,96,0)
(47,0,0)
(118,25,0)
(123,0,0)
(11,68,0)
(13,0,0)
(43,25,0)
(128,100,0)
(76,0,0)
(68,109,0)
(49,106,0)
(106,52,0)
(74,130,0)
(67,25,0)
(4,0,0)
(63,0,0)
(68,42,0)
(116,60,0)
(23,25,0)
(102,0,0)
(51,31,0)
(91,115,0)
(56,0,0)
(1,30,0)
(94,111,0)
(8,58,0)
(2,53,0)
(51,25,0)
(35,68,0)
(121,21,0)
(126,103,0)
(62,42,0)
(124,68,0)
(111,106,0)
(51,106,0)
(128,81,0)
(15,103,0)
(86,0,0)
(5,59,0)
(130,106,0)
(107,2,0)
(32,0,0)
(17,67,0)
(19,8,0)
(41,0,0)
(128,114,0)
(8,25,0)
(55,73,0)
(2,115,0)
(103,25,0)
(127,10,0)
(30,106,0)
(77,0,0)
(95,8,0)
(24,0,0)
(59,47,0)
(118,123,0)
(128,77,0)
(30,100,0)
(128,123,0)
(58,52,0)
(87,91,0)
(30,25,0)
(25,67,0)
(125,30,0)
(68,48,0)
(112,51,0)
(84,58,0)
(59,25,0)
(29,0,0)
(71,91,0)
(57,103,0)
(72,118,0)
(31,51,1)
(128,13,1)
(25,67,1)
(87,79,1)
(130,106,1)
(108,38,1)
(23,25,1)
(21,121,1)
(39,106,1)
(59,25,1)
(81,8,1)
(21,25,1)
(60,106,1)
(62,9,1)
(11,16,1)
(128,81,1)
(40,108,1)
(7,72,1)
(68,124,1)
(16,35,1)
(130,74,1)
(97,87,1)
(130,25,1)
(105,103,1)
(57,105,1)
(128,82,1)
(23,106,1)
(128,6,1)
(40,25,1)
(13,130,1)
(30,125,1)
(71,97,1)
(68,42,1)
(42,62,1)
(107,49,1)
(1,27,1)
(125,1,1)
(60,92,1)
(30,25,1)
(36,122,1)
(6,73,1)
(120,19,1)
(2,107,1)
(58,127,1)
(15,126,1)
(59,90,1)
(104,27,1)
(72,27,1)
(90,5,1)
(68,109,1)
(39,25,1)
(98,28,1)
(123,118,1)
(91,79,1)
(43,58,1)
(92,116,1)
(128,63,1)
(124,11,1)
(8,25,1)
(116,27,1)
(95,120,1)
(8,95,1)
(91,109,1)
(68,48,1)
(23,83,1)
(91,115,1)
(61,25,1)
(64,7,1)
(61,106,1)
(8,106,1)
(82,23,1)
(117,99,1)
(103,25,1)
(128,4,1)
(121,104,1)
(112,80,1)
(49,25,1)
(19,27,1)
(2,53,1)
(42,58,1)
(127,98,1)
(77,60,1)
(83,89,1)
(60,25,1)
(111,106,1)
(30,106,1)
(114,40,1)
(128,50,1)
(96,68,1)
(118,25,1)
(127,10,1)
(56,39,1)
(100,30,1)
(51,25,1)
(88,27,1)
(4,111,1)
(128,123,1)
(67,58,1)
(128,47,1)
(47,59,1)
(59,106,1)
(99,27,1)
(106,2,1)
(79,57,1)
(68,58,1)
(35,42,1)
(50,21,1)
(80,27,1)
(74,88,1)
(111,94,1)
(126,106,1)
(94,18,1)
(51,106,1)
(89,27,1)
(128,31,1)
(73,55,1)
(8,58,1)
(128,96,1)
(91,71,1)
(18,27,1)
(118,64,1)
(57,103,1)
(27,91,1)
(21,106,1)
(111,25,1)
(55,27,1)
(103,15,1)
(122,27,1)
(9,27,1)
(61,117,1)
(5,27,1)
(128,114,1)
(51,112,1)
(2,115,1)
(38,27,1)
(40,106,1)
(128,77,1)
(28,84,1)
(68,106,1)
(128,100,1)
(17,43,1)
(63,61,1)
(39,36,1)
(128,56,1)
(67,17,1)
(68,48,2)
(30,27,2)
(64,27,2)
(124,27,2)
(74,27,2)
(38,27,2)
(1,27,2)
(112,27,2)
(68,58,2)
(128,6,2)
(51,106,2)
(90,27,2)
(39,106,2)
(128,81,2)
(63,27,2)
(21,27,2)
(57,103,2)
(111,25,2)
(128,47,2)
(79,57,2)
(39,27,2)
(83,27,2)
(68,42,2)
(47,27,2)
(117,27,2)
(82,27,2)
(106,2,2)
(92,27,2)
(116,27,2)
(23,106,2)
(11,27,2)
(130,106,2)
(77,27,2)
(128,56,2)
(128,77,2)
(125,27,2)
(72,27,2)
(128,114,2)
(42,58,2)
(130,27,2)
(128,123,2)
(2,115,2)
(40,27,2)
(118,25,2)
(30,106,2)
(36,27,2)
(4,27,2)
(99,27,2)
(61,25,2)
(128,100,2)
(35,27,2)
(25,67,2)
(130,25,2)
(21,106,2)
(128,50,2)
(80,27,2)
(58,127,2)
(104,27,2)
(59,25,2)
(60,106,2)
(91,115,2)
(108,27,2)
(8,58,2)
(120,27,2)
(50,27,2)
(8,106,2)
(111,106,2)
(62,27,2)
(13,27,2)
(16,27,2)
(7,27,2)
(128,82,2)
(39,25,2)
(94,27,2)
(95,27,2)
(56,27,2)
(100,27,2)
(88,27,2)
(18,27,2)
(5,27,2)
(128,4,2)
(2,53,2)
(103,25,2)
(8,25,2)
(51,27,2)
(9,27,2)
(128,63,2)
(23,25,2)
(30,25,2)
(40,25,2)
(6,27,2)
(111,27,2)
(42,27,2)
(68,27,2)
(60,25,2)
(31,27,2)
(60,27,2)
(40,106,2)
(128,31,2)
(114,27,2)
(91,79,2)
(118,27,2)
(21,25,2)
(59,27,2)
(91,109,2)
(81,27,2)
(8,27,2)
(127,10,2)
(68,109,2)
(121,27,2)
(55,27,2)
(96,27,2)
(51,25,2)
(68,106,2)
(122,27,2)
(61,27,2)
(59,106,2)
(61,106,2)
(67,58,2)
(128,13,2)
(23,27,2)
(89,27,2)
(128,96,2)
(19,27,2)
(73,27,2)
(123,27,2)
-----------------------------------
(0,)
(1,h)
(2,(void __user *)
(3,case CDROMEJECT:)
(4,return cciss_getfirmver(h, argp)
(5,h)
(6,return -ENOTTY;)
(7,0)
(8,cciss_getluninfo(h, disk, argp)
(9,disk)
(10,struct block_device *bdev)
(11,cmd)
(12,case SCSI_IOCTL_GET_IDLUN:)
(13,return cciss_setintinfo(h, argp)
(14,case CCISS_PASSTHRU:)
(15,pdev)
(16,mode)
(17,disk)
(18,h)
(19,h)
(20,disk)
(21,cciss_getheartbeat(h, argp)
(22,case SCSI_IOCTL_SEND_COMMAND:)
(23,cciss_getintinfo(h, argp)
(24,case CCISS_REGNEWD:)
(25,*h = get_host(disk)
(26,case CCISS_SETNODENAME:)
(27,cmd)
(28,bdev)
(29,case CCISS_GETHEARTBEAT:)
(30,cciss_passthru(h, argp)
(31,return cciss_getnodename(h, argp)
(32,case CCISS_GETPCIINFO:)
(33,case CCISS_GETINTINFO:)
(34,case CCISS_GETFIRMVER:)
(35,disk)
(36,argp)
(37,h)
(38,h)
(39,cciss_getbustypes(h, argp)
(40,cciss_getpciinfo(h, argp)
(41,default:)
(42,disk->queue)
(43,h)
(44,case SG_SET_RESERVED_SIZE:)
(45,case CCISS_BIG_PASSTHRU:)
(46,case CCISS_DEREGDISK:)
(47,return cciss_getdrivver(h, argp)
(48,fmode_t mode)
(49,argp)
(50,return cciss_getheartbeat(h, argp)
(51,cciss_getnodename(h, argp)
(52,)
(53,void __user *)
(54,argp)
(55,ENOTTY)
(56,return cciss_getbustypes(h, argp)
(57,h->pdev->dev)
(58,*disk = bdev->bd_disk)
(59,cciss_getdrivver(h, argp)
(60,cciss_bigpassthru(h, argp)
(61,cciss_setnodename(h, argp)
(62,queue)
(63,return cciss_setnodename(h, argp)
(64,1)
(65,case SG_GET_VERSION_NUM:)
(66,case CDROM_SEND_PACKET:)
(67,get_host(disk)
(68,scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp)
(69,case CCISS_GETLUNINFO:)
(70,case SG_EMULATED_HOST:)
(71,arg)
(72,h)
(73,-ENOTTY)
(74,argp)
(75,case CCISS_REVALIDVOLS:)
(76,case SG_GET_RESERVED_SIZE:)
(77,return cciss_bigpassthru(h, argp)
(78,switch (cmd)
(79,&h->pdev->dev)
(80,h)
(81,return cciss_getluninfo(h, disk, argp)
(82,return cciss_getintinfo(h, argp)
(83,argp)
(84,disk)
(85,case CCISS_GETDRIVVER:)
(86,case CCISS_GETNODENAME:)
(87,"cciss_ioctl: Called with cmd=%x %lx\\n")
(88,h)
(89,h)
(90,argp)
(91,dev_dbg(&h->pdev->dev, "cciss_ioctl: Called with cmd=%x %lx\\n",\n\\n\\t\\tcmd, arg)
(92,argp)
(93,case SCSI_IOCTL_GET_BUS_NUMBER:)
(94,argp)
(95,argp)
(96,return scsi_cmd_ioctl(disk->queue, disk, mode, cmd, argp)
(97,cmd)
(98,bd_disk)
(99,h)
(100,return cciss_passthru(h, argp)
(101,case SG_SET_TIMEOUT:)
(102,case SG_IO:)
(103,h->pdev)
(104,h)
(105,dev)
(106,*argp = (void __user *)
(107,arg)
(108,argp)
(109,unsigned int cmd)
(110,case SG_GET_TIMEOUT:)
(111,cciss_getfirmver(h, argp)
(112,argp)
(113,case CCISS_GETBUSTYPES:)
(114,return cciss_getpciinfo(h, argp)
(115,unsigned long arg)
(116,h)
(117,argp)
(118,rebuild_lun_table(h, 0, 1)
(119,case CDROMCLOSETRAY:)
(120,disk)
(121,argp)
(122,h)
(123,return rebuild_lun_table(h, 0, 1)
(124,argp)
(125,argp)
(126,h)
(127,bdev->bd_disk)
(128,RET)
(129,case CCISS_SETINTINFO:)
(130,cciss_setintinfo(h, argp)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^