-----label-----
0
-----code-----
static void drm_mm_insert_helper_range(struct drm_mm_node *hole_node,
				       struct drm_mm_node *node,
				       u64 size, unsigned alignment,
				       unsigned long color,
				       u64 start, u64 end,
				       enum drm_mm_allocator_flags flags)
{
	struct drm_mm *mm = hole_node->mm;
	u64 hole_start = drm_mm_hole_node_start(hole_node);
	u64 hole_end = drm_mm_hole_node_end(hole_node);
	u64 adj_start = hole_start;
	u64 adj_end = hole_end;

	BUG_ON(!hole_node->hole_follows || node->allocated);

	if (adj_start < start)
		adj_start = start;
	if (adj_end > end)
		adj_end = end;

	if (mm->color_adjust)
		mm->color_adjust(hole_node, color, &adj_start, &adj_end);

	if (flags & DRM_MM_CREATE_TOP)
		adj_start = adj_end - size;

	if (alignment) {
		u64 tmp = adj_start;
		unsigned rem;

		rem = do_div(tmp, alignment);
		if (rem) {
			if (flags & DRM_MM_CREATE_TOP)
				adj_start -= rem;
			else
				adj_start += alignment - rem;
		}
	}

	if (adj_start == hole_start) {
		hole_node->hole_follows = 0;
		list_del(&hole_node->hole_stack);
		rb_erase_hole_node(hole_node, mm);
	}

	node->start = adj_start;
	node->size = size;
	node->mm = mm;
	node->color = color;
	node->allocated = 1;

	list_add(&node->node_list, &hole_node->node_list);

	drm_mm_interval_tree_add_node(hole_node, node);

	BUG_ON(node->start < start);
	BUG_ON(node->start < adj_start);
	BUG_ON(node->start + node->size > adj_end);
	BUG_ON(node->start + node->size > end);

	node->hole_follows = 0;
	if (__drm_mm_hole_node_start(node) < hole_end) {
		list_add(&node->hole_stack, &mm->hole_stack);
		rb_insert_hole_node(node, mm);
		node->hole_follows = 1;
	}
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
3,8
3,9
3,10
3,11
3,12
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
14,16
17,18
17,19
18,19
20,21
22,23
22,24
24,25
26,27
26,28
28,29
30,31
30,32
31,32
33,34
35,36
35,37
36,37
38,39
40,41
40,42
41,42
43,44
45,46
45,47
45,48
45,49
45,50
45,51
45,52
45,53
45,54
45,55
45,56
45,57
45,58
45,59
45,60
45,61
45,62
45,63
45,64
45,65
45,66
45,67
45,68
45,69
45,70
46,47
47,48
47,49
48,49
50,51
50,52
50,53
53,54
54,55
54,56
55,56
58,59
59,60
59,61
60,61
62,63
62,64
64,65
65,66
65,67
66,67
68,69
70,71
71,72
71,73
72,73
74,75
74,76
76,77
77,78
77,79
78,79
80,81
82,83
83,84
83,85
84,85
86,87
86,88
88,89
89,90
91,92
92,93
92,94
93,94
95,96
95,97
97,98
98,99
100,101
101,102
101,103
102,103
104,105
104,106
105,106
106,107
106,108
107,108
110,111
110,112
111,112
114,115
114,116
115,116
115,117
116,117
118,119
120,121
121,122
121,123
122,123
124,125
126,127
126,128
127,128
127,129
128,129
130,131
132,133
133,134
133,135
134,135
136,137
138,139
138,140
139,140
139,141
140,141
143,144
144,145
144,146
144,147
144,148
144,149
145,146
145,147
146,147
149,150
151,152
153,154
154,155
156,157
157,158
159,160
159,161
160,161
160,162
161,162
163,164
165,166
166,167
166,168
167,168
169,170
169,171
170,171
172,173
174,175
174,176
175,176
177,178
177,179
177,180
177,181
178,179
179,180
179,181
180,181
182,183
182,184
184,185
185,186
187,188
188,189
188,190
190,191
192,193
193,194
193,195
194,195
196,197
196,198
196,199
197,198
199,200
201,202
203,204
203,205
204,205
206,207
207,208
207,209
207,210
208,209
208,210
209,210
211,212
213,214
214,215
214,216
215,216
217,218
219,220
220,221
220,222
221,222
223,224
223,225
224,225
226,227
228,229
228,230
229,230
229,231
230,231
232,233
234,235
234,236
234,237
235,236
236,237
236,238
237,238
237,239
238,239
242,243
243,244
243,245
244,245
246,247
247,248
247,249
248,249
251,252
252,253
252,254
252,255
253,254
255,256
257,258
259,260
260,261
260,262
261,262
261,263
262,263
265,266
267,268
268,269
268,270
269,270
269,271
270,271
273,274
275,276
276,277
276,278
277,278
277,279
278,279
281,282
283,284
284,285
284,286
285,286
285,287
286,287
289,290
291,292
292,293
292,294
293,294
293,295
294,295
298,299
299,300
299,301
299,302
300,301
302,303
303,304
303,305
304,305
307,308
308,309
308,310
309,310
312,313
313,314
313,315
313,316
314,315
316,317
318,319
320,321
321,322
321,323
322,323
324,325
324,326
325,326
325,327
326,327
329,330
331,332
332,333
332,334
333,334
335,336
335,337
336,337
336,338
337,338
340,341
342,343
343,344
343,345
344,345
346,347
346,348
347,348
347,349
348,349
348,350
349,350
352,353
352,354
353,354
356,357
358,359
359,360
359,361
360,361
362,363
362,364
363,364
363,365
364,365
364,366
365,366
368,369
368,370
369,370
372,373
374,375
375,376
375,377
376,377
376,378
377,378
381,382
381,383
382,383
382,384
383,384
383,385
384,385
386,387
388,389
390,391
390,392
390,393
391,392
392,393
392,394
392,395
393,394
395,396
396,397
396,398
397,398
400,401
401,402
401,403
402,403
405,406
406,407
406,408
406,409
407,408
409,410
411,412
413,414
414,415
414,416
415,416
415,417
416,417
-----nextToken-----
2,4,7,9,10,13,15,16,19,21,23,25,27,29,32,34,37,39,42,44,49,51,52,56,57,61,63,67,69,73,75,79,81,85,87,90,94,96,99,103,108,109,112,113,117,119,123,125,129,131,135,137,141,142,147,148,150,152,155,158,162,164,168,171,173,176,181,183,186,189,191,195,198,200,202,205,210,212,216,218,222,225,227,231,233,239,240,241,245,249,250,254,256,258,263,264,266,271,272,274,279,280,282,287,288,290,295,296,297,301,305,306,310,311,315,317,319,323,327,328,330,334,338,339,341,345,350,351,354,355,357,361,366,367,370,371,373,378,379,380,385,387,389,394,398,399,403,404,408,410,412,417,418,419
-----computeFrom-----
104,105
104,106
115,116
115,117
121,122
121,123
127,128
127,129
133,134
133,135
160,161
160,162
166,167
166,168
169,170
169,171
193,194
193,195
208,209
208,210
214,215
214,216
220,221
220,222
223,224
223,225
229,230
229,231
236,237
236,238
260,261
260,262
268,269
268,270
276,277
276,278
284,285
284,286
292,293
292,294
324,325
324,326
335,336
335,337
346,347
346,348
347,348
347,349
362,363
362,364
363,364
363,365
375,376
375,377
382,383
382,384
414,415
414,416
-----guardedBy-----
117,123
119,125
129,135
131,137
387,417
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;UnaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;CompoundStatement;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;
-----ast_node-----
static void drm_mm_insert_helper_range(struct drm_mm_node *hole_node,				       struct drm_mm_node *node,				       u64 size, unsigned alignment,				       unsigned long color,				       u64 start, u64 end,				       enum drm_mm_allocator_flags flags){	struct drm_mm *mm = hole_node->mm;	u64 hole_start = drm_mm_hole_node_start(hole_node);	u64 hole_end = drm_mm_hole_node_end(hole_node);	u64 adj_start = hole_start;	u64 adj_end = hole_end;	BUG_ON(!hole_node->hole_follows || node->allocated);	if (adj_start < start)		adj_start = start;	if (adj_end > end)		adj_end = end;	if (mm->color_adjust)		mm->color_adjust(hole_node, color, &adj_start, &adj_end);	if (flags & DRM_MM_CREATE_TOP)		adj_start = adj_end - size;	if (alignment) {		u64 tmp = adj_start;		unsigned rem;		rem = do_div(tmp, alignment);		if (rem) {			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}	}	if (adj_start == hole_start) {		hole_node->hole_follows = 0;		list_del(&hole_node->hole_stack);		rb_erase_hole_node(hole_node, mm);	}	node->start = adj_start;	node->size = size;	node->mm = mm;	node->color = color;	node->allocated = 1;	list_add(&node->node_list, &hole_node->node_list);	drm_mm_interval_tree_add_node(hole_node, node);	BUG_ON(node->start < start);	BUG_ON(node->start < adj_start);	BUG_ON(node->start + node->size > adj_end);	BUG_ON(node->start + node->size > end);	node->hole_follows = 0;	if (__drm_mm_hole_node_start(node) < hole_end) {		list_add(&node->hole_stack, &mm->hole_stack);		rb_insert_hole_node(node, mm);		node->hole_follows = 1;	}}
static void
drm_mm_insert_helper_range(struct drm_mm_node *hole_node,				       struct drm_mm_node *node,				       u64 size, unsigned alignment,				       unsigned long color,				       u64 start, u64 end,				       enum drm_mm_allocator_flags flags)
drm_mm_insert_helper_range
struct drm_mm_node *hole_node
struct drm_mm_node
drm_mm_node
*hole_node
*
hole_node
struct drm_mm_node *node
struct drm_mm_node
drm_mm_node
*node
*
node
u64 size
u64
u64
size
size
unsigned alignment
unsigned
alignment
alignment
unsigned long color
unsigned long
color
color
u64 start
u64
u64
start
start
u64 end
u64
u64
end
end
enum drm_mm_allocator_flags flags
enum drm_mm_allocator_flags
drm_mm_allocator_flags
flags
flags
{	struct drm_mm *mm = hole_node->mm;	u64 hole_start = drm_mm_hole_node_start(hole_node);	u64 hole_end = drm_mm_hole_node_end(hole_node);	u64 adj_start = hole_start;	u64 adj_end = hole_end;	BUG_ON(!hole_node->hole_follows || node->allocated);	if (adj_start < start)		adj_start = start;	if (adj_end > end)		adj_end = end;	if (mm->color_adjust)		mm->color_adjust(hole_node, color, &adj_start, &adj_end);	if (flags & DRM_MM_CREATE_TOP)		adj_start = adj_end - size;	if (alignment) {		u64 tmp = adj_start;		unsigned rem;		rem = do_div(tmp, alignment);		if (rem) {			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}	}	if (adj_start == hole_start) {		hole_node->hole_follows = 0;		list_del(&hole_node->hole_stack);		rb_erase_hole_node(hole_node, mm);	}	node->start = adj_start;	node->size = size;	node->mm = mm;	node->color = color;	node->allocated = 1;	list_add(&node->node_list, &hole_node->node_list);	drm_mm_interval_tree_add_node(hole_node, node);	BUG_ON(node->start < start);	BUG_ON(node->start < adj_start);	BUG_ON(node->start + node->size > adj_end);	BUG_ON(node->start + node->size > end);	node->hole_follows = 0;	if (__drm_mm_hole_node_start(node) < hole_end) {		list_add(&node->hole_stack, &mm->hole_stack);		rb_insert_hole_node(node, mm);		node->hole_follows = 1;	}}
struct drm_mm *mm = hole_node->mm;
struct drm_mm *mm = hole_node->mm;
struct drm_mm
drm_mm
*mm = hole_node->mm
*
mm
= hole_node->mm
hole_node->mm
hole_node
hole_node
mm
u64 hole_start = drm_mm_hole_node_start(hole_node);
u64 hole_start = drm_mm_hole_node_start(hole_node);
u64
u64
hole_start = drm_mm_hole_node_start(hole_node)
hole_start
= drm_mm_hole_node_start(hole_node)
drm_mm_hole_node_start(hole_node)
drm_mm_hole_node_start
drm_mm_hole_node_start
hole_node
hole_node
u64 hole_end = drm_mm_hole_node_end(hole_node);
u64 hole_end = drm_mm_hole_node_end(hole_node);
u64
u64
hole_end = drm_mm_hole_node_end(hole_node)
hole_end
= drm_mm_hole_node_end(hole_node)
drm_mm_hole_node_end(hole_node)
drm_mm_hole_node_end
drm_mm_hole_node_end
hole_node
hole_node
u64 adj_start = hole_start;
u64 adj_start = hole_start;
u64
u64
adj_start = hole_start
adj_start
= hole_start
hole_start
hole_start
u64 adj_end = hole_end;
u64 adj_end = hole_end;
u64
u64
adj_end = hole_end
adj_end
= hole_end
hole_end
hole_end
BUG_ON(!hole_node->hole_follows || node->allocated);
BUG_ON(!hole_node->hole_follows || node->allocated)
BUG_ON
BUG_ON
!hole_node->hole_follows || node->allocated
!hole_node->hole_follows
hole_node->hole_follows
hole_node
hole_node
hole_follows
node->allocated
node
node
allocated
if (adj_start < start)		adj_start = start;
adj_start < start
adj_start
adj_start
start
start
adj_start = start;
adj_start = start
adj_start
adj_start
start
start
if (adj_end > end)		adj_end = end;
adj_end > end
adj_end
adj_end
end
end
adj_end = end;
adj_end = end
adj_end
adj_end
end
end
if (mm->color_adjust)		mm->color_adjust(hole_node, color, &adj_start, &adj_end);
mm->color_adjust
mm
mm
color_adjust
mm->color_adjust(hole_node, color, &adj_start, &adj_end);
mm->color_adjust(hole_node, color, &adj_start, &adj_end)
mm->color_adjust
mm
mm
color_adjust
hole_node
hole_node
color
color
&adj_start
adj_start
adj_start
&adj_end
adj_end
adj_end
if (flags & DRM_MM_CREATE_TOP)		adj_start = adj_end - size;
flags & DRM_MM_CREATE_TOP
flags
flags
DRM_MM_CREATE_TOP
DRM_MM_CREATE_TOP
adj_start = adj_end - size;
adj_start = adj_end - size
adj_start
adj_start
adj_end - size
adj_end
adj_end
size
size
if (alignment) {		u64 tmp = adj_start;		unsigned rem;		rem = do_div(tmp, alignment);		if (rem) {			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}	}
alignment
alignment
{		u64 tmp = adj_start;		unsigned rem;		rem = do_div(tmp, alignment);		if (rem) {			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}	}
u64 tmp = adj_start;
u64 tmp = adj_start;
u64
u64
tmp = adj_start
tmp
= adj_start
adj_start
adj_start
unsigned rem;
unsigned rem;
unsigned
rem
rem
rem = do_div(tmp, alignment);
rem = do_div(tmp, alignment)
rem
rem
do_div(tmp, alignment)
do_div
do_div
tmp
tmp
alignment
alignment
if (rem) {			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}
rem
rem
{			if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;		}
if (flags & DRM_MM_CREATE_TOP)				adj_start -= rem;			else				adj_start += alignment - rem;
flags & DRM_MM_CREATE_TOP
flags
flags
DRM_MM_CREATE_TOP
DRM_MM_CREATE_TOP
adj_start -= rem;
adj_start -= rem
adj_start
adj_start
rem
rem
adj_start += alignment - rem;
adj_start += alignment - rem
adj_start
adj_start
alignment - rem
alignment
alignment
rem
rem
if (adj_start == hole_start) {		hole_node->hole_follows = 0;		list_del(&hole_node->hole_stack);		rb_erase_hole_node(hole_node, mm);	}
adj_start == hole_start
adj_start
adj_start
hole_start
hole_start
{		hole_node->hole_follows = 0;		list_del(&hole_node->hole_stack);		rb_erase_hole_node(hole_node, mm);	}
hole_node->hole_follows = 0;
hole_node->hole_follows = 0
hole_node->hole_follows
hole_node
hole_node
hole_follows
0
list_del(&hole_node->hole_stack);
list_del(&hole_node->hole_stack)
list_del
list_del
&hole_node->hole_stack
hole_node->hole_stack
hole_node
hole_node
hole_stack
rb_erase_hole_node(hole_node, mm);
rb_erase_hole_node(hole_node, mm)
rb_erase_hole_node
rb_erase_hole_node
hole_node
hole_node
mm
mm
node->start = adj_start;
node->start = adj_start
node->start
node
node
start
adj_start
adj_start
node->size = size;
node->size = size
node->size
node
node
size
size
size
node->mm = mm;
node->mm = mm
node->mm
node
node
mm
mm
mm
node->color = color;
node->color = color
node->color
node
node
color
color
color
node->allocated = 1;
node->allocated = 1
node->allocated
node
node
allocated
1
list_add(&node->node_list, &hole_node->node_list);
list_add(&node->node_list, &hole_node->node_list)
list_add
list_add
&node->node_list
node->node_list
node
node
node_list
&hole_node->node_list
hole_node->node_list
hole_node
hole_node
node_list
drm_mm_interval_tree_add_node(hole_node, node);
drm_mm_interval_tree_add_node(hole_node, node)
drm_mm_interval_tree_add_node
drm_mm_interval_tree_add_node
hole_node
hole_node
node
node
BUG_ON(node->start < start);
BUG_ON(node->start < start)
BUG_ON
BUG_ON
node->start < start
node->start
node
node
start
start
start
BUG_ON(node->start < adj_start);
BUG_ON(node->start < adj_start)
BUG_ON
BUG_ON
node->start < adj_start
node->start
node
node
start
adj_start
adj_start
BUG_ON(node->start + node->size > adj_end);
BUG_ON(node->start + node->size > adj_end)
BUG_ON
BUG_ON
node->start + node->size > adj_end
node->start + node->size
node->start
node
node
start
node->size
node
node
size
adj_end
adj_end
BUG_ON(node->start + node->size > end);
BUG_ON(node->start + node->size > end)
BUG_ON
BUG_ON
node->start + node->size > end
node->start + node->size
node->start
node
node
start
node->size
node
node
size
end
end
node->hole_follows = 0;
node->hole_follows = 0
node->hole_follows
node
node
hole_follows
0
if (__drm_mm_hole_node_start(node) < hole_end) {		list_add(&node->hole_stack, &mm->hole_stack);		rb_insert_hole_node(node, mm);		node->hole_follows = 1;	}
__drm_mm_hole_node_start(node) < hole_end
__drm_mm_hole_node_start(node)
__drm_mm_hole_node_start
__drm_mm_hole_node_start
node
node
hole_end
hole_end
{		list_add(&node->hole_stack, &mm->hole_stack);		rb_insert_hole_node(node, mm);		node->hole_follows = 1;	}
list_add(&node->hole_stack, &mm->hole_stack);
list_add(&node->hole_stack, &mm->hole_stack)
list_add
list_add
&node->hole_stack
node->hole_stack
node
node
hole_stack
&mm->hole_stack
mm->hole_stack
mm
mm
hole_stack
rb_insert_hole_node(node, mm);
rb_insert_hole_node(node, mm)
rb_insert_hole_node
rb_insert_hole_node
node
node
mm
mm
node->hole_follows = 1;
node->hole_follows = 1
node->hole_follows
node
node
hole_follows
1
-----joern-----
(184,14,0)
(84,73,0)
(33,49,0)
(41,174,0)
(61,160,0)
(122,76,0)
(149,52,0)
(204,67,0)
(107,49,0)
(53,178,0)
(54,100,0)
(181,24,0)
(68,123,0)
(135,17,0)
(154,172,0)
(116,58,0)
(2,218,0)
(176,49,0)
(123,208,0)
(213,207,0)
(191,46,0)
(18,167,0)
(110,172,0)
(186,85,0)
(135,199,0)
(48,16,0)
(21,169,0)
(36,183,0)
(81,210,0)
(157,183,0)
(11,117,0)
(55,95,0)
(78,118,0)
(168,163,0)
(121,175,0)
(0,101,0)
(37,62,0)
(93,122,0)
(51,76,0)
(45,124,0)
(114,58,0)
(101,207,0)
(210,208,0)
(213,86,0)
(75,207,0)
(180,207,0)
(179,26,0)
(199,49,0)
(131,9,0)
(137,24,0)
(135,164,0)
(180,183,0)
(98,218,0)
(213,175,0)
(99,41,0)
(16,159,0)
(174,175,0)
(182,49,0)
(46,139,0)
(44,159,0)
(34,208,0)
(29,49,0)
(218,2,0)
(56,19,0)
(36,164,0)
(20,77,0)
(183,36,0)
(85,73,0)
(16,208,0)
(91,217,0)
(152,49,0)
(14,172,0)
(137,179,0)
(52,71,0)
(30,55,0)
(23,169,0)
(100,116,0)
(118,174,0)
(36,65,0)
(169,172,0)
(210,76,0)
(141,67,0)
(143,63,0)
(118,213,0)
(174,183,0)
(14,112,0)
(179,120,0)
(89,218,0)
(32,216,0)
(163,89,0)
(95,55,0)
(120,9,0)
(121,183,0)
(156,37,0)
(162,58,0)
(122,208,0)
(100,43,0)
(207,197,0)
(109,104,0)
(10,126,0)
(105,85,0)
(33,159,0)
(55,47,0)
(87,118,0)
(159,33,0)
(97,49,0)
(7,34,0)
(82,180,0)
(41,95,0)
(103,53,0)
(22,16,0)
(24,208,0)
(117,11,0)
(24,137,0)
(1,128,0)
(13,214,0)
(121,207,0)
(157,207,0)
(192,135,0)
(8,100,0)
(214,76,0)
(200,185,0)
(42,207,0)
(123,172,0)
(134,208,0)
(209,39,0)
(122,17,0)
(146,49,0)
(167,185,0)
(188,213,0)
(180,175,0)
(25,49,0)
(34,196,0)
(104,156,0)
(148,112,0)
(212,49,0)
(64,53,0)
(65,47,0)
(128,139,0)
(167,208,0)
(115,174,0)
(42,175,0)
(140,41,0)
(211,36,0)
(19,208,0)
(178,74,0)
(73,169,0)
(6,164,0)
(213,183,0)
(178,49,0)
(101,183,0)
(213,101,0)
(28,124,0)
(145,164,0)
(163,208,0)
(17,216,0)
(96,167,0)
(39,73,0)
(174,49,0)
(129,2,0)
(30,49,0)
(123,49,0)
(16,174,0)
(89,163,0)
(100,180,0)
(15,49,0)
(72,24,0)
(9,120,0)
(17,135,0)
(156,38,0)
(79,19,0)
(179,137,0)
(80,197,0)
(104,208,0)
(185,49,0)
(134,84,0)
(90,116,0)
(173,123,0)
(101,116,0)
(113,43,0)
(169,73,0)
(101,175,0)
(11,196,0)
(76,49,0)
(127,73,0)
(35,160,0)
(138,42,0)
(120,179,0)
(92,128,0)
(52,172,0)
(177,134,0)
(55,30,0)
(159,197,0)
(66,9,0)
(63,49,0)
(31,34,0)
(62,37,0)
(144,170,0)
(4,134,0)
(80,175,0)
(40,178,0)
(62,172,0)
(119,101,0)
(151,52,0)
(67,97,0)
(77,208,0)
(83,14,0)
(125,46,0)
(113,121,0)
(41,208,0)
(196,11,0)
(86,213,0)
(2,172,0)
(153,157,0)
(160,47,0)
(11,49,0)
(71,52,0)
(121,113,0)
(106,84,0)
(132,207,0)
(124,172,0)
(206,110,0)
(59,121,0)
(157,121,0)
(94,89,0)
(71,148,0)
(174,121,0)
(118,208,0)
(5,175,0)
(194,65,0)
(9,73,0)
(42,124,0)
(142,104,0)
(38,156,0)
(88,165,0)
(174,207,0)
(196,34,0)
(86,49,0)
(124,42,0)
(175,49,0)
(84,49,0)
(157,101,0)
(110,170,0)
(73,49,0)
(166,26,0)
(218,49,0)
(216,208,0)
(203,62,0)
(85,26,0)
(57,77,0)
(3,58,0)
(159,16,0)
(180,58,0)
(174,101,0)
(158,157,0)
(136,183,0)
(116,100,0)
(171,217,0)
(216,174,0)
(133,113,0)
(38,49,0)
(77,174,0)
(150,65,0)
(189,175,0)
(14,73,0)
(36,161,0)
(157,63,0)
(37,156,0)
(12,49,0)
(76,161,0)
(165,65,0)
(69,49,0)
(160,164,0)
(70,36,0)
(63,154,0)
(67,208,0)
(148,71,0)
(201,166,0)
(19,166,0)
(193,97,0)
(165,164,0)
(187,113,0)
(157,175,0)
(17,122,0)
(156,104,0)
(210,95,0)
(214,208,0)
(111,110,0)
(60,62,0)
(124,165,0)
(135,65,0)
(117,217,0)
(164,218,0)
(154,63,0)
(53,208,0)
(217,117,0)
(95,41,0)
(124,74,0)
(195,55,0)
(130,154,0)
(155,80,0)
(217,172,0)
(190,180,0)
(219,39,0)
(113,116,0)
(95,210,0)
(202,80,0)
(213,121,0)
(213,118,0)
(102,210,0)
(50,49,0)
(199,135,0)
(147,216,0)
(170,112,0)
(164,49,0)
(205,214,0)
(85,208,0)
(198,122,0)
(175,63,0)
(165,124,0)
(216,17,0)
(113,187,1)
(157,63,1)
(1,92,1)
(158,27,1)
(84,73,1)
(72,181,1)
(131,137,1)
(191,124,1)
(108,116,1)
(164,218,1)
(14,172,1)
(132,75,1)
(30,55,1)
(111,157,1)
(19,208,1)
(23,21,1)
(102,41,1)
(16,174,1)
(168,97,1)
(122,93,1)
(135,65,1)
(39,209,1)
(157,121,1)
(44,16,1)
(106,134,1)
(34,31,1)
(159,197,1)
(133,59,1)
(7,185,1)
(217,172,1)
(175,63,1)
(194,160,1)
(34,208,1)
(159,16,1)
(36,164,1)
(86,213,1)
(18,178,1)
(213,175,1)
(32,86,1)
(41,174,1)
(24,72,1)
(216,174,1)
(121,207,1)
(100,43,1)
(17,216,1)
(185,200,1)
(135,192,1)
(103,64,1)
(82,190,1)
(121,175,1)
(37,62,1)
(105,186,1)
(8,90,1)
(193,67,1)
(14,83,1)
(204,30,1)
(2,129,1)
(52,172,1)
(101,0,1)
(128,1,1)
(124,165,1)
(160,47,1)
(24,208,1)
(142,37,1)
(40,53,1)
(192,17,1)
(91,171,1)
(78,87,1)
(189,218,1)
(174,183,1)
(180,175,1)
(4,76,1)
(180,82,1)
(27,183,1)
(89,218,1)
(158,121,1)
(76,51,1)
(210,81,1)
(165,65,1)
(104,208,1)
(154,172,1)
(59,128,1)
(180,207,1)
(219,160,1)
(210,76,1)
(214,208,1)
(14,73,1)
(219,65,1)
(188,118,1)
(157,175,1)
(53,103,1)
(123,208,1)
(217,91,1)
(35,80,1)
(203,164,1)
(96,18,1)
(115,77,1)
(214,205,1)
(42,207,1)
(52,149,1)
(213,207,1)
(85,73,1)
(218,2,1)
(67,141,1)
(171,196,1)
(11,117,1)
(213,188,1)
(140,99,1)
(89,94,1)
(33,159,1)
(77,20,1)
(215,166,1)
(118,78,1)
(73,169,1)
(157,207,1)
(201,19,1)
(101,207,1)
(66,131,1)
(207,132,1)
(118,174,1)
(187,133,1)
(160,61,1)
(64,84,1)
(123,68,1)
(35,207,1)
(136,46,1)
(143,73,1)
(119,128,1)
(213,121,1)
(151,170,1)
(191,39,1)
(121,113,1)
(174,175,1)
(169,23,1)
(89,163,1)
(100,180,1)
(55,195,1)
(137,24,1)
(38,156,1)
(85,105,1)
(17,122,1)
(81,102,1)
(0,119,1)
(174,115,1)
(101,175,1)
(11,196,1)
(16,48,1)
(157,101,1)
(210,208,1)
(121,183,1)
(51,214,1)
(20,57,1)
(88,42,1)
(159,44,1)
(163,208,1)
(213,183,1)
(184,148,1)
(76,161,1)
(61,35,1)
(167,208,1)
(46,139,1)
(90,180,1)
(68,173,1)
(181,89,1)
(41,140,1)
(209,219,1)
(55,95,1)
(57,157,1)
(92,108,1)
(113,43,1)
(6,175,1)
(190,27,1)
(213,101,1)
(148,71,1)
(95,210,1)
(113,116,1)
(135,17,1)
(110,172,1)
(153,158,1)
(9,66,1)
(101,116,1)
(117,217,1)
(174,101,1)
(85,208,1)
(124,172,1)
(123,172,1)
(174,207,1)
(186,179,1)
(97,193,1)
(83,184,1)
(13,174,1)
(77,208,1)
(45,28,1)
(163,168,1)
(141,204,1)
(196,34,1)
(70,136,1)
(21,127,1)
(104,109,1)
(53,208,1)
(122,76,1)
(99,199,1)
(110,206,1)
(124,74,1)
(22,123,1)
(149,151,1)
(155,38,1)
(5,189,1)
(124,42,1)
(2,172,1)
(179,137,1)
(19,79,1)
(65,47,1)
(100,54,1)
(178,40,1)
(71,52,1)
(109,142,1)
(94,163,1)
(67,208,1)
(63,154,1)
(177,4,1)
(144,110,1)
(135,164,1)
(42,175,1)
(170,144,1)
(28,39,1)
(84,106,1)
(55,47,1)
(216,208,1)
(174,121,1)
(145,6,1)
(60,203,1)
(125,191,1)
(95,41,1)
(79,56,1)
(134,177,1)
(167,96,1)
(154,130,1)
(39,73,1)
(16,208,1)
(180,183,1)
(179,120,1)
(157,153,1)
(138,45,1)
(62,60,1)
(80,175,1)
(157,183,1)
(36,161,1)
(150,194,1)
(31,7,1)
(93,198,1)
(166,201,1)
(202,155,1)
(118,208,1)
(46,125,1)
(128,139,1)
(147,32,1)
(134,208,1)
(213,118,1)
(98,63,1)
(27,46,1)
(130,143,1)
(216,147,1)
(57,14,1)
(156,104,1)
(158,101,1)
(101,183,1)
(87,33,1)
(65,150,1)
(62,172,1)
(199,135,1)
(207,197,1)
(156,37,1)
(175,5,1)
(36,65,1)
(169,172,1)
(195,95,1)
(205,13,1)
(36,211,1)
(160,164,1)
(9,73,1)
(164,145,1)
(80,197,1)
(215,89,1)
(120,9,1)
(198,216,1)
(42,138,1)
(183,36,1)
(54,8,1)
(75,80,1)
(116,100,1)
(200,167,1)
(41,208,1)
(48,22,1)
(158,108,1)
(165,164,1)
(122,208,1)
(80,202,1)
(178,74,1)
(129,98,1)
(173,11,1)
(165,88,1)
(206,111,1)
(56,85,1)
(211,70,1)
(150,160,2)
(156,104,2)
(178,74,2)
(101,183,2)
(101,116,2)
(157,183,2)
(38,156,2)
(86,213,2)
(11,117,2)
(11,196,2)
(135,17,2)
(213,207,2)
(104,208,2)
(174,175,2)
(24,89,2)
(108,27,2)
(71,157,2)
(149,157,2)
(165,39,2)
(207,80,2)
(41,208,2)
(65,47,2)
(54,27,2)
(89,218,2)
(121,175,2)
(19,208,2)
(95,41,2)
(45,39,2)
(210,208,2)
(131,89,2)
(70,46,2)
(199,135,2)
(213,101,2)
(169,172,2)
(211,46,2)
(174,183,2)
(217,172,2)
(16,208,2)
(157,101,2)
(174,207,2)
(124,172,2)
(179,137,2)
(144,157,2)
(46,139,2)
(9,73,2)
(110,172,2)
(14,73,2)
(165,65,2)
(105,89,2)
(170,157,2)
(134,208,2)
(187,128,2)
(34,208,2)
(123,208,2)
(163,208,2)
(62,172,2)
(89,163,2)
(216,174,2)
(111,157,2)
(72,89,2)
(138,39,2)
(128,139,2)
(100,43,2)
(36,65,2)
(59,128,2)
(56,89,2)
(165,164,2)
(216,208,2)
(213,183,2)
(148,157,2)
(33,159,2)
(17,122,2)
(2,172,2)
(88,39,2)
(42,175,2)
(63,154,2)
(67,208,2)
(42,207,2)
(206,157,2)
(121,207,2)
(183,36,2)
(174,121,2)
(184,157,2)
(154,172,2)
(157,175,2)
(92,108,2)
(52,172,2)
(151,157,2)
(190,27,2)
(213,121,2)
(109,37,2)
(137,89,2)
(16,174,2)
(181,89,2)
(104,37,2)
(8,27,2)
(85,89,2)
(148,71,2)
(77,208,2)
(180,207,2)
(71,52,2)
(85,208,2)
(80,197,2)
(84,73,2)
(180,27,2)
(42,39,2)
(183,46,2)
(83,157,2)
(36,161,2)
(14,157,2)
(196,34,2)
(121,128,2)
(213,175,2)
(121,113,2)
(122,76,2)
(124,42,2)
(160,47,2)
(213,118,2)
(164,218,2)
(180,175,2)
(55,47,2)
(120,89,2)
(174,101,2)
(28,39,2)
(124,39,2)
(175,63,2)
(66,89,2)
(167,208,2)
(122,208,2)
(121,183,2)
(157,207,2)
(160,164,2)
(110,157,2)
(73,169,2)
(157,63,2)
(36,46,2)
(179,120,2)
(136,46,2)
(39,73,2)
(120,9,2)
(85,73,2)
(124,74,2)
(207,197,2)
(159,16,2)
(142,37,2)
(1,108,2)
(17,216,2)
(135,164,2)
(113,128,2)
(36,164,2)
(201,89,2)
(123,172,2)
(0,128,2)
(180,183,2)
(186,89,2)
(55,95,2)
(137,24,2)
(37,62,2)
(113,116,2)
(101,207,2)
(118,174,2)
(214,208,2)
(75,80,2)
(133,128,2)
(124,165,2)
(95,210,2)
(100,180,2)
(117,217,2)
(156,37,2)
(19,89,2)
(76,161,2)
(14,172,2)
(24,208,2)
(116,100,2)
(159,197,2)
(128,108,2)
(100,27,2)
(132,80,2)
(135,65,2)
(119,128,2)
(9,89,2)
(101,128,2)
(30,55,2)
(79,89,2)
(210,76,2)
(101,175,2)
(113,43,2)
(52,157,2)
(166,89,2)
(65,160,2)
(218,2,2)
(116,27,2)
(179,89,2)
(80,175,2)
(194,160,2)
(41,174,2)
(157,121,2)
(82,27,2)
(118,208,2)
(90,27,2)
(53,208,2)
-----------------------------------
(0,rem)
(1,DRM_MM_CREATE_TOP)
(2,drm_mm_hole_node_end(hole_node)
(3,tmp)
(4,node)
(5,hole_start)
(6,adj_end)
(7,node)
(8,tmp)
(9,mm->hole_stack)
(10,if (flags & DRM_MM_CREATE_TOP)
(11,list_add(&node->node_list, &hole_node->node_list)
(12,if (alignment)
(13,node)
(14,rb_erase_hole_node(hole_node, mm)
(15,adj_end)
(16,node->start)
(17,node->start + node->size)
(18,node)
(19,node->hole_follows)
(20,start)
(21,hole_node)
(22,node)
(23,mm)
(24,node->hole_stack)
(25,hole_start)
(26,)
(27,alignment)
(28,hole_node)
(29,if (__drm_mm_hole_node_start(node)
(30,BUG_ON(node->start + node->size > end)
(31,node_list)
(32,node)
(33,BUG_ON(node->start < start)
(34,node->node_list)
(35,adj_end)
(36,adj_end - size)
(37,!hole_node->hole_follows)
(38,BUG_ON(!hole_node->hole_follows || node->allocated)
(39,mm->color_adjust)
(40,color)
(41,node->start)
(42,&adj_start)
(43,unsigned alignment)
(44,start)
(45,color)
(46,flags & DRM_MM_CREATE_TOP)
(47,u64 end)
(48,start)
(49,)
(50,mm)
(51,size)
(52,hole_node->hole_stack)
(53,node->color)
(54,alignment)
(55,node->start + node->size > end)
(56,node)
(57,node)
(58,)
(59,adj_start)
(60,hole_follows)
(61,end)
(62,hole_node->hole_follows)
(63,hole_start = drm_mm_hole_node_start(hole_node)
(64,node)
(65,adj_end = end)
(66,hole_stack)
(67,node->hole_follows)
(68,node)
(69,if (adj_end > end)
(70,adj_end)
(71,&hole_node->hole_stack)
(72,hole_stack)
(73,*mm = hole_node->mm)
(74,unsigned long color)
(75,adj_start)
(76,node->size = size)
(77,node->start)
(78,start)
(79,hole_follows)
(80,adj_start < start)
(81,size)
(82,adj_start)
(83,mm)
(84,node->mm = mm)
(85,rb_insert_hole_node(node, mm)
(86,BUG_ON(node->start < adj_start)
(87,node)
(88,adj_end)
(89,__drm_mm_hole_node_start(node)
(90,rem)
(91,node_list)
(92,flags)
(93,size)
(94,hole_end)
(95,node->start + node->size)
(96,allocated)
(97,node->hole_follows = 0)
(98,hole_end)
(99,node)
(100,do_div(tmp, alignment)
(101,adj_start -= rem)
(102,node)
(103,color)
(104,node->allocated)
(105,mm)
(106,mm)
(107,if (adj_start < start)
(108,rem)
(109,allocated)
(110,hole_node->hole_follows)
(111,hole_node)
(112,)
(113,alignment - rem)
(114,rem)
(115,adj_start)
(116,rem = do_div(tmp, alignment)
(117,&hole_node->node_list)
(118,node->start)
(119,adj_start)
(120,&mm->hole_stack)
(121,adj_start += alignment - rem)
(122,node->size)
(123,drm_mm_interval_tree_add_node(hole_node, node)
(124,mm->color_adjust(hole_node, color, &adj_start, &adj_end)
(125,DRM_MM_CREATE_TOP)
(126,)
(127,mm)
(128,flags & DRM_MM_CREATE_TOP)
(129,hole_node)
(130,hole_node)
(131,mm)
(132,start)
(133,alignment)
(134,node->mm)
(135,node->start + node->size > adj_end)
(136,adj_start)
(137,&node->hole_stack)
(138,adj_start)
(139,enum drm_mm_allocator_flags flags)
(140,start)
(141,hole_follows)
(142,node)
(143,hole_start)
(144,0)
(145,hole_end)
(146,if (adj_start == hole_start)
(147,start)
(148,list_del(&hole_node->hole_stack)
(149,hole_stack)
(150,end)
(151,hole_node)
(152,if (mm->color_adjust)
(153,hole_start)
(154,drm_mm_hole_node_start(hole_node)
(155,adj_start)
(156,!hole_node->hole_follows || node->allocated)
(157,adj_start == hole_start)
(158,adj_start)
(159,node->start < start)
(160,adj_end > end)
(161,u64 size)
(162,if (rem)
(163,__drm_mm_hole_node_start(node)
(164,adj_end = hole_end)
(165,&adj_end)
(166,node->hole_follows = 1)
(167,node->allocated)
(168,node)
(169,hole_node->mm)
(170,hole_node->hole_follows = 0)
(171,hole_node)
(172,struct drm_mm_node *hole_node)
(173,hole_node)
(174,node->start = adj_start)
(175,adj_start = hole_start)
(176,hole_end)
(177,mm)
(178,node->color = color)
(179,list_add(&node->hole_stack, &mm->hole_stack)
(180,tmp = adj_start)
(181,node)
(182,if (flags & DRM_MM_CREATE_TOP)
(183,adj_start = adj_end - size)
(184,hole_node)
(185,node->allocated = 1)
(186,node)
(187,rem)
(188,adj_start)
(189,adj_start)
(190,tmp)
(191,flags)
(192,adj_end)
(193,0)
(194,adj_end)
(195,end)
(196,&node->node_list)
(197,u64 start)
(198,node)
(199,BUG_ON(node->start + node->size > adj_end)
(200,1)
(201,1)
(202,start)
(203,hole_node)
(204,node)
(205,size)
(206,hole_follows)
(207,adj_start = start)
(208,struct drm_mm_node *node)
(209,color_adjust)
(210,node->size)
(211,size)
(212,adj_start)
(213,node->start < adj_start)
(214,node->size)
(215,RET)
(216,node->start)
(217,hole_node->node_list)
(218,hole_end = drm_mm_hole_node_end(hole_node)
(219,mm)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^