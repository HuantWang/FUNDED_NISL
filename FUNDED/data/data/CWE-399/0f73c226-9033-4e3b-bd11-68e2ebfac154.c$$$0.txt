-----label-----
1
-----code-----
int i915_gem_context_create_ioctl(struct drm_device *dev, void *data,
				  struct drm_file *file)
{
	struct drm_i915_private *dev_priv = to_i915(dev);
	struct drm_i915_gem_context_create *args = data;
	struct drm_i915_file_private *file_priv = file->driver_priv;
	struct i915_gem_context *ctx;
	int ret;

	if (!DRIVER_CAPS(dev_priv)->has_logical_contexts)
		return -ENODEV;

	if (args->pad != 0)
		return -EINVAL;

	if (client_is_banned(file_priv)) {
		DRM_DEBUG("client %s[%d] banned from creating ctx\n",
			  current->comm,
			  pid_nr(get_task_pid(current, PIDTYPE_PID)));

		return -EIO;
	}

	ret = i915_mutex_lock_interruptible(dev);
	if (ret)
		return ret;

	ctx = i915_gem_create_context(dev_priv, file_priv);
	mutex_unlock(&dev->struct_mutex);
	if (IS_ERR(ctx))
		return PTR_ERR(ctx);

	GEM_BUG_ON(i915_gem_context_is_kernel(ctx));

	args->ctx_id = ctx->user_handle;
	DRM_DEBUG("HW context %d created\n", args->ctx_id);

	return 0;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
3,7
5,6
5,7
6,7
8,9
8,10
11,12
11,13
13,14
13,15
16,17
16,18
17,18
19,20
19,21
22,23
22,24
22,25
22,26
22,27
22,28
22,29
22,30
22,31
22,32
22,33
22,34
22,35
22,36
22,37
22,38
22,39
23,24
24,25
24,26
25,26
27,28
27,29
27,30
30,31
31,32
31,33
32,33
34,35
36,37
37,38
37,39
38,39
40,41
40,42
40,43
43,44
44,45
46,47
47,48
47,49
48,49
50,51
50,52
50,53
53,54
54,55
54,56
55,56
58,59
59,60
59,61
60,61
62,63
62,64
65,66
66,67
66,68
68,69
70,71
70,72
71,72
72,73
72,74
73,74
73,75
74,75
76,77
79,80
80,81
81,82
83,84
83,85
84,85
84,86
85,86
85,87
86,87
90,91
91,92
92,93
94,95
94,96
95,96
95,97
96,97
98,99
100,101
100,102
101,102
102,103
102,104
102,105
102,106
103,104
106,107
106,108
107,108
110,111
110,112
111,112
113,114
113,115
113,116
114,115
116,117
118,119
120,121
121,122
122,123
124,125
125,126
125,127
126,127
128,129
128,130
129,130
131,132
133,134
133,135
134,135
136,137
137,138
139,140
140,141
140,142
141,142
143,144
143,145
143,146
144,145
146,147
148,149
150,151
151,152
151,153
152,153
154,155
155,156
155,157
156,157
159,160
159,161
160,161
160,162
161,162
163,164
165,166
166,167
166,168
167,168
169,170
171,172
172,173
172,174
173,174
175,176
175,177
176,177
178,179
180,181
181,182
181,183
182,183
182,184
183,184
186,187
186,188
187,188
190,191
191,192
191,193
191,194
192,193
195,196
195,197
196,197
199,200
-----nextToken-----
2,4,7,9,10,12,14,15,18,20,21,26,28,29,33,35,39,41,42,45,49,51,52,56,57,61,63,64,67,69,75,77,78,82,87,88,89,93,97,99,104,105,108,109,112,115,117,119,123,127,130,132,135,138,142,145,147,149,153,157,158,162,164,168,170,174,177,179,184,185,188,189,193,194,197,198,200
-----computeFrom-----
84,85
84,86
125,126
125,127
140,141
140,142
181,182
181,183
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;IfStatement;UnaryExpression;FieldReference;FunctionCallExpression;IdExpression;Name;IdExpression;Name;Name;ReturnStatement;UnaryExpression;IdExpression;Name;IfStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;LiteralExpression;ReturnStatement;UnaryExpression;IdExpression;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;FunctionCallExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ReturnStatement;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;FieldReference;IdExpression;Name;Name;ReturnStatement;LiteralExpression;
-----ast_node-----
int i915_gem_context_create_ioctl(struct drm_device *dev, void *data,				  struct drm_file *file){	struct drm_i915_private *dev_priv = to_i915(dev);	struct drm_i915_gem_context_create *args = data;	struct drm_i915_file_private *file_priv = file->driver_priv;	struct i915_gem_context *ctx;	int ret;	if (!DRIVER_CAPS(dev_priv)->has_logical_contexts)		return -ENODEV;	if (args->pad != 0)		return -EINVAL;	if (client_is_banned(file_priv)) {		DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)));		return -EIO;	}	ret = i915_mutex_lock_interruptible(dev);	if (ret)		return ret;	ctx = i915_gem_create_context(dev_priv, file_priv);	mutex_unlock(&dev->struct_mutex);	if (IS_ERR(ctx))		return PTR_ERR(ctx);	GEM_BUG_ON(i915_gem_context_is_kernel(ctx));	args->ctx_id = ctx->user_handle;	DRM_DEBUG("HW context %d created\n", args->ctx_id);	return 0;}
int
i915_gem_context_create_ioctl(struct drm_device *dev, void *data,				  struct drm_file *file)
i915_gem_context_create_ioctl
struct drm_device *dev
struct drm_device
drm_device
*dev
*
dev
void *data
void
*data
*
data
struct drm_file *file
struct drm_file
drm_file
*file
*
file
{	struct drm_i915_private *dev_priv = to_i915(dev);	struct drm_i915_gem_context_create *args = data;	struct drm_i915_file_private *file_priv = file->driver_priv;	struct i915_gem_context *ctx;	int ret;	if (!DRIVER_CAPS(dev_priv)->has_logical_contexts)		return -ENODEV;	if (args->pad != 0)		return -EINVAL;	if (client_is_banned(file_priv)) {		DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)));		return -EIO;	}	ret = i915_mutex_lock_interruptible(dev);	if (ret)		return ret;	ctx = i915_gem_create_context(dev_priv, file_priv);	mutex_unlock(&dev->struct_mutex);	if (IS_ERR(ctx))		return PTR_ERR(ctx);	GEM_BUG_ON(i915_gem_context_is_kernel(ctx));	args->ctx_id = ctx->user_handle;	DRM_DEBUG("HW context %d created\n", args->ctx_id);	return 0;}
struct drm_i915_private *dev_priv = to_i915(dev);
struct drm_i915_private *dev_priv = to_i915(dev);
struct drm_i915_private
drm_i915_private
*dev_priv = to_i915(dev)
*
dev_priv
= to_i915(dev)
to_i915(dev)
to_i915
to_i915
dev
dev
struct drm_i915_gem_context_create *args = data;
struct drm_i915_gem_context_create *args = data;
struct drm_i915_gem_context_create
drm_i915_gem_context_create
*args = data
*
args
= data
data
data
struct drm_i915_file_private *file_priv = file->driver_priv;
struct drm_i915_file_private *file_priv = file->driver_priv;
struct drm_i915_file_private
drm_i915_file_private
*file_priv = file->driver_priv
*
file_priv
= file->driver_priv
file->driver_priv
file
file
driver_priv
struct i915_gem_context *ctx;
struct i915_gem_context *ctx;
struct i915_gem_context
i915_gem_context
*ctx
*
ctx
int ret;
int ret;
int
ret
ret
if (!DRIVER_CAPS(dev_priv)->has_logical_contexts)		return -ENODEV;
!DRIVER_CAPS(dev_priv)->has_logical_contexts
DRIVER_CAPS(dev_priv)->has_logical_contexts
DRIVER_CAPS(dev_priv)
DRIVER_CAPS
DRIVER_CAPS
dev_priv
dev_priv
has_logical_contexts
return -ENODEV;
-ENODEV
ENODEV
ENODEV
if (args->pad != 0)		return -EINVAL;
args->pad != 0
args->pad
args
args
pad
0
return -EINVAL;
-EINVAL
EINVAL
EINVAL
if (client_is_banned(file_priv)) {		DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)));		return -EIO;	}
client_is_banned(file_priv)
client_is_banned
client_is_banned
file_priv
file_priv
{		DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)));		return -EIO;	}
DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)));
DRM_DEBUG("client %s[%d] banned from creating ctx\n",			  current->comm,			  pid_nr(get_task_pid(current, PIDTYPE_PID)))
DRM_DEBUG
DRM_DEBUG
"client %s[%d] banned from creating ctx\n"
current->comm
current
current
comm
pid_nr(get_task_pid(current, PIDTYPE_PID))
pid_nr
pid_nr
get_task_pid(current, PIDTYPE_PID)
get_task_pid
get_task_pid
current
current
PIDTYPE_PID
PIDTYPE_PID
return -EIO;
-EIO
EIO
EIO
ret = i915_mutex_lock_interruptible(dev);
ret = i915_mutex_lock_interruptible(dev)
ret
ret
i915_mutex_lock_interruptible(dev)
i915_mutex_lock_interruptible
i915_mutex_lock_interruptible
dev
dev
if (ret)		return ret;
ret
ret
return ret;
ret
ret
ctx = i915_gem_create_context(dev_priv, file_priv);
ctx = i915_gem_create_context(dev_priv, file_priv)
ctx
ctx
i915_gem_create_context(dev_priv, file_priv)
i915_gem_create_context
i915_gem_create_context
dev_priv
dev_priv
file_priv
file_priv
mutex_unlock(&dev->struct_mutex);
mutex_unlock(&dev->struct_mutex)
mutex_unlock
mutex_unlock
&dev->struct_mutex
dev->struct_mutex
dev
dev
struct_mutex
if (IS_ERR(ctx))		return PTR_ERR(ctx);
IS_ERR(ctx)
IS_ERR
IS_ERR
ctx
ctx
return PTR_ERR(ctx);
PTR_ERR(ctx)
PTR_ERR
PTR_ERR
ctx
ctx
GEM_BUG_ON(i915_gem_context_is_kernel(ctx));
GEM_BUG_ON(i915_gem_context_is_kernel(ctx))
GEM_BUG_ON
GEM_BUG_ON
i915_gem_context_is_kernel(ctx)
i915_gem_context_is_kernel
i915_gem_context_is_kernel
ctx
ctx
args->ctx_id = ctx->user_handle;
args->ctx_id = ctx->user_handle
args->ctx_id
args
args
ctx_id
ctx->user_handle
ctx
ctx
user_handle
DRM_DEBUG("HW context %d created\n", args->ctx_id);
DRM_DEBUG("HW context %d created\n", args->ctx_id)
DRM_DEBUG
DRM_DEBUG
"HW context %d created\n"
args->ctx_id
args
args
ctx_id
return 0;
0
-----joern-----
(69,96,0)
(89,72,0)
(49,70,0)
(21,31,0)
(82,52,0)
(5,76,0)
(93,52,0)
(16,8,0)
(62,3,0)
(32,38,0)
(25,65,0)
(38,3,0)
(79,72,0)
(41,33,0)
(91,52,0)
(42,75,0)
(9,15,0)
(7,90,0)
(33,41,0)
(27,74,0)
(23,56,0)
(41,74,0)
(22,23,0)
(11,15,0)
(75,27,0)
(91,66,0)
(0,25,0)
(43,76,0)
(59,72,0)
(48,72,0)
(19,42,0)
(1,82,0)
(95,8,0)
(52,91,0)
(33,72,0)
(49,72,0)
(66,72,0)
(44,37,0)
(47,72,0)
(84,72,0)
(65,72,0)
(11,72,0)
(65,82,0)
(13,71,0)
(13,87,0)
(82,65,0)
(77,49,0)
(20,91,0)
(17,41,0)
(8,65,0)
(37,52,0)
(76,43,0)
(43,49,0)
(62,29,0)
(8,49,0)
(86,9,0)
(12,25,0)
(34,64,0)
(67,6,0)
(13,34,0)
(60,72,0)
(14,16,0)
(54,51,0)
(36,25,0)
(13,45,0)
(0,72,0)
(57,91,0)
(80,9,0)
(9,74,0)
(24,61,0)
(51,78,0)
(29,62,0)
(47,96,0)
(18,38,0)
(27,75,0)
(73,72,0)
(85,27,0)
(23,66,0)
(10,43,0)
(45,33,0)
(24,42,0)
(63,43,0)
(30,24,0)
(2,66,0)
(26,23,0)
(16,72,0)
(13,0,0)
(25,49,0)
(35,72,0)
(75,72,0)
(62,64,0)
(15,11,0)
(88,0,0)
(3,38,0)
(94,28,0)
(58,82,0)
(96,52,0)
(40,33,0)
(81,29,0)
(39,29,0)
(91,75,0)
(96,47,0)
(66,23,0)
(8,16,0)
(4,49,0)
(92,75,0)
(53,72,0)
(46,8,0)
(50,72,0)
(3,62,0)
(61,24,0)
(90,71,0)
(52,72,0)
(31,52,0)
(13,78,0)
(83,45,0)
(37,87,0)
(28,66,0)
(68,62,0)
(42,24,0)
(6,34,0)
(15,9,0)
(19,66,1)
(45,83,1)
(31,21,1)
(7,61,1)
(37,52,1)
(47,96,1)
(62,29,1)
(41,74,1)
(27,74,1)
(29,39,1)
(46,14,1)
(36,12,1)
(81,68,1)
(77,75,1)
(13,34,1)
(13,78,1)
(91,75,1)
(17,40,1)
(54,76,1)
(90,7,1)
(8,95,1)
(45,33,1)
(28,66,1)
(88,16,1)
(75,27,1)
(13,45,1)
(91,20,1)
(22,2,1)
(93,55,1)
(33,41,1)
(13,71,1)
(42,75,1)
(86,80,1)
(42,19,1)
(49,70,1)
(24,30,1)
(66,23,1)
(34,6,1)
(11,15,1)
(21,11,1)
(37,44,1)
(52,91,1)
(25,36,1)
(2,49,1)
(57,93,1)
(87,37,1)
(16,8,1)
(69,31,1)
(12,47,1)
(28,94,1)
(13,87,1)
(80,52,1)
(76,43,1)
(3,38,1)
(20,57,1)
(8,49,1)
(68,28,1)
(58,25,1)
(62,3,1)
(65,82,1)
(9,86,1)
(32,29,1)
(44,31,1)
(43,63,1)
(23,26,1)
(40,28,1)
(61,24,1)
(24,42,1)
(91,66,1)
(15,9,1)
(8,65,1)
(0,88,1)
(18,32,1)
(26,22,1)
(10,61,1)
(41,17,1)
(49,4,1)
(0,25,1)
(55,33,1)
(78,51,1)
(95,46,1)
(43,49,1)
(67,62,1)
(6,67,1)
(63,10,1)
(14,65,1)
(39,81,1)
(76,5,1)
(25,49,1)
(83,55,1)
(4,77,1)
(5,43,1)
(82,52,1)
(38,18,1)
(27,85,1)
(9,74,1)
(1,58,1)
(71,90,1)
(96,52,1)
(13,0,1)
(85,92,1)
(94,76,1)
(51,54,1)
(31,52,1)
(96,69,1)
(82,1,1)
(30,42,1)
(23,56,1)
(68,28,2)
(58,31,2)
(13,71,2)
(44,31,2)
(3,38,2)
(32,28,2)
(9,74,2)
(96,52,2)
(82,52,2)
(96,31,2)
(52,91,2)
(47,96,2)
(33,41,2)
(46,31,2)
(8,49,2)
(54,76,2)
(62,28,2)
(63,61,2)
(62,29,2)
(49,70,2)
(37,52,2)
(90,61,2)
(91,66,2)
(0,31,2)
(11,15,2)
(33,28,2)
(86,55,2)
(45,55,2)
(41,28,2)
(43,61,2)
(13,45,2)
(13,87,2)
(88,31,2)
(16,31,2)
(76,61,2)
(14,31,2)
(82,31,2)
(7,61,2)
(27,74,2)
(40,28,2)
(95,31,2)
(55,28,2)
(61,24,2)
(20,55,2)
(0,25,2)
(28,76,2)
(34,28,2)
(13,78,2)
(6,28,2)
(75,27,2)
(24,42,2)
(28,66,2)
(21,55,2)
(31,55,2)
(52,55,2)
(67,28,2)
(13,34,2)
(83,55,2)
(91,75,2)
(9,55,2)
(69,31,2)
(80,55,2)
(45,33,2)
(29,28,2)
(47,31,2)
(65,82,2)
(8,31,2)
(10,61,2)
(76,43,2)
(11,55,2)
(39,28,2)
(42,75,2)
(15,9,2)
(71,61,2)
(1,31,2)
(23,56,2)
(25,49,2)
(66,23,2)
(93,55,2)
(18,28,2)
(91,55,2)
(87,31,2)
(8,65,2)
(31,52,2)
(78,76,2)
(94,76,2)
(36,31,2)
(25,31,2)
(17,28,2)
(5,61,2)
(15,55,2)
(41,74,2)
(57,55,2)
(38,28,2)
(12,31,2)
(13,0,2)
(51,76,2)
(62,3,2)
(43,49,2)
(37,31,2)
(81,28,2)
(65,31,2)
(3,28,2)
(16,8,2)
-----------------------------------
(0,return 0;)
(1,user_handle)
(2,file_priv)
(3,pid_nr(get_task_pid(current, PIDTYPE_PID)
(4,data)
(5,0)
(6,-EIO)
(7,ENODEV)
(8,args->ctx_id)
(9,dev->struct_mutex)
(10,args)
(11,mutex_unlock(&dev->struct_mutex)
(12,args)
(13,RET)
(14,"HW context %d created\\n")
(15,&dev->struct_mutex)
(16,DRM_DEBUG("HW context %d created\\n", args->ctx_id)
(17,dev)
(18,PIDTYPE_PID)
(19,dev_priv)
(20,file_priv)
(21,ctx)
(22,file)
(23,file->driver_priv)
(24,DRIVER_CAPS(dev_priv)
(25,args->ctx_id)
(26,driver_priv)
(27,to_i915(dev)
(28,client_is_banned(file_priv)
(29,current->comm)
(30,has_logical_contexts)
(31,IS_ERR(ctx)
(32,current)
(33,ret = i915_mutex_lock_interruptible(dev)
(34,return -EIO;)
(35,dev_priv)
(36,ctx_id)
(37,PTR_ERR(ctx)
(38,get_task_pid(current, PIDTYPE_PID)
(39,comm)
(40,ret)
(41,i915_mutex_lock_interruptible(dev)
(42,DRIVER_CAPS(dev_priv)
(43,args->pad)
(44,ctx)
(45,return ret;)
(46,args)
(47,GEM_BUG_ON(i915_gem_context_is_kernel(ctx)
(48,if (client_is_banned(file_priv)
(49,*args = data)
(50,if (!DRIVER_CAPS(dev_priv)
(51,-EINVAL)
(52,ctx = i915_gem_create_context(dev_priv, file_priv)
(53,if (ret)
(54,EINVAL)
(55,ret)
(56,struct drm_file *file)
(57,dev_priv)
(58,ctx)
(59,args)
(60,if (IS_ERR(ctx)
(61,!DRIVER_CAPS(dev_priv)
(62,DRM_DEBUG("client %s[%d] banned from creating ctx\\n",\n\\n\\t\\t\\t  current->comm,\n\\n\\t\\t\\t  pid_nr(get_task_pid(current, PIDTYPE_PID)
(63,pad)
(64,)
(65,args->ctx_id = ctx->user_handle)
(66,*file_priv = file->driver_priv)
(67,EIO)
(68,"client %s[%d] banned from creating ctx\\n")
(69,ctx)
(70,void *data)
(71,return -ENODEV;)
(72,)
(73,if (args->pad != 0)
(74,struct drm_device *dev)
(75,*dev_priv = to_i915(dev)
(76,args->pad != 0)
(77,args)
(78,return -EINVAL;)
(79,file_priv)
(80,dev)
(81,current)
(82,ctx->user_handle)
(83,ret)
(84,ret)
(85,dev)
(86,struct_mutex)
(87,return PTR_ERR(ctx)
(88,0)
(89,ctx)
(90,-ENODEV)
(91,i915_gem_create_context(dev_priv, file_priv)
(92,dev_priv)
(93,ctx)
(94,file_priv)
(95,ctx_id)
(96,i915_gem_context_is_kernel(ctx)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^