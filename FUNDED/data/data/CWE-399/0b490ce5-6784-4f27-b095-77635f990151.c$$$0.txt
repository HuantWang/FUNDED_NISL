-----label-----
1
-----code-----
static int bfusb_open(struct hci_dev *hdev)
{
	struct bfusb_data *data = hci_get_drvdata(hdev);
	unsigned long flags;
	int i, err;

	BT_DBG("hdev %p bfusb %p", hdev, data);

	write_lock_irqsave(&data->lock, flags);

	err = bfusb_rx_submit(data, NULL);
	if (!err) {
		for (i = 1; i < BFUSB_MAX_BULK_RX; i++)
			bfusb_rx_submit(data, NULL);
	}

	write_unlock_irqrestore(&data->lock, flags);

	return err;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
5,6
5,7
6,7
8,9
8,10
11,12
11,13
11,14
11,15
11,16
11,17
11,18
11,19
11,20
12,13
13,14
13,15
14,15
16,17
16,18
16,19
19,20
20,21
20,22
21,22
23,24
25,26
26,27
26,28
28,29
30,31
31,32
31,33
31,34
33,34
35,36
37,38
38,39
38,40
38,41
38,42
39,40
42,43
44,45
46,47
47,48
47,49
47,50
48,49
50,51
51,52
51,53
52,53
55,56
57,58
58,59
58,60
59,60
61,62
61,63
61,64
62,63
64,65
66,67
68,69
68,70
69,70
70,71
72,73
73,74
73,75
73,76
73,77
74,75
75,76
75,77
76,77
79,80
79,81
80,81
82,83
84,85
85,86
87,88
88,89
88,90
88,91
89,90
91,92
93,94
95,96
96,97
96,98
96,99
97,98
99,100
100,101
100,102
101,102
104,105
106,107
107,108
-----nextToken-----
2,4,7,9,10,15,17,18,22,24,27,29,32,34,36,40,41,43,45,49,53,54,56,60,63,65,67,71,77,78,81,83,86,90,92,94,98,102,103,105,108
-----computeFrom-----
58,59
58,60
75,76
75,77
79,80
79,81
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FunctionCallExpression;IdExpression;Name;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;Declarator;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;UnaryExpression;IdExpression;Name;CompoundStatement;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;IdExpression;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
static int bfusb_open(struct hci_dev *hdev){	struct bfusb_data *data = hci_get_drvdata(hdev);	unsigned long flags;	int i, err;	BT_DBG("hdev %p bfusb %p", hdev, data);	write_lock_irqsave(&data->lock, flags);	err = bfusb_rx_submit(data, NULL);	if (!err) {		for (i = 1; i < BFUSB_MAX_BULK_RX; i++)			bfusb_rx_submit(data, NULL);	}	write_unlock_irqrestore(&data->lock, flags);	return err;}
static int
bfusb_open(struct hci_dev *hdev)
bfusb_open
struct hci_dev *hdev
struct hci_dev
hci_dev
*hdev
*
hdev
{	struct bfusb_data *data = hci_get_drvdata(hdev);	unsigned long flags;	int i, err;	BT_DBG("hdev %p bfusb %p", hdev, data);	write_lock_irqsave(&data->lock, flags);	err = bfusb_rx_submit(data, NULL);	if (!err) {		for (i = 1; i < BFUSB_MAX_BULK_RX; i++)			bfusb_rx_submit(data, NULL);	}	write_unlock_irqrestore(&data->lock, flags);	return err;}
struct bfusb_data *data = hci_get_drvdata(hdev);
struct bfusb_data *data = hci_get_drvdata(hdev);
struct bfusb_data
bfusb_data
*data = hci_get_drvdata(hdev)
*
data
= hci_get_drvdata(hdev)
hci_get_drvdata(hdev)
hci_get_drvdata
hci_get_drvdata
hdev
hdev
unsigned long flags;
unsigned long flags;
unsigned long
flags
flags
int i, err;
int i, err;
int
i
i
err
err
BT_DBG("hdev %p bfusb %p", hdev, data);
BT_DBG("hdev %p bfusb %p", hdev, data)
BT_DBG
BT_DBG
"hdev %p bfusb %p"
hdev
hdev
data
data
write_lock_irqsave(&data->lock, flags);
write_lock_irqsave(&data->lock, flags)
write_lock_irqsave
write_lock_irqsave
&data->lock
data->lock
data
data
lock
flags
flags
err = bfusb_rx_submit(data, NULL);
err = bfusb_rx_submit(data, NULL)
err
err
bfusb_rx_submit(data, NULL)
bfusb_rx_submit
bfusb_rx_submit
data
data
NULL
NULL
if (!err) {		for (i = 1; i < BFUSB_MAX_BULK_RX; i++)			bfusb_rx_submit(data, NULL);	}
!err
err
err
{		for (i = 1; i < BFUSB_MAX_BULK_RX; i++)			bfusb_rx_submit(data, NULL);	}
for (i = 1; i < BFUSB_MAX_BULK_RX; i++)			bfusb_rx_submit(data, NULL);
i = 1;
i = 1
i
i
1
i < BFUSB_MAX_BULK_RX
i
i
BFUSB_MAX_BULK_RX
BFUSB_MAX_BULK_RX
i++
i
i
bfusb_rx_submit(data, NULL);
bfusb_rx_submit(data, NULL)
bfusb_rx_submit
bfusb_rx_submit
data
data
NULL
NULL
write_unlock_irqrestore(&data->lock, flags);
write_unlock_irqrestore(&data->lock, flags)
write_unlock_irqrestore
write_unlock_irqrestore
&data->lock
data->lock
data
data
lock
flags
flags
return err;
err
err
-----joern-----
(33,22,0)
(35,42,0)
(47,13,0)
(48,42,0)
(26,15,0)
(30,0,0)
(25,0,0)
(14,8,0)
(40,19,0)
(22,21,0)
(2,4,0)
(44,34,0)
(9,5,0)
(39,32,0)
(8,16,0)
(11,15,0)
(36,32,0)
(29,8,0)
(19,16,0)
(23,21,0)
(18,45,0)
(46,0,0)
(49,32,0)
(27,15,0)
(42,0,0)
(41,36,0)
(12,20,0)
(17,32,0)
(1,22,0)
(21,0,0)
(26,13,0)
(24,19,0)
(16,44,0)
(8,34,0)
(44,16,0)
(48,19,0)
(37,5,0)
(38,39,0)
(6,4,0)
(42,48,0)
(4,16,0)
(15,26,0)
(7,39,0)
(3,16,0)
(15,16,0)
(43,0,0)
(22,0,0)
(4,21,0)
(19,48,0)
(21,4,0)
(31,44,0)
(28,8,0)
(16,0,0)
(10,0,0)
(8,0,0)
(13,0,0)
(20,21,0)
(5,16,0)
(13,26,0)
(19,40,1)
(49,20,1)
(42,48,1)
(8,16,1)
(22,21,1)
(36,32,1)
(27,11,1)
(19,16,1)
(39,32,1)
(5,37,1)
(2,23,1)
(8,34,1)
(44,34,1)
(26,15,1)
(17,49,1)
(9,39,1)
(32,17,1)
(47,26,1)
(11,20,1)
(39,38,1)
(28,29,1)
(5,16,1)
(4,16,1)
(37,9,1)
(23,42,1)
(14,28,1)
(15,27,1)
(40,24,1)
(44,31,1)
(29,16,1)
(24,8,1)
(15,16,1)
(7,32,1)
(35,48,1)
(41,5,1)
(31,3,1)
(42,35,1)
(20,12,1)
(7,36,1)
(33,22,1)
(13,47,1)
(36,41,1)
(1,13,1)
(12,21,1)
(8,14,1)
(13,26,1)
(16,44,1)
(6,2,1)
(21,4,1)
(11,39,1)
(38,7,1)
(48,19,1)
(22,1,1)
(4,6,1)
(20,21,1)
(33,22,2)
(39,20,2)
(7,39,2)
(44,34,2)
(17,20,2)
(16,44,2)
(37,39,2)
(22,21,2)
(13,26,2)
(42,48,2)
(36,39,2)
(48,19,2)
(4,16,2)
(38,39,2)
(21,4,2)
(26,15,2)
(49,20,2)
(19,16,2)
(39,32,2)
(41,39,2)
(5,16,2)
(15,16,2)
(8,34,2)
(32,20,2)
(38,20,2)
(5,39,2)
(7,20,2)
(20,21,2)
(8,16,2)
(9,39,2)
(36,32,2)
(39,39,2)
-----------------------------------
(0,)
(1,err)
(2,data)
(3,data)
(4,bfusb_rx_submit(data, NULL)
(5,bfusb_rx_submit(data, NULL)
(6,NULL)
(7,i)
(8,BT_DBG("hdev %p bfusb %p", hdev, data)
(9,data)
(10,i)
(11,data)
(12,err)
(13,write_unlock_irqrestore(&data->lock, flags)
(14,data)
(15,data->lock)
(16,*data = hci_get_drvdata(hdev)
(17,1)
(18,for (i = 1; i < BFUSB_MAX_BULK_RX; i++)
(19,data->lock)
(20,!err)
(21,err = bfusb_rx_submit(data, NULL)
(22,return err;)
(23,err)
(24,data)
(25,if (!err)
(26,&data->lock)
(27,lock)
(28,hdev)
(29,"hdev %p bfusb %p")
(30,err)
(31,hdev)
(32,i = 1)
(33,RET)
(34,struct hci_dev *hdev)
(35,flags)
(36,i++)
(37,NULL)
(38,BFUSB_MAX_BULK_RX)
(39,i < BFUSB_MAX_BULK_RX)
(40,lock)
(41,i)
(42,write_lock_irqsave(&data->lock, flags)
(43,data)
(44,hci_get_drvdata(hdev)
(45,)
(46,flags)
(47,flags)
(48,&data->lock)
(49,i)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^