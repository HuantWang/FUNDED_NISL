Setting random seed 0.
Dataset parameters: {"max_nodes_per_batch": 10000, "num_fwd_edge_types": 7, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 12, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 0, "gnn_message_calculation_class": "GGNN", "gnn_initial_node_representation_activation": "tanh", "gnn_dense_intermediate_layer_activation": "tanh", "gnn_num_layers": 4, "gnn_dense_every_num_layers": 2, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": false, "gnn_layer_input_dropout_rate": 0.0, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 2, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.001, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 16, "graph_aggregation_hidden_layers": [128], "graph_aggregation_dropout_rate": 0.2}
Initial valid acc: Accuracy = 0.500.Initial valid pre: precision = 0.500.Initial valid re: precision = 0.500.Initial valid f1: f1 = 0.667.Initial valid TPR: TPR = 1.000.Initial valid FPR: FPR = 1.000.Initial valid TNR: TNR = 0.000.Initial valid FNR: FNR = 0.000.
== Epoch 1
 Train:  0.0031 loss | Accuracy = 0.500 | precision = 0.500 | recall = 1.000 | f1 = 0.667 |TPR = 1.000 | FPR = 1.000 | TNR = 0.000 | FNR = 0.000 | 79.29 graphs/s
 Valid:  0.0224 loss | Accuracy = 0.800 | precision = 0.765 | recall = 0.867 | f1 = 0.812 |TPR = 0.867 | FPR = 0.267 | TNR = 0.733 | FNR = 0.133 | 112.60 graphs/s
  (Best epoch so far, target metric decreased to -0.80000 from -0.50000.)
== Epoch 2
 Train:  0.0029 loss | Accuracy = 0.550 | precision = 0.531 | recall = 0.851 | f1 = 0.654 |TPR = 0.851 | FPR = 0.752 | TNR = 0.248 | FNR = 0.149 | 136.08 graphs/s
 Valid:  0.0220 loss | Accuracy = 0.500 | precision = 0.000 | recall = 0.000 | f1 = 0.000 |TPR = 0.000 | FPR = nan | TNR = nan | FNR = 1.000 | 109.23 graphs/s
== Epoch 3
 Train:  0.0028 loss | Accuracy = 0.525 | precision = 0.607 | recall = 0.140 | f1 = 0.228 |TPR = 0.140 | FPR = 0.091 | TNR = 0.909 | FNR = 0.860 | 134.86 graphs/s
 Valid:  0.0220 loss | Accuracy = 0.500 | precision = 0.000 | recall = 0.000 | f1 = 0.000 |TPR = 0.000 | FPR = nan | TNR = nan | FNR = 1.000 | 106.37 graphs/s
== Epoch 4
 Train:  0.0028 loss | Accuracy = 0.508 | precision = 0.562 | recall = 0.074 | f1 = 0.131 |TPR = 0.074 | FPR = 0.058 | TNR = 0.942 | FNR = 0.926 | 137.04 graphs/s
 Valid:  0.0215 loss | Accuracy = 0.500 | precision = 0.000 | recall = 0.000 | f1 = 0.000 |TPR = 0.000 | FPR = nan | TNR = nan | FNR = 1.000 | 92.34 graphs/s
== Epoch 5
 Train:  0.0027 loss | Accuracy = 0.529 | precision = 0.606 | recall = 0.165 | f1 = 0.260 |TPR = 0.165 | FPR = 0.107 | TNR = 0.893 | FNR = 0.835 | 130.57 graphs/s
 Valid:  0.0210 loss | Accuracy = 0.667 | precision = 0.857 | recall = 0.400 | f1 = 0.545 |TPR = 0.400 | FPR = 0.067 | TNR = 0.933 | FNR = 0.600 | 90.47 graphs/s
== Epoch 6
 Train:  0.0027 loss | Accuracy = 0.612 | precision = 0.648 | recall = 0.488 | f1 = 0.557 |TPR = 0.488 | FPR = 0.264 | TNR = 0.736 | FNR = 0.512 | 129.81 graphs/s
 Valid:  0.0207 loss | Accuracy = 0.667 | precision = 0.727 | recall = 0.533 | f1 = 0.615 |TPR = 0.533 | FPR = 0.200 | TNR = 0.800 | FNR = 0.467 | 86.12 graphs/s
== Epoch 7
 Train:  0.0026 loss | Accuracy = 0.653 | precision = 0.633 | recall = 0.727 | f1 = 0.677 |TPR = 0.727 | FPR = 0.421 | TNR = 0.579 | FNR = 0.273 | 126.85 graphs/s
 Valid:  0.0206 loss | Accuracy = 0.667 | precision = 0.647 | recall = 0.733 | f1 = 0.688 |TPR = 0.733 | FPR = 0.400 | TNR = 0.600 | FNR = 0.267 | 86.61 graphs/s
== Epoch 8
 Train:  0.0027 loss | Accuracy = 0.649 | precision = 0.613 | recall = 0.810 | f1 = 0.698 |TPR = 0.810 | FPR = 0.512 | TNR = 0.488 | FNR = 0.190 | 129.76 graphs/s
 Valid:  0.0203 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 82.72 graphs/s
== Epoch 9
 Train:  0.0026 loss | Accuracy = 0.657 | precision = 0.616 | recall = 0.835 | f1 = 0.709 |TPR = 0.835 | FPR = 0.521 | TNR = 0.479 | FNR = 0.165 | 127.17 graphs/s
 Valid:  0.0199 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 86.93 graphs/s
== Epoch 10
 Train:  0.0026 loss | Accuracy = 0.645 | precision = 0.610 | recall = 0.802 | f1 = 0.693 |TPR = 0.802 | FPR = 0.512 | TNR = 0.488 | FNR = 0.198 | 127.14 graphs/s
 Valid:  0.0195 loss | Accuracy = 0.700 | precision = 0.688 | recall = 0.733 | f1 = 0.710 |TPR = 0.733 | FPR = 0.333 | TNR = 0.667 | FNR = 0.267 | 86.55 graphs/s
== Epoch 11
 Train:  0.0025 loss | Accuracy = 0.653 | precision = 0.626 | recall = 0.760 | f1 = 0.687 |TPR = 0.760 | FPR = 0.455 | TNR = 0.545 | FNR = 0.240 | 126.72 graphs/s
 Valid:  0.0193 loss | Accuracy = 0.700 | precision = 0.714 | recall = 0.667 | f1 = 0.690 |TPR = 0.667 | FPR = 0.267 | TNR = 0.733 | FNR = 0.333 | 83.22 graphs/s
== Epoch 12
 Train:  0.0025 loss | Accuracy = 0.690 | precision = 0.677 | recall = 0.727 | f1 = 0.701 |TPR = 0.727 | FPR = 0.347 | TNR = 0.653 | FNR = 0.273 | 127.43 graphs/s
 Valid:  0.0192 loss | Accuracy = 0.733 | precision = 0.769 | recall = 0.667 | f1 = 0.714 |TPR = 0.667 | FPR = 0.200 | TNR = 0.800 | FNR = 0.333 | 86.44 graphs/s
== Epoch 13
 Train:  0.0026 loss | Accuracy = 0.640 | precision = 0.627 | recall = 0.694 | f1 = 0.659 |TPR = 0.694 | FPR = 0.413 | TNR = 0.587 | FNR = 0.306 | 126.64 graphs/s
 Valid:  0.0190 loss | Accuracy = 0.700 | precision = 0.714 | recall = 0.667 | f1 = 0.690 |TPR = 0.667 | FPR = 0.267 | TNR = 0.733 | FNR = 0.333 | 84.63 graphs/s
== Epoch 14
 Train:  0.0025 loss | Accuracy = 0.653 | precision = 0.643 | recall = 0.686 | f1 = 0.664 |TPR = 0.686 | FPR = 0.380 | TNR = 0.620 | FNR = 0.314 | 127.99 graphs/s
 Valid:  0.0189 loss | Accuracy = 0.700 | precision = 0.714 | recall = 0.667 | f1 = 0.690 |TPR = 0.667 | FPR = 0.267 | TNR = 0.733 | FNR = 0.333 | 86.97 graphs/s
== Epoch 15
 Train:  0.0025 loss | Accuracy = 0.669 | precision = 0.645 | recall = 0.752 | f1 = 0.695 |TPR = 0.752 | FPR = 0.413 | TNR = 0.587 | FNR = 0.248 | 128.67 graphs/s
 Valid:  0.0188 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 79.06 graphs/s
== Epoch 16
 Train:  0.0025 loss | Accuracy = 0.665 | precision = 0.628 | recall = 0.810 | f1 = 0.708 |TPR = 0.810 | FPR = 0.479 | TNR = 0.521 | FNR = 0.190 | 120.25 graphs/s
 Valid:  0.0188 loss | Accuracy = 0.667 | precision = 0.632 | recall = 0.800 | f1 = 0.706 |TPR = 0.800 | FPR = 0.467 | TNR = 0.533 | FNR = 0.200 | 83.67 graphs/s
== Epoch 17
 Train:  0.0025 loss | Accuracy = 0.682 | precision = 0.645 | recall = 0.810 | f1 = 0.718 |TPR = 0.810 | FPR = 0.446 | TNR = 0.554 | FNR = 0.190 | 107.45 graphs/s
 Valid:  0.0187 loss | Accuracy = 0.667 | precision = 0.632 | recall = 0.800 | f1 = 0.706 |TPR = 0.800 | FPR = 0.467 | TNR = 0.533 | FNR = 0.200 | 47.23 graphs/s
== Epoch 18
 Train:  0.0025 loss | Accuracy = 0.661 | precision = 0.623 | recall = 0.818 | f1 = 0.707 |TPR = 0.818 | FPR = 0.496 | TNR = 0.504 | FNR = 0.182 | 98.68 graphs/s
 Valid:  0.0185 loss | Accuracy = 0.667 | precision = 0.632 | recall = 0.800 | f1 = 0.706 |TPR = 0.800 | FPR = 0.467 | TNR = 0.533 | FNR = 0.200 | 80.77 graphs/s
== Epoch 19
 Train:  0.0024 loss | Accuracy = 0.674 | precision = 0.633 | recall = 0.826 | f1 = 0.717 |TPR = 0.826 | FPR = 0.479 | TNR = 0.521 | FNR = 0.174 | 119.28 graphs/s
 Valid:  0.0184 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 81.27 graphs/s
== Epoch 20
 Train:  0.0025 loss | Accuracy = 0.661 | precision = 0.634 | recall = 0.760 | f1 = 0.692 |TPR = 0.760 | FPR = 0.438 | TNR = 0.562 | FNR = 0.240 | 130.73 graphs/s
 Valid:  0.0183 loss | Accuracy = 0.733 | precision = 0.733 | recall = 0.733 | f1 = 0.733 |TPR = 0.733 | FPR = 0.267 | TNR = 0.733 | FNR = 0.267 | 82.88 graphs/s
== Epoch 21
 Train:  0.0024 loss | Accuracy = 0.707 | precision = 0.676 | recall = 0.793 | f1 = 0.730 |TPR = 0.793 | FPR = 0.380 | TNR = 0.620 | FNR = 0.207 | 112.36 graphs/s
 Valid:  0.0182 loss | Accuracy = 0.667 | precision = 0.692 | recall = 0.600 | f1 = 0.643 |TPR = 0.600 | FPR = 0.267 | TNR = 0.733 | FNR = 0.400 | 70.32 graphs/s
== Epoch 22
 Train:  0.0025 loss | Accuracy = 0.674 | precision = 0.654 | recall = 0.736 | f1 = 0.693 |TPR = 0.736 | FPR = 0.388 | TNR = 0.612 | FNR = 0.264 | 94.24 graphs/s
 Valid:  0.0181 loss | Accuracy = 0.700 | precision = 0.688 | recall = 0.733 | f1 = 0.710 |TPR = 0.733 | FPR = 0.333 | TNR = 0.667 | FNR = 0.267 | 54.86 graphs/s
== Epoch 23
 Train:  0.0024 loss | Accuracy = 0.686 | precision = 0.653 | recall = 0.793 | f1 = 0.716 |TPR = 0.793 | FPR = 0.421 | TNR = 0.579 | FNR = 0.207 | 120.67 graphs/s
 Valid:  0.0180 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 82.49 graphs/s
== Epoch 24
 Train:  0.0025 loss | Accuracy = 0.661 | precision = 0.636 | recall = 0.752 | f1 = 0.689 |TPR = 0.752 | FPR = 0.430 | TNR = 0.570 | FNR = 0.248 | 128.07 graphs/s
 Valid:  0.0179 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 83.42 graphs/s
== Epoch 25
 Train:  0.0024 loss | Accuracy = 0.698 | precision = 0.660 | recall = 0.818 | f1 = 0.731 |TPR = 0.818 | FPR = 0.421 | TNR = 0.579 | FNR = 0.182 | 116.72 graphs/s
 Valid:  0.0178 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 82.84 graphs/s
== Epoch 26
 Train:  0.0024 loss | Accuracy = 0.694 | precision = 0.656 | recall = 0.818 | f1 = 0.728 |TPR = 0.818 | FPR = 0.430 | TNR = 0.570 | FNR = 0.182 | 87.21 graphs/s
 Valid:  0.0177 loss | Accuracy = 0.700 | precision = 0.667 | recall = 0.800 | f1 = 0.727 |TPR = 0.800 | FPR = 0.400 | TNR = 0.600 | FNR = 0.200 | 61.68 graphs/s
Stopping training after 25 epochs without improvement on validation metric.
Training took 63.07098197937012s. Best validation metric: -0.800000011920929
== Running on test dataset
Loading data from ../data/data/tem_CWE-399/ast.
Restoring best model state from trained_model/GGNN_GraphBinaryClassification__2021-01-29_10-33-49_best.pkl.
NoneCP_test  Accuracy = 0.625|precision = 0.600 | recall = 0.750 | f1 = 0.667 |TPR = 0.750 | FPR = 0.500 | TNR = 0.500 | FNR = 0.250 |
