-----label-----
1
-----code-----
static int fops_mmap(struct file *file, struct vm_area_struct * vma)
{
	struct saa7146_fh *fh = file->private_data;
	struct videobuf_queue *q;

	switch (fh->type) {
	case V4L2_BUF_TYPE_VIDEO_CAPTURE: {
		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));
		q = &fh->video_q;
		break;
		}
	case V4L2_BUF_TYPE_VBI_CAPTURE: {
		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));
		q = &fh->vbi_q;
		break;
		}
	default:
		BUG();
		return 0;
	}
	return videobuf_mmap_mapper(vma,q);
}
-----children-----
1,2
1,3
1,4
3,4
3,5
3,6
5,6
5,7
6,7
8,9
8,10
11,12
11,13
12,13
14,15
14,16
17,18
17,19
17,20
17,21
18,19
19,20
19,21
20,21
22,23
22,24
22,25
25,26
26,27
26,28
27,28
30,31
31,32
31,33
32,33
34,35
34,36
37,38
37,39
38,39
38,40
39,40
42,43
42,44
42,45
42,46
42,47
42,48
42,49
43,44
44,45
46,47
46,48
46,49
47,48
48,49
48,50
49,50
51,52
52,53
52,54
52,55
54,55
56,57
58,59
59,60
59,61
60,61
62,63
63,64
63,65
64,65
68,69
69,70
71,72
71,73
71,74
72,73
73,74
73,75
74,75
76,77
77,78
77,79
77,80
79,80
81,82
83,84
84,85
84,86
85,86
87,88
88,89
88,90
89,90
94,95
95,96
96,97
98,99
100,101
101,102
101,103
101,104
102,103
104,105
106,107
-----nextToken-----
2,4,7,9,10,13,15,16,21,23,24,28,29,33,35,36,40,41,45,50,53,55,57,61,65,66,67,70,75,78,80,82,86,90,91,92,93,97,99,103,105,107
-----computeFrom-----
59,60
59,61
84,85
84,86
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;SwitchStatement;FieldReference;IdExpression;Name;Name;CompoundStatement;CaseStatement;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;ExpressionList;LiteralExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;BreakStatement;CaseStatement;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;ExpressionList;LiteralExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;BreakStatement;DefaultStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ReturnStatement;LiteralExpression;ReturnStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;
-----ast_node-----
static int fops_mmap(struct file *file, struct vm_area_struct * vma){	struct saa7146_fh *fh = file->private_data;	struct videobuf_queue *q;	switch (fh->type) {	case V4L2_BUF_TYPE_VIDEO_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->video_q;		break;		}	case V4L2_BUF_TYPE_VBI_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->vbi_q;		break;		}	default:		BUG();		return 0;	}	return videobuf_mmap_mapper(vma,q);}
static int
fops_mmap(struct file *file, struct vm_area_struct * vma)
fops_mmap
struct file *file
struct file
file
*file
*
file
struct vm_area_struct * vma
struct vm_area_struct
vm_area_struct
* vma
*
vma
{	struct saa7146_fh *fh = file->private_data;	struct videobuf_queue *q;	switch (fh->type) {	case V4L2_BUF_TYPE_VIDEO_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->video_q;		break;		}	case V4L2_BUF_TYPE_VBI_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->vbi_q;		break;		}	default:		BUG();		return 0;	}	return videobuf_mmap_mapper(vma,q);}
struct saa7146_fh *fh = file->private_data;
struct saa7146_fh *fh = file->private_data;
struct saa7146_fh
saa7146_fh
*fh = file->private_data
*
fh
= file->private_data
file->private_data
file
file
private_data
struct videobuf_queue *q;
struct videobuf_queue *q;
struct videobuf_queue
videobuf_queue
*q
*
q
switch (fh->type) {	case V4L2_BUF_TYPE_VIDEO_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->video_q;		break;		}	case V4L2_BUF_TYPE_VBI_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->vbi_q;		break;		}	default:		BUG();		return 0;	}
fh->type
fh
fh
type
{	case V4L2_BUF_TYPE_VIDEO_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->video_q;		break;		}	case V4L2_BUF_TYPE_VBI_CAPTURE: {		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->vbi_q;		break;		}	default:		BUG();		return 0;	}
case V4L2_BUF_TYPE_VIDEO_CAPTURE:
V4L2_BUF_TYPE_VIDEO_CAPTURE
V4L2_BUF_TYPE_VIDEO_CAPTURE
{		DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->video_q;		break;		}
DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma));
DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma))
DEB_EE
DEB_EE
("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma)
"V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n",file, vma
"V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\n"
file
file
vma
vma
q = &fh->video_q;
q = &fh->video_q
q
q
&fh->video_q
fh->video_q
fh
fh
video_q
break;
case V4L2_BUF_TYPE_VBI_CAPTURE:
V4L2_BUF_TYPE_VBI_CAPTURE
V4L2_BUF_TYPE_VBI_CAPTURE
{		DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));		q = &fh->vbi_q;		break;		}
DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma));
DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma))
DEB_EE
DEB_EE
("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma)
"V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n",file, vma
"V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\n"
file
file
vma
vma
q = &fh->vbi_q;
q = &fh->vbi_q
q
q
&fh->vbi_q
fh->vbi_q
fh
fh
vbi_q
break;
default:
BUG();
BUG()
BUG
BUG
return 0;
0
return videobuf_mmap_mapper(vma,q);
videobuf_mmap_mapper(vma,q)
videobuf_mmap_mapper
videobuf_mmap_mapper
vma
vma
q
q
-----joern-----
(18,1,0)
(24,51,0)
(51,9,0)
(22,32,0)
(52,17,0)
(31,42,0)
(47,8,0)
(13,19,0)
(50,53,0)
(17,33,0)
(8,32,0)
(5,28,0)
(30,28,0)
(38,6,0)
(6,13,0)
(46,14,0)
(25,32,0)
(21,6,0)
(7,8,0)
(47,4,0)
(43,19,0)
(48,27,0)
(41,1,0)
(53,4,0)
(12,32,0)
(1,32,0)
(9,19,0)
(46,13,0)
(28,32,0)
(34,28,0)
(42,13,0)
(40,13,0)
(34,26,0)
(27,48,0)
(40,27,0)
(41,9,0)
(15,51,0)
(51,48,0)
(26,34,0)
(45,13,0)
(6,26,0)
(11,46,0)
(49,19,0)
(20,40,0)
(23,40,0)
(16,53,0)
(10,33,0)
(29,32,0)
(48,8,0)
(26,6,0)
(37,42,0)
(44,48,0)
(13,46,0)
(5,33,0)
(4,47,0)
(0,34,0)
(3,17,0)
(39,4,0)
(33,5,0)
(2,19,0)
(51,34,0)
(51,36,0)
(27,40,0)
(35,46,0)
(9,51,1)
(46,35,1)
(20,23,1)
(15,7,1)
(5,52,1)
(11,45,1)
(15,30,1)
(30,34,1)
(29,42,1)
(51,24,1)
(23,44,1)
(10,42,1)
(38,0,1)
(44,47,1)
(21,38,1)
(6,13,1)
(34,26,1)
(42,31,1)
(16,39,1)
(31,37,1)
(47,4,1)
(3,10,1)
(46,14,1)
(41,1,1)
(26,6,1)
(50,16,1)
(47,50,1)
(35,11,1)
(42,13,1)
(51,34,1)
(24,15,1)
(0,5,1)
(48,27,1)
(27,40,1)
(5,33,1)
(51,48,1)
(18,29,1)
(7,48,1)
(52,3,1)
(51,36,1)
(13,46,1)
(37,13,1)
(41,9,1)
(40,20,1)
(6,21,1)
(1,18,1)
(39,42,1)
(40,13,1)
(0,42,2)
(51,48,2)
(27,42,2)
(34,26,2)
(16,42,2)
(41,1,2)
(48,42,2)
(46,14,2)
(30,42,2)
(51,34,2)
(1,42,2)
(6,13,2)
(34,42,2)
(6,42,2)
(29,42,2)
(23,42,2)
(24,42,2)
(50,42,2)
(40,42,2)
(9,42,2)
(18,42,2)
(21,42,2)
(10,42,2)
(26,6,2)
(47,4,2)
(15,42,2)
(5,42,2)
(20,42,2)
(13,46,2)
(5,33,2)
(40,13,2)
(27,40,2)
(38,42,2)
(26,42,2)
(42,13,2)
(51,42,2)
(51,36,2)
(7,42,2)
(47,42,2)
(52,42,2)
(41,9,2)
(48,27,2)
(44,42,2)
(39,42,2)
(3,42,2)
-----------------------------------
(0,q)
(1,return 0;)
(2,switch (fh->type)
(3,file)
(4,)
(5,DEB_EE(("V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\\n",file, vma)
(6,fh->video_q)
(7,break;)
(8,)
(9,return videobuf_mmap_mapper(vma,q)
(10,"V4L2_BUF_TYPE_VIDEO_CAPTURE: file:%p, vma:%p\\n")
(11,file)
(12,default:)
(13,*fh = file->private_data)
(14,struct file *file)
(15,vma)
(16,file)
(17,)
(18,0)
(19,)
(20,vbi_q)
(21,video_q)
(22,case V4L2_BUF_TYPE_VIDEO_CAPTURE:)
(23,fh)
(24,q)
(25,case V4L2_BUF_TYPE_VBI_CAPTURE:)
(26,&fh->video_q)
(27,&fh->vbi_q)
(28,)
(29,BUG()
(30,break;)
(31,type)
(32,)
(33,)
(34,q = &fh->video_q)
(35,private_data)
(36,struct vm_area_struct * vma)
(37,fh)
(38,fh)
(39,"V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\\n")
(40,fh->vbi_q)
(41,RET)
(42,fh->type)
(43,q)
(44,q)
(45,fh)
(46,file->private_data)
(47,DEB_EE(("V4L2_BUF_TYPE_VBI_CAPTURE: file:%p, vma:%p\\n",file, vma)
(48,q = &fh->vbi_q)
(49,fh)
(50,vma)
(51,videobuf_mmap_mapper(vma,q)
(52,vma)
(53,)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^