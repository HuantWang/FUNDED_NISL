-----label-----
0
-----code-----
wpt_packet * wpalPacketAlloc(wpt_packet_type pktType, wpt_uint32 nPktSize,
                             wpalPacketLowPacketCB rxLowCB, void *usrData)
{
   VOS_STATUS   vosStatus = VOS_STATUS_E_FAILURE;
   wpt_packet*  pPkt      = NULL;
   vos_pkt_t*   pVosPkt   = NULL;
   void*        pData     = NULL;
   v_U16_t      allocLen;
   /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

   switch (pktType)
   {
   case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:
      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,
                                       nPktSize, 1, VOS_FALSE, 
                                       NULL, NULL /*no callback*/);
      break;

   case eWLAN_PAL_PKT_TYPE_RX_RAW:
      /* Set the wpalPacketAvailableCB before we try to get a VOS
       * packet from the 'free list' and reset it if vos_pkt_get_packet()
       * returns a valid packet. This order is required to avoid the
       * race condition:
       * 1. The below call to vos_pkt_get_packet() in RX_Thread determines
       *    that no more packets are available in the 'free list' and sets
       *    the low resource callbacks.
       * 2. in parallel vos_pkt_return_packet() is called in MC_Thread for a
       *    Management frame before wpalPacketAlloc() gets a chance to set
       *    wpalPacketAvailableCB and since the 'low resource callbacks'
       *    are set the callback function - wpalPacketRXLowResourceCB is
       *    executed,but since wpalPacketAvailableCB is still NULL the low
       *    resource recovery fails.
       */
      wpalPacketAvailableCB = rxLowCB;

      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,
                                       nPktSize, 1, VOS_FALSE, 
                                       wpalPacketRXLowResourceCB, usrData);

#ifndef FEATURE_R33D
      /* Reserve the entire raw rx buffer for DXE */
      if( vosStatus == VOS_STATUS_SUCCESS )
      {
        wpalPacketAvailableCB = NULL;
        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize ); 
      }
#endif /* FEATURE_R33D */
      if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))
      {
         vos_pkt_get_packet_length(pVosPkt, &allocLen);
         if (nPktSize != allocLen)
         {
            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,
                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);
            vos_pkt_return_packet(pVosPkt);
            return NULL;
         }
      }
      break;

   default:
      WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR, 
                  " try to allocate unsupported packet type (%d)", pktType);
      break;
   }

   if(VOS_IS_STATUS_SUCCESS(vosStatus))
   {
      pPkt = (wpt_packet *)pVosPkt;
   }


   return pPkt;
}
-----children-----
1,2
1,3
1,4
2,3
4,5
4,6
4,7
4,8
4,9
4,10
7,8
7,9
8,9
10,11
12,13
12,14
13,14
15,16
17,18
17,19
18,19
20,21
22,23
22,24
24,25
24,26
27,28
27,29
27,30
27,31
27,32
27,33
27,34
27,35
28,29
29,30
29,31
30,31
32,33
32,34
34,35
35,36
37,38
38,39
38,40
39,40
41,42
41,43
41,44
44,45
45,46
47,48
48,49
48,50
49,50
51,52
51,53
51,54
54,55
55,56
57,58
58,59
58,60
60,61
60,62
60,63
63,64
64,65
66,67
67,68
67,69
68,69
70,71
72,73
72,74
73,74
75,76
75,77
75,78
75,79
75,80
75,81
75,82
75,83
75,84
75,85
75,86
75,87
76,77
77,78
79,80
80,81
80,82
81,82
83,84
83,85
83,86
83,87
83,88
83,89
83,90
83,91
84,85
86,87
87,88
89,90
91,92
94,95
96,97
98,99
101,102
102,103
104,105
105,106
105,107
106,107
108,109
110,111
111,112
111,113
112,113
114,115
114,116
114,117
114,118
114,119
114,120
114,121
114,122
115,116
117,118
118,119
120,121
122,123
125,126
127,128
129,130
131,132
131,133
132,133
132,134
133,134
135,136
137,138
137,139
138,139
139,140
139,141
140,141
142,143
144,145
145,146
145,147
146,147
148,149
148,150
148,151
148,152
149,150
151,152
153,154
154,155
156,157
158,159
158,160
159,160
159,161
160,161
161,162
161,163
162,163
164,165
166,167
167,168
167,169
168,169
170,171
172,173
172,174
173,174
174,175
174,176
174,177
175,176
177,178
179,180
180,181
182,183
182,184
183,184
183,185
184,185
186,187
188,189
188,190
188,191
189,190
190,191
190,192
190,193
190,194
190,195
191,192
193,194
195,196
198,199
200,201
201,202
201,203
202,203
204,205
206,207
207,208
211,212
212,213
212,214
212,215
212,216
212,217
213,214
215,216
217,218
220,221
223,224
223,225
224,225
224,226
225,226
227,228
229,230
230,231
231,232
231,233
232,233
234,235
234,236
235,236
235,237
236,237
238,239
240,241
242,243
243,244
-----nextToken-----
3,5,6,9,11,14,16,19,21,23,25,26,31,33,36,40,42,43,46,50,52,53,56,59,61,62,65,69,71,74,78,82,85,88,90,92,93,95,97,99,100,103,107,109,113,116,119,121,123,124,126,128,130,134,136,141,143,147,150,152,155,157,163,165,169,171,176,178,181,185,187,192,194,196,197,199,203,205,208,209,210,214,216,218,219,221,222,226,228,233,237,239,241,244
-----computeFrom-----
80,81
80,82
105,106
105,107
111,112
111,113
132,133
132,134
139,140
139,141
145,146
145,147
159,160
159,161
161,162
161,163
167,168
167,169
183,184
183,185
231,232
231,233
-----guardedBy-----
134,147
163,208
165,205
187,199
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;NamedTypeSpecifier;Name;FunctionDeclarator;Pointer;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;SwitchStatement;IdExpression;Name;CompoundStatement;CaseStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;BreakStatement;CaseStatement;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;UnaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;IdExpression;Name;BreakStatement;DefaultStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;BreakStatement;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;NamedTypeSpecifier;Name;Declarator;Pointer;IdExpression;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
wpt_packet * wpalPacketAlloc(wpt_packet_type pktType, wpt_uint32 nPktSize,                             wpalPacketLowPacketCB rxLowCB, void *usrData){   VOS_STATUS   vosStatus = VOS_STATUS_E_FAILURE;   wpt_packet*  pPkt      = NULL;   vos_pkt_t*   pVosPkt   = NULL;   void*        pData     = NULL;   v_U16_t      allocLen;   /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */   switch (pktType)   {   case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/);      break;   case eWLAN_PAL_PKT_TYPE_RX_RAW:      /* Set the wpalPacketAvailableCB before we try to get a VOS       * packet from the 'free list' and reset it if vos_pkt_get_packet()       * returns a valid packet. This order is required to avoid the       * race condition:       * 1. The below call to vos_pkt_get_packet() in RX_Thread determines       *    that no more packets are available in the 'free list' and sets       *    the low resource callbacks.       * 2. in parallel vos_pkt_return_packet() is called in MC_Thread for a       *    Management frame before wpalPacketAlloc() gets a chance to set       *    wpalPacketAvailableCB and since the 'low resource callbacks'       *    are set the callback function - wpalPacketRXLowResourceCB is       *    executed,but since wpalPacketAvailableCB is still NULL the low       *    resource recovery fails.       */      wpalPacketAvailableCB = rxLowCB;      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData);#ifndef FEATURE_R33D      /* Reserve the entire raw rx buffer for DXE */      if( vosStatus == VOS_STATUS_SUCCESS )      {        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }#endif /* FEATURE_R33D */      if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))      {         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }      break;   default:      WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType);      break;   }   if(VOS_IS_STATUS_SUCCESS(vosStatus))   {      pPkt = (wpt_packet *)pVosPkt;   }   return pPkt;}
wpt_packet
wpt_packet
* wpalPacketAlloc(wpt_packet_type pktType, wpt_uint32 nPktSize,                             wpalPacketLowPacketCB rxLowCB, void *usrData)
*
wpalPacketAlloc
wpt_packet_type pktType
wpt_packet_type
wpt_packet_type
pktType
pktType
wpt_uint32 nPktSize
wpt_uint32
wpt_uint32
nPktSize
nPktSize
wpalPacketLowPacketCB rxLowCB
wpalPacketLowPacketCB
wpalPacketLowPacketCB
rxLowCB
rxLowCB
void *usrData
void
*usrData
*
usrData
{   VOS_STATUS   vosStatus = VOS_STATUS_E_FAILURE;   wpt_packet*  pPkt      = NULL;   vos_pkt_t*   pVosPkt   = NULL;   void*        pData     = NULL;   v_U16_t      allocLen;   /*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */   switch (pktType)   {   case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/);      break;   case eWLAN_PAL_PKT_TYPE_RX_RAW:      /* Set the wpalPacketAvailableCB before we try to get a VOS       * packet from the 'free list' and reset it if vos_pkt_get_packet()       * returns a valid packet. This order is required to avoid the       * race condition:       * 1. The below call to vos_pkt_get_packet() in RX_Thread determines       *    that no more packets are available in the 'free list' and sets       *    the low resource callbacks.       * 2. in parallel vos_pkt_return_packet() is called in MC_Thread for a       *    Management frame before wpalPacketAlloc() gets a chance to set       *    wpalPacketAvailableCB and since the 'low resource callbacks'       *    are set the callback function - wpalPacketRXLowResourceCB is       *    executed,but since wpalPacketAvailableCB is still NULL the low       *    resource recovery fails.       */      wpalPacketAvailableCB = rxLowCB;      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData);#ifndef FEATURE_R33D      /* Reserve the entire raw rx buffer for DXE */      if( vosStatus == VOS_STATUS_SUCCESS )      {        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }#endif /* FEATURE_R33D */      if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))      {         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }      break;   default:      WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType);      break;   }   if(VOS_IS_STATUS_SUCCESS(vosStatus))   {      pPkt = (wpt_packet *)pVosPkt;   }   return pPkt;}
VOS_STATUS   vosStatus = VOS_STATUS_E_FAILURE;
VOS_STATUS   vosStatus = VOS_STATUS_E_FAILURE;
VOS_STATUS
VOS_STATUS
vosStatus = VOS_STATUS_E_FAILURE
vosStatus
= VOS_STATUS_E_FAILURE
VOS_STATUS_E_FAILURE
VOS_STATUS_E_FAILURE
wpt_packet*  pPkt      = NULL;
wpt_packet*  pPkt      = NULL;
wpt_packet
wpt_packet
*  pPkt      = NULL
*
pPkt
= NULL
NULL
NULL
vos_pkt_t*   pVosPkt   = NULL;
vos_pkt_t*   pVosPkt   = NULL;
vos_pkt_t
vos_pkt_t
*   pVosPkt   = NULL
*
pVosPkt
= NULL
NULL
NULL
void*        pData     = NULL;
void*        pData     = NULL;
void
*        pData     = NULL
*
pData
= NULL
NULL
NULL
v_U16_t      allocLen;
v_U16_t      allocLen;
v_U16_t
v_U16_t
allocLen
allocLen
switch (pktType)   {   case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/);      break;   case eWLAN_PAL_PKT_TYPE_RX_RAW:      /* Set the wpalPacketAvailableCB before we try to get a VOS       * packet from the 'free list' and reset it if vos_pkt_get_packet()       * returns a valid packet. This order is required to avoid the       * race condition:       * 1. The below call to vos_pkt_get_packet() in RX_Thread determines       *    that no more packets are available in the 'free list' and sets       *    the low resource callbacks.       * 2. in parallel vos_pkt_return_packet() is called in MC_Thread for a       *    Management frame before wpalPacketAlloc() gets a chance to set       *    wpalPacketAvailableCB and since the 'low resource callbacks'       *    are set the callback function - wpalPacketRXLowResourceCB is       *    executed,but since wpalPacketAvailableCB is still NULL the low       *    resource recovery fails.       */      wpalPacketAvailableCB = rxLowCB;      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData);#ifndef FEATURE_R33D      /* Reserve the entire raw rx buffer for DXE */      if( vosStatus == VOS_STATUS_SUCCESS )      {        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }#endif /* FEATURE_R33D */      if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))      {         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }      break;   default:      WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType);      break;   }
pktType
pktType
{   case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/);      break;   case eWLAN_PAL_PKT_TYPE_RX_RAW:      /* Set the wpalPacketAvailableCB before we try to get a VOS       * packet from the 'free list' and reset it if vos_pkt_get_packet()       * returns a valid packet. This order is required to avoid the       * race condition:       * 1. The below call to vos_pkt_get_packet() in RX_Thread determines       *    that no more packets are available in the 'free list' and sets       *    the low resource callbacks.       * 2. in parallel vos_pkt_return_packet() is called in MC_Thread for a       *    Management frame before wpalPacketAlloc() gets a chance to set       *    wpalPacketAvailableCB and since the 'low resource callbacks'       *    are set the callback function - wpalPacketRXLowResourceCB is       *    executed,but since wpalPacketAvailableCB is still NULL the low       *    resource recovery fails.       */      wpalPacketAvailableCB = rxLowCB;      vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData);#ifndef FEATURE_R33D      /* Reserve the entire raw rx buffer for DXE */      if( vosStatus == VOS_STATUS_SUCCESS )      {        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }#endif /* FEATURE_R33D */      if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))      {         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }      break;   default:      WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType);      break;   }
case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:
eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT
eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT
vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/);
vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/)
vosStatus
vosStatus
vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,                                       nPktSize, 1, VOS_FALSE,                                        NULL, NULL /*no callback*/)
vos_pkt_get_packet
vos_pkt_get_packet
&pVosPkt
pVosPkt
pVosPkt
VOS_PKT_TYPE_TX_802_11_MGMT
VOS_PKT_TYPE_TX_802_11_MGMT
nPktSize
nPktSize
1
VOS_FALSE
VOS_FALSE
NULL
NULL
NULL
NULL
break;
case eWLAN_PAL_PKT_TYPE_RX_RAW:
eWLAN_PAL_PKT_TYPE_RX_RAW
eWLAN_PAL_PKT_TYPE_RX_RAW
wpalPacketAvailableCB = rxLowCB;
wpalPacketAvailableCB = rxLowCB
wpalPacketAvailableCB
wpalPacketAvailableCB
rxLowCB
rxLowCB
vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData);
vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData)
vosStatus
vosStatus
vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,                                       nPktSize, 1, VOS_FALSE,                                        wpalPacketRXLowResourceCB, usrData)
vos_pkt_get_packet
vos_pkt_get_packet
&pVosPkt
pVosPkt
pVosPkt
VOS_PKT_TYPE_RX_RAW
VOS_PKT_TYPE_RX_RAW
nPktSize
nPktSize
1
VOS_FALSE
VOS_FALSE
wpalPacketRXLowResourceCB
wpalPacketRXLowResourceCB
usrData
usrData
if( vosStatus == VOS_STATUS_SUCCESS )      {        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }
vosStatus == VOS_STATUS_SUCCESS
vosStatus
vosStatus
VOS_STATUS_SUCCESS
VOS_STATUS_SUCCESS
{        wpalPacketAvailableCB = NULL;        vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );       }
wpalPacketAvailableCB = NULL;
wpalPacketAvailableCB = NULL
wpalPacketAvailableCB
wpalPacketAvailableCB
NULL
NULL
vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize );
vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize )
vosStatus
vosStatus
vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize )
vos_pkt_reserve_head_fast
vos_pkt_reserve_head_fast
pVosPkt
pVosPkt
&pData
pData
pData
nPktSize
nPktSize
if((NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus))      {         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }
(NULL != pVosPkt) && (VOS_STATUS_E_RESOURCES != vosStatus)
(NULL != pVosPkt)
NULL != pVosPkt
NULL
NULL
pVosPkt
pVosPkt
(VOS_STATUS_E_RESOURCES != vosStatus)
VOS_STATUS_E_RESOURCES != vosStatus
VOS_STATUS_E_RESOURCES
VOS_STATUS_E_RESOURCES
vosStatus
vosStatus
{         vos_pkt_get_packet_length(pVosPkt, &allocLen);         if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }      }
vos_pkt_get_packet_length(pVosPkt, &allocLen);
vos_pkt_get_packet_length(pVosPkt, &allocLen)
vos_pkt_get_packet_length
vos_pkt_get_packet_length
pVosPkt
pVosPkt
&allocLen
allocLen
allocLen
if (nPktSize != allocLen)         {            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }
nPktSize != allocLen
nPktSize
nPktSize
allocLen
allocLen
{            WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);            vos_pkt_return_packet(pVosPkt);            return NULL;         }
WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen);
WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                       "RX packet alloc has problem, discard this frame, Len %d", allocLen)
WPAL_TRACE
WPAL_TRACE
eWLAN_MODULE_PAL
eWLAN_MODULE_PAL
eWLAN_PAL_TRACE_LEVEL_ERROR
eWLAN_PAL_TRACE_LEVEL_ERROR
"RX packet alloc has problem, discard this frame, Len %d"
allocLen
allocLen
vos_pkt_return_packet(pVosPkt);
vos_pkt_return_packet(pVosPkt)
vos_pkt_return_packet
vos_pkt_return_packet
pVosPkt
pVosPkt
return NULL;
NULL
NULL
break;
default:
WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType);
WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,                   " try to allocate unsupported packet type (%d)", pktType)
WPAL_TRACE
WPAL_TRACE
eWLAN_MODULE_PAL
eWLAN_MODULE_PAL
eWLAN_PAL_TRACE_LEVEL_ERROR
eWLAN_PAL_TRACE_LEVEL_ERROR
" try to allocate unsupported packet type (%d)"
pktType
pktType
break;
if(VOS_IS_STATUS_SUCCESS(vosStatus))   {      pPkt = (wpt_packet *)pVosPkt;   }
VOS_IS_STATUS_SUCCESS(vosStatus)
VOS_IS_STATUS_SUCCESS
VOS_IS_STATUS_SUCCESS
vosStatus
vosStatus
{      pPkt = (wpt_packet *)pVosPkt;   }
pPkt = (wpt_packet *)pVosPkt;
pPkt = (wpt_packet *)pVosPkt
pPkt
pPkt
(wpt_packet *)pVosPkt
wpt_packet *
wpt_packet
wpt_packet
*
*
pVosPkt
pVosPkt
return pPkt;
pPkt
pPkt
-----joern-----
(7,14,0)
(33,83,0)
(93,99,0)
(16,27,0)
(11,16,0)
(10,112,0)
(74,46,0)
(22,7,0)
(101,36,0)
(110,70,0)
(84,80,0)
(81,55,0)
(112,81,0)
(7,58,0)
(8,33,0)
(59,110,0)
(84,76,0)
(89,83,0)
(45,87,0)
(112,83,0)
(108,1,0)
(67,17,0)
(88,7,0)
(100,70,0)
(96,72,0)
(18,109,0)
(71,99,0)
(51,48,0)
(46,79,0)
(43,83,0)
(73,43,0)
(40,83,0)
(5,70,0)
(42,43,0)
(20,4,0)
(60,36,0)
(95,4,0)
(57,87,0)
(77,83,0)
(110,99,0)
(52,7,0)
(26,83,0)
(81,1,0)
(56,27,0)
(103,112,0)
(29,40,0)
(70,14,0)
(41,46,0)
(106,99,0)
(44,52,0)
(53,52,0)
(64,7,0)
(107,80,0)
(0,96,0)
(35,104,0)
(80,57,0)
(16,43,0)
(31,58,0)
(82,1,0)
(75,99,0)
(109,14,0)
(28,46,0)
(32,44,0)
(36,76,0)
(21,7,0)
(114,48,0)
(65,38,0)
(97,81,0)
(61,99,0)
(44,110,0)
(46,99,0)
(105,7,0)
(17,99,0)
(104,84,0)
(19,96,0)
(2,48,0)
(73,70,0)
(112,33,0)
(91,83,0)
(16,12,0)
(68,70,0)
(80,14,0)
(7,52,0)
(54,65,0)
(1,43,0)
(1,82,0)
(70,92,0)
(72,96,0)
(23,46,0)
(58,7,0)
(65,17,0)
(3,43,0)
(70,73,0)
(3,38,0)
(44,84,0)
(57,80,0)
(72,104,0)
(47,7,0)
(39,83,0)
(104,72,0)
(58,43,0)
(80,43,0)
(90,57,0)
(111,12,0)
(87,83,0)
(52,99,0)
(63,83,0)
(25,109,0)
(65,36,0)
(10,65,0)
(49,70,0)
(4,110,0)
(34,43,0)
(17,50,0)
(80,84,0)
(70,110,0)
(113,3,0)
(98,17,0)
(44,40,0)
(94,87,0)
(96,43,0)
(9,99,0)
(78,70,0)
(12,16,0)
(1,81,0)
(13,33,0)
(62,84,0)
(85,104,0)
(69,48,0)
(66,40,0)
(30,83,0)
(102,73,0)
(37,99,0)
(6,80,0)
(24,70,0)
(15,99,0)
(48,38,0)
(104,110,0)
(16,12,1)
(31,53,1)
(1,43,1)
(16,43,1)
(0,84,1)
(40,66,1)
(67,98,1)
(32,9,1)
(102,59,1)
(5,68,1)
(20,110,1)
(60,101,1)
(70,92,1)
(17,67,1)
(108,97,1)
(80,57,1)
(28,41,1)
(7,58,1)
(111,11,1)
(103,44,1)
(80,43,1)
(114,2,1)
(1,108,1)
(25,16,1)
(7,22,1)
(32,61,1)
(47,21,1)
(59,17,1)
(44,110,1)
(70,14,1)
(44,52,1)
(49,24,1)
(104,84,1)
(90,6,1)
(36,60,1)
(13,40,1)
(44,40,1)
(32,37,1)
(46,23,1)
(6,62,1)
(98,86,1)
(12,111,1)
(73,43,1)
(21,105,1)
(113,48,1)
(112,81,1)
(51,109,1)
(110,70,1)
(101,4,1)
(58,43,1)
(94,45,1)
(24,73,1)
(96,19,1)
(33,8,1)
(85,35,1)
(103,81,1)
(84,80,1)
(37,109,1)
(9,52,1)
(95,20,1)
(96,43,1)
(74,28,1)
(35,96,1)
(65,17,1)
(7,14,1)
(64,47,1)
(112,103,1)
(45,43,1)
(17,50,1)
(61,46,1)
(62,36,1)
(44,84,1)
(100,49,1)
(46,79,1)
(78,5,1)
(4,110,1)
(69,51,1)
(2,69,1)
(66,29,1)
(65,54,1)
(43,42,1)
(54,3,1)
(18,25,1)
(4,95,1)
(10,112,1)
(48,114,1)
(72,96,1)
(19,0,1)
(70,73,1)
(81,1,1)
(11,72,1)
(104,110,1)
(72,104,1)
(53,86,1)
(42,34,1)
(23,74,1)
(87,94,1)
(34,33,1)
(57,87,1)
(58,31,1)
(52,7,1)
(37,72,1)
(0,4,1)
(80,14,1)
(73,102,1)
(8,13,1)
(109,18,1)
(3,113,1)
(41,86,1)
(22,88,1)
(3,43,1)
(44,32,1)
(1,82,1)
(104,85,1)
(107,57,1)
(70,78,1)
(109,14,1)
(105,58,1)
(68,100,1)
(65,36,1)
(88,64,1)
(80,107,1)
(112,33,1)
(10,65,1)
(57,90,1)
(86,87,1)
(97,44,1)
(65,17,2)
(104,96,2)
(103,109,2)
(52,86,2)
(57,87,2)
(61,86,2)
(44,84,2)
(3,43,2)
(98,86,2)
(17,50,2)
(46,86,2)
(28,86,2)
(31,86,2)
(80,4,2)
(44,86,2)
(74,86,2)
(41,86,2)
(108,44,2)
(90,4,2)
(44,72,2)
(46,79,2)
(17,86,2)
(7,86,2)
(80,14,2)
(73,86,2)
(4,86,2)
(95,86,2)
(112,109,2)
(1,43,2)
(72,86,2)
(104,84,2)
(101,4,2)
(37,72,2)
(20,86,2)
(12,72,2)
(16,12,2)
(54,109,2)
(32,86,2)
(70,92,2)
(80,57,2)
(7,58,2)
(64,86,2)
(19,86,2)
(59,86,2)
(52,7,2)
(109,14,2)
(16,72,2)
(84,80,2)
(57,4,2)
(67,86,2)
(5,86,2)
(1,44,2)
(80,43,2)
(7,14,2)
(113,109,2)
(2,109,2)
(25,72,2)
(104,110,2)
(70,86,2)
(100,86,2)
(48,109,2)
(114,109,2)
(96,43,2)
(88,86,2)
(16,43,2)
(110,86,2)
(10,112,2)
(72,96,2)
(103,72,2)
(49,86,2)
(44,110,2)
(112,72,2)
(58,86,2)
(112,33,2)
(36,4,2)
(112,81,2)
(73,43,2)
(32,109,2)
(78,86,2)
(96,86,2)
(107,4,2)
(37,109,2)
(0,86,2)
(81,1,2)
(72,104,2)
(44,40,2)
(9,86,2)
(44,109,2)
(10,65,2)
(65,109,2)
(11,72,2)
(32,72,2)
(81,44,2)
(69,109,2)
(4,110,2)
(97,44,2)
(60,4,2)
(21,86,2)
(85,96,2)
(6,4,2)
(18,72,2)
(70,14,2)
(84,4,2)
(105,86,2)
(51,109,2)
(22,86,2)
(23,86,2)
(102,86,2)
(68,86,2)
(62,4,2)
(112,86,2)
(1,82,2)
(65,36,2)
(24,86,2)
(47,86,2)
(35,96,2)
(3,109,2)
(109,72,2)
(53,86,2)
(44,52,2)
(70,73,2)
(111,72,2)
(110,70,2)
(58,43,2)
(103,86,2)
-----------------------------------
(0,NULL)
(1,(wpt_packet *)
(2,"RX packet alloc has problem, discard this frame, Len %d")
(3,vos_pkt_return_packet(pVosPkt)
(4,vosStatus == VOS_STATUS_SUCCESS)
(5,wpalPacketRXLowResourceCB)
(6,pVosPkt)
(7,vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,\n\\n                                       nPktSize, 1, VOS_FALSE, \n\\n                                       NULL, NULL /*no callback*/)
(8,NULL)
(9,break;)
(10,RET)
(11,pVosPkt)
(12,&allocLen)
(13,pPkt)
(14,wpt_uint32 nPktSize)
(15,default:)
(16,vos_pkt_get_packet_length(pVosPkt, &allocLen)
(17,wpalPacketAvailableCB = rxLowCB)
(18,allocLen)
(19,pVosPkt)
(20,vosStatus)
(21,nPktSize)
(22,NULL)
(23,pktType)
(24,VOS_PKT_TYPE_RX_RAW)
(25,nPktSize)
(26,switch (pktType)
(27,)
(28,eWLAN_PAL_TRACE_LEVEL_ERROR)
(29,vosStatus)
(30,pVosPkt)
(31,pVosPkt)
(32,vosStatus)
(33,*  pPkt      = NULL)
(34,pVosPkt)
(35,VOS_STATUS_E_RESOURCES)
(36,wpalPacketAvailableCB = NULL)
(37,break;)
(38,)
(39,vosStatus)
(40,vosStatus = VOS_STATUS_E_FAILURE)
(41,eWLAN_MODULE_PAL)
(42,NULL)
(43,*   pVosPkt   = NULL)
(44,VOS_IS_STATUS_SUCCESS(vosStatus)
(45,pData)
(46,WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR, \n\\n                  " try to allocate unsupported packet type (%d)
(47,1)
(48,WPAL_TRACE(eWLAN_MODULE_PAL, eWLAN_PAL_TRACE_LEVEL_ERROR,\n\\n                       "RX packet alloc has problem, discard this frame, Len %d", allocLen)
(49,nPktSize)
(50,wpalPacketLowPacketCB rxLowCB)
(51,eWLAN_MODULE_PAL)
(52,vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_TX_802_11_MGMT,\n\\n                                       nPktSize, 1, VOS_FALSE, \n\\n                                       NULL, NULL /*no callback*/)
(53,vosStatus)
(54,NULL)
(55,)
(56,if (nPktSize != allocLen)
(57,&pData)
(58,&pVosPkt)
(59,vosStatus)
(60,NULL)
(61,break;)
(62,vosStatus)
(63,if(VOS_IS_STATUS_SUCCESS(vosStatus)
(64,VOS_FALSE)
(65,return NULL;)
(66,VOS_STATUS_E_FAILURE)
(67,rxLowCB)
(68,VOS_FALSE)
(69,eWLAN_PAL_TRACE_LEVEL_ERROR)
(70,vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,\n\\n                                       nPktSize, 1, VOS_FALSE, \n\\n                                       wpalPacketRXLowResourceCB, usrData)
(71,case eWLAN_PAL_PKT_TYPE_RX_RAW:)
(72,(NULL != pVosPkt)
(73,&pVosPkt)
(74," try to allocate unsupported packet type (%d)
(75,if( vosStatus == VOS_STATUS_SUCCESS )
(76,)
(77,pData)
(78,usrData)
(79,wpt_packet_type pktType)
(80,vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize )
(81,pPkt = (wpt_packet *)
(82,wpt_packet *)
(83,)
(84,vosStatus =  vos_pkt_reserve_head_fast( pVosPkt, &pData, nPktSize )
(85,vosStatus)
(86,pktType)
(87,*        pData     = NULL)
(88,NULL)
(89,pPkt)
(90,pData)
(91,allocLen)
(92,void *usrData)
(93,case eWLAN_PAL_PKT_TYPE_TX_802_11_MGMT:)
(94,NULL)
(95,VOS_STATUS_SUCCESS)
(96,NULL != pVosPkt)
(97,pPkt)
(98,wpalPacketAvailableCB)
(99,)
(100,1)
(101,wpalPacketAvailableCB)
(102,pVosPkt)
(103,pPkt)
(104,VOS_STATUS_E_RESOURCES != vosStatus)
(105,VOS_PKT_TYPE_TX_802_11_MGMT)
(106,if((NULL != pVosPkt)
(107,nPktSize)
(108,pVosPkt)
(109,nPktSize != allocLen)
(110,vosStatus = vos_pkt_get_packet(&pVosPkt, VOS_PKT_TYPE_RX_RAW,\n\\n                                       nPktSize, 1, VOS_FALSE, \n\\n                                       wpalPacketRXLowResourceCB, usrData)
(111,allocLen)
(112,return pPkt;)
(113,pVosPkt)
(114,allocLen)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^