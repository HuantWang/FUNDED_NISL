-----label-----
0
-----code-----
static const struct unwind_idx *unwind_find_idx(unsigned long addr)
{
	const struct unwind_idx *idx = NULL;
	unsigned long flags;

	pr_debug("%s(%08lx)\n", __func__, addr);

	if (core_kernel_text(addr)) {
		if (unlikely(!__origin_unwind_idx))
			__origin_unwind_idx =
				unwind_find_origin(__start_unwind_idx,
						__stop_unwind_idx);

		/* main unwind table */
		idx = search_index(addr, __start_unwind_idx,
				   __origin_unwind_idx,
				   __stop_unwind_idx);
	} else {
		/* module unwind tables */
		struct unwind_table *table;

		raw_spin_lock_irqsave(&unwind_lock, flags);
		list_for_each_entry(table, &unwind_tables, list) {
			if (addr >= table->begin_addr &&
			    addr < table->end_addr) {
				idx = search_index(addr, table->start,
						   table->origin,
						   table->stop);
				/* Move-to-front to exploit common traces */
				list_move(&table->list, &unwind_tables);
				break;
			}
		}
		raw_spin_unlock_irqrestore(&unwind_lock, flags);
	}

	pr_debug("%s: idx = %p\n", __func__, idx);
	return idx;
}
-----children-----
1,2
1,3
1,4
2,3
4,5
4,6
4,7
7,8
7,9
9,10
11,12
11,13
11,14
11,15
11,16
11,17
12,13
13,14
13,15
14,15
16,17
16,18
16,19
19,20
20,21
22,23
23,24
23,25
25,26
27,28
28,29
28,30
28,31
28,32
29,30
32,33
34,35
36,37
36,38
36,39
37,38
37,39
38,39
40,41
42,43
42,44
43,44
43,45
44,45
44,46
45,46
47,48
48,49
50,51
51,52
51,53
52,53
54,55
54,56
54,57
55,56
57,58
59,60
61,62
62,63
62,64
63,64
65,66
65,67
65,68
65,69
65,70
66,67
68,69
70,71
72,73
74,75
76,77
76,78
76,79
76,80
76,81
76,82
77,78
78,79
78,80
79,80
81,82
81,83
84,85
85,86
85,87
85,88
86,87
88,89
89,90
91,92
93,94
94,95
94,96
94,97
94,98
95,96
97,98
99,100
100,101
102,103
104,105
105,106
106,107
106,108
107,108
107,109
108,109
108,110
109,110
111,112
111,113
112,113
115,116
115,117
116,117
118,119
118,120
119,120
122,123
122,124
122,125
123,124
124,125
124,126
125,126
127,128
127,129
127,130
127,131
127,132
128,129
130,131
132,133
132,134
133,134
136,137
136,138
137,138
140,141
140,142
141,142
144,145
145,146
145,147
145,148
146,147
148,149
149,150
149,151
150,151
153,154
154,155
157,158
158,159
158,160
158,161
159,160
161,162
162,163
164,165
166,167
167,168
167,169
167,170
167,171
168,169
171,172
173,174
175,176
176,177
-----nextToken-----
3,5,6,8,10,15,17,18,21,24,26,30,31,33,35,39,41,46,49,53,56,58,60,64,67,69,71,73,75,80,82,83,87,90,92,96,98,101,103,110,113,114,117,120,121,126,129,131,134,135,138,139,142,143,147,151,152,155,156,160,163,165,169,170,172,174,177
-----computeFrom-----
51,52
51,53
62,63
62,64
107,108
107,109
108,109
108,110
115,116
115,117
124,125
124,126
-----guardedBy-----
117,131
120,151
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;ElaboratedTypeSpecifier;Name;FunctionDeclarator;Pointer;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;IfStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;IfStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;ProblemStatement;CompoundStatement;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;BinaryExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;FieldReference;IdExpression;Name;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;FieldReference;IdExpression;Name;Name;UnaryExpression;IdExpression;Name;BreakStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;ReturnStatement;IdExpression;Name;
-----ast_node-----
static const struct unwind_idx *unwind_find_idx(unsigned long addr){	const struct unwind_idx *idx = NULL;	unsigned long flags;	pr_debug("%s(%08lx)\n", __func__, addr);	if (core_kernel_text(addr)) {		if (unlikely(!__origin_unwind_idx))			__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);		/* main unwind table */		idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx);	} else {		/* module unwind tables */		struct unwind_table *table;		raw_spin_lock_irqsave(&unwind_lock, flags);		list_for_each_entry(table, &unwind_tables, list) {			if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}		}		raw_spin_unlock_irqrestore(&unwind_lock, flags);	}	pr_debug("%s: idx = %p\n", __func__, idx);	return idx;}
static const struct unwind_idx
unwind_idx
*unwind_find_idx(unsigned long addr)
*
unwind_find_idx
unsigned long addr
unsigned long
addr
addr
{	const struct unwind_idx *idx = NULL;	unsigned long flags;	pr_debug("%s(%08lx)\n", __func__, addr);	if (core_kernel_text(addr)) {		if (unlikely(!__origin_unwind_idx))			__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);		/* main unwind table */		idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx);	} else {		/* module unwind tables */		struct unwind_table *table;		raw_spin_lock_irqsave(&unwind_lock, flags);		list_for_each_entry(table, &unwind_tables, list) {			if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}		}		raw_spin_unlock_irqrestore(&unwind_lock, flags);	}	pr_debug("%s: idx = %p\n", __func__, idx);	return idx;}
const struct unwind_idx *idx = NULL;
const struct unwind_idx *idx = NULL;
const struct unwind_idx
unwind_idx
*idx = NULL
*
idx
= NULL
NULL
NULL
unsigned long flags;
unsigned long flags;
unsigned long
flags
flags
pr_debug("%s(%08lx)\n", __func__, addr);
pr_debug("%s(%08lx)\n", __func__, addr)
pr_debug
pr_debug
"%s(%08lx)\n"
__func__
__func__
addr
addr
if (core_kernel_text(addr)) {		if (unlikely(!__origin_unwind_idx))			__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);		/* main unwind table */		idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx);	} else {		/* module unwind tables */		struct unwind_table *table;		raw_spin_lock_irqsave(&unwind_lock, flags);		list_for_each_entry(table, &unwind_tables, list) {			if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}		}		raw_spin_unlock_irqrestore(&unwind_lock, flags);	}
core_kernel_text(addr)
core_kernel_text
core_kernel_text
addr
addr
{		if (unlikely(!__origin_unwind_idx))			__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);		/* main unwind table */		idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx);	}
if (unlikely(!__origin_unwind_idx))			__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);
unlikely(!__origin_unwind_idx)
unlikely
unlikely
!__origin_unwind_idx
__origin_unwind_idx
__origin_unwind_idx
__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx);
__origin_unwind_idx =				unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx)
__origin_unwind_idx
__origin_unwind_idx
unwind_find_origin(__start_unwind_idx,						__stop_unwind_idx)
unwind_find_origin
unwind_find_origin
__start_unwind_idx
__start_unwind_idx
__stop_unwind_idx
__stop_unwind_idx
idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx);
idx = search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx)
idx
idx
search_index(addr, __start_unwind_idx,				   __origin_unwind_idx,				   __stop_unwind_idx)
search_index
search_index
addr
addr
__start_unwind_idx
__start_unwind_idx
__origin_unwind_idx
__origin_unwind_idx
__stop_unwind_idx
__stop_unwind_idx
{		/* module unwind tables */		struct unwind_table *table;		raw_spin_lock_irqsave(&unwind_lock, flags);		list_for_each_entry(table, &unwind_tables, list) {			if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}		}		raw_spin_unlock_irqrestore(&unwind_lock, flags);	}
struct unwind_table *table;
struct unwind_table *table;
struct unwind_table
unwind_table
*table
*
table
raw_spin_lock_irqsave(&unwind_lock, flags);
raw_spin_lock_irqsave(&unwind_lock, flags)
raw_spin_lock_irqsave
raw_spin_lock_irqsave
&unwind_lock
unwind_lock
unwind_lock
flags
flags
list_for_each_entry(table, &unwind_tables, list)
list_for_each_entry(table, &unwind_tables, list)
list_for_each_entry
list_for_each_entry
table
table
&unwind_tables
unwind_tables
unwind_tables
list
list
)
{			if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}		}
if (addr >= table->begin_addr &&			    addr < table->end_addr) {				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}
addr >= table->begin_addr &&			    addr < table->end_addr
addr >= table->begin_addr
addr
addr
table->begin_addr
table
table
begin_addr
addr < table->end_addr
addr
addr
table->end_addr
table
table
end_addr
{				idx = search_index(addr, table->start,						   table->origin,						   table->stop);				/* Move-to-front to exploit common traces */				list_move(&table->list, &unwind_tables);				break;			}
idx = search_index(addr, table->start,						   table->origin,						   table->stop);
idx = search_index(addr, table->start,						   table->origin,						   table->stop)
idx
idx
search_index(addr, table->start,						   table->origin,						   table->stop)
search_index
search_index
addr
addr
table->start
table
table
start
table->origin
table
table
origin
table->stop
table
table
stop
list_move(&table->list, &unwind_tables);
list_move(&table->list, &unwind_tables)
list_move
list_move
&table->list
table->list
table
table
list
&unwind_tables
unwind_tables
unwind_tables
break;
raw_spin_unlock_irqrestore(&unwind_lock, flags);
raw_spin_unlock_irqrestore(&unwind_lock, flags)
raw_spin_unlock_irqrestore
raw_spin_unlock_irqrestore
&unwind_lock
unwind_lock
unwind_lock
flags
flags
pr_debug("%s: idx = %p\n", __func__, idx);
pr_debug("%s: idx = %p\n", __func__, idx)
pr_debug
pr_debug
"%s: idx = %p\n"
__func__
__func__
idx
idx
return idx;
idx
idx
-----joern-----
(28,2,0)
(58,60,0)
(45,49,0)
(21,42,0)
(43,7,0)
(0,2,0)
(40,30,0)
(54,2,0)
(81,32,0)
(2,54,0)
(66,32,0)
(46,19,0)
(10,18,0)
(18,10,0)
(20,22,0)
(12,60,0)
(35,19,0)
(31,43,0)
(80,34,0)
(48,19,0)
(62,43,0)
(8,5,0)
(60,19,0)
(70,73,0)
(76,72,0)
(29,42,0)
(17,18,0)
(13,42,0)
(23,72,0)
(44,61,0)
(33,57,0)
(74,67,0)
(69,11,0)
(25,53,0)
(41,11,0)
(78,46,0)
(75,61,0)
(77,68,0)
(48,73,0)
(56,48,0)
(38,45,0)
(42,13,0)
(46,73,0)
(51,68,0)
(22,7,0)
(11,19,0)
(71,37,0)
(67,45,0)
(37,34,0)
(37,68,0)
(11,34,0)
(22,20,0)
(14,18,0)
(61,44,0)
(63,20,0)
(39,48,0)
(42,29,0)
(53,49,0)
(65,46,0)
(46,10,0)
(48,60,0)
(3,19,0)
(36,61,0)
(6,29,0)
(13,54,0)
(7,22,0)
(37,30,0)
(52,26,0)
(37,73,0)
(48,10,0)
(15,80,0)
(9,18,0)
(54,34,0)
(42,34,0)
(45,67,0)
(55,29,0)
(46,60,0)
(5,8,0)
(27,5,0)
(10,57,0)
(1,10,0)
(4,8,0)
(8,49,0)
(37,72,0)
(7,43,0)
(22,26,0)
(32,66,0)
(79,18,0)
(82,46,0)
(73,37,0)
(59,49,0)
(16,30,0)
(18,34,0)
(68,37,0)
(54,13,0)
(72,37,0)
(64,54,0)
(30,37,0)
(47,44,0)
(73,26,0)
(50,11,0)
(24,19,0)
(38,67,1)
(54,34,1)
(72,76,1)
(82,78,1)
(40,16,1)
(27,80,1)
(70,13,1)
(46,10,1)
(31,62,1)
(55,6,1)
(37,34,1)
(11,69,1)
(52,22,1)
(1,66,1)
(1,44,1)
(68,77,1)
(51,71,1)
(11,34,1)
(73,37,1)
(78,45,1)
(12,58,1)
(48,10,1)
(37,30,1)
(43,31,1)
(48,73,1)
(4,5,1)
(10,18,1)
(28,64,1)
(69,41,1)
(50,60,1)
(80,34,1)
(15,11,1)
(64,42,1)
(62,73,1)
(46,60,1)
(9,1,1)
(22,7,1)
(74,13,1)
(32,81,1)
(29,55,1)
(56,48,1)
(18,14,1)
(41,50,1)
(0,28,1)
(37,72,1)
(16,72,1)
(80,15,1)
(78,10,1)
(18,34,1)
(17,79,1)
(74,52,1)
(45,38,1)
(66,32,1)
(2,0,1)
(76,23,1)
(39,46,1)
(54,2,1)
(23,68,1)
(21,8,1)
(20,63,1)
(81,80,1)
(13,54,1)
(48,60,1)
(71,70,1)
(75,36,1)
(13,42,1)
(77,51,1)
(45,67,1)
(61,75,1)
(79,9,1)
(67,74,1)
(37,68,1)
(48,39,1)
(6,21,1)
(63,7,1)
(46,73,1)
(14,17,1)
(44,61,1)
(8,4,1)
(46,65,1)
(8,5,1)
(5,27,1)
(22,20,1)
(36,47,1)
(60,12,1)
(7,43,1)
(30,40,1)
(42,34,1)
(42,29,1)
(47,66,1)
(65,82,1)
(36,66,2)
(7,43,2)
(22,20,2)
(81,80,2)
(44,61,2)
(0,42,2)
(43,13,2)
(47,66,2)
(29,80,2)
(66,80,2)
(42,80,2)
(1,80,2)
(48,73,2)
(80,34,2)
(74,80,2)
(11,34,2)
(37,13,2)
(28,42,2)
(76,13,2)
(72,13,2)
(27,80,2)
(23,13,2)
(46,10,2)
(13,80,2)
(66,32,2)
(64,42,2)
(70,13,2)
(68,13,2)
(32,80,2)
(16,13,2)
(17,80,2)
(22,13,2)
(73,13,2)
(9,80,2)
(51,13,2)
(22,7,2)
(42,34,2)
(42,29,2)
(20,13,2)
(48,10,2)
(45,67,2)
(46,73,2)
(61,66,2)
(38,80,2)
(46,60,2)
(54,34,2)
(10,80,2)
(18,80,2)
(56,48,2)
(37,68,2)
(7,13,2)
(77,13,2)
(37,72,2)
(73,37,2)
(63,13,2)
(8,5,2)
(30,13,2)
(44,66,2)
(8,80,2)
(75,66,2)
(37,34,2)
(6,80,2)
(10,18,2)
(71,13,2)
(21,80,2)
(45,80,2)
(14,80,2)
(4,80,2)
(54,42,2)
(40,13,2)
(5,80,2)
(31,13,2)
(79,80,2)
(62,13,2)
(13,42,2)
(13,54,2)
(54,2,2)
(52,13,2)
(55,80,2)
(48,60,2)
(18,34,2)
(37,30,2)
(2,42,2)
(67,80,2)
-----------------------------------
(0,end_addr)
(1,idx)
(2,table->end_addr)
(3,idx)
(4,flags)
(5,&unwind_lock)
(6,table)
(7,&table->list)
(8,raw_spin_lock_irqsave(&unwind_lock, flags)
(9,addr)
(10,idx = search_index(addr, __start_unwind_idx,\n\\n\\t\\t\\t\\t   __origin_unwind_idx,\n\\n\\t\\t\\t\\t   __stop_unwind_idx)
(11,pr_debug("%s(%08lx)
(12,NULL)
(13,addr >= table->begin_addr &&\n\\n\\t\\t\\t    addr < table->end_addr)
(14,__stop_unwind_idx)
(15,addr)
(16,table)
(17,__origin_unwind_idx)
(18,search_index(addr, __start_unwind_idx,\n\\n\\t\\t\\t\\t   __origin_unwind_idx,\n\\n\\t\\t\\t\\t   __stop_unwind_idx)
(19,)
(20,&unwind_tables)
(21,addr)
(22,list_move(&table->list, &unwind_tables)
(23,table)
(24,flags)
(25,if (addr >= table->begin_addr &&\n\\n\\t\\t\\t    addr < table->end_addr)
(26,)
(27,unwind_lock)
(28,table)
(29,table->begin_addr)
(30,table->stop)
(31,list)
(32,!__origin_unwind_idx)
(33,if (unlikely(!__origin_unwind_idx)
(34,unsigned long addr)
(35,if (core_kernel_text(addr)
(36,__start_unwind_idx)
(37,search_index(addr, table->start,\n\\n\\t\\t\\t\\t\\t\\t   table->origin,\n\\n\\t\\t\\t\\t\\t\\t   table->stop)
(38,flags)
(39,idx)
(40,stop)
(41,__func__)
(42,addr >= table->begin_addr)
(43,table->list)
(44,__origin_unwind_idx =\n\\n\\t\\t\\t\\tunwind_find_origin(__start_unwind_idx,\n\\n\\t\\t\\t\\t\\t\\t__stop_unwind_idx)
(45,raw_spin_unlock_irqrestore(&unwind_lock, flags)
(46,pr_debug("%s: idx = %p\\n", __func__, idx)
(47,__origin_unwind_idx)
(48,return idx;)
(49,)
(50,"%s(%08lx)
(51,table)
(52,break;)
(53,)
(54,addr < table->end_addr)
(55,begin_addr)
(56,RET)
(57,)
(58,idx)
(59,table)
(60,*idx = NULL)
(61,unwind_find_origin(__start_unwind_idx,\n\\n\\t\\t\\t\\t\\t\\t__stop_unwind_idx)
(62,table)
(63,unwind_tables)
(64,addr)
(65,idx)
(66,unlikely(!__origin_unwind_idx)
(67,&unwind_lock)
(68,table->start)
(69,addr)
(70,idx)
(71,addr)
(72,table->origin)
(73,idx = search_index(addr, table->start,\n\\n\\t\\t\\t\\t\\t\\t   table->origin,\n\\n\\t\\t\\t\\t\\t\\t   table->stop)
(74,unwind_lock)
(75,__stop_unwind_idx)
(76,origin)
(77,start)
(78,"%s: idx = %p\\n")
(79,__start_unwind_idx)
(80,core_kernel_text(addr)
(81,__origin_unwind_idx)
(82,__func__)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^