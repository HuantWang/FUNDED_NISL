-----label-----
1
-----code-----
int cayman_pcie_gart_enable(struct radeon_device *rdev)
{
	int i, r;

	if (rdev->gart.robj == NULL) {
		dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");
		return -EINVAL;
	}
	r = radeon_gart_table_vram_pin(rdev);
	if (r)
		return r;
	radeon_gart_restore(rdev);
	/* Setup TLB control */
	WREG32(MC_VM_MX_L1_TLB_CNTL,
	       (0xA << 7) |
	       ENABLE_L1_TLB |
	       ENABLE_L1_FRAGMENT_PROCESSING |
	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |
	       ENABLE_ADVANCED_DRIVER_MODEL |
	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU);
	/* Setup L2 cache */
	WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |
	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |
	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |
	       EFFECTIVE_L2_QUEUE_SIZE(7) |
	       CONTEXT1_IDENTITY_ACCESS_MODE(1));
	WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE);
	WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |
	       L2_CACHE_BIGK_FRAGMENT_SIZE(6));
	/* setup context0 */
	WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12);
	WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12);
	WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12);
	WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,
			(u32)(rdev->dummy_page.addr >> 12));
	WREG32(VM_CONTEXT0_CNTL2, 0);
	WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |
				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);

	WREG32(0x15D4, 0);
	WREG32(0x15D8, 0);
	WREG32(0x15DC, 0);

	/* empty context1-7 */
	for (i = 1; i < 8; i++) {
		WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);
		WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);
		WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),
			rdev->gart.table_addr >> 12);
	}

	/* enable context1-7 */
	WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,
	       (u32)(rdev->dummy_page.addr >> 12));
	WREG32(VM_CONTEXT1_CNTL2, 0);
	WREG32(VM_CONTEXT1_CNTL, 0);
	WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |
				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);

	cayman_pcie_gart_tlb_flush(rdev);
	DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX).\n",
		 (unsigned)(rdev->mc.gtt_size >> 20),
		 (unsigned long long)rdev->gart.table_addr);
	rdev->gart.ready = true;
	return 0;
}
-----children-----
1,2
1,3
1,4
3,4
3,5
5,6
5,7
6,7
8,9
8,10
11,12
11,13
11,14
11,15
11,16
11,17
11,18
11,19
11,20
11,21
11,22
11,23
11,24
11,25
11,26
11,27
11,28
11,29
11,30
11,31
11,32
11,33
11,34
11,35
11,36
11,37
11,38
12,13
13,14
13,15
13,16
15,16
17,18
19,20
19,21
20,21
20,22
21,22
21,23
22,23
22,24
23,24
27,28
29,30
29,31
30,31
31,32
31,33
31,34
32,33
34,35
34,36
35,36
39,40
40,41
41,42
43,44
44,45
44,46
45,46
47,48
47,49
48,49
50,51
52,53
52,54
53,54
55,56
56,57
58,59
59,60
59,61
60,61
62,63
64,65
65,66
65,67
65,68
66,67
68,69
70,71
70,72
71,72
71,73
72,73
72,74
73,74
73,75
74,75
74,76
75,76
76,77
76,78
79,80
81,82
83,84
85,86
87,88
89,90
90,91
90,92
90,93
91,92
93,94
95,96
95,97
96,97
96,98
97,98
97,99
98,99
98,100
99,100
101,102
103,104
105,106
105,107
106,107
109,110
109,111
110,111
113,114
114,115
114,116
114,117
115,116
117,118
119,120
119,121
120,121
122,123
124,125
125,126
125,127
125,128
126,127
128,129
130,131
130,132
131,132
133,134
133,135
134,135
137,138
138,139
138,140
138,141
139,140
141,142
143,144
143,145
144,145
144,146
145,146
145,147
146,147
151,152
152,153
152,154
152,155
153,154
155,156
157,158
157,159
158,159
158,160
159,160
159,161
160,161
165,166
166,167
166,168
166,169
167,168
169,170
171,172
171,173
172,173
172,174
173,174
173,175
174,175
179,180
180,181
180,182
180,183
181,182
183,184
185,186
185,187
186,187
187,188
189,190
189,191
190,191
190,192
191,192
191,193
192,193
197,198
198,199
198,200
198,201
199,200
201,202
204,205
205,206
205,207
205,208
206,207
208,209
210,211
210,212
211,212
211,213
212,213
214,215
214,216
215,216
218,219
220,221
221,222
221,223
221,224
222,223
226,227
227,228
227,229
227,230
228,229
232,233
233,234
233,235
233,236
234,235
238,239
238,240
238,241
238,242
239,240
240,241
240,242
241,242
244,245
244,246
245,246
248,249
249,250
251,252
251,253
251,254
252,253
253,254
253,255
253,256
254,255
256,257
256,258
257,258
259,260
260,261
260,262
261,262
265,266
266,267
266,268
266,269
267,268
269,270
269,271
270,271
272,273
273,274
273,275
274,275
278,279
279,280
279,281
279,282
280,281
282,283
282,284
283,284
285,286
286,287
286,288
287,288
290,291
290,292
291,292
291,293
292,293
292,294
293,294
298,299
299,300
299,301
299,302
300,301
302,303
304,305
304,306
305,306
306,307
308,309
308,310
309,310
309,311
310,311
310,312
311,312
316,317
317,318
317,319
317,320
318,319
320,321
323,324
324,325
324,326
324,327
325,326
327,328
330,331
331,332
331,333
331,334
332,333
334,335
336,337
336,338
337,338
337,339
338,339
340,341
340,342
341,342
344,345
346,347
347,348
347,349
348,349
350,351
352,353
353,354
353,355
353,356
353,357
354,355
357,358
357,359
358,359
358,360
361,362
362,363
362,364
363,364
363,365
364,365
364,366
365,366
370,371
370,372
371,372
371,373
374,375
374,376
375,376
375,377
376,377
380,381
381,382
381,383
382,383
382,384
383,384
383,385
384,385
389,390
-----nextToken-----
2,4,7,9,10,14,16,18,24,25,26,28,33,36,37,38,42,46,49,51,54,57,61,63,67,69,77,78,80,82,84,86,88,92,94,100,102,104,107,108,111,112,116,118,121,123,127,129,132,135,136,140,142,147,148,149,150,154,156,161,162,163,164,168,170,175,176,177,178,182,184,188,193,194,195,196,200,202,203,207,209,213,216,217,219,223,224,225,229,230,231,235,236,237,242,243,246,247,250,255,258,262,263,264,268,271,275,276,277,281,284,288,289,294,295,296,297,301,303,307,312,313,314,315,319,321,322,326,328,329,333,335,339,342,343,345,349,351,355,356,359,360,366,367,368,369,372,373,377,378,379,385,386,387,388,390
-----computeFrom-----
20,21
20,22
44,45
44,46
70,71
70,72
71,72
71,73
72,73
72,74
73,74
73,75
74,75
74,76
76,77
76,78
95,96
95,97
96,97
96,98
97,98
97,99
98,99
98,100
119,120
119,121
130,131
130,132
143,144
143,145
157,158
157,159
171,172
171,173
189,190
189,191
210,211
210,212
211,212
211,213
240,241
240,242
244,245
244,246
256,257
256,258
260,261
260,262
269,270
269,271
273,274
273,275
282,283
282,284
286,287
286,288
290,291
290,292
308,309
308,310
336,337
336,338
337,338
337,339
362,363
362,364
381,382
381,383
-----guardedBy-----
24,36
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;ElaboratedTypeSpecifier;Name;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;Declarator;Name;IfStatement;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;FieldReference;IdExpression;Name;Name;LiteralExpression;ReturnStatement;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;IdExpression;Name;ReturnStatement;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;BinaryExpression;BinaryExpression;BinaryExpression;UnaryExpression;BinaryExpression;LiteralExpression;LiteralExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;FunctionCallExpression;IdExpression;Name;LiteralExpression;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FunctionCallExpression;UnaryExpression;IdExpression;Name;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;UnaryExpression;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FunctionCallExpression;UnaryExpression;IdExpression;Name;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;LiteralExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;UnaryExpression;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;FieldReference;FieldReference;IdExpression;Name;Name;Name;ExpressionStatement;BinaryExpression;FieldReference;FieldReference;IdExpression;Name;Name;Name;LiteralExpression;ReturnStatement;LiteralExpression;
-----ast_node-----
int cayman_pcie_gart_enable(struct radeon_device *rdev){	int i, r;	if (rdev->gart.robj == NULL) {		dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");		return -EINVAL;	}	r = radeon_gart_table_vram_pin(rdev);	if (r)		return r;	radeon_gart_restore(rdev);	/* Setup TLB control */	WREG32(MC_VM_MX_L1_TLB_CNTL,	       (0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL |	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU);	/* Setup L2 cache */	WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7) |	       CONTEXT1_IDENTITY_ACCESS_MODE(1));	WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE);	WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |	       L2_CACHE_BIGK_FRAGMENT_SIZE(6));	/* setup context0 */	WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12);	WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12);	WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12);	WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,			(u32)(rdev->dummy_page.addr >> 12));	WREG32(VM_CONTEXT0_CNTL2, 0);	WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);	WREG32(0x15D4, 0);	WREG32(0x15D8, 0);	WREG32(0x15DC, 0);	/* empty context1-7 */	for (i = 1; i < 8; i++) {		WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12);	}	/* enable context1-7 */	WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,	       (u32)(rdev->dummy_page.addr >> 12));	WREG32(VM_CONTEXT1_CNTL2, 0);	WREG32(VM_CONTEXT1_CNTL, 0);	WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);	cayman_pcie_gart_tlb_flush(rdev);	DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX).\n",		 (unsigned)(rdev->mc.gtt_size >> 20),		 (unsigned long long)rdev->gart.table_addr);	rdev->gart.ready = true;	return 0;}
int
cayman_pcie_gart_enable(struct radeon_device *rdev)
cayman_pcie_gart_enable
struct radeon_device *rdev
struct radeon_device
radeon_device
*rdev
*
rdev
{	int i, r;	if (rdev->gart.robj == NULL) {		dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");		return -EINVAL;	}	r = radeon_gart_table_vram_pin(rdev);	if (r)		return r;	radeon_gart_restore(rdev);	/* Setup TLB control */	WREG32(MC_VM_MX_L1_TLB_CNTL,	       (0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL |	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU);	/* Setup L2 cache */	WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7) |	       CONTEXT1_IDENTITY_ACCESS_MODE(1));	WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE);	WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |	       L2_CACHE_BIGK_FRAGMENT_SIZE(6));	/* setup context0 */	WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12);	WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12);	WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12);	WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,			(u32)(rdev->dummy_page.addr >> 12));	WREG32(VM_CONTEXT0_CNTL2, 0);	WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);	WREG32(0x15D4, 0);	WREG32(0x15D8, 0);	WREG32(0x15DC, 0);	/* empty context1-7 */	for (i = 1; i < 8; i++) {		WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12);	}	/* enable context1-7 */	WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,	       (u32)(rdev->dummy_page.addr >> 12));	WREG32(VM_CONTEXT1_CNTL2, 0);	WREG32(VM_CONTEXT1_CNTL, 0);	WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);	cayman_pcie_gart_tlb_flush(rdev);	DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX).\n",		 (unsigned)(rdev->mc.gtt_size >> 20),		 (unsigned long long)rdev->gart.table_addr);	rdev->gart.ready = true;	return 0;}
int i, r;
int i, r;
int
i
i
r
r
if (rdev->gart.robj == NULL) {		dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");		return -EINVAL;	}
rdev->gart.robj == NULL
rdev->gart.robj
rdev->gart
rdev
rdev
gart
robj
NULL
NULL
{		dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");		return -EINVAL;	}
dev_err(rdev->dev, "No VRAM object for PCIE GART.\n");
dev_err(rdev->dev, "No VRAM object for PCIE GART.\n")
dev_err
dev_err
rdev->dev
rdev
rdev
dev
"No VRAM object for PCIE GART.\n"
return -EINVAL;
-EINVAL
EINVAL
EINVAL
r = radeon_gart_table_vram_pin(rdev);
r = radeon_gart_table_vram_pin(rdev)
r
r
radeon_gart_table_vram_pin(rdev)
radeon_gart_table_vram_pin
radeon_gart_table_vram_pin
rdev
rdev
if (r)		return r;
r
r
return r;
r
r
radeon_gart_restore(rdev);
radeon_gart_restore(rdev)
radeon_gart_restore
radeon_gart_restore
rdev
rdev
WREG32(MC_VM_MX_L1_TLB_CNTL,	       (0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL |	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU);
WREG32(MC_VM_MX_L1_TLB_CNTL,	       (0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL |	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
WREG32
WREG32
MC_VM_MX_L1_TLB_CNTL
MC_VM_MX_L1_TLB_CNTL
(0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL |	       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU
(0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS |	       ENABLE_ADVANCED_DRIVER_MODEL
(0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING |	       SYSTEM_ACCESS_MODE_NOT_IN_SYS
(0xA << 7) |	       ENABLE_L1_TLB |	       ENABLE_L1_FRAGMENT_PROCESSING
(0xA << 7) |	       ENABLE_L1_TLB
(0xA << 7)
0xA << 7
0xA
7
ENABLE_L1_TLB
ENABLE_L1_TLB
ENABLE_L1_FRAGMENT_PROCESSING
ENABLE_L1_FRAGMENT_PROCESSING
SYSTEM_ACCESS_MODE_NOT_IN_SYS
SYSTEM_ACCESS_MODE_NOT_IN_SYS
ENABLE_ADVANCED_DRIVER_MODEL
ENABLE_ADVANCED_DRIVER_MODEL
SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU
SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU
WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7) |	       CONTEXT1_IDENTITY_ACCESS_MODE(1));
WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7) |	       CONTEXT1_IDENTITY_ACCESS_MODE(1))
WREG32
WREG32
VM_L2_CNTL
VM_L2_CNTL
ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7) |	       CONTEXT1_IDENTITY_ACCESS_MODE(1)
ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |	       EFFECTIVE_L2_QUEUE_SIZE(7)
ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |	       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE
ENABLE_L2_CACHE |	       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE
ENABLE_L2_CACHE
ENABLE_L2_CACHE
ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE
ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE
ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE
ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE
EFFECTIVE_L2_QUEUE_SIZE(7)
EFFECTIVE_L2_QUEUE_SIZE
EFFECTIVE_L2_QUEUE_SIZE
7
CONTEXT1_IDENTITY_ACCESS_MODE(1)
CONTEXT1_IDENTITY_ACCESS_MODE
CONTEXT1_IDENTITY_ACCESS_MODE
1
WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE);
WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE)
WREG32
WREG32
VM_L2_CNTL2
VM_L2_CNTL2
INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE
INVALIDATE_ALL_L1_TLBS
INVALIDATE_ALL_L1_TLBS
INVALIDATE_L2_CACHE
INVALIDATE_L2_CACHE
WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |	       L2_CACHE_BIGK_FRAGMENT_SIZE(6));
WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |	       L2_CACHE_BIGK_FRAGMENT_SIZE(6))
WREG32
WREG32
VM_L2_CNTL3
VM_L2_CNTL3
L2_CACHE_BIGK_ASSOCIATIVITY |	       L2_CACHE_BIGK_FRAGMENT_SIZE(6)
L2_CACHE_BIGK_ASSOCIATIVITY
L2_CACHE_BIGK_ASSOCIATIVITY
L2_CACHE_BIGK_FRAGMENT_SIZE(6)
L2_CACHE_BIGK_FRAGMENT_SIZE
L2_CACHE_BIGK_FRAGMENT_SIZE
6
WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12);
WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_START_ADDR
VM_CONTEXT0_PAGE_TABLE_START_ADDR
rdev->mc.gtt_start >> 12
rdev->mc.gtt_start
rdev->mc
rdev
rdev
mc
gtt_start
12
WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12);
WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_END_ADDR
VM_CONTEXT0_PAGE_TABLE_END_ADDR
rdev->mc.gtt_end >> 12
rdev->mc.gtt_end
rdev->mc
rdev
rdev
mc
gtt_end
12
WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12);
WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_BASE_ADDR
VM_CONTEXT0_PAGE_TABLE_BASE_ADDR
rdev->gart.table_addr >> 12
rdev->gart.table_addr
rdev->gart
rdev
rdev
gart
table_addr
12
WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,			(u32)(rdev->dummy_page.addr >> 12));
WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,			(u32)(rdev->dummy_page.addr >> 12))
WREG32
WREG32
VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR
VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR
(u32)(rdev->dummy_page.addr >> 12)
(u32)
u32
u32
rdev->dummy_page.addr >> 12
rdev->dummy_page.addr
rdev->dummy_page
rdev
rdev
dummy_page
addr
12
WREG32(VM_CONTEXT0_CNTL2, 0);
WREG32(VM_CONTEXT0_CNTL2, 0)
WREG32
WREG32
VM_CONTEXT0_CNTL2
VM_CONTEXT0_CNTL2
0
WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);
WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT)
WREG32
WREG32
VM_CONTEXT0_CNTL
VM_CONTEXT0_CNTL
ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
ENABLE_CONTEXT
ENABLE_CONTEXT
PAGE_TABLE_DEPTH(0)
PAGE_TABLE_DEPTH
PAGE_TABLE_DEPTH
0
RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
WREG32(0x15D4, 0);
WREG32(0x15D4, 0)
WREG32
WREG32
0x15D4
0
WREG32(0x15D8, 0);
WREG32(0x15D8, 0)
WREG32
WREG32
0x15D8
0
WREG32(0x15DC, 0);
WREG32(0x15DC, 0)
WREG32
WREG32
0x15DC
0
for (i = 1; i < 8; i++) {		WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12);	}
i = 1;
i = 1
i
i
1
i < 8
i
i
8
i++
i
i
{		WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);		WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12);	}
WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0);
WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2), 0)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2)
VM_CONTEXT0_PAGE_TABLE_START_ADDR
VM_CONTEXT0_PAGE_TABLE_START_ADDR
(i << 2)
i << 2
i
i
2
0
WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0);
WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2), 0)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2)
VM_CONTEXT0_PAGE_TABLE_END_ADDR
VM_CONTEXT0_PAGE_TABLE_END_ADDR
(i << 2)
i << 2
i
i
2
0
WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12);
WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2),			rdev->gart.table_addr >> 12)
WREG32
WREG32
VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2)
VM_CONTEXT0_PAGE_TABLE_BASE_ADDR
VM_CONTEXT0_PAGE_TABLE_BASE_ADDR
(i << 2)
i << 2
i
i
2
rdev->gart.table_addr >> 12
rdev->gart.table_addr
rdev->gart
rdev
rdev
gart
table_addr
12
WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,	       (u32)(rdev->dummy_page.addr >> 12));
WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,	       (u32)(rdev->dummy_page.addr >> 12))
WREG32
WREG32
VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR
VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR
(u32)(rdev->dummy_page.addr >> 12)
(u32)
u32
u32
rdev->dummy_page.addr >> 12
rdev->dummy_page.addr
rdev->dummy_page
rdev
rdev
dummy_page
addr
12
WREG32(VM_CONTEXT1_CNTL2, 0);
WREG32(VM_CONTEXT1_CNTL2, 0)
WREG32
WREG32
VM_CONTEXT1_CNTL2
VM_CONTEXT1_CNTL2
0
WREG32(VM_CONTEXT1_CNTL, 0);
WREG32(VM_CONTEXT1_CNTL, 0)
WREG32
WREG32
VM_CONTEXT1_CNTL
VM_CONTEXT1_CNTL
0
WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT);
WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT)
WREG32
WREG32
VM_CONTEXT1_CNTL
VM_CONTEXT1_CNTL
ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0) |				RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
ENABLE_CONTEXT
ENABLE_CONTEXT
PAGE_TABLE_DEPTH(0)
PAGE_TABLE_DEPTH
PAGE_TABLE_DEPTH
0
RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
RANGE_PROTECTION_FAULT_ENABLE_DEFAULT
cayman_pcie_gart_tlb_flush(rdev);
cayman_pcie_gart_tlb_flush(rdev)
cayman_pcie_gart_tlb_flush
cayman_pcie_gart_tlb_flush
rdev
rdev
DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX).\n",		 (unsigned)(rdev->mc.gtt_size >> 20),		 (unsigned long long)rdev->gart.table_addr);
DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX).\n",		 (unsigned)(rdev->mc.gtt_size >> 20),		 (unsigned long long)rdev->gart.table_addr)
DRM_INFO
DRM_INFO
"PCIE GART of %uM enabled (table at 0x%016llX).\n"
(unsigned)(rdev->mc.gtt_size >> 20)
unsigned
unsigned

(rdev->mc.gtt_size >> 20)
rdev->mc.gtt_size >> 20
rdev->mc.gtt_size
rdev->mc
rdev
rdev
mc
gtt_size
20
(unsigned long long)rdev->gart.table_addr
unsigned long long
unsigned long long

rdev->gart.table_addr
rdev->gart
rdev
rdev
gart
table_addr
rdev->gart.ready = true;
rdev->gart.ready = true
rdev->gart.ready
rdev->gart
rdev
rdev
gart
ready
true
return 0;
0
-----joern-----
(18,165,0)
(19,122,0)
(216,74,0)
(197,207,0)
(217,178,0)
(157,139,0)
(81,84,0)
(156,122,0)
(184,121,0)
(213,157,0)
(211,88,0)
(181,75,0)
(134,100,0)
(112,7,0)
(161,117,0)
(5,34,0)
(39,153,0)
(62,140,0)
(140,91,0)
(206,72,0)
(53,122,0)
(116,59,0)
(95,72,0)
(50,70,0)
(106,22,0)
(145,108,0)
(83,85,0)
(12,4,0)
(219,145,0)
(131,47,0)
(126,88,0)
(10,178,0)
(205,211,0)
(10,155,0)
(101,124,0)
(34,122,0)
(111,132,0)
(210,1,0)
(65,19,0)
(143,23,0)
(117,161,0)
(159,178,0)
(44,132,0)
(186,166,0)
(44,7,0)
(191,138,0)
(19,65,0)
(136,191,0)
(79,119,0)
(95,138,0)
(56,85,0)
(82,146,0)
(4,122,0)
(52,130,0)
(115,192,0)
(40,155,0)
(193,3,0)
(133,72,0)
(144,35,0)
(130,72,0)
(112,122,0)
(21,122,0)
(207,193,0)
(193,207,0)
(164,144,0)
(139,157,0)
(47,196,0)
(166,100,0)
(48,180,0)
(6,122,0)
(33,106,0)
(74,122,0)
(179,9,0)
(1,122,0)
(86,23,0)
(175,31,0)
(73,31,0)
(57,120,0)
(199,175,0)
(25,204,0)
(118,65,0)
(178,159,0)
(21,77,0)
(209,180,0)
(189,205,0)
(162,206,0)
(103,2,0)
(182,75,0)
(41,161,0)
(26,141,0)
(24,95,0)
(192,175,0)
(136,141,0)
(56,130,0)
(97,191,0)
(27,95,0)
(60,179,0)
(178,10,0)
(98,138,0)
(203,130,0)
(80,66,0)
(206,162,0)
(8,216,0)
(79,53,0)
(126,72,0)
(20,0,0)
(58,133,0)
(176,219,0)
(45,72,0)
(135,20,0)
(185,12,0)
(92,126,0)
(70,122,0)
(120,57,0)
(7,44,0)
(29,181,0)
(181,29,0)
(138,191,0)
(30,211,0)
(121,72,0)
(88,211,0)
(180,122,0)
(163,0,0)
(171,93,0)
(202,117,0)
(124,3,0)
(94,142,0)
(157,213,0)
(113,126,0)
(117,31,0)
(187,207,0)
(205,122,0)
(133,155,0)
(154,56,0)
(4,12,0)
(59,201,0)
(162,166,0)
(80,219,0)
(178,217,0)
(22,106,0)
(172,206,0)
(13,122,0)
(78,206,0)
(194,9,0)
(170,108,0)
(146,71,0)
(36,204,0)
(150,88,0)
(84,102,0)
(49,122,0)
(219,122,0)
(213,72,0)
(3,193,0)
(211,205,0)
(9,216,0)
(155,133,0)
(195,66,0)
(28,2,0)
(130,56,0)
(196,47,0)
(140,72,0)
(161,41,0)
(76,100,0)
(43,133,0)
(102,84,0)
(46,91,0)
(37,162,0)
(174,196,0)
(104,21,0)
(108,122,0)
(152,20,0)
(89,106,0)
(15,77,0)
(100,166,0)
(168,139,0)
(139,79,0)
(59,0,0)
(153,196,0)
(2,72,0)
(87,122,0)
(93,0,0)
(79,139,0)
(61,1,0)
(160,47,0)
(100,76,0)
(114,122,0)
(216,9,0)
(45,122,0)
(147,83,0)
(148,147,0)
(198,213,0)
(29,122,0)
(132,72,0)
(158,159,0)
(214,0,0)
(77,21,0)
(121,122,0)
(119,79,0)
(22,120,0)
(188,70,0)
(42,157,0)
(100,134,0)
(146,65,0)
(136,35,0)
(120,76,0)
(159,122,0)
(16,46,0)
(180,48,0)
(109,91,0)
(141,204,0)
(128,53,0)
(120,22,0)
(12,72,0)
(153,35,0)
(75,181,0)
(31,117,0)
(14,107,0)
(196,153,0)
(69,125,0)
(110,140,0)
(55,45,0)
(102,124,0)
(191,136,0)
(7,112,0)
(208,145,0)
(68,29,0)
(183,7,0)
(149,165,0)
(91,140,0)
(167,112,0)
(125,77,0)
(54,132,0)
(76,122,0)
(84,122,0)
(107,125,0)
(51,87,0)
(106,72,0)
(173,76,0)
(102,165,0)
(53,79,0)
(204,141,0)
(169,13,0)
(137,122,0)
(2,145,0)
(3,124,0)
(124,102,0)
(107,72,0)
(201,144,0)
(175,192,0)
(145,2,0)
(32,59,0)
(215,87,0)
(204,0,0)
(161,142,0)
(65,146,0)
(23,122,0)
(166,162,0)
(200,71,0)
(71,146,0)
(132,44,0)
(125,107,0)
(127,10,0)
(77,125,0)
(64,41,0)
(144,201,0)
(212,181,0)
(177,48,0)
(9,179,0)
(99,201,0)
(142,161,0)
(76,120,0)
(138,95,0)
(190,22,0)
(47,0,0)
(88,126,0)
(151,213,0)
(155,10,0)
(11,13,0)
(201,59,0)
(90,107,0)
(91,46,0)
(105,44,0)
(63,4,0)
(80,83,0)
(31,175,0)
(218,74,0)
(74,216,0)
(38,193,0)
(192,122,0)
(129,48,0)
(141,136,0)
(67,19,0)
(66,4,0)
(165,102,0)
(123,34,0)
(96,3,0)
(50,34,1)
(45,55,1)
(47,160,1)
(196,47,1)
(208,2,1)
(136,141,1)
(93,171,1)
(149,81,1)
(162,206,1)
(219,145,1)
(188,50,1)
(142,94,1)
(120,57,1)
(91,109,1)
(176,108,1)
(12,185,1)
(107,72,1)
(25,36,1)
(89,100,1)
(139,157,1)
(63,46,1)
(163,214,1)
(187,197,1)
(146,71,1)
(12,72,1)
(211,88,1)
(19,65,1)
(37,206,1)
(93,0,1)
(22,190,1)
(193,207,1)
(42,213,1)
(106,33,1)
(64,202,1)
(41,64,1)
(13,169,1)
(148,56,1)
(152,135,1)
(56,130,1)
(133,43,1)
(77,15,1)
(21,77,1)
(33,89,1)
(96,101,1)
(162,37,1)
(30,88,1)
(116,32,1)
(61,13,1)
(14,90,1)
(67,1,1)
(161,142,1)
(178,10,1)
(147,148,1)
(108,170,1)
(204,25,1)
(177,209,1)
(75,182,1)
(129,177,1)
(140,62,1)
(182,212,1)
(191,138,1)
(45,72,1)
(121,184,1)
(145,2,1)
(192,175,1)
(113,189,1)
(3,193,1)
(215,74,1)
(60,8,1)
(158,205,1)
(172,78,1)
(124,3,1)
(92,113,1)
(66,195,1)
(138,98,1)
(170,145,1)
(150,126,1)
(26,144,1)
(161,41,1)
(206,72,1)
(54,167,1)
(128,20,1)
(0,163,1)
(24,141,1)
(120,22,1)
(127,155,1)
(43,58,1)
(80,219,1)
(101,165,1)
(99,153,1)
(140,72,1)
(16,91,1)
(69,107,1)
(66,4,1)
(135,93,1)
(206,172,1)
(65,146,1)
(153,39,1)
(46,91,1)
(7,44,1)
(216,9,1)
(46,16,1)
(126,72,1)
(190,106,1)
(175,31,1)
(88,126,1)
(138,95,1)
(79,139,1)
(115,84,1)
(185,63,1)
(146,82,1)
(4,12,1)
(117,161,1)
(151,198,1)
(209,192,1)
(8,218,1)
(80,66,1)
(211,30,1)
(125,69,1)
(207,187,1)
(165,18,1)
(195,17,1)
(82,71,1)
(104,112,1)
(83,147,1)
(9,179,1)
(78,173,1)
(53,79,1)
(17,4,1)
(90,104,1)
(29,181,1)
(180,48,1)
(84,102,1)
(91,140,1)
(86,143,1)
(181,75,1)
(31,117,1)
(100,134,1)
(62,110,1)
(39,196,1)
(178,217,1)
(44,132,1)
(121,72,1)
(174,20,1)
(40,133,1)
(88,150,1)
(98,95,1)
(189,21,1)
(144,201,1)
(74,216,1)
(118,67,1)
(213,151,1)
(130,52,1)
(210,61,1)
(107,14,1)
(52,203,1)
(173,45,1)
(47,0,1)
(171,136,1)
(168,157,1)
(7,183,1)
(159,178,1)
(59,0,1)
(198,128,1)
(212,68,1)
(133,72,1)
(109,140,1)
(214,70,1)
(154,130,1)
(167,29,1)
(58,158,1)
(87,51,1)
(145,208,1)
(81,121,1)
(130,72,1)
(20,0,1)
(97,138,1)
(106,72,1)
(9,194,1)
(141,204,1)
(10,127,1)
(191,97,1)
(2,72,1)
(80,83,1)
(194,179,1)
(94,41,1)
(20,152,1)
(199,115,1)
(183,44,1)
(219,176,1)
(197,38,1)
(157,213,1)
(125,107,1)
(131,174,1)
(68,180,1)
(18,149,1)
(153,196,1)
(157,42,1)
(155,133,1)
(73,199,1)
(186,162,1)
(136,191,1)
(123,87,1)
(76,100,1)
(112,7,1)
(105,132,1)
(169,11,1)
(32,99,1)
(144,164,1)
(56,154,1)
(164,201,1)
(203,46,1)
(102,165,1)
(201,59,1)
(103,28,1)
(77,125,1)
(184,17,1)
(155,40,1)
(71,200,1)
(15,125,1)
(44,105,1)
(51,215,1)
(202,73,1)
(27,24,1)
(218,23,1)
(1,210,1)
(95,72,1)
(34,5,1)
(100,166,1)
(28,76,1)
(11,53,1)
(5,123,1)
(10,155,1)
(76,120,1)
(55,19,1)
(79,119,1)
(205,211,1)
(160,131,1)
(23,86,1)
(213,72,1)
(166,186,1)
(22,106,1)
(126,92,1)
(132,72,1)
(38,96,1)
(95,27,1)
(166,162,1)
(59,116,1)
(200,118,1)
(139,168,1)
(135,0,1)
(70,188,1)
(2,103,1)
(143,159,1)
(36,26,1)
(179,60,1)
(132,111,1)
(204,0,1)
(48,129,1)
(111,54,1)
(102,124,1)
(9,17,2)
(145,2,2)
(172,17,2)
(11,17,2)
(66,4,2)
(166,17,2)
(213,17,2)
(216,9,2)
(100,134,2)
(50,17,2)
(76,17,2)
(120,57,2)
(144,201,2)
(20,17,2)
(115,17,2)
(4,46,2)
(138,20,2)
(84,102,2)
(98,20,2)
(184,17,2)
(126,72,2)
(211,88,2)
(138,95,2)
(201,20,2)
(93,0,2)
(112,17,2)
(191,20,2)
(117,161,2)
(141,20,2)
(3,193,2)
(165,17,2)
(33,17,2)
(20,0,2)
(212,17,2)
(12,46,2)
(185,46,2)
(106,17,2)
(44,132,2)
(79,119,2)
(64,17,2)
(148,46,2)
(216,17,2)
(10,155,2)
(175,17,2)
(141,204,2)
(206,72,2)
(93,20,2)
(193,207,2)
(128,17,2)
(96,17,2)
(104,17,2)
(86,17,2)
(88,126,2)
(186,17,2)
(127,17,2)
(192,17,2)
(139,17,2)
(123,17,2)
(147,46,2)
(171,20,2)
(125,107,2)
(46,91,2)
(100,166,2)
(100,17,2)
(162,17,2)
(23,17,2)
(181,17,2)
(135,20,2)
(5,17,2)
(153,20,2)
(166,162,2)
(63,46,2)
(126,17,2)
(146,17,2)
(79,17,2)
(116,20,2)
(182,17,2)
(12,72,2)
(154,46,2)
(95,72,2)
(218,17,2)
(176,17,2)
(113,17,2)
(175,31,2)
(151,17,2)
(209,17,2)
(195,17,2)
(42,17,2)
(27,20,2)
(206,17,2)
(152,20,2)
(124,3,2)
(73,17,2)
(65,17,2)
(47,20,2)
(196,20,2)
(39,20,2)
(76,100,2)
(90,17,2)
(199,17,2)
(125,17,2)
(153,196,2)
(67,17,2)
(219,145,2)
(36,20,2)
(7,17,2)
(15,17,2)
(108,17,2)
(74,17,2)
(118,17,2)
(210,17,2)
(121,72,2)
(19,65,2)
(131,20,2)
(26,20,2)
(130,72,2)
(198,17,2)
(193,17,2)
(53,17,2)
(25,20,2)
(168,17,2)
(208,17,2)
(164,20,2)
(59,20,2)
(107,72,2)
(205,211,2)
(89,17,2)
(117,17,2)
(163,17,2)
(143,17,2)
(179,17,2)
(14,17,2)
(174,20,2)
(75,17,2)
(77,17,2)
(58,17,2)
(107,17,2)
(80,83,2)
(30,17,2)
(74,216,2)
(56,46,2)
(48,17,2)
(81,17,2)
(112,7,2)
(21,77,2)
(146,71,2)
(54,17,2)
(136,20,2)
(38,17,2)
(204,0,2)
(167,17,2)
(194,17,2)
(196,47,2)
(3,17,2)
(29,181,2)
(183,17,2)
(173,17,2)
(180,17,2)
(17,46,2)
(31,117,2)
(13,17,2)
(84,17,2)
(133,17,2)
(37,17,2)
(1,17,2)
(2,17,2)
(144,20,2)
(111,17,2)
(80,66,2)
(155,133,2)
(204,20,2)
(102,17,2)
(52,46,2)
(80,219,2)
(201,59,2)
(95,20,2)
(197,17,2)
(76,120,2)
(60,17,2)
(31,17,2)
(129,17,2)
(169,17,2)
(132,17,2)
(152,17,2)
(133,72,2)
(145,17,2)
(205,17,2)
(215,17,2)
(92,17,2)
(103,17,2)
(28,17,2)
(56,130,2)
(51,17,2)
(87,17,2)
(140,72,2)
(24,20,2)
(106,72,2)
(159,178,2)
(53,79,2)
(161,17,2)
(150,17,2)
(102,165,2)
(91,140,2)
(94,17,2)
(121,17,2)
(9,179,2)
(99,20,2)
(44,17,2)
(157,17,2)
(178,217,2)
(61,17,2)
(178,17,2)
(161,142,2)
(69,17,2)
(88,17,2)
(211,17,2)
(178,10,2)
(130,46,2)
(45,17,2)
(207,17,2)
(181,75,2)
(29,17,2)
(71,17,2)
(170,17,2)
(136,191,2)
(102,124,2)
(213,72,2)
(124,17,2)
(158,17,2)
(189,17,2)
(149,17,2)
(2,72,2)
(22,106,2)
(142,17,2)
(202,17,2)
(187,17,2)
(219,17,2)
(20,20,2)
(105,17,2)
(188,17,2)
(157,213,2)
(82,17,2)
(59,0,2)
(41,17,2)
(135,17,2)
(70,17,2)
(177,17,2)
(83,46,2)
(4,12,2)
(68,17,2)
(79,139,2)
(155,17,2)
(132,72,2)
(101,17,2)
(43,17,2)
(120,17,2)
(180,48,2)
(214,17,2)
(120,22,2)
(78,17,2)
(47,0,2)
(45,72,2)
(55,17,2)
(7,44,2)
(8,17,2)
(19,17,2)
(40,17,2)
(21,17,2)
(203,46,2)
(65,146,2)
(77,125,2)
(66,17,2)
(159,17,2)
(160,20,2)
(32,20,2)
(22,17,2)
(191,138,2)
(10,17,2)
(18,17,2)
(200,17,2)
(192,175,2)
(34,17,2)
(0,17,2)
(162,206,2)
(139,157,2)
(161,41,2)
(190,17,2)
(97,20,2)
(136,141,2)
-----------------------------------
(0,i = 1)
(1,WREG32(VM_CONTEXT1_CNTL, 0)
(2,rdev->gart)
(3,ENABLE_L1_FRAGMENT_PROCESSING |\n\\n\\t       SYSTEM_ACCESS_MODE_NOT_IN_SYS |\n\\n\\t       ENABLE_ADVANCED_DRIVER_MODEL |\n\\n\\t       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
(4,r = radeon_gart_table_vram_pin(rdev)
(5,0)
(6,for (i = 1; i < 8; i++)
(7,rdev->mc.gtt_start >> 12)
(8,ENABLE_CONTEXT)
(9,PAGE_TABLE_DEPTH(0)
(10,rdev->dummy_page.addr >> 12)
(11,VM_CONTEXT1_CNTL2)
(12,radeon_gart_table_vram_pin(rdev)
(13,WREG32(VM_CONTEXT1_CNTL2, 0)
(14,mc)
(15,12)
(16,NULL)
(17,r)
(18,7)
(19,WREG32(VM_CONTEXT1_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
(20,i < 8)
(21,WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR, rdev->mc.gtt_end >> 12)
(22,rdev->gart.table_addr)
(23,WREG32(VM_CONTEXT0_CNTL2, 0)
(24,rdev)
(25,2)
(26,VM_CONTEXT0_PAGE_TABLE_BASE_ADDR)
(27,gart)
(28,rdev)
(29,WREG32(VM_L2_CNTL3, L2_CACHE_BIGK_ASSOCIATIVITY |\n\\n\\t       L2_CACHE_BIGK_FRAGMENT_SIZE(6)
(30,12)
(31,ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       EFFECTIVE_L2_QUEUE_SIZE(7)
(32,i)
(33,gart)
(34,WREG32(0x15D8, 0)
(35,)
(36,i)
(37,gtt_size)
(38,SYSTEM_ACCESS_MODE_NOT_IN_SYS)
(39,0)
(40,addr)
(41,EFFECTIVE_L2_QUEUE_SIZE(7)
(42,addr)
(43,dummy_page)
(44,rdev->mc.gtt_start)
(45,cayman_pcie_gart_tlb_flush(rdev)
(46,rdev->gart.robj == NULL)
(47,i << 2)
(48,INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE)
(49,r)
(50,0x15DC)
(51,0)
(52,dev)
(53,WREG32(VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR,\n\\n\\t       (u32)
(54,rdev)
(55,rdev)
(56,dev_err(rdev->dev, "No VRAM object for PCIE GART.\\n")
(57,unsigned long long)
(58,rdev)
(59,i << 2)
(60,0)
(61,VM_CONTEXT1_CNTL)
(62,gart)
(63,r)
(64,7)
(65,ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
(66,return r;)
(67,VM_CONTEXT1_CNTL)
(68,VM_L2_CNTL3)
(69,gtt_end)
(70,WREG32(0x15DC, 0)
(71,PAGE_TABLE_DEPTH(0)
(72,struct radeon_device *rdev)
(73,ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE)
(74,WREG32(VM_CONTEXT0_CNTL, ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
(75,L2_CACHE_BIGK_FRAGMENT_SIZE(6)
(76,DRM_INFO("PCIE GART of %uM enabled (table at 0x%016llX)
(77,rdev->mc.gtt_end >> 12)
(78,rdev)
(79,(u32)
(80,RET)
(81,MC_VM_MX_L1_TLB_CNTL)
(82,RANGE_PROTECTION_FAULT_ENABLE_DEFAULT)
(83,return -EINVAL;)
(84,WREG32(MC_VM_MX_L1_TLB_CNTL,\n\\n\\t       (0xA << 7)
(85,)
(86,0)
(87,WREG32(0x15D4, 0)
(88,rdev->gart.table_addr)
(89,rdev)
(90,rdev)
(91,rdev->gart.robj)
(92,gart)
(93,i++)
(94,1)
(95,rdev->gart)
(96,ENABLE_L1_FRAGMENT_PROCESSING)
(97,12)
(98,table_addr)
(99,VM_CONTEXT0_PAGE_TABLE_END_ADDR)
(100,(unsigned)
(101,ENABLE_L1_TLB)
(102,(0xA << 7)
(103,gart)
(104,VM_CONTEXT0_PAGE_TABLE_END_ADDR)
(105,gtt_start)
(106,rdev->gart)
(107,rdev->mc)
(108,rdev->gart.ready = true)
(109,robj)
(110,rdev)
(111,mc)
(112,WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR, rdev->mc.gtt_start >> 12)
(113,rdev)
(114,if (rdev->gart.robj == NULL)
(115,VM_L2_CNTL)
(116,2)
(117,ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       EFFECTIVE_L2_QUEUE_SIZE(7)
(118,ENABLE_CONTEXT)
(119,u32)
(120,(unsigned long long)
(121,radeon_gart_restore(rdev)
(122,)
(123,0x15D8)
(124,ENABLE_L1_TLB |\n\\n\\t       ENABLE_L1_FRAGMENT_PROCESSING |\n\\n\\t       SYSTEM_ACCESS_MODE_NOT_IN_SYS |\n\\n\\t       ENABLE_ADVANCED_DRIVER_MODEL |\n\\n\\t       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
(125,rdev->mc.gtt_end)
(126,rdev->gart)
(127,12)
(128,VM_CONTEXT1_PROTECTION_FAULT_DEFAULT_ADDR)
(129,INVALIDATE_L2_CACHE)
(130,rdev->dev)
(131,i)
(132,rdev->mc)
(133,rdev->dummy_page)
(134,unsigned)
(135,i)
(136,WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2)
(137,i)
(138,rdev->gart.table_addr)
(139,rdev->dummy_page.addr >> 12)
(140,rdev->gart)
(141,VM_CONTEXT0_PAGE_TABLE_BASE_ADDR + (i << 2)
(142,CONTEXT1_IDENTITY_ACCESS_MODE(1)
(143,VM_CONTEXT0_CNTL2)
(144,WREG32(VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2)
(145,rdev->gart.ready)
(146,PAGE_TABLE_DEPTH(0)
(147,-EINVAL)
(148,EINVAL)
(149,0xA)
(150,table_addr)
(151,dummy_page)
(152,8)
(153,WREG32(VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2)
(154,"No VRAM object for PCIE GART.\\n")
(155,rdev->dummy_page.addr)
(156,if (r)
(157,rdev->dummy_page.addr)
(158,VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR)
(159,WREG32(VM_CONTEXT0_PROTECTION_FAULT_DEFAULT_ADDR,\n\\n\\t\\t\\t(u32)
(160,2)
(161,EFFECTIVE_L2_QUEUE_SIZE(7)
(162,rdev->mc.gtt_size)
(163,1)
(164,0)
(165,0xA << 7)
(166,rdev->mc.gtt_size >> 20)
(167,VM_CONTEXT0_PAGE_TABLE_START_ADDR)
(168,12)
(169,0)
(170,true)
(171,i)
(172,mc)
(173,"PCIE GART of %uM enabled (table at 0x%016llX)
(174,VM_CONTEXT0_PAGE_TABLE_START_ADDR)
(175,ENABLE_L2_CACHE |\n\\n\\t       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       EFFECTIVE_L2_QUEUE_SIZE(7)
(176,0)
(177,INVALIDATE_ALL_L1_TLBS)
(178,(u32)
(179,PAGE_TABLE_DEPTH(0)
(180,WREG32(VM_L2_CNTL2, INVALIDATE_ALL_L1_TLBS | INVALIDATE_L2_CACHE)
(181,L2_CACHE_BIGK_ASSOCIATIVITY |\n\\n\\t       L2_CACHE_BIGK_FRAGMENT_SIZE(6)
(182,6)
(183,12)
(184,rdev)
(185,rdev)
(186,20)
(187,SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
(188,0)
(189,VM_CONTEXT0_PAGE_TABLE_BASE_ADDR)
(190,table_addr)
(191,rdev->gart.table_addr >> 12)
(192,WREG32(VM_L2_CNTL, ENABLE_L2_CACHE |\n\\n\\t       ENABLE_L2_PTE_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE |\n\\n\\t       EFFECTIVE_L2_QUEUE_SIZE(7)
(193,SYSTEM_ACCESS_MODE_NOT_IN_SYS |\n\\n\\t       ENABLE_ADVANCED_DRIVER_MODEL |\n\\n\\t       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
(194,RANGE_PROTECTION_FAULT_ENABLE_DEFAULT)
(195,r)
(196,VM_CONTEXT0_PAGE_TABLE_START_ADDR + (i << 2)
(197,ENABLE_ADVANCED_DRIVER_MODEL)
(198,rdev)
(199,ENABLE_L2_CACHE)
(200,0)
(201,VM_CONTEXT0_PAGE_TABLE_END_ADDR + (i << 2)
(202,ENABLE_L2_PDE0_CACHE_LRU_UPDATE_BY_WRITE)
(203,rdev)
(204,i << 2)
(205,WREG32(VM_CONTEXT0_PAGE_TABLE_BASE_ADDR, rdev->gart.table_addr >> 12)
(206,rdev->mc)
(207,ENABLE_ADVANCED_DRIVER_MODEL |\n\\n\\t       SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU)
(208,ready)
(209,VM_L2_CNTL2)
(210,0)
(211,rdev->gart.table_addr >> 12)
(212,L2_CACHE_BIGK_ASSOCIATIVITY)
(213,rdev->dummy_page)
(214,i)
(215,0x15D4)
(216,ENABLE_CONTEXT | PAGE_TABLE_DEPTH(0)
(217,u32)
(218,VM_CONTEXT0_CNTL)
(219,return 0;)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^